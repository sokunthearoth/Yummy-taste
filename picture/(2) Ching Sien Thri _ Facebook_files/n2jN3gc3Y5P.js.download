if (self.CavalryLogger) { CavalryLogger.start_js(["XVMqx"]); }

__d("VideoQualityClassInternal",[],(function(a,b,c,d,e,f){e.exports={orderedValues:["sd","hd","uhd"]}}),null);
__d("dispatchEvent",[],(function(a,b,c,d,e,f){function b(b,c){var d;typeof a.Event==="function"?d=new a.Event(c):(d=a.document.createEvent("Event"),d.initEvent(c,!0,!0));b.dispatchEvent(d)}e.exports=b}),null);
__d("HiveStreaming",[],(function $module_HiveStreaming(global,require,requireDynamic,requireLazy,module,exports){!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}(function(){return function a(o,s,c){function d(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(p)return p(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return d(o[t][1][e]||e)},i,i.exports,a,o,s,c)}return s[t].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)d(c[e]);return d}({1:[function(e,t,r){"use strict";var n=e("./adapter_factory.js").adapterFactory({window:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=a.log,n=a.detectBrowser(e),i={browserDetails:n,commonShim:p,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(n.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;r("adapter.js shimming chrome."),(i.browserShim=o).shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),(i.browserShim=c).shimGetUserMedia(e),c.shimPeerConnection(e),c.shimOnTrack(e),c.shimRemoveStream(e),c.shimSenderGetStats(e),c.shimReceiverGetStats(e),c.shimRTCDataChannel(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"edge":if(!s||!s.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),i;r("adapter.js shimming edge."),(i.browserShim=s).shimGetUserMedia(e),s.shimGetDisplayMedia(e),s.shimPeerConnection(e),s.shimReplaceTrack(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"safari":if(!d||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),(i.browserShim=d).shimRTCIceServerUrls(e),d.shimCreateOfferLegacy(e),d.shimCallbacksAPI(e),d.shimLocalStreamsAPI(e),d.shimRemoteStreamsAPI(e),d.shimTrackEventTransceiver(e),d.shimGetUserMedia(e),p.shimRTCIceCandidate(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return i};var a=n(e("./utils")),o=n(e("./chrome/chrome_shim")),s=n(e("./edge/edge_shim")),c=n(e("./firefox/firefox_shim")),d=n(e("./safari/safari_shim")),p=n(e("./common_shim"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(a){if("object"!==(void 0===a?"undefined":s(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)c.wrapPeerConnectionEvent(a,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track};var r=new Event("track");r.track=t.track,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)}),n.stream.getTracks().forEach(function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t};var r=new Event("track");r.track=t,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var n=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var r=i.apply(this,arguments);return r||(r=n(this,e),this._senders.push(r)),r};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(n(t,e))})};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var r=this;this._senders=this._senders||[],t.apply(this,[e]),e.getTracks().forEach(function(t){var e=r._senders.find(function(e){return e.track===t});e&&r._senders.splice(r._senders.indexOf(e),1)})}}else if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this,i=arguments;if(0<arguments.length&&"function"==typeof e)return s.apply(this,arguments);if(0===s.length&&(0===arguments.length||"function"!=typeof e))return s.apply(this,[]);function a(e){var n={};return e.result().forEach(function(t){var r={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){r[e]=t.stat(e)}),n[r.id]=r}),n}function o(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))}return 2<=arguments.length?s.apply(this,[function(e){i[1](o(a(e)))},e]):new Promise(function(t,e){s.apply(n,[function(e){t(o(a(e)))},e])}).then(t,r)}},r.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),c.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,i=void 0;return this.getSenders().forEach(function(e){e.track===t&&(r?i=!0:r=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(n?i=!0:n=e),e.track===t}),i||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},r.shimAddTrackRemoveTrackWithNative=d,r.shimAddTrackRemoveTrack=function(o){if(!o.RTCPeerConnection)return;var e=c.detectBrowser(o);if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return d(o);var r=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})};var n=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[e.id]){var t=new o.MediaStream(e.getTracks());this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t}n.apply(this,[e])};var t=o.RTCPeerConnection.prototype.removeStream;function i(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(r.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:i})}o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[e.id];if(i)i.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var a=new o.MediaStream([t]);this._streams[e.id]=a,this._reverseStreams[a.id]=e,this.addStream(a)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var t=o.RTCPeerConnection.prototype[e];o.RTCPeerConnection.prototype[e]=function(){var r=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?t.apply(this,[function(e){var t=i(r,e);n[0].apply(null,[t])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):t.apply(this,arguments).then(function(e){return i(r,e)})}});var a=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=function(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),r.id)}),new RTCSessionDescription({type:e.type,sdp:i})}(this,arguments[0])),a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:i(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}},r.shimPeerConnection=function(r){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection);if(!r.RTCPeerConnection)return;["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},r.fixNegotiationNeeded=function(e){c.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};var c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils.js"));function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=n.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(r)&&this._shimmedLocalStreams[t.id].push(r):this._shimmedLocalStreams[t.id]=[t,r],r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var t=this.getSenders();i.apply(this,arguments);var n=this.getSenders().filter(function(e){return-1===t.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(n)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},r&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=n._shimmedLocalStreams[e].indexOf(r);-1!==t&&n._shimmedLocalStreams[e].splice(t,1),1===n._shimmedLocalStreams[e].length&&delete n._shimmedLocalStreams[e]}),a.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(a,e){if(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)return;if(!a.navigator.mediaDevices)return;if("function"!=typeof e)return void 0;a.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(function(e){var t=i.video&&i.video.width,r=i.video&&i.video.height,n=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:n||3}},t&&(i.video.mandatory.maxWidth=t),r&&(i.video.mandatory.maxHeight=r),a.navigator.mediaDevices.getUserMedia(i)})}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var o=e&&e.navigator;if(!o.mediaDevices)return;function s(i){if("object"!==(void 0===i?"undefined":d(i))||i.mandatory||i.optional)return i;var a={};return Object.keys(i).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var r="object"===d(i[t])?i[t]:{ideal:i[t]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){a.optional=a.optional||[];var e={};"number"==typeof r.ideal?(e[n("min",t)]=r.ideal,a.optional.push(e),(e={})[n("max",t)]=r.ideal):e[n("",t)]=r.ideal,a.optional.push(e)}void 0!==r.exact&&"number"!=typeof r.exact?(a.mandatory=a.mandatory||{},a.mandatory[n("",t)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(a.mandatory=a.mandatory||{},a.mandatory[n(e,t)]=r[e])})}}),i.advanced&&(a.optional=(a.optional||[]).concat(i.advanced)),a}function n(r,n){if(61<=c.version)return n(r);if((r=JSON.parse(JSON.stringify(r)))&&"object"===d(r.audio)){var e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};e((r=JSON.parse(JSON.stringify(r))).audio,"autoGainControl","googAutoGainControl"),e(r.audio,"noiseSuppression","googNoiseSuppression"),r.audio=s(r.audio)}if(r&&"object"===d(r.video)){var i=r.video.facingMode;i=i&&("object"===(void 0===i?"undefined":d(i))?i:{ideal:i});var t=c.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!o.mediaDevices.getSupportedConstraints||!o.mediaDevices.getSupportedConstraints().facingMode||t)){delete r.video.facingMode;var a=void 0;if("environment"===i.exact||"environment"===i.ideal?a=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(a=["front"]),a)return o.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return a.some(function(e){return t.label.toLowerCase().includes(e)})});return!t&&e.length&&a.includes("back")&&(t=e[e.length-1]),t&&(r.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),r.video=s(r.video),p("chrome: "+JSON.stringify(r)),n(r)})}r.video=s(r.video)}return p("chrome: "+JSON.stringify(r)),n(r)}function i(e){return 64<=c.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}}var c=a.detectBrowser(e);if(o.getUserMedia=function(e,t,r){n(e,function(e){o.webkitGetUserMedia(e,t,function(e){r&&r(i(e))})})}.bind(o),o.mediaDevices.getUserMedia){var r=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){return n(e,function(t){return r(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(i(e))})})}}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils.js")),p=a.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;var i=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var t=new i(e),r=s["default"].parseCandidate(e.candidate),n=Object.assign(t,r);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new i(e)},t.RTCIceCandidate.prototype=i.prototype,c.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e})},r.shimMaxMessageSize=function(e){if(e.RTCSctpTransport||!e.RTCPeerConnection)return;var a=c.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,function(e){if(!e||!e.sdp)return!1;var t=s["default"].splitSections(e.sdp);return t.shift(),t.some(function(e){var t=s["default"].parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var e=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),t=function(e){var t=65536;return"firefox"===a.browser&&(t=a.version<57?-1===e?16384:2147483637:a.version<60?57===a.version?65535:65536:2147483637),t}(e),r=function(e,t){var r=65536;"firefox"===a.browser&&57===a.version&&(r=65535);var n=s["default"].matchPrefix(e.sdp,"a=max-message-size:");return 0<n.length?r=parseInt(n[0].substr(19),10):"firefox"===a.browser&&-1!==t&&(r=2147483637),r}(arguments[0],e),n=void 0;n=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);var i={};Object.defineProperty(i,"maxMessageSize",{get:function(){return n}}),this._sctp=i}return o.apply(this,arguments)}},r.shimSendThrowTypeError=function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,n){var i=r.send;r.send=function(){var e=arguments[0],t=e.length||e.size||e.byteLength;if("open"===r.readyState&&n.sctp&&t>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},c.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})},r.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})},r.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=c.detectBrowser(e);if("chrome"===t.browser&&71<=t.version)return;var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),r.apply(this,arguments)}};var n,i=e("sdp"),s=(n=i)&&n.__esModule?n:{"default":n},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=d["default"](e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=s.filterIceServers(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(a=c)&&a.__esModule?a:{"default":a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?n=!0:t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e)["catch"](function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(r){var n=s.detectBrowser(r);if("object"!==(void 0===r?"undefined":o(r))||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(e,t,r){return a.apply(this,[e||null]).then(function(r){if(n.version<53&&!t)try{r.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}return r}).then(t,r)}},r.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map())}},r.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},r.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(t){var r=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})}},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(r,n){if(r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices)return;if(!r.navigator.mediaDevices)return;r.navigator.mediaDevices.getDisplayMedia=function(e){if(e&&e.video)return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,r.navigator.mediaDevices.getUserMedia(e);var t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=d.detectBrowser(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":c(e))&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},r&&r.prototype.getSettings){var o=r.prototype.getSettings;r.prototype.getSettings=function(){var e=o.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":c(e))&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getTracks().forEach(function(e){return n.call(r,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e,t){return t&&(this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]),n.call(this,e,t)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)})}})},r.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var r=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!r._remoteStreams.includes(e)){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!(0<=r._remoteStreams.indexOf(e))){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})}),t.apply(r,arguments)}}},r.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,i=t.createOffer,a=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=a.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};var r=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=r,r=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=r,r=function(e,t,r){var n=c.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=r},r.shimGetUserMedia=function(e){var n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){var t=n.mediaDevices,r=t.getUserMedia.bind(t);n.mediaDevices.getUserMedia=function(e){return r(i(e))}}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}.bind(n))},r.shimConstraints=i,r.shimRTCIceServerUrls=function(e){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var r=[],n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(i=JSON.parse(JSON.stringify(i))).urls=i.url,delete i.url,r.push(i)):r.push(e.iceServers[n])}e.iceServers=r}return new a(e,t)},e.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":d(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return n.apply(this,arguments)}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"));function i(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.extractVersion=a,r.wrapPeerConnectionEvent=function(e,n,i){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,a=t.addEventListener;t.addEventListener=function(e,r){if(e!==n)return a.apply(this,arguments);function t(e){var t=i(e);t&&r(t)}return this._eventMap=this._eventMap||{},this._eventMap[r]=t,a.apply(this,[e,t])};var o=t.removeEventListener;t.removeEventListener=function(e,t){if(e!==n||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);var r=this._eventMap[t];return delete this._eventMap[t],o.apply(this,[e,r])},Object.defineProperty(t,"on"+n,{get:function(){return this["_on"+n]},set:function(e){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),e&&this.addEventListener(n,this["_on"+n]=e)},enumerable:!0,configurable:!0})},r.disableLog=function(e){return"boolean"==typeof e?(n=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.disableWarnings=function(e){return"boolean"==typeof e?(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.log=function(){if("object"===("undefined"==typeof window?"undefined":s(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof emptyFunction&&emptyFunction.apply(console,arguments)}},r.deprecated=function(e,t){if(!i)return},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function a(o){return"object"!==(void 0===o?"undefined":s(o))?o:Object.keys(o).reduce(function(e,t){var r="object"===s(o[t]),n=r?a(o[t]):o[t],i=r&&!Object.keys(n).length;return void 0===n||i?e:Object.assign(e,c({},t,n))},{})},r.walkStats=o,r.filterStats=function(r,t,e){var n=e?"outbound-rtp":"inbound-rtp",i=new Map();if(null===t)return i;var a=[];return r.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){r.forEach(function(e){e.type===n&&e.trackId===t.id&&o(r,e,i)})}),i};var n=!0,i=!0;function a(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function o(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(e){e.endsWith("Id")?o(t,t.get(r[e]),n):e.endsWith("Ids")&&r[e].forEach(function(e){o(t,t.get(e),n)})}))}},{}],16:[function(e,t,r){"use strict";var G=e("sdp");function c(e,t,r,n,i){var a=G.writeRtpDescription(e.kind,t);if(a+=G.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=G.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(n?n.id:"-")+" "+o+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+G.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+G.localCName+"\r\n"),a}function A(d,p){function u(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]}var f={codecs:[],headerExtensions:[],fecMechanisms:[]};return d.codecs.forEach(function(r){for(var e=0;e<p.codecs.length;e++){var t=p.codecs[e];if(r.name.toLowerCase()===t.name.toLowerCase()&&r.clockRate===t.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&t.parameters.apt&&(n=r,i=t,a=d.codecs,o=p.codecs,c=s=void 0,s=u(n.parameters.apt,a),c=u(i.parameters.apt,o),!s||!c||s.name.toLowerCase()!==c.name.toLowerCase()))continue;(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(r.numChannels,t.numChannels),f.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}var n,i,a,o,s,c}),d.headerExtensions.forEach(function(e){for(var t=0;t<p.headerExtensions.length;t++){var r=p.headerExtensions[t];if(e.uri===r.uri){f.headerExtensions.push(r);break}}}),f}function a(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function N(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function m(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(I,j){function L(e,t){t.addTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("addtrack",{track:e}))}function i(e,t,r,n){var i=new Event("track");i.track=t,i.receiver=r,i.transceiver={receiver:r},i.streams=n,I.setTimeout(function(){e._dispatchEvent("track",i)})}function n(e){var t=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=r[e].bind(r)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw m("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=function(e,n){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&!1;var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!i?i=!0:0===e.indexOf("stun:")&&14393<=n&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers||[],j),this._iceGatherers=[],e.iceCandidatePoolSize)for(var n=e.iceCandidatePoolSize;0<n;n--)this._iceGatherers.push(new I.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=G.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},n.prototype.addTrack=function(t,e){if(this._isClosed)throw m("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw m("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(r=this.transceivers[n]);return r=r||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),r.track=t,r.stream=e,r.rtpSender=new I.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},n.prototype.addStream=function(t){var r=this;if(15025<=j)t.getTracks().forEach(function(e){r.addTrack(e,t)});else{var n=t.clone();t.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},n.prototype.removeTrack=function(t){if(this._isClosed)throw m("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof I.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw m("InvalidAccessError","Sender was not created by this connection.");var r=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var r=this;e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});e&&r.removeTrack(e)})},n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},n.prototype._createIceGatherer=function(r,e){var n=this;if(e&&0<r)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new I.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[r].bufferedCandidateEvents=[],this.transceivers[r].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;i.state=t?"completed":"gathering",null!==n.transceivers[r].bufferedCandidateEvents&&n.transceivers[r].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[r].bufferCandidates),i},n.prototype._gather=function(s,c){var d=this,p=this.transceivers[c].iceGatherer;if(!p.onlocalcandidate){var e=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null,p.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates),p.onlocalcandidate=function(e){if(!(d.usingBundle&&0<c)){var t=new Event("icecandidate");t.candidate={sdpMid:s,sdpMLineIndex:c};var r=e.candidate,n=!r||0===Object.keys(r).length;if(n)"new"!==p.state&&"gathering"!==p.state||(p.state="completed");else{"new"===p.state&&(p.state="gathering"),r.component=1,r.ufrag=p.getLocalParameters().usernameFragment;var i=G.writeCandidate(r);t.candidate=Object.assign(t.candidate,G.parseCandidate(i)),t.candidate.candidate=i,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}}var a=G.getMediaSections(d._localDescription.sdp);a[t.candidate.sdpMLineIndex]+=n?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",d._localDescription.sdp=G.getDescription(d._localDescription.sdp)+a.join("");var o=d.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),n||d._dispatchEvent("icecandidate",t),o&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}},I.setTimeout(function(){e.forEach(function(e){p.onlocalcandidate(e)})},0)}},n.prototype._createIceAndDtlsTransports=function(){var e=this,t=new I.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new I.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,t,r){var n=A(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(n.encodings=e.sendEncodingParameters,n.rtcp={cname:G.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(n)),r&&e.rtpReceiver&&0<n.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&j<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?n.encodings=e.recvEncodingParameters:n.encodings=[{}],n.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(n.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(n))},n.prototype.setLocalDescription=function(e){var t,u,f=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(m("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,f.signalingState)||f._isClosed)return Promise.reject(m("InvalidStateError","Can not set local "+e.type+" in state "+f.signalingState));if("offer"===e.type)t=G.splitSections(e.sdp),u=t.shift(),t.forEach(function(e,t){var r=G.parseRtpParameters(e);f.transceivers[t].localCapabilities=r}),f.transceivers.forEach(function(e,t){f._gather(e.mid,t)});else if("answer"===e.type){t=G.splitSections(f._remoteDescription.sdp),u=t.shift();var l=0<G.matchPrefix(u,"a=ice-lite").length;t.forEach(function(e,t){var r=f.transceivers[t],n=r.iceGatherer,i=r.iceTransport,a=r.dtlsTransport,o=r.localCapabilities,s=r.remoteCapabilities;if(!(G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length)&&!r.rejected){var c=G.getIceParameters(e,u),d=G.getDtlsParameters(e,u);l&&(d.role="server"),f.usingBundle&&0!==t||(f._gather(r.mid,t),"new"===i.state&&i.start(n,c,l?"controlling":"controlled"),"new"===a.state&&a.start(d));var p=A(o,s);f._transceive(r,0<p.codecs.length,!1)}})}return f._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?f._updateSignalingState("have-local-offer"):f._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(_){var w=this;if(-1===["offer","answer"].indexOf(_.type))return Promise.reject(m("TypeError",'Unsupported type "'+_.type+'"'));if(!a("setRemoteDescription",_.type,w.signalingState)||w._isClosed)return Promise.reject(m("InvalidStateError","Can not set remote "+_.type+" in state "+w.signalingState));var k={};w.remoteStreams.forEach(function(e){k[e.id]=e});var M=[],e=G.splitSections(_.sdp),D=e.shift(),x=0<G.matchPrefix(D,"a=ice-lite").length,O=0<G.matchPrefix(D,"a=group:BUNDLE ").length;w.usingBundle=O;var t=G.matchPrefix(D,"a=ice-options:")[0];return w.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var r=G.splitLines(e),n=G.getKind(e),i=G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length,a=r[0].substr(2).split(" ")[2],o=G.getDirection(e,D),s=G.parseMsid(e),c=G.getMid(e)||G.generateIdentifier();if(i||"application"===n&&("DTLS/SCTP"===a||"UDP/DTLS/SCTP"===a))w.transceivers[t]={mid:c,kind:n,protocol:a,rejected:!0};else{var d,p,u,f,l,m,h,v,y;!i&&w.transceivers[t]&&w.transceivers[t].rejected&&(w.transceivers[t]=w._createTransceiver(n,!0));var g,C,S=G.parseRtpParameters(e);i||(g=G.getIceParameters(e,D),(C=G.getDtlsParameters(e,D)).role="client"),h=G.parseRtpEncodingParameters(e);var T=G.parseRtcpParameters(e),R=0<G.matchPrefix(e,"a=end-of-candidates",D).length,P=G.matchPrefix(e,"a=candidate:").map(function(e){return G.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===_.type||"answer"===_.type)&&!i&&O&&0<t&&w.transceivers[t]&&(w._disposeIceAndDtlsTransports(t),w.transceivers[t].iceGatherer=w.transceivers[0].iceGatherer,w.transceivers[t].iceTransport=w.transceivers[0].iceTransport,w.transceivers[t].dtlsTransport=w.transceivers[0].dtlsTransport,w.transceivers[t].rtpSender&&w.transceivers[t].rtpSender.setTransport(w.transceivers[0].dtlsTransport),w.transceivers[t].rtpReceiver&&w.transceivers[t].rtpReceiver.setTransport(w.transceivers[0].dtlsTransport)),"offer"!==_.type||i)"answer"===_.type&&!i&&(p=(d=w.transceivers[t]).iceGatherer,u=d.iceTransport,f=d.dtlsTransport,l=d.rtpReceiver,m=d.sendEncodingParameters,v=d.localCapabilities,w.transceivers[t].recvEncodingParameters=h,w.transceivers[t].remoteCapabilities=S,w.transceivers[t].rtcpParameters=T,P.length&&"new"===u.state&&(!x&&!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):u.setRemoteCandidates(P)),O&&0!==t||("new"===u.state&&u.start(p,g,"controlling"),"new"===f.state&&f.start(C)),!A(d.localCapabilities,d.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,w._transceive(d,"sendrecv"===o||"recvonly"===o,"sendrecv"===o||"sendonly"===o),!l||"sendrecv"!==o&&"sendonly"!==o?delete d.rtpReceiver:(y=l.track,s?(k[s.stream]||(k[s.stream]=new I.MediaStream()),L(y,k[s.stream]),M.push([y,l,k[s.stream]])):(k["default"]||(k["default"]=new I.MediaStream()),L(y,k["default"]),M.push([y,l,k["default"]]))));else{(d=w.transceivers[t]||w._createTransceiver(n)).mid=c,d.iceGatherer||(d.iceGatherer=w._createIceGatherer(t,O)),P.length&&"new"===d.iceTransport.state&&(!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):d.iceTransport.setRemoteCandidates(P)),v=I.RTCRtpReceiver.getCapabilities(n),j<15019&&(v.codecs=v.codecs.filter(function(e){return"rtx"!==e.name})),m=d.sendEncodingParameters||[{ssrc:1001*(2*t+2)}];var b,E=!1;"sendrecv"===o||"sendonly"===o?(E=!d.rtpReceiver,l=d.rtpReceiver||new I.RTCRtpReceiver(d.dtlsTransport,n),E)&&(y=l.track,s&&"-"===s.stream||(b=s?(k[s.stream]||(k[s.stream]=new I.MediaStream(),Object.defineProperty(k[s.stream],"id",{get:function(){return s.stream}})),Object.defineProperty(y,"id",{get:function(){return s.track}}),k[s.stream]):(k["default"]||(k["default"]=new I.MediaStream()),k["default"])),b&&(L(y,b),d.associatedRemoteMediaStreams.push(b)),M.push([y,l,b])):d.rtpReceiver&&d.rtpReceiver.track&&(d.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===d.rtpReceiver.track.id});t&&(function(e,t){t.removeTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("removetrack",{track:e}))})(t,e)}),d.associatedRemoteMediaStreams=[]);d.localCapabilities=v,d.remoteCapabilities=S,d.rtpReceiver=l,d.rtcpParameters=T,d.sendEncodingParameters=m,d.recvEncodingParameters=h,w._transceive(w.transceivers[t],!1,E)}}}),void 0===w._dtlsRole&&(w._dtlsRole="offer"===_.type?"active":"passive"),w._remoteDescription={type:_.type,sdp:_.sdp},"offer"===_.type?w._updateSignalingState("have-remote-offer"):w._updateSignalingState("stable"),Object.keys(k).forEach(function(e){var n=k[e];if(n.getTracks().length){if(-1===w.remoteStreams.indexOf(n)){w.remoteStreams.push(n);var t=new Event("addstream");t.stream=n,I.setTimeout(function(){w._dispatchEvent("addstream",t)})}M.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&i(w,t,r,[n])})}}),M.forEach(function(e){e[2]||i(w,e[0],e[1],[])}),I.setTimeout(function(){w&&w.transceivers&&w.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(!1,e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,I.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},n.prototype._updateIceConnectionState=function(){var e,t={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t["new"]?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},n.prototype._updateConnectionState=function(){var e,t={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t["new"]?e="new":0<t.connected&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},n.prototype.createOffer=function(){var s=this;if(s._isClosed)return Promise.reject(m("InvalidStateError","Can not call createOffer after close"));var t=s.transceivers.filter(function(e){return"audio"===e.kind}).length,r=s.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(r=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(s.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)});0<t||0<r;)0<t&&(s._createTransceiver("audio"),t--),0<r&&(s._createTransceiver("video"),r--);var n=G.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(e,t){var r=e.track,n=e.kind,i=e.mid||G.generateIdentifier();e.mid=i,e.iceGatherer||(e.iceGatherer=s._createIceGatherer(t,s.usingBundle));var a=I.RTCRtpSender.getCapabilities(n);j<15019&&(a.codecs=a.codecs.filter(function(e){return"rtx"!==e.name})),a.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),a.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})});var o=e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}];r&&15019<=j&&"video"===n&&!o[0].rtx&&(o[0].rtx={ssrc:o[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new I.RTCRtpReceiver(e.dtlsTransport,n)),e.localCapabilities=a,e.sendEncodingParameters=o}),"max-compat"!==s._config.bundlePolicy&&(n+="a=group:BUNDLE "+s.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n",s.transceivers.forEach(function(e,t){n+=c(e,e.localCapabilities,"offer",e.stream,s._dtlsRole),n+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===s.iceGatheringState||0!==t&&s.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,n+="a="+G.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(n+="a=end-of-candidates\r\n"))});var i=new I.RTCSessionDescription({type:"offer",sdp:n});return Promise.resolve(i)},n.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(m("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(m("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var a=G.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(a+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var o=G.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach(function(e,t){if(!(o<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void (a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var r;e.stream&&("audio"===e.kind?r=e.stream.getAudioTracks()[0]:"video"===e.kind&&(r=e.stream.getVideoTracks()[0]),r&&15019<=j&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var n=A(e.localCapabilities,e.remoteCapabilities);!n.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=c(e,n,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var e=new I.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(e)},n.prototype.addIceCandidate=function(c){var d,p=this;return c&&void 0===c.sdpMLineIndex&&!c.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!p._remoteDescription)return t(m("InvalidStateError","Can not add ICE candidate without a remote description"));if(c&&""!==c.candidate){var r=c.sdpMLineIndex;if(c.sdpMid)for(var n=0;n<p.transceivers.length;n++)if(p.transceivers[n].mid===c.sdpMid){r=n;break}var i=p.transceivers[r];if(!i)return t(m("OperationError","Can not add ICE candidate"));if(i.rejected)return e();var a=0<Object.keys(c.candidate).length?G.parseCandidate(c.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return e();if(a.component&&1!==a.component)return e();if((0===r||0<r&&i.iceTransport!==p.transceivers[0].iceTransport)&&!N(i.iceTransport,a))return t(m("OperationError","Can not add ICE candidate"));var o=c.candidate.trim();0===o.indexOf("a=")&&(o=o.substr(2)),(d=G.getMediaSections(p._remoteDescription.sdp))[r]+="a="+(a.type?o:"end-of-candidates")+"\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join("")}else for(var s=0;s<p.transceivers.length&&(p.transceivers[s].rejected||(p.transceivers[s].iceTransport.addRemoteCandidate({}),(d=G.getMediaSections(p._remoteDescription.sdp))[s]+="a=end-of-candidates\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join(""),!p.usingBundle));s++);e()})},n.prototype.getStats=function(t){if(t&&t instanceof I.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw m("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&n.push(t[e].getStats())})}),Promise.all(n).then(function(e){var t=new Map();return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t=I[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then(function(t){var r=new Map();return Object.keys(t).forEach(function(e){t[e].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(t[e]),r.set(e,t[e])}),r})}}});var e=["createOffer","createAnswer"];return e.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?r.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):r.apply(this,arguments)}}),(e=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?r.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):r.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),n}},{sdp:17}],17:[function(e,t,r){"use strict";var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},p.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},p.getDescription=function(e){var t=p.splitSections(e);return t&&t[0]},p.getMediaSections=function(e){var t=p.splitSections(e);return t.shift(),t},p.matchPrefix=function(e,t){return p.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},p.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},p.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},p.parseIceOptions=function(e){return e.substr(14).split(" ")},p.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},p.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},p.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}},p.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},p.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},p.writeFmtp=function(t){var e="",r=t.payloadType;if(void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var n=[];Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return e},p.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},p.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},p.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return-1<n?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},p.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},p.getMid=function(e){var t=p.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},p.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},p.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:p.matchPrefix(e+t,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},p.getIceParameters=function(e,t){var r=p.splitLines(e);return{usernameFragment:(r=r.concat(p.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},p.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},p.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=p.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var i=r[n],a=p.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var o=p.parseRtpMap(a),s=p.matchPrefix(e,"a=fmtp:"+i+" ");switch(o.parameters=s.length?p.parseFmtp(s[0]):{},o.rtcpFeedback=p.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(p.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return p.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(p.parseExtmap(e))}),t},p.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=0<t.codecs.length?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=p.writeRtpMap(e),r+=p.writeFmtp(e),r+=p.writeRtcpFb(e)});var n=0;return t.codecs.forEach(function(e){e.maxptime>n&&(n=e.maxptime)}),0<n&&(r+="a=maxptime:"+n+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){r+=p.writeExtmap(e)}),r},p.parseRtpEncodingParameters=function(e){var r,n=[],t=p.parseRtpParameters(e),i=-1!==t.fecMechanisms.indexOf("RED"),a=-1!==t.fecMechanisms.indexOf("ULPFEC"),o=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,c=p.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});0<c.length&&1<c[0].length&&c[0][0]===s&&(r=c[0][1]),t.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&r&&(t.rtx={ssrc:r}),n.push(t),i&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});var d=p.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=d})),n},p.parseRtcpParameters=function(e){var t={},r=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=p.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length,t.compound=0===n.length;var i=p.matchPrefix(e,"a=rtcp-mux");return t.mux=0<i.length,t},p.parseMsid=function(e){var t,r=p.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<n.length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},p.generateSessionId=function(){return Math.random().toString().substr(2,21)},p.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||p.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(e,t,r,n){var i=p.writeRtpDescription(e.kind,t);if(i+=p.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=p.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),i},p.getDirection=function(e,t){for(var r=p.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?p.getDirection(t):"sendrecv"},p.getKind=function(e){return p.splitLines(e)[0].split(" ")[0].substr(2)},p.isRejected=function(e){return"0"===e.split(" ",2)[1]},p.parseMLine=function(e){var t=p.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},p.parseOLine=function(e){var t=p.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},p.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=p.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=p)},{}]},{},[1])(1)}),!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.i)define([],i);else{var n=i();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return f=[function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(26),s=n(3),e=n(41),h=n(113),o=(u.getId=function(){return"["+a.time()+"] ["+a.h().id+"]"},u);function u(){}var a=(f.o=function(t){this.startTime=new Date(),t.apply(this.u),this.l=this.u.resolve(e.p.v),this.g=this.u.resolve(e.p.T),this.m=this.l.O(),this.R=!1,this.l.init()},f._=function(t,i,n){this.I<1&&(this.o(i),this.A(t,n),this.N(t)),this.I+=1},f.k=function(){this.network=this.u.resolve(e.p.NETWORK),this.network.init()},f.net=function(){return this.network},f.system=function(){return this.u},f.logger=function(){return this.g},f.C=function(){return this.l},f.D=function(t){return this.M.get(t)},f.A=function(t,i){var n=new h.j(t);return n.apply(i),this.M.set(t,n),n},f.N=function(t){this.P=this.D(t)},f.resolve=function(t){return null!=this.P?this.P.context.resolve(t):(!1,null)},f.h=function(){return this.P},f.time=function(){if(this.l)return this.l.time();throw new Error("Framework.time called on purged Framework")},f.setTimeout=function(t,i,n){if(void 0===n&&(n=!1),!this.l||this.R)throw new Error("Framework.setTimeout called on purging / purged Framework");return this.l.setTimeout(t,i,n)},f.clearTimeout=function(t){return this.l.clearTimeout(t)},f.setInterval=function(t,i){if(!this.l||this.R)throw new Error("Framework.setInterval called on purging / purged Framework");return this.l.setInterval(t,i)},f.clearInterval=function(t){return this.l.clearInterval(t)},f.L=function(){return this.l.L()},f.H=function(t){if(void 0===t&&(t=!1),t)return this.U(t),void (this.I=0);0!==this.I&&(this.I<=1&&this.U(),this.I-=1)},f.U=function(t){var i=this;void 0===t&&(t=!1),this.R=!0,this.l&&this.l.F(t,function(){i.R&&i.reset()})},f.reset=function(){this.u.G(),this.u=new r.B(),this.M=new s(),this.P=null,this.startTime=null,this.m=!1,this.seed=null,this.l=null,this.network=null,this.g=null},f.V=function(t){this.seed=t},f.random=function(){return null==this.seed&&(this.seed=new Date().getTime()),this.seed=(9301*this.seed+49297)%233280,this.seed/233280},f.q=function(){return this.startTime},f.O=function(){return this.m},f.Y=o,f.p=e.p,f.I=0,f.u=new r.B(),f.M=new s(),f.m=!1,f);function f(){}i.Framework=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(115),s=n(19),e=n(7),o=n(2),u=n(2),h=e.W.K,f=(e.W.$,e.W.X),c=e.W.J,a=(l.Z=function(t){return void 0===t&&(t="3.0.0"),void 0===this.tt&&(this.tt=new l(t)),this.tt},l.prototype.it=function(){r.rt.Z().nt([16,17,88],function(){try{throw new Error("Upload console logs")}catch(t){atatus.notify(t),window.console&&!1}})},l.prototype.st=function(){try{throw new Error("test")}catch(t){var i=t.stack.match(/(\/\/.*\.js)/i);if(i&&0<i.length)return i[0]}},l.prototype.setUser=function(t){this.et&&this.isActive&&atatus.setUser(t)},l.prototype.ht=function(t){this.logger=t},l.prototype.setCustomData=function(t){this.et&&this.isActive&&atatus.setCustomData(t)},l.prototype.ot=function(t){for(var i in t)this.ut[i]=t[i]},l.prototype.at=function(t){this.ft=t},l.prototype.ct=function(){this.ft=null},l.prototype.logError=function(t,i,n,r,s){var e="",h=n&&u.lt[n]?u.lt[n]:u.dt.vt;if("string"==typeof i?e=i.trim():void 0!==i&&(r=i),(r instanceof Error||r&&"object"!=typeof r)&&(r={error:r.toString()}),(r=r||{}).errorCode=n||o.GENERIC_ERROR,this.logger&&(0<Object.keys(r).length?this.logger.warn(e+" "+t,r):this.logger.warn(e+" "+t)),e&&(s=s?s.concat([e]):[e]),r.forceSend=!0,this.et&&this.isActive)try{throw new Error(t)}catch(t){atatus.notify(t,r,s)}if(this.ft)try{this.ft({pluginVersion:this.version,reportingId:this.ut?this.ut.reportingGuid:"",p2pId:this.ut?this.ut.p2pId:"",message:t,severity:h,code:r.errorCode})}catch(t){this.logger.warn("Error in the onErrorCallback",t)}},l.prototype.setTags=function(t){this.et&&this.isActive&&atatus.setTags(t)},l.prototype.notify=function(t,i){this.et&&this.isActive&&((i=i||{}).forceSend=!0,atatus.notify(t,i))},l);function l(t){var o=this;if(this.isActive=!1,this.et="undefined"!=typeof atatus&&null!=atatus,this.ut={},this.version=t,l.tt)throw new Error("Error: Instantiation failed: Use AtatusLogger.getInstance() instead of new.");var u,i=null!=s.Et.key?s.Et.key:h,n=1==s.Et.enabledRUM,r=1==s.Et.enableKeyCombination,a=1==s.Et.enabledErrorFilter;a&&(u=this.st()),this.version=t,this.et&&(null==s.Et.enabled&&f||null!=s.Et.enabled&&1==s.Et.enabled)&&(atatus.config(i,{enableSourcemap:!0,disableRUM:!n,console:!1,version:t,beforeErrorSend:function(t){var i=!1;for(var n in t.customData=t.customData||{},void 0!==t.customData.forceSend&&(i=t.customData.forceSend,delete t.customData.forceSend,0===Object.keys(t.customData).length&&(t.customData=null)),o.ut)t.customData[n]=o.ut[n];if(!a||i)return!0;if(!u)return!1;try{var r=!1;if(t.backTraces){for(var s=0,e=t.backTraces;s<e.length;s++){var h=e[s];if(-1<h.f.indexOf(u)&&h.ln>c){r=!0;break}}r&&(t.name=t.name.replace(/%s \[[0-9]{2}:[0-9]{2}:[0-9]{2}:[0-9]+] /,""),0<=t.name.indexOf("Status Code Error:")&&(t.tags=["Plugin Error Code",t.name.split(":")[1].trim()]))}return r}catch(t){return!1}}}).install(),r&&this.it(),this.isActive=!0,window.console&&!1,a&&!u&&this.logError("Could not extract error filter"))}i.ErrorMonitor=a},function(t,i,n){"use strict";var r,s,e,h,o,u,a,f,c,l,v,d,E,w,p,g,b,y,T,m,O,S,R,_,I,A,N,k,C,D,M,j,P,L,H,U,F,G,x,B,V,q,Q,Y,K,W,$,X,J,z,Z,tt,it,nt,rt,st,et,ht;Object.defineProperty(i,"s",{value:!0}),(h=e=i.dt||(i.dt={}))[h.vt=0]="NORMAL",h[h.wt=1]="HIGH",h[h.CRITICAL=2]="CRITICAL",(u=o=i.pt||(i.pt={}))[u.gt=268435456]="BASE_CODE",u[u.bt=268435457]="FIRE_SERVER_CONNECTED_WITH_SWARM",u[u.yt=268435458]="FIRE_SERVER_CONNECTED_WITHOUT_SWARM",u[u.Tt=268435459]="CONNECTION_NOT_ESTABLISHED",u[u.Ot=268435460]="SEND_MESSAGE_TO_NON_EXISTING_CHANNEL",u[u.St=268435461]="RECEIVED_MESSAGE_FROM_NON_EXISTING_CONNECTION",(a=i.Rt||(i.Rt={}))[a.gt=536870912]="BASE_CODE",a[a._t=536870913]="CREATE_OFFER",a[a.It=536870914]="CREATE_ANSWER",a[a.At=536870915]="SIGNALING_STATE_CLOSED",a[a.Nt=536870916]="SET_LOCAL_DESCRIPTION_FAILED",a[a.kt=536870917]="NEGOTIATION_FAILURE",a[a.Ct=536870918]="SETUP_CHANNEL_ERROR",a[a.Dt=536870919]="ICE_CONNECTION_FAILED",a[a.Mt=536870920]="SET_REMOTE_DESCRIPTION",a[a.jt=536870921]="UPDATE_ICE_CANDIDATES",a[a.Pt=536870922]="ANSWER_RECEIVED",a[a.Lt=536870923]="OFFER_RECEIVED",a[a.Ht=536870924]="SEND_CANDIDATES",a[a.Ut=536870925]="CLOSE_CONNECTION",a[a.Ft=536870926]="SEND_DATA",(f=i.Gt||(i.Gt={}))[f.gt=805306368]="BASE_CODE",f[f.xt=805306369]="SEND_MSG_WITHOUT_CHANNEL",f[f.Bt=805306370]="MSG_TRIGGER_ERROR",f[f.Vt=805306371]="CONNECTION_TIMEOUT",(c=i.qt||(i.qt={}))[c.gt=1073741824]="BASE_CODE",c[c.Ut=1073741825]="CLOSE_CONNECTION",c[c.Qt=1073741826]="P2P_DISPATCHER_ERROR",(l=i.Yt||(i.Yt={}))[l.gt=1342177280]="BASE_CODE",l[l.Kt=1342177281]="CONSTRUCT_MESSAGE",l[l.Wt=1342177282]="DROPPED_MESSAGE",l[l.$t=1342177283]="SEND_MESSAGE",l[l.Xt=1342177284]="RECEIVE_MESSAGE",(v=i.Jt||(i.Jt={}))[v.gt=1610612736]="BASE_CODE",v[v.zt=1610612737]="NEW_DISPATCHER",(d=i.Zt||(i.Zt={}))[d.gt=1879048192]="BASE_CODE",d[d.ti=1879048193]="INIT_CACHE",d[d.ii=1879048194]="PUT_OPERATION",d[d.ni=1879048195]="GET_OPERATION",d[d.ri=1879048196]="CONTAINS_OPERATION",d[d.si=1879048197]="GET_KEYS_OPERATION",d[d.ei=1879048198]="GET_ELEMENTS_OPERATION",(E=i.hi||(i.hi={}))[E.gt=2147483648]="BASE_CODE",E[E.ii=2147483649]="PUT_OPERATION",E[E.ni=2147483650]="GET_OPERATION",E[E.ri=2147483651]="CONTAINS_OPERATION",E[E.si=2147483652]="GET_KEYS_OPERATION",E[E.ei=2147483653]="GET_ELEMENTS_OPERATION",E[E.oi=2147483654]="PURGE_CACHE_OPERATION",(w=i.ui||(i.ui={}))[w.gt=2415919104]="BASE_CODE",(p=i.ai||(i.ai={}))[p.gt=2684354560]="BASE_CODE",p[p.fi=2684354561]="DISCOVERED_PEERS",p[p.ci=2684354562]="LEADER_ELECTION",p[p.li=2684354563]="GC_MEMBERS",p[p.vi=2684354564]="ADD_LAN_MEMBER",p[p.di=2684354565]="ADD_RANDOM_MEMBER",p[p.Ei=2684354566]="SAMPLE_MEMBERSHIP",(g=i.wi||(i.wi={}))[g.gt=2952790016]="BASE_CODE",g[g.pi=2952790017]="SEND_ALL_HAVES",g[g.gi=2952790018]="SEND_HAVE",g[g.bi=2952790019]="UNKNOWN_HAVE",g[g.yi=2952790020]="UNKNOWN_HAVES",g[g.Ti=2952790021]="RECEIVED_HAVE",g[g.mi=2952790022]="RECEIVED_HAVES",g[g.Oi=2952790023]="NO_OUT_PARTNER",g[g.Si=2952790024]="CREATE_RANDOM_BUFFER",g[g.Ri=2952790025]="REQUEST_PING",g[g._i=2952790026]="RECEIVED_PING",g[g.Ii=2952790027]="UNKNOWN_PING",g[g.Ai=2952790028]="SEND_PONG",g[g.Ni=2952790029]="UNKOWN_PONG",g[g.ki=2952790030]="WRONG_PONG_SIZE",g[g.Ci=2952790031]="WRONG_TIMESTAMP",g[g.Di=2952790032]="RECEIVED_PONG",g[g.Mi=2952790033]="COLLECT_PARTNER_SNAPSHOTS",(y=b=i.ji||(i.ji={}))[y.gt=3221225472]="BASE_CODE",y[y.Pi=3221225473]="START_PARTNERSHIP",y[y.Li=3221225474]="NEW_LAN_MEMBER",y[y.Hi=3221225475]="IN_PARTNER_CHOICE",y[y.Ui=3221225476]="IN_PARTNER_ADD_PROCESS",y[y.Fi=3221225477]="IN_PARTNER_CONNECT",y[y.Gi=3221225478]="IN_PARTNERSHIP_REQUEST",y[y.xi=3221225479]="OUT_PARNTERSHIP_REQUEST_PROCESS",y[y.Bi=3221225480]="CONSTRUCT_DISCOVER_PEER_INFO",y[y.Vi=3221225481]="SEND_PARTN_RESP",y[y.qi=3221225482]="NEW_IN_PARTNER_TO_LIST",y[y.Qi=3221225483]="REMOVE_DISCONNECTED_PEER",y[y.Yi=3221225484]="REMOVE_IN_PARTNER",y[y.Ki=3221225485]="CLOSE_RECEIVED",y[y.Wi=3221225486]="SEND_PART_REQUEST",y[y.$i=3221225487]="PART_REQUEST_EXPIRED",y[y.Xi=3221225488]="UNKNOWN_PARTNERSHIP_REQUEST_EXPIRED",y[y.Ji=3221225489]="UNKNOWN_OUT_PART_RESP",y[y.zi=3221225490]="CLOSE_PARTNERSHIP",y[y.Zi=3221225491]="ANNOUNCE_BITRATE",y[y.tn=3221225492]="CONSTRUCT_ANNOUNCE_BITRATE_MSG",y[y["in"]=3221225493]="RECEIVE_BITRATE_INFO",y[y.nn=3221225494]="PEER_INFO_RECEIVED",y[y.rn=3221225495]="PEER_INFO_ANNOUNCED",y[y.sn=3221225496]="COLLECT_ALL_PARTNERS",(T=i.en||(i.en={}))[T.gt=3489660928]="BASE_CODE",T[T.hn=3489660929]="UPDATE_IN_PARTNERS",(m=i.un||(i.un={}))[m.gt=3758096384]="BASE_CODE",m[m.an=3758096385]="SELECT_PARTNERS_TO_REMOVE",m[m.fn=3758096386]="SELECT_PARTNERS_TO_ADD",m[m.cn=3758096387]="SELECT_UPDATE_OUT",(O=i.vn||(i.vn={}))[O.gt=4026531840]="BASE_CODE",O[O.an=4026531841]="SELECT_PARTNERS_TO_REMOVE",O[O.fn=4026531842]="SELECT_PARTNERS_TO_ADD",O[O.cn=4026531843]="SELECT_UPDATE_OUT",(S=i.dn||(i.dn={}))[S.gt=4294967296]="BASE_CODE",S[S.hn=4294967297]="UPDATE_IN_PARTNERS",S[S.an=4294967298]="SELECT_PARTNERS_TO_REMOVE",S[S.fn=4294967299]="SELECT_PARTNERS_TO_ADD",S[S.cn=4294967300]="SELECT_UPDATE_OUT",S[S.En=4294967301]="GROUP_PARTNERS",S[S.wn=4294967302]="IDENTIFY_MEMBER_AS_LEADER_OR_SAME_SITE",S[S.pn=4294967303]="AHEAD_BUT_BEHIND_DELTA",S[S.gn=4294967304]="BEHIND_OR_NOT_RETRIEVING_BITRATE",S[S.bn=4294967305]="GET_DELTA_FOR_BITRATE",(R=i.yn||(i.yn={}))[R.gt=4563402752]="BASE_CODE",R[R.Tn=4563402753]="UPDATE_OUT_PARTNERS",(_=i.mn||(i.mn={}))[_.gt=4831838208]="BASE_CODE",_[_.On=4831838209]="ADD_FRAGMENT_TO_MAP",_[_.Sn=4831838210]="WRAP_CHUNK",_[_.Rn=4831838211]="GENERATE_HASHMAPS",(I=i._n||(i._n={}))[I.gt=5100273664]="BASE_CODE",I[I.In=5100273665]="INIT_AES_MANAGER",I[I.An=5100273666]="INIT_KEY",I[I.Nn=5100273667]="INIT_IV",I[I.kn=5100273668]="DECRYPT_BUFFER",I[I.Cn=5100273669]="DOWNLOAD_KEY_ONLOAD",I[I.Dn=5100273670]="DOWNLOAD_KEY",(N=A=i.Mn||(i.Mn={}))[N.gt=5368709120]="BASE_CODE",N[N.jn=5368709121]="GET_ENTITY_TYPE",N[N.Pn=5368709122]="GET_ENTITY_CHARACTERISTICS",N[N.Ln=5368709123]="GET_NEXT_ENTITY",N[N.Hn=5368709124]="IS_CURRENT_CONTEXT",N[N.Un=5368709125]="PARSED_METADATA",N[N.Fn=5368709126]="PREFETCH_METADATA_RECEIVED",N[N.Gn=5368709127]="FRAGMENT_RECEIVED",N[N.xn=5368709128]="EVALUATE_PROTECTION",N[N.Bn=5368709129]="GET_DISTANCE_DURATION",(C=k=i.Vn||(i.Vn={}))[C.gt=5637144576]="BASE_CODE",C[C.qn=5637144577]="PARSE_METADATA",C[C.Qn=5637144578]="EXTRACT_SEGMENT_MAPS",C[C.Yn=5637144579]="INIT_PROTECTION",C[C.Kn=5637144580]="GET_SEGMENT_INFO",C[C.Wn=5637144581]="GET_SEGMENT_DISTANCE",C[C.$n=5637144582]="EXTRACT_DURATION",C[C.Xn=5637144583]="EXTRACT_DURATION_OR_DECRYPT",C[C.Jn=5637144584]="EXTRACT_DURATION_CANNOT_DECRYPT",C[C.zn=5637144585]="EXTRACT_DURATION_NON_ENCRYPTED",C[C.Zn=5637144586]="GENERATE_MISSING_SEGMENTS",C[C.tr=5637144587]="REGENERATE_MANIFEST",C[C.ir=5637144588]="TRIM_MANIFEST",C[C.nr=5637144589]="PARSE_BITRATES_TO_FILTER",C[C.rr=5637144590]="FILTER_BITRATES",C[C.sr=5637144591]="GET_DISTANCE_DURATION_BETWEEN_SEGMENTS",C[C.er=5637144592]="GET_SEGMENT",(M=D=i.hr||(i.hr={}))[M.gt=5905580032]="BASE_CODE",M[M.Hn=5905580033]="IS_CURRENT_CONTEXT",M[M.jn=5905580034]="GET_ENTITY_TYPE",M[M.Pn=5905580035]="GET_ENTITY_CHARACTERISTICS",M[M.ur=5905580036]="METADATA_RECEIVED",M[M.ar=5905580037]="SCHEDULE_METADATA_PREFETCH",M[M.Ln=5905580038]="GET_NEXT_ENTITY",M[M.Bn=5905580039]="GET_DISTANCE_DURATION",(P=j=i.cr||(i.cr={}))[P.gt=6174015488]="BASE_CODE",P[P.lr=6174015489]="PLAYLIST_MISMATCH",P[P.vr=6174015490]="FLOAT_BITRATE",P[P.qn=6174015491]="PARSE_METADATA",P[P.Kn=6174015492]="GET_SEGMENT_INFO",P[P.dr=6174015493]="UPDATE_PLAYLIST",P[P.Er=6174015494]="TRIM_PLAYLIST",(L=i.wr||(i.wr={}))[L.gt=6442450944]="BASE_CODE",L[L.pr=6442450945]="GET_P2P_TIMEOUT",L[L.gr=6442450946]="DELIVER_DELAY",(H=i.br||(i.br={}))[H.gt=6710886400]="BASE_CODE",H[H.yr=6710886401]="IS_PLAYER_BUFFERING_BASE",H[H.Tr=6710886402]="CONFIGURE_REQUEST_DIRECTIVE",H[H.mr=6710886403]="ATTEMPT_TO_UPGRADE_PREFETCH",(U=i.Or||(i.Or={}))[U.gt=6979321856]="BASE_CODE",U[U.Sr=6979321857]="PREPARE_REQUEST",U[U.Rr=6979321858]="GET_CONNECTIVITY_INFO",U[U.Ir=6979321859]="COLLECT_TRACKER_REQUEST_INFO",U[U.Ar=6979321860]="PREPARE_QUERY",U[U.Nr=6979321861]="PREPARE_BITRATE_QUERY",U[U.kr=6979321862]="PREPARE_TRACKER_INFO",U[U.Cr=6979321863]="SEND_REQUEST",U[U.Dr=6979321864]="HANDLE_RESPONSE",(F=i.Mr||(i.Mr={}))[F.gt=7247757312]="BASE_CODE",F[F.jr=7247757313]="NEW_TRACKER_CLIENT",F[F.Pr=7247757314]="SERIALIZE_REQUEST",F[F.Lr=7247757315]="DESERIALIZE_RESPONSE",F[F.Hr=7247757316]="SERVICE_CONNECTION_DOWN",F[F.Cr=7247757317]="SEND_REQUEST",F[F.Ur=7247757318]="TRACKER_MANAGER_INIT",(G=i.Fr||(i.Fr={}))[G.gt=7516192768]="BASE_CODE",G[G.Gr=7516192769]="SORT_PARTNERS",(x=i.xr||(i.xr={}))[x.gt=7784628224]="BASE_CODE",x[x.Br=7784628225]="CHOOSE_PARTNER",(B=i.Vr||(i.Vr={}))[B.gt=8053063680]="BASE_CODE",B[B.qr=8053063681]="CONSTRUCT_FRAGMENT_REQUEST_MESSAGE",B[B.Qr=8053063682]="SEND_FRAGMENT_REQUEST",B[B.Yr=8053063683]="RECEIVE_CHUNK",B[B.Kr=8053063684]="SEND_ACK",B[B.Wr=8053063685]="CLEAN_UP_NOT_PENDING",B[B.$r=8053063686]="STOP_TRANSFER",B[B.Xr=8053063687]="RECEIVE_EXPIRED_CHUNK",(V=i.Jr||(i.Jr={}))[V.gt=8321499136]="BASE_CODE",V[V.zr=8321499137]="CONSTRUCT_CHUNK_RESPONSE",V[V.Zr=8321499138]="START_SENDING_CHUNK",V[V.ns=8321499139]="SEND_CHUNK",V[V.rs=8321499140]="UNKNOWN_ACK",(q=i.ss||(i.ss={}))[q.gt=8589934592]="BASE_CODE",q[q.es=8589934593]="NO_PARTNER_FOUND",q[q.hs=8589934594]="FILTER_IN_PARTNERS",q[q.us=8589934595]="SET_REQUEST_TIMEOUT",q[q.fs=8589934596]="REMOVE_REQUEST",q[q.cs=8589934597]="CANCEL_ON_NON_EXISTING_SESSION",q[q.ls=8589934598]="DO_NOT_HAVE",q[q.vs=8589934599]="REQUESTED_TO_NON_PARTNER",(Q=i.ds||(i.ds={}))[Q.gt=8858370048]="BASE_CODE",Q[Q.Es=8858370049]="RESPOND_TO_PEER",Q[Q.ws=8858370050]="REQUEST_SATISFIED",Q[Q.ps=8858370051]="REQUEST_PARTIALLY_SATISFIED",Q[Q.gs=8858370052]="REQUEST_NOT_SATISFIED",Q[Q.bs=8858370053]="SEND_DO_NOT_HAVE",Q[Q.ys=8858370054]="SEND_NO_PARTNERS",(Y=i.Ts||(i.Ts={}))[Y.gt=9126805504]="BASE_CODE",Y[Y.ms=9126805505]="VIOLATE_SPOOFING_HANDLER",Y[Y.Os=9126805506]="VIOLATE_SPOOFING_RULES",Y[Y.Ss=9126805507]="ADD_OR_UPDATE_SPOOFING_MAPS",Y[Y.Rs=9126805508]="PERIODIC_CHECK_IP_SPOOFING",(K=i._s||(i._s={}))[K.gt=9395240960]="BASE_CODE",K[K.Is=9395240961]="REQUEST_COMPLETED",K[K.As=9395240962]="REQUEST_NOT_EXISTING_COMPLETED",K[K.Ns=9395240963]="REQUEST_PARTIALLY_FAILED",K[K.ks=9395240964]="REQUEST_NOT_EXISTING_PARTIALLY_FAILED",K[K.Cs=9395240965]="REQUEST_FAILED",K[K.Ds=9395240966]="REQUEST_NOT_EXISTING_FAILED",(W=i.Ms||(i.Ms={}))[W.gt=9663676416]="BASE_CODE",W[W.js=9663676417]="UPDATE_WANTED_SESSIONS",W[W.Ps=9663676418]="CONFIGURE_PREFETCHING",W[W.Ls=9663676419]="START_PREFETCHING",W[W.Hs=9663676420]="FRAGMENT_RETRIEVED_SESSION_NOT_EXISTING",W[W.Us=9663676421]="ATTEMPT_PREFETCH_BEFORE_PLAYER_REQUEST",W[W.Fs=9663676422]="FORWARD_IF_NECESSARY",W[W.Gs=9663676423]="IS_ALLOWED_TO_PREFETCH",W[W.xs=9663676424]="PREFETCH_PROCESS",W[W.Bs=9663676425]="CHECK_PLAYER_DISTANCE",W[W.Vs=9663676426]="OFFLOAD_LEADER",W[W.qs=9663676427]="UPGRADE_PREFETCH",($=i.Qs||(i.Qs={}))[$.gt=9932111872]="BASE_CODE",$[$.Ys=9932111873]="REQUEST_TIMEOUT",(X=i.Ks||(i.Ks={}))[X.gt=10200547328]="BASE_CODE",X[X.Ws=10200547329]="PLAYER_REQUEST_ERROR",X[X.$s=10200547330]="PLAYER_ABORT_ERROR",(J=i.Xs||(i.Xs={}))[J.gt=10468982784]="BASE_CODE",J[J.Js=10468982785]="ADD_HAVE",J[J.zs=10468982786]="REMOVE_PEER",(Z=z=i.Zs||(i.Zs={}))[Z.gt=10737418240]="BASE_CODE",Z[Z.te=10737418241]="CONSTRUCT_SWARM",Z[Z.ie=10737418242]="INIT_SWARM",Z[Z.ne=10737418243]="SWITCH_STATE",Z[Z.Ys=10737418244]="REQUEST_TIMEOUT",(tt=i.re||(i.re={}))[tt.gt=11005853696]="BASE_CODE",tt[tt.se=11005853697]="SERIALIZE_MESSAGE",tt[tt.ee=11005853698]="EXTRACT_MESSAGE",(nt=it=i.he||(i.he={}))[nt.gt=11274289152]="BASE_CODE",nt[nt.oe=11274289153]="NO_MATCHING_SESSION",nt[nt.ue=11274289154]="UNABLE_RESOLVE_TICKET",nt[nt.ae=11274289155]="UNABLE_INIT_TECHS",nt[nt.fe=11274289156]="NO_TOKEN_FOUND",nt[nt.ce=11274289157]="NO_VALID_TICKET",nt[nt.le=11274289158]="ON_ACTIVE_SESSION_CB_ERROR",nt[nt.ve=11274289159]="NO_VISIBILITY_LISTENER",nt[nt.de=11274289160]="STATUS_CODE",nt[nt.Ee=11274289161]="ON_SESSION_STATE_CHANGE_CB_ERROR",(rt=i.we||(i.we={}))[rt.gt=11542724608]="BASE_CODE",rt[rt.pe=11542724609]="CALCULATE_BATCH_LOCALITY",(et=st=i.ge||(i.ge={}))[et.gt=11811160064]="BASE_CODE",et[et.be=11811160065]="BITRATE_TOO_HIGH",et[et.ye=11811160066]="NUM_BITRATES_NONE",et[et.Te=11811160067]="NUM_BITRATES_OK",et[et.me=11811160068]="NUM_BITRATES_WARNING",et[et.Oe=11811160069]="NUM_BITRATES_ERROR",et[et.Se=11811160070]="NUM_BITRATES_ATATUS_ERROR_NONE",et[et.Re=11811160071]="NUM_BITRATES_ATATUS_ERROR_HIGH",(ht=i._e||(i._e={}))[ht.gt=12079595520]="BASE_CODE",ht[ht.se=12079595521]="SERIALIZE_MESSAGE",ht[ht.Cr=12079595522]="SEND_REQUEST",ht[ht.Hr=12079595523]="SERVICE_CONNECTION_DOWN",ht[ht.Rr=12079595524]="GET_CONNECTIVITY_INFO",i.GENERIC_ERROR=1,i.Ie=((r={})[st.be]="The detected bitrate ({0}) is higher than the maximum certified bitrate ({1}). You may encounter issues watching the stream.",r[st.ye]="{0} stream detected with missing video bitrate metadata. This is likely caused by an incorrect manifest served by the video platform application.",r[st.Te]="{0} stream detected {1} video bitrates: {2}",r[st.me]="{0} stream detected with {1} video bitrates: {2}. Hive Streaming recommends four or fewer video bitrates to insure optimal networking savings.",r[st.Oe]="{0} stream detected with {1} video bitrates: {2}. This is likely caused by an incorrect configuration in the video encoder, video streaming origin or transcoding service.",r[st.Se]="Stream has zero available bitrates.",r[st.Re]="Stream has too many available bitrates.",r),i.lt=((s={})[o.bt]=e.wt,s[o.yt]=e.wt,s[b.Pi]=e.wt,s[A.Hn]=e.wt,s[k.tr]=e.wt,s[D.Hn]=e.wt,s[j.lr]=e.wt,s[z.te]=e.wt,s[it.oe]=e.wt,s[it.ue]=e.wt,s[it.ae]=e.wt,s[it.fe]=e.wt,s[it.ce]=e.wt,s)},function(t,i,n){"use strict";n(10);var s=n(70),r=n(11),e=n(56),h=n(12);function o(t,n,i,r){if(!(this instanceof o))return new o(t,n,i,r);n=n||Object.Ae,i=i||Object.hash,r=r||Function.Ne,this.ke=n,this.Ce=i,this.De=r,this.store=new s(void 0,function(t,i){return n(t.key,i.key)},function(t){return i(t.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).Map=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),Object.defineProperty(o.prototype,"size",r.Me),o.prototype.je=function(t){return new this.constructor(t,this.ke,this.Ce,this.De)},o.prototype.log=function(t,r,i,n){r=r||this.Pe,this.store.log(t,function(t,i,n){r(t.value.value,i,n)},i,n)},o.prototype.Pe=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(i,t,n){(function(W,$){!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):i.exports=t()}(function(){"use strict";var o=!1;try{throw new Error()}catch(t){o=!!t.stack}function i(){}var s,e=T(),c=function(){var n={Le:void 0,next:null},i=n,r=!1,s=void 0,e=!1,t=!1;try{t=navigator&&("Microsoft Internet Explorer"===navigator.appName||null!=navigator.appVersion.match(/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i))}catch(t){}var h=[];function o(){for(var t,i;n.next;)t=(n=n.next).Le,n.Le=void 0,(i=n.domain)&&(n.domain=void 0,i.He()),u(t,i);for(;h.length;)u(t=h.pop());r=!1}function u(t,i){try{t()}catch(t){if(e)throw i&&i.Ue(),setTimeout(o,0),i&&i.He(),t;setTimeout(function(){throw t},0)}i&&i.Ue()}if(c=function(t){"undefined"!=typeof Framework&&Framework.O()?Framework.setTimeout(t,0):(i=i.next={Le:t,domain:e&&W.domain,next:null},r||(r=!0,s()))},"object"==typeof W&&W&&"[object process]"===W.toString()&&W.Fe)e=!0,s=function(){W.Fe(o)};else if("function"!=typeof $||t)if("undefined"==typeof MessageChannel||t)s=function(){setTimeout(o,0)};else{var a=new MessageChannel();a.port1.onmessage=function(){s=f,(a.port1.onmessage=o)()};var f=function(){a.port2.postMessage(0)};s=function(){setTimeout(o,0),f()}}else s="undefined"!=typeof window?$.bind(window,o):function(){$(o)};return c.Ge=function(t){h.push(t),r||(r=!0,s())},c}(),n=Function.call;function t(t){return function(){return n.apply(t,arguments)}}var h,u=t(Array.prototype.slice),a=t(Array.prototype.reduce||function(t,i){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){i=this[n++];break}if(++n>=r)throw new TypeError()}for(;n<r;n++)n in this&&(i=t(i,this[n],n));return i}),r=t(Array.prototype.indexOf||function(t){for(var i=0;i<this.length;i++)if(this[i]===t)return i;return-1}),f=t(Array.prototype.map||function(r,s){var e=this,h=[];return a(e,function(t,i,n){h.push(r.call(s,i,n,e))},void 0),h}),l=Object.create||function(t){function i(){}return i.prototype=t,new i()},v=Object.defineProperty||function(t,i,n){return t[i]=n.value,t},d=t(Object.prototype.hasOwnProperty),E=Object.keys||function(t){var i=[];for(var n in t)d(t,n)&&i.push(n);return i},w=t(Object.prototype.toString);h="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var p="From previous event:";function g(t,i){if(o&&i.stack&&"object"==typeof t&&null!==t&&t.stack){for(var n=[],r=i;r;r=r.source)r.stack&&(!t.xe||t.xe>r.Be)&&(v(t,"__minimumStackCounter__",{value:r.Be,configurable:!0}),n.unshift(r.stack));n.unshift(t.stack);var s=function(t){for(var i=t.split("\n"),n=[],r=0;r<i.length;++r){var s=i[r];!y(s)&&-1===(e=s).indexOf("(module.js:")&&-1===e.indexOf("(node.js:")&&s&&n.push(s)}var e;return n.join("\n")}(n.join("\n"+p+"\n"));v(t,"stack",{value:s,configurable:!0})}}function b(t){var i=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(i)return[i[1],Number(i[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function y(t){var i=b(t);if(!i)return!1;var n=i[0],r=i[1];return n===s&&e<=r&&r<=K}function T(){if(o)try{throw new Error()}catch(t){var i=t.stack.split("\n"),n=b(0<i[0].indexOf("@")?i[1]:i[2]);if(!n)return;return s=n[0],n[1]}}function m(t){return t instanceof I?t:C(t)?function(t){var i=S();return m.Fe(function(){try{t.then(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}}),i.promise}(t):x(t)}(m.resolve=m).Fe=c,m.Ve=!1;var O=1;function S(){var s,e=[],h=[],t=l(S.prototype),i=l(I.prototype);if(i.qe=function(t,i,n){var r=u(arguments);e?(e.push(r),"when"===i&&n[1]&&h.push(n[1])):m.Fe(function(){s.qe.apply(s,r)})},i.valueOf=function(){if(e)return i;var t=N(s);return k(t)&&(s=t),t},i.Qe=function(){return s?s.Qe():{state:"pending"}},m.Ve&&o)try{throw new Error()}catch(t){i.stack=t.stack.substring(t.stack.indexOf("\n")+1),i.Be=O++}function n(n){s=n,m.Ve&&o&&(i.source=n),a(e,function(t,i){m.Fe(function(){n.qe.apply(n,i)})},void 0),h=e=void 0}return t.promise=i,t.resolve=function(t){s||n(m(t))},t.fulfill=function(t){s||n(x(t))},t.reject=function(t){s||n(G(t))},t.notify=function(n){s||a(h,function(t,i){m.Fe(function(){i(n)})},void 0)},t}function R(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var i=S();try{t(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}return i.promise}function _(s){return R(function(t,i){for(var n=0,r=s.length;n<r;n++)m(s[n]).then(t,i)})}function I(s,e,i){void 0===e&&(e=function(t){return G(new Error("Promise does not support operation: "+t))}),void 0===i&&(i=function(){return{state:"unknown"}});var h=l(I.prototype);if(h.qe=function(t,i,n){var r;try{r=s[i]?s[i].apply(h,n):e.call(h,i,n)}catch(t){r=G(t)}t&&t(r)},h.Qe=i){var t=i();"rejected"===t.state&&(h.exception=t.reason),h.valueOf=function(){var t=i();return"pending"===t.state||"rejected"===t.state?h:t.value}}return h}function A(t,i,n,r){return m(t).then(i,n,r)}function N(t){if(k(t)){var i=t.Qe();if("fulfilled"===i.state)return i.value}return t}function k(t){return t instanceof I}function C(t){return function(t){return t===Object(t)}(t)&&"function"==typeof t.then}"object"==typeof W&&W&&W.Ye&&W.Ye.Ke&&(m.Ve=!0),(m.defer=S).prototype.We=function(){var n=this;return function(t,i){t?n.reject(t):2<arguments.length?n.resolve(u(arguments,1)):n.resolve(i)}},m.Promise=R,(m.promise=R).race=_,R.all=q,R.reject=G,(R.resolve=m).$e=function(t){return t},I.prototype.$e=function(){return this},m.join=function(t,i){return m(t).join(i)},I.prototype.join=function(t){return m([this,t]).Xe(function(t,i){if(t===i)return t;throw new Error("Q can't join: not the same: "+t+" "+i)})},m.race=_,I.prototype.race=function(){return this.then(m.race)},(m.Je=I).prototype.toString=function(){return"[object Promise]"},I.prototype.then=function(i,n,r){var s=this,e=S(),h=!1;return m.Fe(function(){s.qe(function(t){h||(h=!0,e.resolve(function(t){try{return"function"==typeof i?i(t):t}catch(t){return G(t)}}(t)))},"when",[function(t){h||(h=!0,e.resolve(function(t){if("function"==typeof n){g(t,s);try{return n(t)}catch(t){return G(t)}}return G(t)}(t)))}])}),s.qe(void 0,"when",[void 0,function(t){var i,n=!1;try{i=function(t){return"function"==typeof r?r(t):t}(t)}catch(t){if(n=!0,!m.onerror)throw t;m.onerror(t)}n||e.notify(i)}]),e.promise},m.ze=function(t,i){return m(t).ze(i)},I.prototype.ze=function(i){return i=m(i),this.then(function(t){return i.th(t).Ze(t)})},m.when=A,I.prototype.Ze=function(t){return this.then(function(){return t})},m.Ze=function(t,i){return m(t).Ze(i)},I.prototype.ih=function(t){return this.then(function(){throw t})},m.ih=function(t,i){return m(t).ih(i)},m.nh=N,m.rh=k,m.sh=C,m.eh=function(t){return k(t)&&"pending"===t.Qe().state},I.prototype.eh=function(){return"pending"===this.Qe().state},m.hh=function(t){return!k(t)||"fulfilled"===t.Qe().state},I.prototype.hh=function(){return"fulfilled"===this.Qe().state},m.oh=function(t){return k(t)&&"rejected"===t.Qe().state},I.prototype.oh=function(){return"rejected"===this.Qe().state};var D,M,j,P=[],L=[],H=[],U=!0;function F(){P.length=0,L.length=0,U=U||!0}function G(i){var t=I({when:function(t){return t&&function(i){if(U){var n=r(L,i);-1!==n&&("object"==typeof W&&W&&"function"==typeof W.uh&&m.Fe.Ge(function(){var t=r(H,i);-1!==t&&(W.uh("rejectionHandled",P[n],i),H.splice(t,1))}),L.splice(n,1),P.splice(n,1))}}(this),t?t(i):this}},function(){return this},function(){return{state:"rejected",reason:i}});return function(t,i){U&&("object"==typeof W&&W&&"function"==typeof W.uh&&m.Fe.Ge(function(){-1!==r(L,t)&&(W.uh("unhandledRejection",i,t),H.push(t))}),L.push(t),i&&void 0!==i.stack?P.push(i.stack):P.push("(no stack) "+i))}(t,i),t}function x(n){return I({when:function(){return n},get:function(t){return n[t]},set:function(t,i){n[t]=i},"delete":function(t){delete n[t]},ah:function(t,i){return null==t?n.apply(void 0,i):n[t].apply(n,i)},apply:function(t,i){return n.apply(t,i)},keys:function(){return E(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function B(t,i,n){return m(t).Xe(i,n)}function V(t,i,n){return m(t).fh(i,n)}function q(t){return A(t,function(s){var e=0,h=S();return a(s,function(t,i,n){var r;k(i)&&"fulfilled"===(r=i.Qe()).state?s[n]=r.value:(++e,A(i,function(t){s[n]=t,0==--e&&h.resolve(s)},h.reject,function(t){h.notify({index:n,value:t})}))},void 0),0===e&&h.resolve(s),h.promise})}function Q(s){if(0===s.length)return m.resolve();var e=m.defer(),h=0;return a(s,function(t,i,n){var r=s[n];h++,A(r,function(t){e.resolve(t)},function(t){if(0===--h){var i=t||new Error(""+t);i.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+i.message,e.reject(i)}},function(t){e.notify({index:n,value:t})})},void 0),e.promise}function Y(t){return A(t,function(t){return t=f(t,m),A(q(f(t,function(t){return A(t,i,i)})),function(){return t})})}m.lh=F,m.vh=function(){return P.slice()},m.dh=function(){F(),U=!1},F(),m.reject=G,m.fulfill=x,m.Eh=function(n){return I({wh:function(){}},function(t,i){return V(n,t,i)},function(){return m(n).Qe()})},m.Xe=B,I.prototype.Xe=function(i,t){return this.all().then(function(t){return i.apply(void 0,t)},t)},m.async=function(i){return function(){function t(t,i){var n;if("undefined"==typeof StopIteration){try{n=r[t](i)}catch(t){return G(t)}return n.done?m(n.value):A(n.value,s,e)}try{n=r[t](i)}catch(t){return function(t){return"[object StopIteration]"===w(t)||t instanceof h}(t)?m(t.value):G(t)}return A(n,s,e)}var r=i.apply(this,arguments),s=t.bind(t,"next"),e=t.bind(t,"throw");return s()}},m.ph=function(t){m.done(m.async(t)())},m.gh=function(t){throw new h(t)},m.bh=function(n){return function(){return B([this,q(arguments)],function(t,i){return n.apply(t,i)})}},m.fh=V,I.prototype.fh=function(t,i){var n=this,r=S();return m.Fe(function(){n.qe(r.resolve,t,i)}),r.promise},m.get=function(t,i){return m(t).fh("get",[i])},I.prototype.get=function(t){return this.fh("get",[t])},m.set=function(t,i,n){return m(t).fh("set",[i,n])},I.prototype.set=function(t,i){return this.fh("set",[t,i])},m.yh=m["delete"]=function(t,i){return m(t).fh("delete",[i])},I.prototype.yh=I.prototype["delete"]=function(t){return this.fh("delete",[t])},m.Th=m.ah=function(t,i,n){return m(t).fh("post",[i,n])},I.prototype.Th=I.prototype.ah=function(t,i){return this.fh("post",[t,i])},m.send=m.mh=m.Oh=function(t,i){return m(t).fh("post",[i,u(arguments,2)])},I.prototype.send=I.prototype.mh=I.prototype.Oh=function(t){return this.fh("post",[t,u(arguments,1)])},m.Sh=function(t,i){return m(t).fh("apply",[void 0,i])},I.prototype.Sh=function(t){return this.fh("apply",[void 0,t])},m.Rh=m.th=function(t){return m(t).fh("apply",[void 0,u(arguments,1)])},I.prototype.th=function(){return this.fh("apply",[void 0,u(arguments)])},m._h=function(t){var i=m(t),n=u(arguments,1);return function(){return i.fh("apply",[this,n.concat(u(arguments))])}},I.prototype._h=function(){var t=this,i=u(arguments);return function(){return t.fh("apply",[this,i.concat(u(arguments))])}},m.keys=function(t){return m(t).fh("keys",[])},I.prototype.keys=function(){return this.fh("keys",[])},m.all=q,I.prototype.all=function(){return q(this)},m.Ih=Q,I.prototype.Ih=function(){return Q(this)},m.Ah=(D=Y,M="allResolved",j="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof emptyFunction&&!1,D.apply(D,arguments)}),I.prototype.Ah=function(){return Y(this)},m.allSettled=function(t){return m(t).allSettled()},I.prototype.allSettled=function(){return this.then(function(t){return q(f(t,function(t){function i(){return t.Qe()}return(t=m(t)).then(i,i)}))})},m.fail=m["catch"]=function(t,i){return m(t).then(void 0,i)},I.prototype.fail=I.prototype["catch"]=function(t){return this.then(void 0,t)},m.progress=function(t,i){return m(t).then(void 0,void 0,i)},I.prototype.progress=function(t){return this.then(void 0,void 0,t)},m.Nh=m["finally"]=function(t,i){return m(t)["finally"](i)},I.prototype.Nh=I.prototype["finally"]=function(i){if(!i||"function"!=typeof i.apply)throw new Error("Q can't apply finally callback");return i=m(i),this.then(function(t){return i.th().then(function(){return t})},function(t){return i.th().then(function(){throw t})})},m.done=function(t,i,n,r){return m(t).done(i,n,r)},I.prototype.done=function(t,i,n){var r=function(t){m.Fe(function(){if(g(t,s),!m.onerror)throw t;m.onerror(t)})},s=t||i||n?this.then(t,i,n):this;"object"==typeof W&&W&&W.domain&&(r=W.domain.bind(r)),s.then(void 0,r)},m.timeout=function(t,i,n){return m(t).timeout(i,n)},I.prototype.timeout=function(t,i){var n=S(),r=setTimeout(function(){i&&"string"!=typeof i||((i=new Error(i||"Timed out after "+t+" ms")).code="ETIMEDOUT"),n.reject(i)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},m.delay=function(t,i){return void 0===i&&(i=t,t=void 0),m(t).delay(i)},I.prototype.delay=function(n){return this.then(function(t){var i=S();return setTimeout(function(){i.resolve(t)},n),i.promise})},m.kh=function(t,i){return m(t).kh(i)},I.prototype.kh=function(t){var i=S(),n=u(t);return n.push(i.We()),this.Sh(n).fail(i.reject),i.promise},m.Ch=function(t){var i=u(arguments,1);return m(t).kh(i)},I.prototype.Ch=function(){var t=u(arguments),i=S();return t.push(i.We()),this.Sh(t).fail(i.reject),i.promise},m.Dh=m.Mh=function(n){if(void 0===n)throw new Error("Q can't wrap an undefined function");var r=u(arguments,1);return function(){var t=r.concat(u(arguments)),i=S();return t.push(i.We()),m(n).Sh(t).fail(i.reject),i.promise}},I.prototype.Dh=I.prototype.Mh=function(){var t=u(arguments);return t.unshift(this),m.Mh.apply(void 0,t)},m.jh=function(n,r){var s=u(arguments,2);return function(){var t=s.concat(u(arguments)),i=S();return t.push(i.We()),m(function(){return n.apply(r,arguments)}).Sh(t).fail(i.reject),i.promise}},I.prototype.jh=function(){var t=u(arguments,0);return t.unshift(this),m.jh.apply(void 0,t)},m.Ph=m.Lh=function(t,i,n){return m(t).Lh(i,n)},I.prototype.Ph=I.prototype.Lh=function(t,i){var n=u(i||[]),r=S();return n.push(r.We()),this.fh("post",[t,n]).fail(r.reject),r.promise},m.Hh=m.Uh=m.Fh=function(t,i){var n=u(arguments,2),r=S();return n.push(r.We()),m(t).fh("post",[i,n]).fail(r.reject),r.promise},I.prototype.Hh=I.prototype.Uh=I.prototype.Fh=function(t){var i=u(arguments,1),n=S();return i.push(n.We()),this.fh("post",[t,i]).fail(n.reject),n.promise},m.Gh=function(t,i){return m(t).Gh(i)},I.prototype.Gh=function(i){if(!i)return this;this.then(function(t){m.Fe(function(){i(null,t)})},function(t){m.Fe(function(){i(t)})})},m.xh=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var K=T();return m})}).call(this,n(36),n(106).setImmediate)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(7),s=(e.Bh=5e3,e.Vh=6,e.qh=1e4,e.Qh=.2,e.Yh=10,e);function e(){}var h=(o.Kh="0.0.1",o.Wh=3e4,o.$h=4e7,o.Xh=1,o.Jh=.8,o.zh=!1,o.Zh=2e4,o.to=1e4,o);function o(){}var u=(a.io=r.W.no,a.ro=3,a.so=1e4,a);function a(){}var f=(c.eo=1.2,c.ho=1.5,c.oo=1.2,c.uo=.5,c);function c(){}var l=(v.ao=r.W.fo,v.co=2e4,v.lo=5e3,v);function v(){}var d=(E.vo=[412,404],E);function E(){}var w=(p["do"]=2e3,p.Eo=!0,p.wo=!1,p.po=!0,p.bo=1,p.yo=.04,p.To=2,p.mo=!0,p.Oo=!1,p.So=!1,p.Ro=1e4,p._o=4e4,p.Io=3700,p.Ao=2e4,p.No=1,p.ko=5,p.Co=.4,p.Do=1,p.Mo=!0,p.jo=2,p.Po=1.5,p);function p(){}var g=(b.Lo=30,b.Ho=2e4,b.Uo=3e4,b);function b(){}var y=(T.Fo=3e7,T.Go=3e4,T.xo=10,T);function T(){}var m=(O.Bo=3,O.Vo=!1,O.qo=3e4,O.Qo=3,O.Yo=.2,O.Ko=.2,O.Wo=1e4,O);function O(){}var S=(R.$o=!1,R);function R(){}var _=(I.Xo=64e3,I.Jo=5e3,I.zo=1,I.Zo=1,I.tu=!1,I.iu=!0,I);function I(){}var A=(N.nu=4e3,N.ru=3e4,N.su=4096,N.eu=!0,N.hu=5e3,N.ou=1e4,N);function N(){}var k=(C.uu=100,C.au=200,C);function C(){}var D=(M.fu=20,M.cu=20,M.lu=20,M.vu=5,M.TIMEOUT=6e4,M);function M(){}var j=(P.du="site",P.Eu="externalAs",P.wu="availableSendRate",P.pu="remoteAddress",P.gu="localAddress",P.bu=2e4,P);function P(){}var L=(H.yu=3e4,H);function H(){}var U=(F.Tu=300,F);function F(){}var G=(x.mu=!0,x.Ou=!0,x);function x(){}var B=(V.Su=1,V.Ru=6,V._u=12,V.Iu=4,V.Au=27,V);function V(){}var q=(Q.Nu=s,Q.ku=h,Q.Cu=u,Q.Du=f,Q.Mu=l,Q.ju=d,Q.Pu=w,Q.Lu=g,Q.Cache=y,Q.Hu=m,Q.Uu=S,Q.Fu=_,Q.UDPBroadcast=A,Q.Gu=k,Q.xu=D,Q.Bu=j,Q.Vu=L,Q.qu=U,Q.Qu=G,Q.Yu=B,Q);function Q(){}i.Ku=q},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(30),e=n(23),h=n(0),r=(s.prototype.next=function(){return this.count++,this.count},s);function s(){this.count=0}i.Counter=r;var o=(a.prototype.start=function(t){void 0===t&&(t=h.Framework.time()),this.Wu||(this.Wu={start:t,end:void 0},this.$u.push(this.Wu))},a.prototype.stop=function(t){void 0===t&&(t=h.Framework.time()),this.Wu&&(this.Wu.end=t,this.Wu=void 0,this.Xu=!1)},a.prototype.Ju=function(t,i){void 0===t&&(t=h.Framework.time());var n=this.Wu,r=this.Xu;n&&this.stop(t);var s=(r?i:0)||this.$u.reduce(function(t,i){var n=i.start;return t+i.end-n},0);return this.$u.length=0,n&&(this.start(t),this.Xu=!0),s},a.prototype.reset=function(){this.Xu=!1,this.Wu=void 0,this.$u.length=0},a.prototype.zu=function(){return Boolean(this.Wu)},a);function a(t){this.$u=[],this.Xu=!1,void 0!==t&&this.start(t)}i.Zu=o;var f=(c.prototype.add=function(t){t<=0||(this.ta+=t,this.ia++,t>this.na&&(this.na=t),t<this.ra&&(this.ra=t))},c.prototype.min=function(t){void 0===t&&(t=!0);var i=this.ra==Number.POSITIVE_INFINITY?0:this.ra;return t&&this.reset(),i},c.prototype.max=function(t){void 0===t&&(t=!0);var i=this.na==Number.NEGATIVE_INFINITY?0:this.na;return t&&this.reset(),i},c.prototype.sa=function(t){void 0===t&&(t=!0);var i=this.ta;return t&&this.reset(),i},c.prototype.ea=function(t){void 0===t&&(t=!0);var i=0<this.ia?this.ta/this.ia:0;return t&&this.reset(),i},c.prototype.reset=function(){this.ra=Number.POSITIVE_INFINITY,this.na=Number.NEGATIVE_INFINITY,this.ta=0,this.ia=0},c);function c(){this.reset()}i.ha=f;var l=(v.prototype.oa=function(t,i,n){this.protocol.ua(i,e.aa.ONEWAY,n),t.write(this.protocol),this.protocol.fa();var r=this.la.ca(),s=this.va(r,",",4);return r.slice(s+1,r.length-1)},v.prototype.da=function(t,i,n,r){var s="["+n+', "'+i+'", 4, 0,'+t+"]";this.la.Ea(s),this.protocol.wa();var e=new r();return e.read(this.protocol),this.protocol.pa(),e},v.prototype.va=function(t,i,n){return t.split(i,n).join(i).length},v);function v(){this.la=new e.ga(),this.protocol=new e.ba(this.la)}i.ya=l;var d=(E.prototype.Ta=function(){return void 0!==this.ma},E.prototype.Oa=function(t,i){return this.ma=Math.min(this.Sa,i/t*8e3),this},E.prototype.Ra=function(t){return this.ma=Math.max(this.Sa,t),this},E.prototype._a=function(t){t.Ta()&&(this.Ta()?this.ma=this.ma*(1-this.ALPHA)+t.ma*this.ALPHA:this.ma=t.ma)},E.prototype.Ia=function(t){return this.Ta()?Math.round(8e3*t/this.ma):NaN},E.prototype.Aa=function(){return this.Ta()?this.ma:NaN},E.prototype.Na=function(){return this.Ta()?this.ma/1e3:NaN},E.prototype.ka=function(){return this.Ta()?this.ma/1e6:NaN},E.prototype.Ca=function(){return this.Ta()?1e6<this.ma?(this.ma/1e6).toFixed(2)+"Mb/s":1e3<this.ma?(this.ma/1e3).toFixed(2)+"Kb/s":this.ma+"b/s":"NaN"},E);function E(){this.ALPHA=.25,this.Sa=1e8,this.Da=1e4}i.Ma=d,i.ja=new r(),i.Pa=function(t,i){return i?t+"-"+i:t},i.appendBuffer=function(t,i){var n=new Uint8Array(t.byteLength+i.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(i),t.byteLength),n.buffer},i.La=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Ha=function(t,i,n){void 0===n&&(n=!0);for(var r=0;r<t.length;)if(t[r]===i){if(t.splice(r,1),n)break}else r++},i.Ua=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},i.Fa=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},i.Ga=function(t){for(var i=t.length-1;0<i;i--){var n=Math.floor(h.Framework.random()*(i+1)),r=t[i];t[i]=t[n],t[n]=r}return t},i.xa=function(t){var i=new Array();for(var n in t)t.hasOwnProperty(n)&&!/^\d+$/.test(n)&&i.push(n);return i},i.Ba=function(t){return Object.keys(t).map(function(t){return parseInt(t,10)}).filter(function(t){return!isNaN(t)})},i.Va=function(t,i){return t[i]?t[i]:null},i.qa=function(t,i){return new u(i).Qa(t).toString()},i.Ya=function(t){void 0===t&&(t="");var i=t.toLowerCase().indexOf("(format=mpd-time-csf)");return-1!=i&&(t=t.substr(0,i)),-1==(i=t.indexOf("?"))&&(i=t.length),t.substr(0,i)},i.Ka=function(t){var i,n,r,s,e=new u(t),h=e.origin(),o=e.path();for("/"!==o.charAt(0)&&(i=!0,o="/"+o),"/.."!==o.slice(-3)&&"/."!==o.slice(-2)||(o+="/"),o=o.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(n=(n=o.substring(1).match(/^(\.\.\/)+/)||"")&&n[0]);-1!==(r=o.search(/\/\.\.(\/|$)/));)o=0!==r?(-1===(s=o.substring(0,r).lastIndexOf("/"))&&(s=r),o.substring(0,s)+o.substring(r+3)):o.substring(3);return h+o},i.ea=function(t){return 0==t.length?0:t.reduce(function(t,i){return t+i})/t.length},i.Wa=function(t){for(var i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0,s=t.length;r<s;r++)n[r]=t.charCodeAt(r);return i},i.createEvent=function(t,i,n,r){var s=new t(i,n),e=r||n.currentTarget;return e&&Object.defineProperties(s,{currentTarget:{value:e,enumerable:!0,writable:!1},target:{value:e,enumerable:!0,writable:!1}}),s},i.$a=/[-\/\\^$*+?.()|[\]{}]/g,i.Xa=function(t){return t.replace(i.$a,"\\$&")}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ja=!0,s.za=!0,s.Za="undefined"!=typeof HIVE_COMM_JS_PROXY&&HIVE_COMM_JS_PROXY,s["if"]="3.16.0",s.nf="facebook",s.rf="undefined"!=typeof HIVE_PLUGIN_TIMEOUT?HIVE_PLUGIN_TIMEOUT:3e4,s.sf="6.3.0",s.ef=!1,s.hf=!0,s.uf="undefined"!=typeof INCLUDE_UDP_BROADCAST&&INCLUDE_UDP_BROADCAST,s.af="undefined"!=typeof INCLUDE_UDP_LEADER_ELECTION&&INCLUDE_UDP_LEADER_ELECTION,s.ff="undefined"!=typeof LEADER_SCORE_EQUALITY&&LEADER_SCORE_EQUALITY,s.cf="undefined"!=typeof INCLUDE_DEFAULT_NETWORK&&INCLUDE_DEFAULT_NETWORK,s.lf="undefined"!=typeof HIVE_RESTRICTED_CONNINFO&&HIVE_RESTRICTED_CONNINFO,s.fo="undefined"!=typeof HIVE_DISCOVERY?HIVE_DISCOVERY:"ws://127.0.0.1:8000/hive",s.vf="undefined"!=typeof P2PDispatcherDetailedLog&&P2PDispatcherDetailedLog,s.df="undefined"!=typeof NetworkManagerDetailedLog&&NetworkManagerDetailedLog,s.K="undefined"!=typeof ATATUS_KEY?ATATUS_KEY:"592835a6b4204dd197c00488610003e0",s.$="undefined"!=typeof ATATUS_VERSION?ATATUS_VERSION:"0.8",s.X="undefined"==typeof ATATUS_DEFAULT_ENABLED||ATATUS_DEFAULT_ENABLED,s.J="undefined"!=typeof ATATUS_ROWS_TO_EXCLUDE?ATATUS_ROWS_TO_EXCLUDE:5,s.Ef="undefined"==typeof HIVE_DETECT_PRIVATEIP||HIVE_DETECT_PRIVATEIP,s.wf=!0,s.pf=!1,s.gf=!0,s.no=!1,s.bf="undefined"!=typeof STATS_MANIFEST_INTERCEPTION_ENABLED&&STATS_MANIFEST_INTERCEPTION_ENABLED,s);function s(){}i.W=r},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.yf||(i.yf={}))[r.Tf=0]="AUDIO",r[r.mf=1]="VIDEO",r[r.Of=2]="METADATA",r[r.Sf=3]="OTHER"},function(t,i,n){"use strict";var r,s;Object.defineProperty(i,"s",{value:!0}),n(62),(r=i.Rf||(i.Rf={}))[r._f=0]="TRACKER",r[r.If=1]="UDP",(s=i.Af||(i.Af={}))[s.Nf=1]="PLAYER",s[s.kf=2]="P2P_AGENT",s[s.Cf=3]="PREFETCHER_FIRST_TIER",s[s.Df=4]="PREFETCHER_SECOND_TIER";function e(){}i.TrackerPeerStreamInfo=e;function h(t,i,n){this.internalAs=0,this.externalAs=0,this.type=t,(this.isLeader=n)||(this.isLeader=!1),i&&(this.guid=i.guid,this.internalAs=i.internalAs,this.externalAs=i.externalAs,this.nat=i.nat,this.bandwidth=i.bandwidth,this.watchingBitrate=i.watchingBitrate,this.streams=i.streams,this.rankValue=i.rankValue,this.timestamp=i.timestamp,this.privateIpString=i.privateIpString,this.publicIpString=i.publicIpString)}i.Mf=h},function(t,i,n){n(67),n(37),n(68),n(108)},function(t,i,n){"use strict";function r(){throw new Error("Can't construct. GenericCollection is a mixin.")}(t.exports=r).jf=Object.freeze([]),r.prototype.hiveAddEach=function(i){if(i&&Object(i)===i)if("function"==typeof i.forEach)i.forEach(this.hiveAdd,this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else Object.keys(i).forEach(function(t){this.hiveAdd(i[t],t)},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},r.prototype.Pf=function(t,i){return t.forEach(function(t){this["delete"](t,i)},this),this},r.prototype.forEach=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)},void 0)},r.prototype.map=function(e){var h=arguments[1],o=[];return this.reduce(function(t,i,n,r,s){o.push(e.call(h,i,n,r,s))},void 0),o},r.prototype.enumerate=function(n){null==n&&(n=0);var r=[];return this.reduce(function(t,i){r.push([n++,i])},void 0),r},r.prototype.group=function(e,h,o){o=o||Object.Ae;var u=[],a=[];return this.forEach(function(t,i,n){i=e.call(h,t,i,n);var r,s=a.indexOf(i,o);-1===s?(r=[],u.push([i,r]),a.push(i)):r=u[s][1],r.push(t)}),u},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.Lf=function(){var r={};return this.reduce(function(t,i,n){r[n]=i},void 0),r},r.prototype.filter=function(e){var h=arguments[1],o=this.je();return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)&&o.hiveAdd(i,n)},void 0),o},r.prototype.every=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t&&e.call(h,i,n,r,s)},!0)},r.prototype.some=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t||e.call(h,i,n,r,s)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.Ih=function(){return this.some(Boolean)},r.prototype.min=function(n){n=n||this.Hf||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):n(i,t)<0?i:t},void 0)},r.prototype.max=function(n){n=n||this.Hf||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):0<n(i,t)?i:t},void 0)},r.prototype.sa=function(t){return t=void 0===t?0:t,this.reduce(function(t,i){return t+i},t)},r.prototype.Uf=function(t){var n=void 0===t?0:t,r=void 0===t?0:t;return this.reduce(function(t,i){n+=i,r+=1},void 0),n/r},r.prototype.concat=function(){for(var t=this.je(this),i=0;i<arguments.length;i++)t.hiveAddEach(arguments[i]);return t},r.prototype.Ff=function(){var n=this;return this.reduce(function(t,i){return i.forEach(function(t){this.push(t)},t,n),t},[])},r.prototype.Gf=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),Array.xf(t)},r.prototype.join=function(n){return this.reduce(function(t,i){return void 0===t?i:t+n+i},void 0)},r.prototype.Bf=function(n,i,r){return(n=n||this.Hf||Object.compare).Vf?(i=n.Vf,n=n.compare||this.Hf||Object.compare):i=i||Function.identity,void 0===r&&(r=1),this.map(function(t){return{Vf:i(t),value:t}}).sort(function(t,i){return n(t.Vf,i.Vf)*r}).map(function(t){return t.value})},r.prototype.reversed=function(){return this.je(this).reverse()},r.prototype.clone=function(n,r){if(void 0===n)n=1/0;else if(0===n)return this;var s=this.je();return this.forEach(function(t,i){s.hiveAdd(Object.clone(t,n-1,r),i)},this),s},r.prototype.only=function(){if(1===this.length)return this.qf()},r.prototype.iterator=function(){return this.Qf.apply(this,arguments)},r.Me={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(r.prototype,"size",r.Me),n(67)},function(t,i,n){n(10);var r=Object.prototype.hasOwnProperty;function h(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}function o(t,i,n,r){var s,e,h,o=t.active,u=t.Yf,a=u.length,f=a;for(o.length>a&&(o.length=a);a--;)o[a]=u[a];for(e=0;e<f;e++)if(h=o[e],!e||0<=u.indexOf(h)){if(!(s=h[t.Kf]||h[t.Wf]||h).call)throw new Error("No event listener for "+t.$f+" or "+t.Xf+" or call on "+s);s.call(h,n,i,r)}}(t.exports=h).debug=!0,h.prototype.Jf=function(t){this.zf||Object.defineProperty(this,"zf",{value:{},enumerable:!1,configurable:!0,writable:!0});var i=this.zf;if(!r.call(i,t)){var n=String(t);n=n&&n[0].toUpperCase()+n.slice(1),i[t]={Zf:{Yf:[],active:[],Kf:"handle"+n+"WillChange",Wf:"handlePropertyWillChange"},tc:{Yf:[],active:[],Kf:"handle"+n+"Change",Wf:"handlePropertyChange"}}}return i[t]},h.prototype.ic=function(t){if(!this.zf)return!1;if(!t)return!0;var i=this.zf;return!!r.call(i,t)},h.prototype.rc=function(t,i,n){this.sc&&!this.ec&&this.sc();var r,s=h.Jf(this,t);r=n?s.Zf:s.tc,h.hc(this,t),r.Yf.push(i);var e=this;return function(){h.oc(e,t,i,n),e=null}},h.prototype.uc=function(t,i){return h.rc(this,t,i,!0)},h.prototype.oc=function(t,i,n){var r,s=h.Jf(this,t),e=(r=n?s.Zf:s.tc).Yf.lastIndexOf(i);if(-1===e)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(t));r.Yf.splice(e,1)},h.prototype.ac=function(t,i){return h.oc(this,t,i,!0)},h.prototype.fc=function(t,i,n){var r,s=h.Jf(this,t);if(!s.isActive){s.isActive=!0,r=n?s.Zf:s.tc;try{o(r,t,i,this)}finally{s.isActive=!1}}},h.prototype.cc=function(t,i){return h.fc(this,t,i,!0)},h.prototype.hc=function(s){var e,h,t=this.lc;if(t){if(r.call(t,s))return}else{if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(s)+" observable on "+this+" because object is not extensible");t={},Object.defineProperty(this,"lc",{value:t,enumerable:!1,writable:!0,configurable:!0})}"object"==typeof this.vc?e=this.vc:(e={},Object.defineProperty(this,"vc",{value:e,writable:!0,enumerable:!1})),e[s]=this[s];var i,n=this;do{if(h=Object.getOwnPropertyDescriptor(n,s))break;n=Object.getPrototypeOf(n)}while(n);if(h){if(!h.configurable)return;if(!h.writable&&!h.set)return}else h={value:void 0,enumerable:!0,writable:!0,configurable:!0};i="value"in(t[s]=h)?{get:function(){return h.value},set:function(t){var i,n;if(t!==h.value){if(!(n=(i=this.zf[s]).isActive)){i.isActive=!0;try{o(i.Zf,s,h.value,this)}finally{}}if(h.value=t,e[s]=t,!n)try{o(i.tc,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0}:{get:h.get,set:function(t){var i,n,r=this[s];if(h.set.call(this,t),(t=this[s])!==r){if(!(n=(i=this.zf[s]).isActive)){i.isActive=!0;try{o(i.Zf,s,r,this)}finally{}}if(e[s]=t,!n)try{o(i.tc,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0},Object.defineProperty(this,s,i)},h.Jf=function(t,i){return t.Jf?t.Jf(i):h.prototype.Jf.call(t,i)},h.ic=function(t,i){return t.ic?t.ic(i):h.prototype.ic.call(t,i)},h.rc=function(t,i,n,r){if(Object.dc(t))return t.rc?t.rc(i,n,r):h.prototype.rc.call(t,i,n,r)},h.oc=function(t,i,n,r){if(Object.dc(t))return t.oc?t.oc(i,n,r):h.prototype.oc.call(t,i,n,r)},h.fc=function(t,i,n,r){if(Object.dc(t))return t.fc?t.fc(i,n,r):h.prototype.fc.call(t,i,n,r)},h.uc=function(t,i,n){return h.rc(t,i,n,!0)},h.ac=function(t,i,n){return h.oc(t,i,n,!0)},h.cc=function(t,i,n){return h.fc(t,i,n,!0)},h.hc=function(t,i){return t.hc?t.hc(i):h.prototype.hc.call(t,i)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(4),o=n(30);function h(i,r,s,e){void 0===r&&(r=""),void 0===s&&(s=[]),void 0===e&&(e=!1);function t(n){if(i.hasOwnProperty(n)){var t=i[n];Array.isArray(t)?t.forEach(function(t,i){"object"==typeof t&&h(t,r+"."+n+"["+i+"]",s,e)}):"object"==typeof t?h(t,r+"."+n,s,e):"number"==typeof t&&isNaN(t)&&(s.push(r+"."+n),e||(i[n]=null))}}for(var n in i)t(n);return s}function a(t,i){var n;switch(typeof i){case"number":n=parseInt(t);break;case"boolean":n="true"===t;break;default:n=t}return n}function s(t,i,n,r,s){void 0===r&&(r=!0),void 0===s&&(s={});var e=u.defer();try{var h=new XMLHttpRequest();if(h.open(t,i,r),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),s)for(var o in s)s.hasOwnProperty(o)&&null!==s[o]&&h.setRequestHeader(o,s[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.statusText,body:h.responseText})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send()}catch(t){e.reject({status:-1,reason:t})}return e.promise}i.Ca=function(t,i){return void 0===i&&(i=2),1e6<t?(t/1e6).toFixed(i)+"MB":1e3<t?(t/1e3).toFixed(i)+"KB":t+"B"},i.Ec=function(t,i,n){return void 0===i&&(i=""),void 0===n&&(n=[]),h(t,i,n,!0)},i.wc=h,i.pc=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=t[0],r=1;r<t.length;r++){var s=new RegExp("\\{"+(r-1)+"\\}","gm");n=n.replace(s,t[r])}return n},i.updateOptions=function(t,i){for(var n in t)t.hasOwnProperty(n)&&i.hasOwnProperty(n)&&(i[n]=t[n])},i.parseParameterOptions=function(t,i,n){var r=new o(t).query(!0);for(var s in r)try{if(r.hasOwnProperty(s)&&i.hasOwnProperty(s)&&n.hasOwnProperty(i[s])){var e=i[s],h=r[s];n[e]=a(h,n[e])}}catch(t){}},i.gc=function(i,n){var r=u.defer();return u.Fe(function t(){if(!i())return r.resolve(!0);u.when(n(),t,r.reject)}),r.promise},i.bc=function(t,i,n,r){return void 0===n&&(n=!0),void 0===r&&(r={}),s("GET",t,i,n,r)},i.yc=s,i.Tc=function(t,i,n,r,s){void 0===s&&(s=!0);var e=u.defer();try{var h=new XMLHttpRequest();if(h.open("POST",t,s),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),null!=r&&null!=r)for(var o in r)r.hasOwnProperty(o)&&null!==r[o]&&h.setRequestHeader(o,r[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.response})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send(i)}catch(t){e.reject({status:-1,reason:t})}return e.promise},i.mc=function(){"function"!=typeof Object.assign&&(Object.assign=function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var s=arguments[r];if(null!=s)for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(n[e]=s[e])}return n})},i.La=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Oc=function(t,i){var n=0,r=0,s=!1;if(i)for(;r<i.length&&!s;)t>=i.start(r)&&t<i.end(r)&&(n=i.end(r)-t,s=!0),r++;return n}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(42),h=n(7),o=(u.DashFilterBitrates=null,u.DashRemoveBitrateSize=!1,u);function u(){}var a=(f.AudioAccounting=!0,f);function f(){}var c,l=(c=e.HiveConfig.DebugLogs,s(v,c),v.TrackerLogs=0,v);function v(){return null!==c&&c.apply(this,arguments)||this}var d=(E.usiz=null,E);function E(){}var w=(p.restrictedConnectivityInfo=h.W.lf,p.hiddenHostnameValue="[Hidden]",p);function p(){}var g=(b.Rc=null,b._c=null,b);function b(){}var y=(T.detectPrivateIP=h.W.Ef,T);function T(){}var m=(O.Dash=o,O.Stats=a,O.DebugLogs=l,O.UDPBroadcast=d,O.SensitiveInfo=w,O.ClientInfo=g,O.ConnInfo=y,O);function O(){}i.HiveConfig=m,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Dash=m.Dash,window.HiveConfig.Stats=m.Stats,window.HiveConfig.UDPBroadcast=m.UDPBroadcast,window.HiveConfig.DebugLogs=m.DebugLogs,window.HiveConfig.SensitiveInfo=m.SensitiveInfo,window.HiveConfig.ClientInfo=m.ClientInfo,window.HiveConfig.ConnInfo=m.ConnInfo)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(7),s=(e.Ic="ws://127.0.0.1:8000/hive",e.Ac="wss://bee.hivestreaming.com:443/v1/hivejs",e.Nc="ws://127.0.0.1:8001/v1/hivejs",e.kc="wss://bee-test.hivestreaming.com:443/v1/hivejs",e.Cc="https://api-groot-test.hivestreaming.com/v1/auth/stream",e.Dc="https://api-groot-prod.hivestreaming.com/v1/auth/stream",e.Mc={iceServers:[{url:"stun:stun.hivestreaming.com:3478"}]},e.jc=3e4,e.Pc=3e5,e.Lc=8e4,e.Hc=1e3,e.Uc=3e4,e.Fc=100,e.Gc=1e4,e.xc=!1,e.Bc=!1,e.hf=r.W.hf,e.wf=r.W.wf,e.Vc=250,e);function e(){}i.qc=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(1),e=n(2);i.loggerId="[HiveServices] ";var h=(o.prototype.oa=function(){try{var t=[new Uint8Array([this.service>>8,255&this.service]),new Uint8Array([this.msgId]),this.msg];return new Blob(t,{type:"application/octet-binary"})}catch(t){throw s.ErrorMonitor.Z().logError("Error serializing message to send to the services",o.loggerId,e.re.se,t),new Error(t)}},o.Qc=function(t){try{String.fromCharCode.apply(null,new Uint8Array(t));var i=String.fromCharCode.apply(null,new Uint8Array(t.slice(3))),n=new Uint8Array(t.slice(0,2)),r=new Uint8Array(t.slice(2,3));return new o((n[0]<<8)+n[1],r[0],i)}catch(t){throw s.ErrorMonitor.Z().logError("Error extracting message from the services",this.loggerId,e.re.ee,t),new Error(t)}},o.loggerId="[Message] ",o);function o(t,i,n){this.msgId=i,this.service=t,this.msg=n}i.Yc=h,i.logger=function(){if(r)return r;var t=window&&window.window?window.window.Kc:void 0;if(void 0!==t&&t.log&&t.debug&&t.info&&t.warn&&t.error&&(r=t),!r){var i=!(void 0===window.console),n=i?emptyFunction.bind(console):function(){};r={log:n,debug:i&&window.console.debug?window.console.debug.bind(console):n,info:i&&window.console.info?window.console.info.bind(console):n,warn:i&&window.console.warn?window.console.warn.bind(console):n,error:i&&window.console.error?window.console.error.bind(console):n}}return r}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),a=n(4),o=n(0),u=n(22),f=n(45);(e=i.Wc||(i.Wc={}))[e.STOP=0]="STOP",e[e.IDLE=1]="IDLE",e[e.$c=2]="PLAY";var c=(l.prototype.close=function(t){t?(this.Xc["delete"](t),0==this.Xc.length&&this.Jc.close()):(this.Xc.clear(),this.Jc.close())},l.prototype.zc=function(t){return this.Xc.has(t)},l);function l(){this.p2pId=null,this.reportingId=null,this.Xc=new h(),this.logger=o.Framework.resolve(o.Framework.p.T).log(),this.logger.debug("INIT REPORTING"),this.Jc=o.Framework.resolve(o.Framework.p.Zc),this.tl=o.Framework.resolve(o.Framework.p.il)}i.nl=c;var v=(d.prototype.rl=function(t,i){this.sl=t,this.el.rl(this.sl),this.hl.rl(this.sl,i)},d.prototype.ol=function(t){this.ul.ol(t)},d.prototype.al=function(){return this.renderStatsCallback},d.prototype.fl=function(t){this.renderStatsCallback=t},d.prototype.cl=function(){this.vl.ll()},d);function d(t,i,n,r){this.ticket=t,this.Jc=i,this.sl=n,this.identity=r,this.el=o.Framework.resolve(o.Framework.p.dl),this.ul=o.Framework.resolve(o.Framework.p.El),this.hl=o.Framework.resolve(o.Framework.p.wl),this.vl=new u.pl(this.hl)}i.gl=v;var E,w=(s(p,E=c),p.prototype.initSession=function(t,i,n,r,s){var e=this,h=a.defer(),o=this.tl.bl(),u=this.Tl.yl(i);return u.pluginId=t,null!=r&&(u.testId=r),null!=u?o.then(function(t){return e.ml(t,u,h,n)}).fail(h.reject):h.reject("Ticket URL not valid"),h.promise},p.prototype.ml=function(s,t,e,i){var h=this;this.p2pId=s.Ol(),this.reportingId=s.Sl();var n=this.Jc.init(this.p2pId,t),r=this.Tl.resolve(n.Rl,t,i);n.promise.then(function(t){r.then(function(t){var i=t.sessionId;if(h.Xc.has(i))n=h.Xc.get(i),h.logger.warn("SESSION ALREADY EXISTING "+n.el.ticket);else{var n,r=f["default"]._l();(n=new v(t,h.Jc,r,s)).el.init(h.reportingId,t,r,i),n.hl.init(h.reportingId,r),n.hl.Il(t),h.Xc.set(i,n),h.logger.debug("SESSION SET ",i),e.resolve(n)}}).fail(function(t){return e.reject(t||"Error resolving the ticket")}),t.onerror(function(t){e.reject("Error establishing connection to Hive Services")})}).fail(function(t){return e.reject(t)}),this.Jc.connect()},p);function p(){var t=E.call(this)||this;return t.Tl=o.Framework.resolve(o.Framework.p.Al),t}i.Nl=w;var g,b=(s(y,g=c),y.prototype.initSession=function(t,i,n,r,s){var e=this,h=this.tl.bl();return i.pluginId=t,null!=r&&(i.testId=r),h.then(function(t){return e.ml(t,i,null,!1,s)}).fail(a.reject)},y.prototype.ml=function(s,e,t,i,n){var h=this;this.p2pId=s.Ol(),this.reportingId=s.Sl();var r=this.Jc.init(this.p2pId,e,n);return this.Jc.connect(),r.then(function(t){var i,n=e.sessionId;if(h.Xc.has(n))i=h.Xc.get(n),h.logger.warn("SESSION ALREADY EXISTING "+i.el.ticket);else{var r=f["default"]._l();(i=new v(e,h.Jc,r,s)).el.init(h.reportingId,e,r,n),i.hl.init(h.reportingId,r),i.hl.Il(e),h.Xc.set(n,i),h.logger.debug("SESSION SET ",n)}return i}).fail(function(t){return a.reject(t)})},y);function y(){return null!==g&&g.apply(this,arguments)||this}i.kl=b},function(t,c,i){"use strict";Object.defineProperty(c,"s",{value:!0});var l,n,s=i(4),r=i(175),v=i(35),e=i(3),d=i(31),E=i(0),h=i(177),a=i(184),w=i(5),f=i(6),p=i(1),g=i(2);c.Cl=!1,(n=l=c.Dl||(c.Dl={}))[n.Have=1]="Have",n[n.Chunk=2]="Chunk",n[n.Request=3]="Request",n[n.Cancel=4]="Cancel",n[n.Ack=5]="Ack",n[n.Close=6]="Close",n[n.DoNotHave=7]="DoNotHave",n[n.Ml=8]="OutPartRequest",n[n.jl=9]="OutPartResp",n[n.Pl=10]="UDPHandshakeReq",n[n.UDPHandshakeResponse=11]="UDPHandshakeResponse",n[n.UDPSwitchLeadershipRequest=12]="UDPSwitchLeadershipRequest",n[n.Ll=13]="UDPSwitchAck",n[n.Bitrate=14]="Bitrate",n[n.Haves=15]="Haves",n[n.Hl=16]="PeerInfo",n[n.Ping=17]="Ping",n[n.Pong=18]="Pong",n[n.Ul=19]="NoPartnerResp";var o=(u.prototype.Fl=function(t){try{var i=null,n=E.Framework.resolve(E.Framework.p.xl).Gl(t);return null==n?(this.logger.warn("MSG RECEIVED FROM UNKNOWN SWARM"),null):(i=new h.Bl(n,this.la.Vl,this.la.otherGuid,this.la),this.ql.has(t)||this.ql.set(t,i),this.ql.get(t))}catch(t){p.ErrorMonitor.Z().logError("Error creating new dispatcher",this.loggerId,g.Jt.zt,t)}},u.prototype.Ql=function(t){this.ql["delete"](t)},u.prototype.Yl=function(t){return this.ql.get(t)},u);function u(t){this.loggerId="[DispatcherManager] ",this.ql=new e(),this.logger=E.Framework.resolve(E.Framework.p.T).log(),this.la=t}c.Kl=o;var b=(y.prototype.init=function(t,i){this.Vl=t,this.otherGuid=i,this.Wl=E.Framework.resolve(E.Framework.p.$l)},y.prototype.Xl=function(){var n=!1;return this.Jl.ql.forEach(function(t,i){(t.sender.Xl()||t.receiver.Xl())&&(n=!0)}),n},y.prototype.reset=function(){this.Jl.ql.forEach(function(t,i){t.sender.zl()})},y.prototype.close=function(t){return this.Jl.Ql(t),0==this.Jl.ql.length&&this.Wl.disconnect(this.otherGuid),s("ok")},y.prototype.Zl=function(i,n,t){var r,s;try{this.tv=E.Framework.time();var e=t.Wa(),h=e.byteLength,o=d.sv.rv.nv.create(e),u=d.sv.ev(o),a=new v();a.hv(i),a.ov(n),a.hv(h),a.ov(u.toString()),a.append(e),a.uv(),r=a.Wa(),s=i===l.Chunk&&E.Framework.O()?r.byteLength+w.Ku.Fu.Xo:r.byteLength,c.Cl&&this.av.log(n).debug(this.tt+" SEND MSG ID "+i+","+s+" HASH "+u.toString()+" TO "+this.otherGuid)}catch(t){p.ErrorMonitor.Z().logError("Error constructing message",this.loggerId,g.Yt.Kt,{fv:l[i]})}try{var f=this.Wl.send(this.otherGuid,r,s);return f||p.ErrorMonitor.Z().logError("Error message dropped",this.loggerId,g.Yt.Wt,{fv:l[i],otherGuid:this.otherGuid}),f}catch(t){p.ErrorMonitor.Z().logError("Error sending message",this.loggerId,g.Yt.$t,{fv:l[i],otherGuid:this.otherGuid}),this.av.log(n).warn("ERROR SENDING MESSAGE TO "+this.otherGuid+" "+t.stack)}},y.prototype.cv=function(){this.Jl.ql.forEach(function(t){return t.cv()})},y.prototype.lv=function(h){var o=this;c.Cl&&this.av.log().debug(this.tt+" GOT MSG "+h.byteLength);try{var u=E.Framework.time();this.tv=u,this.vv(h).then(function(t){if(c.Cl&&o.av.log().debug(o.tt+" RECEIVING "+t.byteLength+" after "+(E.Framework.time()-u)),t.byteLength>y.dv)throw new RangeError("P2P Message too big to be processed");var i=o.message;if(null===i){var n=v.wrap(t),r=n.Ev();if(c.Cl&&o.av.log().debug("MSG ID "+r),r>Object.keys(l).length)return o.av.log().warn("MSG OF WRONG ID RECEIVED: "+r),void (o.message=null);if((i=o.message=new a.pv()).wv=r,i.swarmId=n.gv(),i.length=n.Ev(),i.hash=n.gv(),i.bv=n.Wa(),i.length>y.dv)throw new RangeError("P2P Message too big to be processed");c.Cl&&o.av.log(i.swarmId).debug("MSG ID "+i.wv+" L "+i.length+" SWID "+i.swarmId+" H "+i.hash+" TR "+i.bv.byteLength)}else{if(c.Cl&&o.av.log().debug("APPENDING TO P2P MESSAGE "+i.wv),null!=i.bv.byteLength&&i.bv.byteLength>y.dv)throw new RangeError("P2P Message too big to be processed");i.bv=f.appendBuffer(i.bv,h)}if(i.bv.byteLength===i.length){var s=d.sv.rv.nv.create(i.bv);if(d.sv.ev(s).toString()!==i.hash)return void o.av.log(i.swarmId).warn(" INTEGRITY CHECK FAILED ");var e=o.Jl.Yl(i.swarmId);e||(e=o.Jl.Fl(i.swarmId),o.av.log(i.swarmId).debug("CREATED NEW DISPATCHER FOR "+o.otherGuid)),e&&e.fh(i),i.bv=null,o.message=null}})}catch(t){p.ErrorMonitor.Z().logError("Error receiving message",this.loggerId,g.Yt.Xt,t),this.message=null}},y.prototype.vv=function(i){var t=!E.Framework.O()&&-1<navigator.userAgent.toLowerCase().indexOf("firefox"),n=s.defer();if(t){var r=new FileReader();r.onload=function(t){i=this.result,n.resolve(i)},r.onerror=n.reject,r.readAsArrayBuffer(i)}else n.resolve(i);return n.promise},y.prototype.yv=function(){return this.tv},y.Tv=r.Ov(i(185)).mv("HiveMsgs"),y.Sv=0,y.dv=136+Math.ceil(1.2*w.Ku.Fu.Xo),y);function y(){this.loggerId="[Transport] ",this.message=null,this.av=E.Framework.resolve(E.Framework.p.T),this.Jl=new o(this),this.tt=y.Sv++,this.tv=E.Framework.time()}c.Rv=b},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.monitorPort=e.qc._v?h.Av.Iv:h.Av.Nv,this.playerPort=e.qc._v?h.Av.kv:h.Av.Cv,this.feedbackPeriod=2e3,this.idleTimePeriod=6e4,this.useSessionCheck=e.qc.Dv,this.debugLevel="notice",this.isSDNDebug=!1,this.hiveTechOrder=[],this.telemetryId=null,this.silent=!1,this.loggerTimestamp=s.HiveConfig.Framework.LoggerTimestamp,this.testId=null,this.pluginTimeout=o.W.rf,this.readyCheckTimeout=0,this.Mv=-1,this.onSourceSetCompleted=function(t){},this.onLoadingCompleted=function(t){},this.detectPrivateIP=o.W.Ef,this.authTokenEnabled=!0,this.dashRemoveBitrateSize=!1,this.dashFilterBitrates=null,this.staticPartnerId=null,this.staticCustomerId=null,this.audioMetrics=!0,this.logJsonSnapshots=void 0,this.onActiveSession=function(t){},this.onError=function(t){},this.jv=void 0}var s=n(42),e=n(27),h=n(43),o=n(7);i.Options=r;function u(){this.initTimeout=3e4,this.onError=function(t){return!0},this.onActiveSession=function(t){}}i.HiveTechOptions=u;function a(){this.hivePlayerPort="playerPort",this.hiveMonitorPort="monitorPort",this.hiveSilent="silent",this.hiveDebugLevel="debugLevel",this.isSDNDebug="isSDNDebug",this.hiveDebugTimestamp="loggerTimestamp",this.hiveSetupTimeout="setupTimeout",this.hiveJavaTimeout="initTimeout",this.hiveWarnJavaTimeout="warnSlowRespTimeout",this.hiveTestId="testId",this.hiveDetectPrivateIP="detectPrivateIP",this.hiveAuthTokenEnabled="authTokenEnabled",this.hiveDashRemoveBitrateSize="dashRemoveBitrateSize",this.hiveDashFilterBitrates="dashFilterBitrates",this.hiveLogJsonSnapshots="logJsonSnapshots",this.hiveStaticPartnerId="staticPartnerId",this.hiveStaticCustomerId="staticCustomerId",this.hiveAudioMetrics="audioMetrics"}i.UrlConfigurableOptions=a;var f=(c.enabledRUM=!1,c.enableKeyCombination=!0,c.enabledErrorFilter=!0,c);function c(){}i.Et=f;var l=(v.Pv=function(t){"dashRemoveBitrateSize"in t&&t.dashRemoveBitrateSize&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashRemoveBitrateSize=t.dashRemoveBitrateSize),"dashFilterBitrates"in t&&t.dashFilterBitrates&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashFilterBitrates=t.dashFilterBitrates),"staticCustomerId"in t&&t.staticCustomerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo._c=t.staticCustomerId),"staticPartnerId"in t&&t.staticPartnerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.Rc=t.staticPartnerId),"audioMetrics"in t&&!t.audioMetrics&&window.HiveConfig&&window.HiveConfig.Stats&&(window.HiveConfig.Stats.AudioAccounting=t.audioMetrics),"detectPrivateIP"in t&&"boolean"==typeof t.detectPrivateIP&&window.HiveConfig&&window.HiveConfig.ConnInfo&&(window.HiveConfig.ConnInfo.detectPrivateIP=t.detectPrivateIP),"logJsonSnapshots"in t&&t.logJsonSnapshots&&window.HiveConfig&&window.HiveConfig.DebugLogs&&(window.HiveConfig.DebugLogs.MetricSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackerLogs=1)},v);function v(){}i.Lv=l,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.ErrorMonitor=f)},function(t,i){t.exports=void 0},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.savings=0,this.cdnRequests=0,this.cdnResponses=0,this.cdnResponseErrors=0,this.cdnResponseBytes=0,this.p2pRequests=0,this.p2pResponses=0,this.p2pResponseErrors=0,this.p2pResponseBytes=0,this.p2pPartnerTotalSentBytes=0,this.partners={}}i.Hv=r;function s(){this.uuid="",this.sentBytes=0,this.receivedBytes=0,this.successTransfers=0,this.failedTransfers=0,this.rateReceived=0,this.Uv=0}i.Fv=s;function e(){}var h,o,u,a;i.HiveSession=e,(o=h=i.HiveSessionErrorCode||(i.HiveSessionErrorCode={}))[o.GENERIC_ERROR=0]="GENERIC_ERROR",o[o.NO_TECH_AVAILABLE=1]="NO_TECH_AVAILABLE",o[o.NO_TECH_RESOLVED=2]="NO_TECH_RESOLVED",o[o.TECH_ERROR=3]="TECH_ERROR",o[o.TICKET_ERROR=4]="TICKET_ERROR",(a=u=u||{})[a.Gv=0]="Generic Undefined Error",a[a.xv=1]="No Tech available to resolve the ticket",a[a.Bv=2]="No available Tech could resolved the ticket",a[a.Vv=3]="Stopped resolving session on last tech onError",a[a.qv=4]="The ticket could not be resolved";var f=(c.getHiveSessionErrorMessage=function(t){return u[t]},c.getHiveSessionError=function(t,i,n){var r=new c();return r.ticketUrl=t,r.code=i,r.message=c.getHiveSessionErrorMessage(i),r.detailedMessage=n,r},c.HiveSessionErrorCode=h,c);function c(){}i.HiveSessionError=f;function l(t,i){this.code=t,this.message=i}var v,d,E;i.HiveTechError=l,(v=i.Qv||(i.Qv={}))[v.Yv=0]="NOT_READY",v[v.Kv=1]="PLUGIN_ERROR",v[v.Wv=2]="SESSION_ERROR",v[v.TICKET_ERROR=3]="TICKET_ERROR",v[v.$v=4]="VERSION_ERROR",v[v.Xv=5]="TIMEOUT_ERROR",(E=d=i.MainStatusCode||(i.MainStatusCode={}))[E.Jv=0]="OK",E[E.zv=1]="HIVE_NOT_ALLOWED",E[E.Zv=2]="TICKET_NOT_RESOLVED",E[E.td=3]="TIMEOUT_RESOLVING_TICKET",i.nd=function(t){switch(t){case d.Jv:return"OK";case d.zv:return"HIVE_NOT_ALLOWED";case d.Zv:return"TICKET_NOT_RESOLVED";case d.td:return"TIMEOUT_RESOLVING_TICKET";default:return}};var w=(p.prototype.getPluginStatusCode=function(){return this.rd.getStatusCode()},p);function p(t){this.rd=t}i.HivePluginReference=w},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(73),h=n(57),o=n(4),u=n(0),a=n(15),f=n(16),c=n(14),l=n(74),v=n(121),d=n(122),E=n(123),w=(p.sd="hive-client-track",p.hd="trackevent",p.od="NULLID",p.ud="",p);function p(){}var g,b="[TRACK] ";(g=i.PlayerEvents||(i.PlayerEvents={}))[g.PLAYING=0]="PLAYING",g[g.BUFFERING=1]="BUFFERING",g[g.PAUSED=2]="PAUSED",g[g.SKIP=3]="SKIP",g[g.STOPPED=4]="STOPPED",g[g.ERROR=5]="ERROR",g[g.WINDOW_SIZE=6]="WINDOW_SIZE",g[g.FULLSCREEN=7]="FULLSCREEN",g[g.VISIBLE=8]="VISIBLE",g[g.HIDDEN=9]="HIDDEN",g[g.ad=10]="MUTED",g[g.fd=11]="LANGUAGE_SWITCH";function y(){}i.ld=y;var T,m=function(){this.type=2},O=(T=v.vd,s(S,T),S.prototype.dd=function(i,t){var n;this.sessions.forEach(function(t){t.sessionId==i&&(n=t)}),n||((n=new E.Ed()).sessionId=i,n.events=[],this.sessions.push(n)),n.events.push(t)},S);function S(){var t=T.call(this)||this;return t.sessions=new Array(),t}var R=(_.prototype.wd=function(t){this.client=t},_.prototype.init=function(t,i){this.pd=t,this.rl(i),this.logger.debug(b+"INIT ID: "+t)},_.prototype.rl=function(t,i){this.sl=t,i&&(this.gd=i)},_.prototype.updatePlayerInfo=function(t){this.bd=t},_.prototype.Il=function(t){var i=new N(t,this);this.yd.push(i),this.Td=null,this.client.md(!0)},_.prototype.Od=function(t,i,n){if(!this.Td)for(var r=0;r<this.yd.length;r++){var s=this.yd[r];if(s.ticket.sessionId===t){this.logger.debug(b+"Activating Track for session "+t),this.Td=s;break}}if(this.Td)if(this.Td.ticket.sessionId==t){if(!this.Td.Sd){var e=new C(t,i,n);this.Td.Rd(e),this.client.md()}}else this.logger.warn(b+"ignoring manifest not matching event "+this.Td.ticket.sessionId+" != "+t)},_.prototype.Id=function(t,i,n){null!=this.Td&&(this.Td.Sd||this.Td.Ad.push(new G(t,i,n)))},_.prototype.Nd=function(t,i,n){this.kd.push(new P(t,i,n)),this.client.md()},_.prototype.Cd=function(t,i,n){this.Dd.push(new U(t,i,n)),this.client.md()},_.prototype.Md=function(t){var i=this;t&&t.forEach(function(t){i.Dd.push(t)})},_.prototype.jd=function(){var t=new d.Hl();this.gd?(t.partnerId=this.gd.partnerId,t.customerId=this.gd.customerId):c.HiveConfig.ClientInfo.Rc&&c.HiveConfig.ClientInfo._c?(t.partnerId=c.HiveConfig.ClientInfo.Rc,t.customerId=c.HiveConfig.ClientInfo._c):this.Td&&(t.partnerId=this.Td.ticket.Pd(),t.customerId=this.Td.ticket.Ld()),t.version=this.sl.name+"_"+(this.gd?this.gd.version:this.sl.version),this.gd&&(t.installVersion=this.gd.installVersion,t.installTs=this.gd.installTs);var i=new h.Hd();return i.Ud(navigator.userAgent),t.os=i.Fd().name+" "+i.Fd().version,this.bd&&(t.commVersion=this.bd.commVersion,t.pluginName=this.bd.pluginName,t.pluginVersion=this.bd.pluginVersion,t.playerTech=this.bd.playerTech,t.playerVersion=this.bd.playerVersion,this.bd.telemetryId&&(t.telemetryId=this.bd.telemetryId)),t},_.prototype.Gd=function(){return this.Td?this.Td:this.yd&&0<this.yd.length?this.yd[this.yd.length-1]:void 0},_.prototype.xd=function(t){var n=this;if(void 0===t&&(t=!0),0==this.yd.length&&0==this.kd.length)return t?o.reject("nothing to send"):(this.logger.debug(b+" NOTHING TO SEND"),null);var r=new l.Bd();r.app=w.sd,r.createdAt=u.Framework.time(),r.guid=this.pd,r.name=w.hd;var i=this.Gd();if(i){var s=i.ticket.Vd().replace(/[\[\]]/g,"");r.tags=[s],r.tags.push(i.ticket.Pd()),r.tags.push(i.ticket.Ld())}else r.tags=new Array();var e=new O();if(e.peer=this.jd(),this.yd.forEach(function(t){t.Sd||e.dd(t.ticket.sessionId,t)}),this.kd.forEach(function(t){e.dd(t.sessionId,t)}),this.Dd.forEach(function(t){e.dd(t.sessionId,t)}),r.data=e,t)return this.qd.getConnectivityInfo().then(function(t){var i=n.Qd(t);return e.dd("null",i),r}).fail(function(t){return r});var h=this.Qd(this.qd.Yd());return e.dd("null",h),r},_.prototype.Qd=function(t){var i=new m();i.ts=u.Framework.time();var n=t.getNetworkChanged();return n.getPublicIp()&&(i.pubIp=n.getPublicIp()),n.getPrivateIp()&&(i.privIp=e.Kd.getPrivateIp(n)),t.getHostName()&&(i.hostname=e.Kd.Wd(t)),n.getCidr()&&(i.netmask=n.getCidr()),n.getNic()&&(i.nic=n.getNic()),n.getNicName()&&(i.nicName=n.getNicName()),n.getMacAddress()&&(i.mac=n.getMacAddress()),i},_.prototype.$d=function(){return this.gd?this.gd.userAgent:navigator.userAgent},_.prototype.reset=function(){this.yd=new Array(),this.kd=new Array(),this.Dd=new Array()},_.prototype.Xd=function(t){},_);function _(){this.logger=u.Framework.resolve(u.Framework.p.T).log(),this.qd=u.Framework.resolve(u.Framework.p.Jd),this.yd=new Array(),this.kd=new Array(),this.Dd=new Array()}i.zd=R;var I=(A.prototype.md=function(t){void 0===t&&(t=!1);var i=t?a.qc.Lc:a.qc.Pc;this.Zd?i<this.tE-new Date().getTime()&&(u.Framework.clearTimeout(this.Zd),this.tE=null,this.iE(i)):this.iE(i)},A.prototype.ll=function(){this.Zd&&(u.Framework.clearTimeout(this.Zd),this.tE=this.Zd=null)},A.prototype.iE=function(t,i){var n=this;void 0===i&&(i=!1),this.Zd=u.Framework.setTimeout(function(){n.nE()},t,i),this.tE=new Date().getTime()+t},A.prototype.nE=function(t){var i=this;void 0===t&&(t=!0),this.Zd=null,this.tE=null;var n=this.hl.xd(t);t?(this.logger.debug(b+"TAKING A TRACK SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.debug(b+" ERROR GENERATING/SENDING THE TRACK SNAPSHOT: ",t)})["finally"](function(){return i.hl.reset()}).done()):(this.logger.debug(b+"FLUSHING TRACK SNAPSHOT"),this.forward(n),this.hl.reset())},A.prototype.forward=function(t){if(this.client&&this.client.rE()&&t){var i=JSON.stringify(t);switch(this.sE){case 0:default:this.logger.debug(b+"TRACK EVENT");break;case 1:this.logger.debug(b+"TRACK EVENT:"+i)}var n=new f.Yc(HiveStreamingServices.eE,2,i);this.client.rE().send(n)}},A.prototype.hE=function(t){void 0===t&&(t=!0),t?(this.ll(),this.iE(a.qc.Hc,!0)):this.nE(!1)},A);function A(t){this.sE=isNaN(c.HiveConfig.DebugLogs.TrackSnapshotLogs)?0:c.HiveConfig.DebugLogs.TrackSnapshotLogs,this.hl=t,this.logger=u.Framework.resolve(u.Framework.p.T).log(),this.client=u.Framework.resolve(u.Framework.p.Zc),this.hl.wd(this)}i.pl=I;var N=(k.prototype.Rd=function(t){this.manifests.push(t)},k.prototype.toJSON=function(){var n={type:0,ticket:{}};n.ticket.url=this.ticket.ticketUrl,n.ticket.reqTs=this.ticket.oE,n.ticket.respTs=this.ticket.uE,n.ticket.userAgent=this.hl.$d(),null!=this.ticket.testId&&(n.ticket.testId=this.ticket.testId),n.manifests=[],this.manifests.forEach(function(t){var i={};i.url=t.url,i.respTs=t.uE,i.respCode=t.respCode,n.manifests.push(i)});var i=-1,r=-1,s=-1;return this.Ad.forEach(function(t){0<t.aE&&(-1==i&&(i=t.ts,r=t.aE),s=t.aE)}),-1!=i&&(n.playTs=i),-1!=s&&(n.buffTime=s),-1!=r&&(n.initBuffTime=r),n},k);function k(t,i){this.createdAt=new Date().getTime(),this.Sd=!1,this.ticket=t,this.manifests=new Array(),this.Ad=new Array(),this.hl=i}i.fE=N;var C=function(t,i,n){this.eventId=t,this.url=i,this.uE=new Date().getTime(),this.respCode=n},D=(M.prototype.toJSON=function(){var t={};return t.type=this.cE+this.event,t.ts=this.ts,this.lE&&(t.parameters=this.lE),t},M);function M(t,i,n,r){this.ts=new Date().getTime(),this.sessionId=t,this.sessionId||(this.sessionId="null"),this.event=i,this.lE=n,r&&(this.ts=r)}var j,P=(s(L,j=D),L);function L(t,i,n,r){var s=j.call(this,t,i,n,r)||this;return s.cE=100,s}var H,U=(s(F,H=D),F);function F(t,i,n,r){var s=H.call(this,t,i,n,r)||this;return s.cE=200,s}i.vE=U;var G=function(t,i,n){this.ts=new Date().getTime(),this.playingPoint=t,this.dE=i,this.aE=n}},function(module,exports,__webpack_require__){var Thrift={EE:"0.9.3",Type:{STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17},aa:{CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4},wE:function(t){var i=0;for(var n in t)t.hasOwnProperty(n)&&i++;return i},pE:function(t,i,n){function r(){}r.prototype=i.prototype,t.prototype=new r(),t.prototype.name=n||""}},copyList,copyMap;Thrift.gE=function(t){this.message=t},Thrift.pE(Thrift.gE,Error,"TException"),Thrift.gE.prototype.bE=function(){return this.message},Thrift.yE={TE:0,mE:1,OE:2,SE:3,RE:4,_E:5,IE:6,AE:7,NE:8,kE:9,CE:10},Thrift.DE=function(t,i){this.message=t,this.code="number"==typeof i?i:0},Thrift.pE(Thrift.DE,Thrift.gE,"TApplicationException"),Thrift.DE.prototype.read=function(t){for(;;){var i=t.ME();if(i.ftype==Thrift.Type.STOP)break;switch(i.fid){case 1:i.ftype==Thrift.Type.STRING?(i=t.jE(),this.message=i.value):i=t.PE(i.ftype);break;case 2:i.ftype==Thrift.Type.I32?(i=t.LE(),this.code=i.value):i=t.PE(i.ftype);break;default:i=t.PE(i.ftype)}t.HE()}t.UE()},Thrift.DE.prototype.write=function(t){t.FE("TApplicationException"),this.message&&(t.GE("message",Thrift.Type.STRING,1),t.xE(this.bE()),t.BE()),this.code&&(t.GE("type",Thrift.Type.I32,2),t.VE(this.code),t.BE()),t.qE(),t.QE()},Thrift.DE.prototype.YE=function(){return this.code},Thrift.Fu=Thrift.ga=function(t,i){this.url=t,this.KE=0,this.WE=0,this.$E=i&&i.$E,this.XE="",this.JE=""},Thrift.ga.prototype={zE:function(){try{return new XMLHttpRequest()}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw"Your browser doesn't support XHR."},flush:function(t,i){var n=this;if(t&&!i||void 0===this.url||""===this.url)return this.XE;var r,s=this.zE();if(s.overrideMimeType&&s.overrideMimeType("application/vnd.apache.thrift.json; charset=utf-8"),i&&(s.onreadystatechange=(r=i,function(){4==this.readyState&&200==this.status&&(n.Ea(this.responseText),r())})),s.open("POST",this.url,!!t),s.setRequestHeader&&(s.setRequestHeader("Accept","application/vnd.apache.thrift.json; charset=utf-8"),s.setRequestHeader("Content-Type","application/vnd.apache.thrift.json; charset=utf-8")),s.send(this.XE),!t||!i){if(4!=s.readyState)throw"encountered an unknown ajax ready state: "+s.readyState;if(200!=s.status)throw"encountered a unknown request status: "+s.status;this.JE=s.responseText,this.ZE=this.JE.length,this.KE=this.JE.length,this.WE=0}},tw:function(i,t,n,r){if("undefined"==typeof jQuery||void 0===jQuery.iw)throw"Thrift.js requires jQuery 1.5+ to use asynchronous requests";var s=this;return jQuery.nw({url:this.url,data:t,type:"POST",rw:!1,contentType:"application/vnd.apache.thrift.json; charset=utf-8",sw:"text thrift",ew:{hw:function(t){return s.Ea(t),r.call(i)}},context:i,success:jQuery.ow(n).pop()})},Ea:function(t){this.JE=t,this.ZE=this.JE.length,this.KE=this.JE.length,this.WE=0},isOpen:function(){return!0},open:function(){},close:function(){},read:function(t){var i=this.KE-this.WE;if(0==i)return"";var n=t;i<t&&(n=i);var r=this.uw.substr(this.WE,n);return this.WE+=n,r},aw:function(){return this.JE},write:function(t){this.XE=t},ca:function(){return this.XE}},Thrift.fw=function(t){this.cw(t)},Thrift.fw.prototype={cw:function(t){this.url=t,this.lw=null,this.callbacks=[],this.vw=[],this.XE="",this.JE="",this.dw=0,this.Ew=0},flush:function(t,i){var n,r=this;this.isOpen()?(this.lw.send(this.XE),this.callbacks.push((n=i,function(t){r.Ea(t),n()}))):this.vw.push({ww:this.XE,pw:i})},gw:function(){var n=this;0<this.vw.length&&(this.vw.forEach(function(t){var i;this.lw.send(t.ww),this.callbacks.push((i=t.pw,function(t){n.Ea(t),i()}))}),this.vw=[])},bw:function(t){this.cw(this.url)},yw:function(t){this.callbacks.length&&this.callbacks.shift()(t.data)},Tw:function(t){!1,this.lw.close()},Ea:function(t){this.JE=t,this.ZE=this.JE.length,this.KE=this.JE.length,this.WE=0},isOpen:function(){return this.lw&&this.lw.readyState==this.lw.OPEN},open:function(){this.lw&&this.lw.readyState!=this.lw.CLOSED||(this.lw=new WebSocket(this.url),this.lw.onopen=this.gw.bind(this),this.lw.onmessage=this.yw.bind(this),this.lw.onerror=this.Tw.bind(this),this.lw.onclose=this.bw.bind(this))},close:function(){this.lw.close()},read:function(t){var i=this.KE-this.WE;if(0==i)return"";var n=t;i<t&&(n=i);var r=this.uw.substr(this.WE,n);return this.WE+=n,r},aw:function(){return this.JE},write:function(t){this.XE=t},ca:function(){return this.XE}},Thrift.ba=Thrift.Ow=function(t){this.Sw=[],this.Rw=[],this.la=t},Thrift.Ow.Type={},Thrift.Ow.Type[Thrift.Type.BOOL]='"tf"',Thrift.Ow.Type[Thrift.Type.BYTE]='"i8"',Thrift.Ow.Type[Thrift.Type.I16]='"i16"',Thrift.Ow.Type[Thrift.Type.I32]='"i32"',Thrift.Ow.Type[Thrift.Type.I64]='"i64"',Thrift.Ow.Type[Thrift.Type.DOUBLE]='"dbl"',Thrift.Ow.Type[Thrift.Type.STRUCT]='"rec"',Thrift.Ow.Type[Thrift.Type.STRING]='"str"',Thrift.Ow.Type[Thrift.Type.MAP]='"map"',Thrift.Ow.Type[Thrift.Type.LIST]='"lst"',Thrift.Ow.Type[Thrift.Type.SET]='"set"',Thrift.Ow._w={},Thrift.Ow._w.tf=Thrift.Type.BOOL,Thrift.Ow._w.i8=Thrift.Type.BYTE,Thrift.Ow._w.i16=Thrift.Type.I16,Thrift.Ow._w.i32=Thrift.Type.I32,Thrift.Ow._w.i64=Thrift.Type.I64,Thrift.Ow._w.dbl=Thrift.Type.DOUBLE,Thrift.Ow._w.rec=Thrift.Type.STRUCT,Thrift.Ow._w.str=Thrift.Type.STRING,Thrift.Ow._w.map=Thrift.Type.MAP,Thrift.Ow._w.lst=Thrift.Type.LIST,Thrift.Ow._w.set=Thrift.Type.SET,Thrift.Ow.EE=1,Thrift.Ow.prototype={Iw:function(){return this.la},ua:function(t,i,n){this.Sw=[],this.Rw=[],this.Sw.push([Thrift.Ow.EE,'"'+t+'"',i,n])},fa:function(){var t=this.Sw.pop();this.Aw=this.Sw.pop(),this.Aw.push(t),this.Nw="["+this.Aw.join(",")+"]",this.la.write(this.Nw)},FE:function(t){this.Rw.push(this.Sw.length),this.Sw.push({})},QE:function(){var t=this.Rw.pop(),i=this.Sw[t],n="{",r=!0;for(var s in i)r?r=!1:n+=",",n+=s+":"+i[s];n+="}",this.Sw[t]=n},GE:function(t,i,n){this.Rw.push(this.Sw.length),this.Sw.push({kw:'"'+n+'"',Cw:Thrift.Ow.Type[i]})},BE:function(){var t=this.Sw.pop(),i=this.Sw.pop();this.Sw[this.Sw.length-1][i.kw]="{"+i.Cw+":"+t+"}",this.Rw.pop()},qE:function(){},Dw:function(t,i,n){this.Rw.push(this.Sw.length),this.Sw.push([Thrift.Ow.Type[t],Thrift.Ow.Type[i],0])},Mw:function(){var t=this.Rw.pop();if(t!=this.Sw.length){(this.Sw.length-t-1)%2!=0&&this.Sw.push("");var i=(this.Sw.length-t-1)/2;this.Sw[t][this.Sw[t].length-1]=i;for(var n="}",r=!0;this.Sw.length>t+1;){var s=this.Sw.pop(),e=this.Sw.pop();r?r=!1:n=","+n,isNaN(e)||(e='"'+e+'"'),n=e+":"+s+n}n="{"+n,this.Sw[t].push(n),this.Sw[t]="["+this.Sw[t].join(",")+"]"}},jw:function(t,i){this.Rw.push(this.Sw.length),this.Sw.push([Thrift.Ow.Type[t],i])},Pw:function(){for(var t=this.Rw.pop();this.Sw.length>t+1;){var i=this.Sw[t+1];this.Sw.splice(t+1,1),this.Sw[t].push(i)}this.Sw[t]="["+this.Sw[t].join(",")+"]"},Lw:function(t,i){this.Rw.push(this.Sw.length),this.Sw.push([Thrift.Ow.Type[t],i])},Hw:function(){for(var t=this.Rw.pop();this.Sw.length>t+1;){var i=this.Sw[t+1];this.Sw.splice(t+1,1),this.Sw[t].push(i)}this.Sw[t]="["+this.Sw[t].join(",")+"]"},Uw:function(t){this.Sw.push(t?1:0)},Fw:function(t){this.Sw.push(t)},Gw:function(t){this.Sw.push(t)},VE:function(t){this.Sw.push(t)},xw:function(t){this.Sw.push(t)},Bw:function(t){this.Sw.push(t)},xE:function(t){if(null===t)this.Sw.push(null);else{for(var i="",n=0;n<t.length;n++){var r=t.charAt(n);i+='"'===r?'\\"':"\\"===r?"\\\\":"\b"===r?"\\b":"\f"===r?"\\f":"\n"===r?"\\n":"\r"===r?"\\r":"\t"===r?"\\t":r}this.Sw.push('"'+i+'"')}},Vw:function(t){this.xE(t)},wa:function(){this.qw=[],this.WE=[],"undefined"!=typeof JSON&&"function"==typeof JSON.parse?this.Qw=JSON.parse(this.la.aw()):"undefined"!=typeof jQuery?this.Qw=jQuery.Yw(this.la.aw()):this.Qw=eval(this.la.aw());var r={},version=this.Qw.shift();if(version!=Thrift.Ow.EE)throw"Wrong thrift protocol version: "+version;return r.fname=this.Qw.shift(),r.Kw=this.Qw.shift(),r.Ww=this.Qw.shift(),this.qw.push(this.Qw.shift()),r},pa:function(){},$w:function(t){var i={fname:""};return this.qw[this.qw.length-1]instanceof Array&&this.qw.push(this.qw[this.qw.length-1].shift()),i},UE:function(){this.qw[this.qw.length-2]instanceof Array&&this.qw.pop()},ME:function(){var t={},i=-1,n=Thrift.Type.STOP;for(var r in this.qw[this.qw.length-1])if(null!==r){i=parseInt(r,10),this.WE.push(this.qw.length);var s=this.qw[this.qw.length-1][i];delete this.qw[this.qw.length-1][i],this.qw.push(s);break}if(-1!=i)for(var e in this.qw[this.qw.length-1])null!==Thrift.Ow._w[e]&&(n=Thrift.Ow._w[e],this.qw[this.qw.length-1]=this.qw[this.qw.length-1][e]);return t.fname="",t.ftype=n,t.fid=i,t},HE:function(){for(var t=this.WE.pop();this.qw.length>t;)this.qw.pop()},Xw:function(){var t=this.qw.pop(),i=t.shift();i instanceof Array&&(this.qw.push(t),i=(t=i).shift());var n={};return n.Jw=Thrift.Ow._w[i],n.zw=Thrift.Ow._w[t.shift()],n.size=t.shift(),this.WE.push(this.qw.length),this.qw.push(t.shift()),n},Zw:function(){this.HE()},tp:function(){var t=this.qw[this.qw.length-1],i={};return i.np=Thrift.Ow._w[t.shift()],i.size=t.shift(),this.WE.push(this.qw.length),this.qw.push(t.shift()),i},rp:function(){this.HE()},sp:function(t,i){return this.tp(t,i)},ep:function(){return this.rp()},hp:function(){var t=this.LE();return null!==t&&"1"==t.value?t.value=!0:t.value=!1,t},op:function(){return this.LE()},up:function(){return this.LE()},LE:function(t){void 0===t&&(t=this.qw[this.qw.length-1]);var i={};if(t instanceof Array)0===t.length?i.value=void 0:i.value=t.shift();else if(t instanceof Object){for(var n in t)if(null!==n){this.qw.push(t[n]),delete t[n],i.value=n;break}}else i.value=t,this.qw.pop();return i},ap:function(){return this.LE()},fp:function(){return this.LE()},jE:function(){return this.LE()},cp:function(){return this.jE()},PE:function(t){var i,n;switch(t){case Thrift.Type.STOP:return null;case Thrift.Type.BOOL:return this.hp();case Thrift.Type.BYTE:return this.op();case Thrift.Type.I16:return this.up();case Thrift.Type.I32:return this.LE();case Thrift.Type.I64:return this.ap();case Thrift.Type.DOUBLE:return this.fp();case Thrift.Type.STRING:return this.jE();case Thrift.Type.STRUCT:for(this.$w();(i=this.ME()).ftype!=Thrift.Type.STOP;)this.PE(i.ftype),this.HE();return this.UE(),null;case Thrift.Type.MAP:for(i=this.Xw(),n=0;n<i.size;n++)0<n&&this.qw.length>this.WE[this.WE.length-1]+1&&this.qw.pop(),this.PE(i.Jw),this.PE(i.zw);return this.Zw(),null;case Thrift.Type.SET:for(i=this.sp(),n=0;n<i.size;n++)this.PE(i.np);return this.ep(),null;case Thrift.Type.LIST:for(i=this.tp(),n=0;n<i.size;n++)this.PE(i.np);return this.rp(),null}}},Thrift.lp=function(t,i,n,r){Thrift.Ow.call(this,i,n,r),this.vp=t},Thrift.pE(Thrift.lp,Thrift.Ow,"multiplexProtocol"),Thrift.lp.prototype.ua=function(t,i,n){i===Thrift.aa.CALL||i===Thrift.aa.ONEWAY?Thrift.Ow.prototype.ua.call(this,this.vp+":"+t,i,n):Thrift.Ow.prototype.ua.call(this,t,i,n)},Thrift.dp=function(){this.Ep=0},Thrift.dp.prototype.wp=function(t,i,n){i.pl&&(i=i.pl);var r=this;return i.prototype.pp=function(){return r.Ep+=1,r.Ep},new i(new Thrift.lp(t,n))},copyList=function(t,i){if(!t)return t;var n,r,s,e=n=void 0===i.shift?i:i[0],h=t.length,o=[];for(r=0;r<h;r++)s=t[r],null===n?o.push(s):n===copyMap||n===copyList?o.push(n(s,i.slice(1))):o.push(new e(s));return o},copyMap=function(t,i){if(!t)return t;var n,r,s=n=void 0===i.shift?i:i[0],e={};for(var h in t)t.hasOwnProperty(h)&&(r=t[h],e[h]=null===n?r:n===copyMap||n===copyList?n(r,i.slice(1)):new s(r));return e},Thrift.gp=copyMap,Thrift.bp=copyList,module.exports=Thrift},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,e=n(0),s=n(6);(r=i.yp||(i.yp={}))[r.Tp=0]="UPPER_LAYER",r[r.mp=1]="CDN",r[r.Op=2]="CDN_PREFETCH",r[r.Sp=3]="CDN_COMPENSATION",r[r.Rp=4]="P2P",r[r._p=5]="P2P_PREFETCH";var h=function(){this.Ip=!1,this.Ap=!1,this.Np=0,this.kp=0,this.Cp=0,this.Dp=0,this.Mp=0,this.p2pAgenTrafficSuccessQt=0,this.jp=0,this.srcOtherRespQt=0,this.Pp=0,this.Lp=0,this.Hp=0,this.Up=0,this.Fp=0};i.Gp=h;var o=(u.prototype.xp=function(){return this.type},u.prototype.Bp=function(){return this.Vp.Bp()},u.prototype.qp=function(){return this.Vp.qp()},u.prototype.Qp=function(){return this.qp()+"-"+this.Yp},u.prototype.Kp=function(){return this.Vp.Wp()},u.prototype.$p=function(){return this.Vp.Xp()},u.prototype.loaded=function(){this.Jp=e.Framework.time()},u.prototype.zp=function(){return this.Jp?Math.max(1,this.Jp-this.Zp.Hp):Math.max(1,this.Zp.Up-this.Zp.Hp)},u.prototype.tg=function(){return this.Jp?Math.max(1,this.Jp-this.Zp.Lp):Math.max(1,this.Zp.Up-this.Zp.Lp)},u.prototype.ig=function(){return 0!=this.Zp.Mp?new s.Ma().Oa(this.zp(),this.Zp.Mp):new s.Ma().Oa(this.tg(),this.Zp.kp)},u);function u(t,i,n,r,s){this.ng=!1,this.type=void 0,this.Zp=new h(),this.rg=!1,this.sg=!1,this.eg="",this.hg=new ArrayBuffer(0),this.og=0,this.type=n,this.ug=t,this.Yp=i,this.ag=s,this.Vp=r,this.Zp.Pp=e.Framework.time()}i.fg=o},function(t,i,u){"use strict";Object.defineProperty(i,"s",{value:!0});var h=u(52),v=u(4),o=u(3),n=u(112);i.cg=n.cg;var a=u(0),f=u(19);i.Options=f.Options,i.UrlConfigurableOptions=f.UrlConfigurableOptions;var c=u(114);i.TechName=c.TechName;var d=u(21);i.HiveSession=d.HiveSession,i.HivePluginReference=d.HivePluginReference,i.HiveSessionError=d.HiveSessionError,i.HiveSessionErrorCode=d.HiveSessionErrorCode,i.MainStatusCode=d.MainStatusCode;var l=u(42),r=u(28);i.HiveRequestFactory=r.HiveRequestFactory;var s=u(116),E=u(72),w=u(117),e=u(118),p=u(119);i.HivePlayerExtendedStats=p.HivePlayerExtendedStats;var g=u(29);i.HiveSessionInternal=g.HiveSessionInternal;var b=u(13);i.BasicUtils=b;var y=u(13),T=u(120),m=u(22);i.PlayerEvents=m.PlayerEvents;var O=u(124),S=u(126),R=u(84);i.StatsJS=R.StatsJS;var _=u(45),I=u(1),A=u(2),N=u(46);i.Ticket=N.Ticket;var k=u(27),C=u(15),D=u(87),M=u(7);i.W=M.W;var j=u(152),P=u(6),L=M.W["if"],H=M.W.za,U=M.W.Ja,F=M.W.Za;(U||F)&&u(14).HiveConfig;var G=(x.prototype.options=function(){return this.options_},x.prototype.logger=function(){return this.lg?this.g.log(this.lg.id):this.g.log()},x.prototype.loggerLevel=function(t){if("string"==typeof t&&this.g.vg(t),this.logger)return this.g.level},x.prototype.getPluginId=function(){return this.pluginId},x.prototype.getPluginId4Java=function(){return this.dg},x.prototype.Eg=function(){return L},x.prototype.updateCommsForInitSessions=function(){for(var t=0,i=this.initializedSessions;t<i.length;t++){var n=i[t];n.tech.wg(this),"HiveJS"===n.tech.getName()&&n.tech.pg&&n.tech.pg.wg(this)}},x.prototype.gg=function(t){var i=new R.StatsJS(this,t);if(this.bg.set(R.StatsJS.yg,i),U){var n=u(153).HiveJS;this.bg.set(n.yg,new n(this,t,i))}if(F){var r=u(215).HiveJsProxy;this.bg.set(r.yg,new r(this,t,i))}if(H){var s=u(218).HiveJava;this.bg.set(s.yg,new s(this,t))}var e=t.hiveTechOrder;if(!e||e instanceof Array)if(e&&0<e.length)for(var h=e.length;h--;){var o=e[h];"string"!=typeof o||-1==this.Tg.indexOf(o)?(!1,e.splice(h,1)):"string"==typeof o&&this.bg.has(o)||!1}else e=this.Tg;else!1,e=this.Tg;t.hiveTechOrder=e},x.prototype.mg=function(){this.videoRepresentationsMap=new o({"qd-v":125e3,"ld-v":25e4,"md-v":5e5,"hd-v":12e5,"hd1-v":2e6,"a1-v":55e4,"b1-v":8e5,"c1-v":1e6,"d1-v":17e5,Og:11e5}),this.audioRepresentationsMap=new o({"qd-a":64e3,"ld-a":128e3,"md-a":256e3,"b1-a":68e3,Sg:124e3})},x.prototype.Rg=function(){return this.videoRepresentationsMap.concat(this.audioRepresentationsMap)},x.prototype.resolveTicketPromise=function(r){var s=this;this.logger().notice(this.loggerId+"resolving "+r);var i=v.defer();if(!r)return i.reject(d.HiveSessionError.getHiveSessionError("",d.HiveSessionErrorCode.TICKET_ERROR,"No ticket provided.")),i.promise;this._g(r);var t=this.Ig().values();0==t.length&&(I.ErrorMonitor.Z().logError("Error initializing all Techs",this.loggerId,A.he.ae),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)));var e,h,o=!1,u=!1,a=0,f=null;return y.gc(function(){return!o&&!u&&a<t.length&&!e},function(){var n=t[a++];return n.Ag(),(n.Ng()&&!h?s.kg(r,s.options().testId):v.resolve(null)).then(function(t){null!=t&&(h=t);var i=n.Cg();return n.initSession(r,h).timeout(i,"["+n.getName()+"] Error: initialization timed out after "+i+"ms").then(function(t){f=t,s.Dg(f,n),o=!0,!n.Ng()&&h&&h.hl.reset(),I.ErrorMonitor.Z().ot({sessionId:f.id}),t.Mg(g.Pg.jg),s.logger().notice(s.loggerId+"initializing Session:["+f.id+"] Ticket:"+f.ticket.toString()+" HiveTech:["+f.tech.getName()+"]"),v.resolve(!0)},function(t){t instanceof Error&&(t=new d.HiveTechError(d.Qv.Xv,t.message),n.Lg(t)),t.ticketUrl=r,u=!n.onError(t),s.logger().debug(s.loggerId+"tech "+n.getName()+": "+t.message),v.resolve(!0)})},function(t){e=t,v.resolve(!0)})}).then(function(){e?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TICKET_ERROR,e)):u?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TECH_ERROR)):o?i.resolve(f):(I.ErrorMonitor.Z().logError("Error initializing all Techs",s.loggerId,A.he.ae),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)))})["catch"](function(t){I.ErrorMonitor.Z().logError("Error resolving ticket promise",s.loggerId,A.he.ue,t),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.GENERIC_ERROR,t.toString()))}).done(),i.promise},x.prototype.authenticate=function(f){var c=this,t=M.W.ef?C.qc.Cc:C.qc.Dc;if(!this.Hg(f))return v.reject({code:"Init Error",reason:JSON.stringify({code:"C_INVALID_DATA",description:"There are missing data in among the videoId, JWT or manifest lists"})});var l=new Date().getTime();return y.Tc(t,JSON.stringify(f)).then(function(t){var i=Date.now();c.logger().warn("[Timing] Authentication request to service",i-l);var u=JSON.parse(t);c.logger().debug("Response: ",u),c.options().hiveTechOrder=u.techs;var n=v.defer(),r=c.Ig().values(),a=!1,s=0,e=[];return y.gc(function(){return 0<e.length?(n.resolve(e),!1):!a&&s<r.length||(I.ErrorMonitor.Z().logError("Error initializing all Techs",c.loggerId,A.he.ae),n.reject({code:"Init Error",reason:JSON.stringify({code:"C_"+d.HiveSessionErrorCode[d.HiveSessionErrorCode.NO_TECH_AVAILABLE],description:"No Tech successfully initialized"})}),!1)},function(){var o=r[s++];if(o.Ag(),"HiveJsProxy"!==o.getName())return v.allSettled(u.validated.map(function(t){var h=t.videoId;if(0===f.filter(function(t){return t.videoId===h}).length)return I.ErrorMonitor.Z().logError("No Token found for the specific videoId",c.loggerId,A.he.fe,{videoId:h}),v.reject(!1);var i=t.manifests;return c.logger().debug("Manifests: ",i),v.allSettled(i.map(function(r){var t,i=o.Cg(),s=Date.now();if(o.Ng()){var n=new N.Ticket();n.Ug(u.partnerId,u.customerId,u.validated[0].videoId),n.Fg=r.uri,n.oE=l,n.uE=new Date().getTime(),t=_["default"].Z().initSession(c.pluginId,n,!1,"",u.connectionEndpoint)}else t=v.resolve(null);var e=Date.now();return t.then(function(n){var t=Date.now();return c.logger().warn("[Timing] Init RI for "+o.getName(),t-s),n&&c.updatePlayerInfo(n),o.initSession(u.ticketEndpoint+"/"+r.jwt,n).timeout(i).then(function(t){c.Dg(t,o),a=!0,"HiveJava"===o.getName()&&t.ticket.Ug(u.partnerId,u.customerId,h),!o.Ng()&&n&&n.hl.reset(),I.ErrorMonitor.Z().ot({sessionId:t.id}),c.logger().notice(c.loggerId+"initializing Session:["+t.id+"] Ticket:"+t.ticket.toString()+" HiveTech:["+t.tech.getName()+"]"),t.ticket.originalManifest=r.uri;var i=Date.now();return c.logger().warn("[Timing] Init Tech Successful for "+o.getName(),i-e),t})}).fail(function(t){return t=c.Gg(t,o,e),v.reject(t)})})).then(function(t){return c.xg(t,!1)})})).then(function(t){var i=c.xg(t,[],!1);i instanceof Array&&(e=i)});var n=Date.now();return o.Bg(c.pluginId,u).then(function(t){c.Dg(t,o),a=!0,e.push(t),I.ErrorMonitor.Z().ot({sessionId:t.id}),c.logger().notice(c.loggerId+"initializing Session:["+t.id+"] Ticket:"+t.ticket.toString()+" HiveTech:["+t.tech.getName()+"]");var i=Date.now();return c.logger().warn("[Timing] Init Tech Successful for "+o.getName(),i-n),t},function(t){return c.Gg(t,o,n)})}).done(),n.promise}).fail(function(t){return c.logger().debug("Authentication Failed",t),v.reject(t)})},x.prototype.Gg=function(t,i,n){this.logger().debug(this.loggerId+" init Session failed:",t.message),t instanceof Error&&(t=new d.HiveTechError(d.Qv.Xv,t.message),i.Lg(t)),this.logger().debug(this.loggerId+"tech "+i.getName()+": "+t.message);var r=Date.now();return this.logger().warn("[Timing] Init Tech Failed for "+i.getName(),r-n),t},x.prototype.Hg=function(t){return 0!==t.length&&t.every(function(t,i,n){return t.jwt&&t.videoId&&0<t.manifests.length})},x.prototype.xg=function(t,i,n){void 0===n&&(n=!0);for(var r=[],s=0,e=t;s<e.length;s++){var h=e[s];"fulfilled"===h.state&&(n?r.push(h.value):r=r.concat(h.value))}return 0<r.length?r:v.reject(i)},x.prototype.kg=function(i,t){var n=this;return _["default"].Z().initSession(this.pluginId,i,!1,t).then(function(t){return n.logger().debug(n.loggerId+"verified ticket "+i),n.updatePlayerInfo(t),t})["catch"](function(t){return v.reject("Ticket not verified, error: "+t.message)})},x.prototype.Ig=function(){var t=JSON.parse(JSON.stringify(this.options().hiveTechOrder)),i=new o();for(var n in t)this.bg.has(t[n])&&i.set(t[n],this.bg.get(t[n]));return i},x.prototype._g=function(t){var i=I.ErrorMonitor.Z();try{var n=new N.Ticket();n.Vg(t),n.Pd()&&n.Ld()&&n.qg()?i.setTags([n.Pd(),n.Ld(),n.qg()]):i.logError("Ticket not valid, we could not resolve the triple partnerId/CustomerId/ContentId",this.loggerId,A.he.ce,{partnerId:n.Pd(),customerId:n.Ld(),contentId:n.qg()})}catch(t){this.logger().warn(this.loggerId+" "+t.message,t),i.notify(t)}},x.prototype.updatePlayerInfo=function(t){var i={commVersion:L,pluginName:this.getPluginName(),pluginVersion:this.getPluginVersion(),playerTech:this.getPlayerTech(),playerVersion:this.getPlayerVersion(),telemetryId:this.getTelemetryId()};t.hl.updatePlayerInfo(i)},x.prototype.addTechEvent=function(t){this.lg&&this.lg.tech?(t.sessionId=this.lg.id,this.lg.tech.Cd(this.lg,t)):this.Qg.push(t)},x.prototype.flushTechEvents=function(){var t=this.Qg;return this.Qg=new Array(),t},x.prototype.Yg=function(){this.destroyHivePlugin(!1)},x.prototype.Kg=function(){var t=window;this.Yg=this.Yg.bind(this),t.addEventListener?t.addEventListener("beforeunload",this.Yg,!1):t.attachEvent("onbeforeunload",this.Yg)},x.prototype.Wg=function(){var t=window;t.removeEventListener?t.removeEventListener("beforeunload",this.Yg,!1):t.detachEvent("onbeforeunload",this.Yg)},x.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0),this.logger().debug("Manually Closing Session"+(t?" because: "+t:"")),this.Xg.$g(),this.Jg=null,r.HiveRequestFactory.clearPluginState(this.pluginId),this.resetSession(!0,i)},x.prototype.destroyHivePlugin=function(t){return void 0===t&&(t=!0),this.Wg(),this.Xg.$g(!0),this.closeHiveSession("Invoked Plugin Destroy",t),e.Zg.Z(this.logger()).zg(),a.Framework.H(),this.options_.onLoadingCompleted=null,this.options_.onSourceSetCompleted=null,this.options_.onActiveSession=null,this.options_.onError=null,I.ErrorMonitor.Z().ct(),a.Framework.I},x.prototype.resetSession=function(t,i){var n=this;void 0===i&&(i=!0),this.tb(t,i),!1===t?this.lg&&this.initializedSessions.every(function(t){return t.id!==n.lg.id})&&this.initializedSessions.unshift(this.lg):this.initializedSessions.length=0,this.ib(),this.lg=null,this.nb=0,this.rb=0},x.prototype.Dg=function(t,i){t.tech=i,this.initializedSessions.push(t)},x.prototype.onActivateSession=function(t,i){var n=this;if(void 0===i&&(i=!1),null==this.lg){for(var r=t||this.getPlayerSource(),s=0;s<this.initializedSessions.length;s++){var e=this.initializedSessions[s];if(e.isActive(r,i)){if(this.lg=e,this.lg.sb?this.lg.sb.Jc.eb(this.lg.ticket):this.hb(),this.lg.tech.onActiveSession(this.lg),this.lg.Mg(g.Pg.ACTIVE),this.logger().notice(this.loggerId+"activating Session:["+this.lg.id+"] Ticket:"+this.lg.ticket.toString()+" HiveTech:["+this.lg.tech.getName()+"]"),this.options().onActiveSession)try{this.options().onActiveSession(e.toHiveSession())}catch(t){I.ErrorMonitor.Z().logError(this.loggerId+" exception in user-defined Generic onActiveSession callback: "+t,this.loggerId,A.he.le)}break}}if(this.lg)return this.initializedSessions.forEach(function(t){t!=n.lg&&t.ob().then(function(t){return t.cl()})}),!(this.initializedSessions.length=0);I.ErrorMonitor.Z().logError("No matching session found",this.loggerId,A.he.oe,{playerSource:r,initializedSessions:this.initializedSessions.map(function(t){return t.manifest})}),this.resetSession()}return!1},x.prototype.getActiveSession=function(){if(this.lg)return this.lg.toHiveSession()},x.prototype.hb=function(){var i=!1;this.initializedSessions.forEach(function(t){t.sb&&(i=!0)}),i&&_["default"].Z().close()},x.prototype.isSessionActive=function(){if(null!=this.lg){if(this.lg.isActive(this.getPlayerSource()))return!0;var t="Session src mismatch: "+this.getPlayerSource()+" != "+this.lg.manifest;this.logger().warn(this.loggerId+t),this.closeHiveSession(t)}return!1},x.prototype.tb=function(i,n){var r=this;void 0===n&&(n=!0),null!=this.lg?(this.logger().notice(this.loggerId+"Stopping session ["+this.lg.id+"]"),this.lg.close(i,n)):0<this.initializedSessions.length&&this.initializedSessions.forEach(function(t){r.logger().notice(r.loggerId+"Attempt to stopping session ["+t.id+"]"),t.close(i,n)})},x.prototype.ub=function(){var t=this;null==this.ab&&(this.ab=setInterval(function(){t.fb(!0)},this.options().feedbackPeriod),this.fb())},x.prototype.ib=function(){clearInterval(this.ab),this.ab=null},x.prototype.cb=function(t){return void 0===t&&(t=!1),this.lb.Ju(void 0,t?this.options().feedbackPeriod:void 0)},x.prototype.fb=function(t){var i=this;if(void 0===t&&(t=!1),this.isSessionActive()){if(!this.isActive())return void this.resetSession();var n=this.getWindowSize(),r=new s.vb(this.getCurrentTime(),this.getBufferLen(),this.nb,n.width,n.height,this.isFullscreen(),this.cb(t));this.lg.Eb(this.wb.check(r)),this.lg.tech.pb(this.lg,r).fail(function(t){i.logger().warn(i.loggerId+"stats handling failed",t),i.ib()})}},x.prototype.registerGenericEvents=function(){var n=this;try{e.Zg.Z(this.logger()).gb(function(t){var i=n.getPotentialSession();i&&!i.bb()&&(n.onEventFeedback(t?m.PlayerEvents.VISIBLE:m.PlayerEvents.HIDDEN),n.logger().debug(t?"visible":"hidden"))})}catch(t){I.ErrorMonitor.Z().logError("error setting up the visibilityChange listener",this.loggerId,A.he.ve,{error:t})}},x.prototype.onStartBuffering=function(t,i){void 0===i&&(i=!1),(i||this.isSessionActive())&&this.rb<=0&&(this.rb=Date.now(),null!=t&&!t||this.onEventFeedback(m.PlayerEvents.BUFFERING))},x.prototype.onEndBuffering=function(){var t=0==this.nb;if(0<this.rb){var i=Date.now()-this.rb;return this.nb+=i,this.logger().debug(this.loggerId+"reporting new buffering event of "+i),this.rb=0,t&&this.fb(),!0}return!1},x.prototype.onError=function(t,i,n){void 0===n&&(n=!0),this.onEventFeedback(m.PlayerEvents.ERROR,{code:-1,"player-code":t}),n&&this.closeHiveSession(i)},x.prototype.onEventFeedback=function(t,i){var n=this,r=this.getPotentialSession();if(null!=r&&(r==this.lg||r.tech.getName()!==c.yb[c.yb.HiveJava])){switch(t){case m.PlayerEvents.PLAYING:this.lb.start();break;case m.PlayerEvents.PAUSED:case m.PlayerEvents.SKIP:case m.PlayerEvents.BUFFERING:case m.PlayerEvents.STOPPED:this.lb.stop()}r.tech.Tb(r,t,i).fail(function(t){n.logger().warn(n.loggerId+"error in forwarding player event to tech",t)})}},x.prototype.mb=function(t,i){t!==this.Jg&&this.onEventFeedback(t,i),this.Jg=t},x.prototype.getPotentialSession=function(){return this.lg?this.lg:this.initializedSessions&&0<this.initializedSessions.length?this.initializedSessions[0]:void 0},x.prototype.initStatusCode=function(){this.Ob=0},x.prototype.setStatusCode=function(t,i){this.initStatusCode(),this.Ob+=t<<28,i&&0===t&&(this.Ob+=1<<4*(6-c.yb[i.getName()])),0<t&&I.ErrorMonitor.Z().logError("Status Code Error",this.loggerId,A.he.de,{code:d.nd(t)},["Plugin Error Code",d.nd(t)])},x.prototype.getStatusCode=function(){return this.Ob},x.prototype.getTelemetryId=function(){return this.options().telemetryId},x.logError=function(t,i,n,r){var s=I.ErrorMonitor.Z();s.logError.apply(s,arguments)},x.prototype.registerPlugin=function(t){D.Sb.registerPlugin(this,t)},x.prototype.getPluginVersion=function(){return M.W.sf},x);function x(t){this.Tg=[c.yb[c.yb.HiveJava],c.yb[c.yb.HiveJsProxy],c.yb[c.yb.HiveJS],c.yb[c.yb.StatsJS]],this.bg=new o(),this.Qg=new Array(),this.initializedSessions=new Array(),this.lg=null,this.nb=0,this.rb=0,this.loggerId="[HiveComm] ",this.Ob=0,this.lb=new P.Zu(),this.videoRepresentationsMap=new o(),this.audioRepresentationsMap=new o(),this.Xg=new j["default"](this),this.pluginId=h.Rb(),a.Framework._("peer0",new O._b(),new S.Ib()),this.dg=E.Ab.getItem("hivePluginId"),this.dg||(this.dg=Math.abs(Math.floor(68719476736*Math.random())).toString(16),E.Ab.setItem("hivePluginId",this.dg));var i=I.ErrorMonitor.Z(M.W.sf);this.options_=new f.Options(),this.gg(t),this.mg(),y.updateOptions(t,this.options_),y.parseParameterOptions(window.location.href,new f.UrlConfigurableOptions(),this.options_),f.Lv.Pv(this.options_),this.g=a.Framework.resolve(a.Framework.p.T),l.HiveConfig.Framework.LoggerTimestamp=this.options().loggerTimestamp,this.options().isSDNDebug&&(this.options().debugLevel="debug"),this.g.vg(this.options().debugLevel),i.ht(this.g.log()),this.options().onError&&i.at(this.options().onError);var n=a.Framework.resolve(a.Framework.p.il),r=a.Framework.resolve(a.Framework.p.Jd);n.bl().then(function(t){i.setUser(t.Ol()),i.ot({reportingGuid:t.Sl()}),i.ot({p2pId:t.Ol()})});var s={};new T.Nb(this),r.getConnectivityInfo().then(function(t){s={pIPAddr:t.getNetworkChanged().getPrivateIp()},i.ot({privateIp:s.pIPAddr})}),window.Kc=this.g.log(),this.Kg(),this.pluginReference=new d.HivePluginReference(this);var e=this.options().idleTimePeriod>this.options().feedbackPeriod?this.options().idleTimePeriod:k.qc.yu;this.wb=new w.kb(e),this.registerGenericEvents()}i.Plugin=G,"undefined"!=typeof window&&(window.HiveRequestFactory=r.HiveRequestFactory),i.Cb=A.he,i.logError=function(t,i,n,r){var s=I.ErrorMonitor.Z();s.logError.apply(s,arguments)}},function(t,i,n){t.exports=function s(e,h,o){function u(n,t){if(!h[n]){if(!e[n]){if(a)return a(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=h[n]={exports:{}};e[n][0].call(r.exports,function(t){var i=e[n][1][t];return u(i||t)},r,r.exports,s,e,h,o)}return h[n].exports}for(var a=!1,t=0;t<o.length;t++)u(o[t]);return u}({1:[function(t,i,n){var r=t("./kernel");n.B=r.B;var s=t("./type_binding");n.Db=s.Db;var e=t("./type_binding_scope");n.Mb=e.Mb},{"./kernel":2,"./type_binding":4,"./type_binding_scope":5}],2:[function(t,i,n){var r=t("./type_binding_scope"),s=t("./lookup"),e=function(){function t(){this.jb=new s.Pb()}return t.prototype.bind=function(t){this.jb.add(t.Lb,t)},t.prototype.Hb=function(i){try{this.jb.remove(i)}catch(t){throw new Error("Could not resolve service "+i)}},t.prototype.G=function(){this.jb=new s.Pb()},t.prototype.resolve=function(t){if(!this.jb.Ub(t))return null;var i=this.jb.get(t)[0];if(i.scope===r.Mb.Fb&&null!==i.rw)return i.rw;var n=this.Gb(i.xb);return i.rw=n},t.prototype.Bb=function(t){var i,n,r,s,e,h;return e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,h=/([^\s,]+)/g,i=t.toString().replace(e,""),n=i.indexOf("(")+1,r=i.indexOf(")"),null===(s="function"==typeof Map&&-1!==i.indexOf("class")&&-1===i.indexOf("constructor")?null:i.slice(n,r).match(h))&&(s=[]),s},t.prototype.Gb=function(t){var i=this.Bb(t);if(0===i.length)return new t();for(var n=[],r=null,s=0;s<i.length;s++){var e=i[s];r=this.resolve(e),n.push(r)}return this.Vb(t,n)},t.prototype.Vb=function(t,i){return new(Function.prototype.bind.apply(t,[null].concat(i)))()},t}();n.B=e},{"./lookup":3,"./type_binding_scope":5}],3:[function(t,i,n){var s=function(t,i){this.key=t,this.value=new Array(),this.value.push(i)},r=function(){function t(){this.qb=new Array()}return t.prototype.Qb=function(t){for(var i=-1,n=0;n<this.qb.length;n++){var r=this.qb[n];r.key===t&&(i=n)}return i},t.prototype.add=function(t,i){if(null==t)throw new Error("Argument Null");if(null==i)throw new Error("Argument Null");var n=this.Qb(t);if(-1!==n){var r=this.qb[n];r.key===t&&r.value.push(i)}else this.qb.push(new s(t,i))},t.prototype.get=function(t){if(null==t)throw new Error("Argument Null");var i=this.Qb(t);if(-1===i)throw new Error("Key Not Found");var n=this.qb[i];return n.key===t?n.value:void 0},t.prototype.remove=function(t){if(null==t)throw new Error("Argument Null");var i=this.Qb(t);if(-1===i)throw new Error("Key Not Found");this.qb.splice(i,1)},t.prototype.Ub=function(t){if(null==t)throw new Error("Argument Null");var i=this.Qb(t);return-1!==i},t}();n.Pb=r},{}],4:[function(t,i,n){var r=t("./type_binding_scope"),s=function(t,i,n){if(this.Lb=t,this.xb=i,this.rw=null,void 0===n)this.scope=r.Mb.Yb;else{if(!r.Mb[n])throw new Error("Invalid scope type "+n);this.scope=n}};n.Db=s},{"./type_binding_scope":5}],5:[function(t,i,n){var r;!function(t){t[t.Yb=0]="Transient",t[t.Fb=1]="Singleton"}(r=r||{}),n.Mb=r},{}]},{},[1])(1)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s._v="undefined"!=typeof location&&"https:"===location.protocol,s.Dv=!0,s.Kb=1e4,s.yu=6e4,s.Wb="X-Hive-TestId",s);function s(){}i.qc=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),s=(e.prototype.$b=function(){if(!this.pluginId){if(0===Object.keys(e.Xb).length)return e.logError("No registered default HiveRequestFactory tech",e.loggerId),new XMLHttpRequest();this.pluginId=Object.keys(e.Xb)[0]}var t=e.Xb[this.pluginId];if(!t)return e.logError("no registered HiveRequestFactory tech for plugin",{pluginId:this.pluginId}),new XMLHttpRequest();var i=t.Jb;return t.Od?i.zb(this.pluginId):(t.Od=!0,i.Zb(this.pluginId))},e.register=function(t){var i=t.getName(),n=t.getPluginId();this.Xb[n]||(this.Xb[n]={tech:i,Jb:t,Od:!1})},e.clear=function(){this.Xb={}},e.clearPlugin=function(t){this.Xb[t]&&delete this.Xb[t]},e.clearPluginState=function(t){this.Xb[t]&&(this.Xb[t].Od=!1)},e.logError=function(t,i){this.ty||(this.ty=!0,r.ErrorMonitor.Z().logError(t,i))},e.loggerId="[HiveRequestFactory]",e.Xb={},e.ty=!1,e);function e(t){this.pluginId=t}i.HiveRequestFactory=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(4),h=n(1),o=n(21),u=n(2);(s=r=i.Pg||(i.Pg={})).jg="INITIALIZED",s.ACTIVE="ACTIVE",s.IDLE="IDLE",s.CLOSED="CLOSED";var a=(f.prototype.isActive=function(t,i){return void 0===i&&(i=!1),null!==this.tech&&this.tech.isActive(t,this,i)},f.prototype.Eb=function(t){if(this.iy!=t){this.iy=t,this.tech&&this.tech.ol(this,t);var i=this.iy?r.IDLE:r.ACTIVE;this.Mg(i)}},f.prototype.getTechName=function(){return this.tech&&this.tech.getName()||void 0},f.prototype.bb=function(){return this.iy},f.prototype.close=function(t,i){void 0===i&&(i=!0),this.iy=!0,null!=this.tech&&this.tech.ny(this,t,i),this.Mg(r.CLOSED)},f.prototype.toString=function(){return this.ticket.toString()},f.prototype.toHiveSession=function(){var t=new o.HiveSession();return t.id=this.id,t.ticketUrl=this.ticketUrl,t.manifest=this.manifest,t.tech=this.tech.getName(),t},f.prototype.ob=function(){return this.sy.promise},f.prototype.ey=function(t){this.sb=t,this.sy.resolve(this.sb)},f.prototype.Mg=function(t){if(this.hy)try{this.hy({id:this.id,state:t})}catch(t){h.ErrorMonitor.Z().logError(this.loggerId+" exception in user-defined Generic onSessionStateChange callback: "+t,this.loggerId,u.he.Ee)}},f);function f(t,i,n,r,s){this.loggerId="[HiveSessionInternal]",this.iy=!1,this.ticketUrl=t,this.ticket=i,this.manifest=n,"function"==typeof s&&(this.hy=s),this.sy=e.defer(),this.sb=r,this.sb&&this.sy.resolve(this.sb)}i.HiveSessionInternal=a},function(n,r,s){var e,h,o;!function(t,i){"use strict";n.exports?n.exports=i(s(20),s(20),s(20)):(h=[s(20),s(20),s(20)],void 0===(o="function"==typeof (e=i)?e.apply(r,h):e)||(n.exports=o))}(0,function(o,i,a,n){"use strict";var r=n&&n.oy;function p(t,i){var n=1<=arguments.length;if(!(this instanceof p))return n?2<=arguments.length?new p(t,i):new p(t):new p();if(void 0===t){if(n)throw new TypeError("undefined is not a valid argument for URI");t="undefined"!=typeof location?location.href+"":""}if(null===t&&n)throw new TypeError("null is not a valid argument for URI");return this.href(t),void 0!==i?this.Qa(i):this}p.version="1.19.1";var t=p.prototype,f=Object.prototype.hasOwnProperty;function u(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function h(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function c(t){return"Array"===h(t)}function l(t,i){var n,r,s={};if("RegExp"===h(i))s=null;else if(c(i))for(n=0,r=i.length;n<r;n++)s[i[n]]=!0;else s[i]=!0;for(n=0,r=t.length;n<r;n++)(s&&void 0!==s[t[n]]||!s&&i.test(t[n]))&&(t.splice(n,1),r--,n--);return t}function v(t,i){var n,r;if(c(i)){for(n=0,r=i.length;n<r;n++)if(!v(t,i[n]))return!1;return!0}var s=h(i);for(n=0,r=t.length;n<r;n++)if("RegExp"===s){if("string"==typeof t[n]&&t[n].match(i))return!0}else if(t[n]===i)return!0;return!1}function d(t,i){if(!c(t)||!c(i))return!1;if(t.length!==i.length)return!1;t.sort(),i.sort();for(var n=0,r=t.length;n<r;n++)if(t[n]!==i[n])return!1;return!0}function E(t){return t.replace(/^\/+|\/+$/g,"")}function s(t){return escape(t)}function e(t){return encodeURIComponent(t).replace(/[!'()*]/g,s).replace(/\*/g,"%2A")}p.uy=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,ay:null,ly:p.ly,vy:p.vy,Ey:p.Ey}},p.ly=!1,p.vy=!1,p.Ey=!0,p.wy=/^[a-z][a-z0-9.+-]*$/i,p.py=/[^a-z0-9\._-]/i,p.gy=/(xn--)/i,p.by=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p.yy=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,p.Ty=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi,p.my={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?]+$/,Oy:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},p.Sy={Ry:"80",_y:"443",Iy:"21",Ay:"70",Ny:"80",ky:"443"},p.Cy=["http","https"],p.Dy=/[^a-zA-Z0-9\.\-:_]/,p.My={a:"href",jy:"cite",link:"href",Py:"href",Ly:"src",form:"action",Hy:"src",Uy:"href",Fy:"src",Gy:"src",source:"src",track:"src",input:"src",xy:"src",video:"src"},p.By=function(t){if(t&&t.nodeName){var i=t.nodeName.toLowerCase();if("input"!==i||"image"===t.type)return p.My[i]}},p.encode=e,p.decode=decodeURIComponent,p.Vy=function(){p.encode=escape,p.decode=unescape},p.unicode=function(){p.encode=e,p.decode=decodeURIComponent},p.qy={pathname:{encode:{Qy:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{Qy:/[\/\?#]/g,map:{Yy:"%2F",Ky:"%3F",Wy:"%23"}}},$y:{encode:{Qy:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":",Xy:"/",Jy:"?",zy:"#",Zy:"[",tT:"]","%40":"@",iT:"!","%24":"$","%26":"&",nT:"'",rT:"(",sT:")",eT:"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},hT:{encode:{Qy:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{iT:"!","%24":"$",nT:"'",rT:"(",sT:")",eT:"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{Qy:/[\/\?#:]/g,map:{Yy:"%2F",Ky:"%3F",Wy:"%23",oT:"%3A"}}}},p.uT=function(t,i){var n=p.encode(t+"");return void 0===i&&(i=p.Ey),i?n.replace(/%20/g,"+"):n},p.aT=function(i,t){i+="",void 0===t&&(t=p.Ey);try{return p.decode(t?i.replace(/\+/g,"%20"):i)}catch(t){return i}};function w(n,r){return function(i){try{return p[r](i+"").replace(p.qy[n][r].Qy,function(t){return p.qy[n][r].map[t]})}catch(t){return i}}}var g,b={encode:"encode",decode:"decode"};for(g in b)p[g+"PathSegment"]=w("pathname",b[g]),p[g+"UrnPathSegment"]=w("urnpath",b[g]);function y(e,h,o){return function(t){var i;i=o?function(t){return p[h](p[o](t))}:p[h];for(var n=(t+"").split(e),r=0,s=n.length;r<s;r++)n[r]=i(n[r]);return n.join(e)}}function T(n){return function(t,i){return void 0===t?this.uy[n]||"":(this.uy[n]=t||null,this.mv(!i),this)}}function m(n,r){return function(t,i){return void 0===t?this.uy[n]||"":(null!==t&&(t+="").charAt(0)===r&&(t=t.substring(1)),this.uy[n]=t,this.mv(!i),this)}}p.fT=y("/","decodePathSegment"),p.cT=y(":","decodeUrnPathSegment"),p.lT=y("/","encodePathSegment","decode"),p.vT=y(":","encodeUrnPathSegment","decode"),p.dT=w("reserved","encode"),p.parse=function(t,i){var n;return i=i||{ly:p.ly},-1<(n=t.indexOf("#"))&&(i.ay=t.substring(n+1)||null,t=t.substring(0,n)),-1<(n=t.indexOf("?"))&&(i.query=t.substring(n+1)||null,t=t.substring(0,n)),"//"===t.substring(0,2)?(i.protocol=null,t=t.substring(2),t=p.ET(t,i)):-1<(n=t.indexOf(":"))&&(i.protocol=t.substring(0,n)||null,i.protocol&&!i.protocol.match(p.wy)?i.protocol=void 0:"//"===t.substring(n+1,n+3)?(t=t.substring(n+3),t=p.ET(t,i)):(t=t.substring(n+1),i.urn=!0)),i.path=t,i},p.wT=function(t,i){var n,r,s=(t=(t=t||"").replace(/\\/g,"/")).indexOf("/");if(-1===s&&(s=t.length),"["===t.charAt(0))n=t.indexOf("]"),i.hostname=t.substring(1,n)||null,i.port=t.substring(n+2,s)||null,"/"===i.port&&(i.port=null);else{var e=t.indexOf(":"),h=t.indexOf("/"),o=t.indexOf(":",e+1);-1!==o&&(-1===h||o<h)?(i.hostname=t.substring(0,s)||null,i.port=null):(r=t.substring(0,s).split(":"),i.hostname=r[0]||null,i.port=r[1]||null)}return i.hostname&&"/"!==t.substring(s).charAt(0)&&(s++,t="/"+t),i.ly&&p.pT(i.hostname,i.protocol),i.port&&p.gT(i.port),t.substring(s)||"/"},p.ET=function(t,i){return t=p.bT(t,i),p.wT(t,i)},p.bT=function(t,i){var n,r=t.indexOf("/"),s=t.lastIndexOf("@",-1<r?r:t.length-1);return-1<s&&(-1===r||s<r)?(n=t.substring(0,s).split(":"),i.username=n[0]?p.decode(n[0]):null,n.shift(),i.password=n[0]?p.decode(n.join(":")):null,t=t.substring(s+1)):(i.username=null,i.password=null),t},p.yT=function(t,i){if(!t)return{};if(!(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,s,e={},h=t.split("&"),o=h.length,u=0;u<o;u++)n=h[u].split("="),r=p.aT(n.shift(),i),s=n.length?p.aT(n.join("="),i):null,f.call(e,r)?("string"!=typeof e[r]&&null!==e[r]||(e[r]=[e[r]]),e[r].push(s)):e[r]=s;return e},p.mv=function(t){var i="";return t.protocol&&(i+=t.protocol+":"),t.urn||!i&&!t.hostname||(i+="//"),i+=p.TT(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&"string"==typeof t.hostname&&(i+="/"),i+=t.path),"string"==typeof t.query&&t.query&&(i+="?"+t.query),"string"==typeof t.ay&&t.ay&&(i+="#"+t.ay),i},p.mT=function(t){var i="";return t.hostname?(p.yy.test(t.hostname)?i+="["+t.hostname+"]":i+=t.hostname,t.port&&(i+=":"+t.port),i):""},p.TT=function(t){return p.OT(t)+p.mT(t)},p.OT=function(t){var i="";return t.username&&(i+=p.encode(t.username)),t.password&&(i+=":"+p.encode(t.password)),i&&(i+="@"),i},p.ST=function(t,i,n){var r,s,e,h,o="";for(s in t)if(f.call(t,s)&&s)if(c(t[s]))for(r={},e=0,h=t[s].length;e<h;e++)void 0!==t[s][e]&&void 0===r[t[s][e]+""]&&(o+="&"+p.RT(s,t[s][e],n),!0!==i&&(r[t[s][e]+""]=!0));else void 0!==t[s]&&(o+="&"+p.RT(s,t[s],n));return o.substring(1)},p.RT=function(t,i,n){return p.uT(t,n)+(null!==i?"="+p.uT(i,n):"")},p._T=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&p._T(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===t[i])return void (t[i]=n);"string"==typeof t[i]&&(t[i]=[t[i]]),c(n)||(n=[n]),t[i]=(t[i]||[]).concat(n)}},p.IT=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&p.IT(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");t[i]=void 0===n?null:n}},p.AT=function(t,i,n){var r,s,e;if(c(i))for(r=0,s=i.length;r<s;r++)t[i[r]]=void 0;else if("RegExp"===h(i))for(e in t)i.test(e)&&(t[e]=void 0);else if("object"==typeof i)for(e in i)f.call(i,e)&&p.AT(t,e,i[e]);else{if("string"!=typeof i)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===h(n)?!c(t[i])&&n.test(t[i])?t[i]=void 0:t[i]=l(t[i],n):t[i]!==String(n)||c(n)&&1!==n.length?c(t[i])&&(t[i]=l(t[i],n)):t[i]=void 0:t[i]=void 0}},p.NT=function(t,i,n,r){switch(h(i)){case"String":break;case"RegExp":for(var s in t)if(f.call(t,s)&&i.test(s)&&(void 0===n||p.NT(t,s,n)))return!0;return!1;case"Object":for(var e in i)if(f.call(i,e)&&!p.NT(t,e,i[e]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(h(n)){case"Undefined":return i in t;case"Boolean":return n===Boolean(c(t[i])?t[i].length:t[i]);case"Function":return!!n(t[i],i,t);case"Array":return!!c(t[i])&&(r?v:d)(t[i],n);case"RegExp":return c(t[i])?!!r&&v(t[i],n):Boolean(t[i]&&t[i].match(n));case"Number":n=String(n);case"String":return c(t[i])?!!r&&v(t[i],n):t[i]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},p.kT=function(){for(var t=[],i=[],n=0,r=0;r<arguments.length;r++){var s=new p(arguments[r]);t.push(s);for(var e=s.CT(),h=0;h<e.length;h++)"string"==typeof e[h]&&i.push(e[h]),e[h]&&n++}if(!i.length||!n)return new p("");var o=new p("").CT(i);return""!==t[0].path()&&"/"!==t[0].path().slice(0,1)||o.path("/"+o.path()),o.normalize()},p.DT=function(t,i){var n,r=Math.min(t.length,i.length);for(n=0;n<r;n++)if(t.charAt(n)!==i.charAt(n)){n--;break}return n<1?t.charAt(0)===i.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"===t.charAt(n)&&"/"===i.charAt(n)||(n=t.substring(0,n).lastIndexOf("/")),t.substring(0,n+1))},p.MT=function(t,i,n){var r=(n=n||{}).start||p.my.start,s=n.end||p.my.end,e=n.trim||p.my.trim,h=n.Oy||p.my.Oy,o=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var u=r.exec(t);if(!u)break;var a=u.index;if(n.jT){var f=t.slice(Math.max(a-3,0),a);if(f&&o.test(f))continue}for(var c=a+t.slice(a).search(s),l=t.slice(a,c),v=-1;;){var d=h.exec(l);if(!d)break;var E=d.index+d[0].length;v=Math.max(v,E)}if(!((l=-1<v?l.slice(0,v)+l.slice(v).replace(e,""):l.replace(e,"")).length<=u[0].length||n.PT&&n.PT.test(l))){var w=i(l,a,c=a+l.length,t);void 0!==w?(w=String(w),t=t.slice(0,a)+w+t.slice(c),r.lastIndex=a+w.length):r.lastIndex=c}}return r.lastIndex=0,t},p.pT=function(t,i){var n=!!t,r=!1;if(!!i&&(r=v(p.Cy,i)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+i);if(t&&t.match(p.Dy)){if(!o)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(o.LT(t).match(p.Dy))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},p.gT=function(t){if(t){var i=Number(t);if(!(function(t){return/^[0-9]+$/.test(t)}(i)&&0<i&&i<65536))throw new TypeError('Port "'+t+'" is not a valid port')}},p.xh=function(t){if(t){var i={oy:this.xh()};return n.HT&&"function"==typeof n.HT.xh&&(i.HT=n.HT.xh()),n.UT&&"function"==typeof n.UT.xh&&(i.UT=n.UT.xh()),n.FT&&"function"==typeof n.FT.xh&&(i.FT=n.FT.xh()),i}return n.oy===this&&(n.oy=r),this},t.mv=function(t){return!0===t?this.GT=!0:void 0!==t&&!this.GT||(this.xT=p.mv(this.uy),this.GT=!1),this},t.clone=function(){return new p(this)},t.valueOf=t.toString=function(){return this.mv(!1).xT},t.protocol=T("protocol"),t.username=T("username"),t.password=T("password"),t.hostname=T("hostname"),t.port=T("port"),t.query=m("query","?"),t.ay=m("fragment","#"),t.search=function(t,i){var n=this.query(t,i);return"string"==typeof n&&n.length?"?"+n:n},t.hash=function(t,i){var n=this.ay(t,i);return"string"==typeof n&&n.length?"#"+n:n},t.pathname=function(t,i){if(void 0!==t&&!0!==t)return this.uy.urn?this.uy.path=t?p.vT(t):"":this.uy.path=t?p.lT(t):"/",this.mv(!i),this;var n=this.uy.path||(this.uy.hostname?"/":"");return t?(this.uy.urn?p.cT:p.fT)(n):n},t.path=t.pathname,t.href=function(t,i){var n;if(void 0===t)return this.toString();this.xT="",this.uy=p.uy();var r=t instanceof p,s="object"==typeof t&&(t.hostname||t.path||t.pathname);t.nodeName&&(t=t[p.By(t)]||"",s=!1);if(!r&&s&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t||t instanceof String)this.uy=p.parse(String(t),this.uy);else{if(!r&&!s)throw new TypeError("invalid input");var e=r?t.uy:t;for(n in e)"query"!==n&&f.call(this.uy,n)&&(this.uy[n]=e[n]);e.query&&this.query(e.query,!1)}return this.mv(!i),this},t.is=function(t){var i=!1,n=!1,r=!1,s=!1,e=!1,h=!1,o=!1,u=!this.uy.urn;switch(this.uy.hostname&&(u=!1,n=p.by.test(this.uy.hostname),r=p.yy.test(this.uy.hostname),e=(s=!(i=n||r))&&a&&a.has(this.uy.hostname),h=s&&p.py.test(this.uy.hostname),o=s&&p.gy.test(this.uy.hostname)),t.toLowerCase()){case"relative":return u;case"absolute":return!u;case"domain":case"name":return s;case"sld":return e;case"ip":return i;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return h;case"url":return!this.uy.urn;case"urn":return!!this.uy.urn;case"punycode":return o}return null};var O=t.protocol,S=t.port,R=t.hostname;t.protocol=function(t,i){if(t&&!(t=t.replace(/:(\/\/)?$/,"")).match(p.wy))throw new TypeError('Protocol "'+t+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return O.call(this,t,i)},t.scheme=t.protocol,t.port=function(t,i){return this.uy.urn?void 0===t?"":this:(void 0!==t&&(0===t&&(t=null),t&&(":"===(t+="").charAt(0)&&(t=t.substring(1)),p.gT(t))),S.call(this,t,i))},t.hostname=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0!==t){var n={ly:this.uy.ly};if("/"!==p.wT(t,n))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');t=n.hostname,this.uy.ly&&p.pT(t,this.uy.protocol)}return R.call(this,t,i)},t.origin=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0===t){var n=this.protocol();return this.BT()?(n?n+"://":"")+this.BT():""}var r=p(t);return this.protocol(r.protocol()).BT(r.BT()).mv(!i),this},t.host=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0===t)return this.uy.hostname?p.mT(this.uy):"";if("/"!==p.wT(t,this.uy))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.mv(!i),this},t.BT=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0===t)return this.uy.hostname?p.TT(this.uy):"";if("/"!==p.ET(t,this.uy))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.mv(!i),this},t.VT=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0!==t)return"@"!==t[t.length-1]&&(t+="@"),p.bT(t,this.uy),this.mv(!i),this;var n=p.OT(this.uy);return n?n.substring(0,n.length-1):n},t.qT=function(t,i){var n;return void 0===t?this.path()+this.search()+this.hash():(n=p.parse(t),this.uy.path=n.path,this.uy.query=n.query,this.uy.ay=n.ay,this.mv(!i),this)},t.QT=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0===t){if(!this.uy.hostname||this.is("IP"))return"";var n=this.uy.hostname.length-this.domain().length-1;return this.uy.hostname.substring(0,n)||""}var r=this.uy.hostname.length-this.domain().length,s=this.uy.hostname.substring(0,r),e=new RegExp("^"+u(s));if(t&&"."!==t.charAt(t.length-1)&&(t+="."),-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");return t&&p.pT(t,this.uy.protocol),this.uy.hostname=this.uy.hostname.replace(e,t),this.mv(!i),this},t.domain=function(t,i){if(this.uy.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.uy.hostname||this.is("IP"))return"";var n=this.uy.hostname.match(/\./g);if(n&&n.length<2)return this.uy.hostname;var r=this.uy.hostname.length-this.YT(i).length-1;return r=this.uy.hostname.lastIndexOf(".",r-1)+1,this.uy.hostname.substring(r)||""}if(!t)throw new TypeError("cannot set domain empty");if(-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(p.pT(t,this.uy.protocol),!this.uy.hostname||this.is("IP"))this.uy.hostname=t;else{var s=new RegExp(u(this.domain())+"$");this.uy.hostname=this.uy.hostname.replace(s,t)}return this.mv(!i),this},t.YT=function(t,i){if(this.uy.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.uy.hostname||this.is("IP"))return"";var n=this.uy.hostname.lastIndexOf("."),r=this.uy.hostname.substring(n+1);return!0!==i&&a&&a.list[r.toLowerCase()]&&a.get(this.uy.hostname)||r}var s;if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!a||!a.is(t))throw new TypeError('TLD "'+t+'" contains characters other than [A-Z0-9]');s=new RegExp(u(this.YT())+"$"),this.uy.hostname=this.uy.hostname.replace(s,t)}else{if(!this.uy.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");s=new RegExp(u(this.YT())+"$"),this.uy.hostname=this.uy.hostname.replace(s,t)}return this.mv(!i),this},t.KT=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.uy.path&&!this.uy.hostname)return"";if("/"===this.uy.path)return"/";var n=this.uy.path.length-this.filename().length-1,r=this.uy.path.substring(0,n)||(this.uy.hostname?"/":"");return t?p.fT(r):r}var s=this.uy.path.length-this.filename().length,e=this.uy.path.substring(0,s),h=new RegExp("^"+u(e));return this.is("relative")||"/"!==(t=t||"/").charAt(0)&&(t="/"+t),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=p.lT(t),this.uy.path=this.uy.path.replace(h,t),this.mv(!i),this},t.filename=function(t,i){if(this.uy.urn)return void 0===t?"":this;if("string"!=typeof t){if(!this.uy.path||"/"===this.uy.path)return"";var n=this.uy.path.lastIndexOf("/"),r=this.uy.path.substring(n+1);return t?p.WT(r):r}var s=!1;"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(s=!0);var e=new RegExp(u(this.filename())+"$");return t=p.lT(t),this.uy.path=this.uy.path.replace(e,t),s?this.$T(i):this.mv(!i),this},t.suffix=function(t,i){if(this.uy.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.uy.path||"/"===this.uy.path)return"";var n,r,s=this.filename(),e=s.lastIndexOf(".");return-1===e?"":(n=s.substring(e+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",t?p.WT(r):r)}"."===t.charAt(0)&&(t=t.substring(1));var h,o=this.suffix();if(o)h=t?new RegExp(u(o)+"$"):new RegExp(u("."+o)+"$");else{if(!t)return this;this.uy.path+="."+p.lT(t)}return h&&(t=p.lT(t),this.uy.path=this.uy.path.replace(h,t)),this.mv(!i),this},t.CT=function(t,i,n){var r=this.uy.urn?":":"/",s=this.path(),e="/"===s.substring(0,1),h=s.split(r);if(void 0!==t&&"number"!=typeof t&&(n=i,i=t,t=void 0),void 0!==t&&"number"!=typeof t)throw new Error('Bad segment "'+t+'", must be 0-based integer');if(e&&h.shift(),t<0&&(t=Math.max(h.length+t,0)),void 0===i)return void 0===t?h:h[t];if(null===t||void 0===h[t])if(c(i)){h=[];for(var o=0,u=i.length;o<u;o++)(i[o].length||h.length&&h[h.length-1].length)&&(h.length&&!h[h.length-1].length&&h.pop(),h.push(E(i[o])))}else!i&&"string"!=typeof i||(i=E(i),""===h[h.length-1]?h[h.length-1]=i:h.push(i));else i?h[t]=E(i):h.splice(t,1);return e&&h.unshift(""),this.path(h.join(r),n)},t.XT=function(t,i,n){var r,s,e;if("number"!=typeof t&&(n=i,i=t,t=void 0),void 0===i){if(c(r=this.CT(t,i,n)))for(s=0,e=r.length;s<e;s++)r[s]=p.decode(r[s]);else r=void 0!==r?p.decode(r):void 0;return r}if(c(i))for(s=0,e=i.length;s<e;s++)i[s]=p.encode(i[s]);else i="string"==typeof i||i instanceof String?p.encode(i):i;return this.CT(t,i,n)};var _=t.query;return t.query=function(t,i){if(!0===t)return p.yT(this.uy.query,this.uy.Ey);if("function"!=typeof t)return void 0!==t&&"string"!=typeof t?(this.uy.query=p.ST(t,this.uy.vy,this.uy.Ey),this.mv(!i),this):_.call(this,t,i);var n=p.yT(this.uy.query,this.uy.Ey),r=t.call(this,n);return this.uy.query=p.ST(r||n,this.uy.vy,this.uy.Ey),this.mv(!i),this},t.IT=function(t,i,n){var r=p.yT(this.uy.query,this.uy.Ey);if("string"==typeof t||t instanceof String)r[t]=void 0!==i?i:null;else{if("object"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var s in t)f.call(t,s)&&(r[s]=t[s])}return this.uy.query=p.ST(r,this.uy.vy,this.uy.Ey),"string"!=typeof t&&(n=i),this.mv(!n),this},t._T=function(t,i,n){var r=p.yT(this.uy.query,this.uy.Ey);return p._T(r,t,void 0===i?null:i),this.uy.query=p.ST(r,this.uy.vy,this.uy.Ey),"string"!=typeof t&&(n=i),this.mv(!n),this},t.AT=function(t,i,n){var r=p.yT(this.uy.query,this.uy.Ey);return p.AT(r,t,i),this.uy.query=p.ST(r,this.uy.vy,this.uy.Ey),"string"!=typeof t&&(n=i),this.mv(!n),this},t.NT=function(t,i,n){var r=p.yT(this.uy.query,this.uy.Ey);return p.NT(r,t,i,n)},t.JT=t.IT,t.zT=t._T,t.ZT=t.AT,t.tm=t.NT,t.normalize=function(){return this.uy.urn?this.rm(!1).$T(!1).nm(!1).im(!1).mv():this.rm(!1).em(!1).sm(!1).$T(!1).nm(!1).im(!1).mv()},t.rm=function(t){return"string"==typeof this.uy.protocol&&(this.uy.protocol=this.uy.protocol.toLowerCase(),this.mv(!t)),this},t.em=function(t){return this.uy.hostname&&(this.is("IDN")&&o?this.uy.hostname=o.LT(this.uy.hostname):this.is("IPv6")&&i&&(this.uy.hostname=i.hm(this.uy.hostname)),this.uy.hostname=this.uy.hostname.toLowerCase(),this.mv(!t)),this},t.sm=function(t){return"string"==typeof this.uy.protocol&&this.uy.port===p.Sy[this.uy.protocol]&&(this.uy.port=null,this.mv(!t)),this},t.$T=function(t){var i,n=this.uy.path;if(!n)return this;if(this.uy.urn)return this.uy.path=p.vT(this.uy.path),this.mv(!t),this;if("/"===this.uy.path)return this;var r,s,e="";for("/"!==(n=p.lT(n)).charAt(0)&&(i=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(e=(e=n.substring(1).match(/^(\.\.\/)+/)||"")&&e[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)n=0!==r?(-1===(s=n.substring(0,r).lastIndexOf("/"))&&(s=r),n.substring(0,s)+n.substring(r+3)):n.substring(3);return i&&this.is("relative")&&(n=e+n.substring(1)),this.uy.path=n,this.mv(!t),this},t.om=t.$T,t.nm=function(t){return"string"==typeof this.uy.query&&(this.uy.query.length?this.query(p.yT(this.uy.query,this.uy.Ey)):this.uy.query=null,this.mv(!t)),this},t.im=function(t){return this.uy.ay||(this.uy.ay=null,this.mv(!t)),this},t.um=t.nm,t.am=t.im,t.Vy=function(){var t=p.encode,i=p.decode;p.encode=escape,p.decode=decodeURIComponent;try{this.normalize()}finally{p.encode=t,p.decode=i}return this},t.unicode=function(){var t=p.encode,i=p.decode;p.encode=e,p.decode=unescape;try{this.normalize()}finally{p.encode=t,p.decode=i}return this},t.readable=function(){var t=this.clone();t.username("").password("").normalize();var i="";if(t.uy.protocol&&(i+=t.uy.protocol+"://"),t.uy.hostname&&(t.is("punycode")&&o?(i+=o.fm(t.uy.hostname),t.uy.port&&(i+=":"+t.uy.port)):i+=t.host()),t.uy.hostname&&t.uy.path&&"/"!==t.uy.path.charAt(0)&&(i+="/"),i+=t.path(!0),t.uy.query){for(var n="",r=0,s=t.uy.query.split("&"),e=s.length;r<e;r++){var h=(s[r]||"").split("=");n+="&"+p.aT(h[0],this.uy.Ey).replace(/&/g,"%26"),void 0!==h[1]&&(n+="="+p.aT(h[1],this.uy.Ey).replace(/&/g,"%26"))}i+="?"+n.substring(1)}return i+=p.aT(t.hash(),!0)},t.Qa=function(t){var i,n,r,s=this.clone(),e=["protocol","username","password","hostname","port"];if(this.uy.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t instanceof p||(t=new p(t)),s.uy.protocol)return s;if(s.uy.protocol=t.uy.protocol,this.uy.hostname)return s;for(n=0;r=e[n];n++)s.uy[r]=t.uy[r];return s.uy.path?(".."===s.uy.path.substring(-2)&&(s.uy.path+="/"),"/"!==s.path().charAt(0)&&(i=(i=t.KT())||(0===t.path().indexOf("/")?"/":""),s.uy.path=(i?i+"/":"")+s.uy.path,s.$T())):(s.uy.path=t.uy.path,s.uy.query||(s.uy.query=t.uy.query)),s.mv(),s},t.cm=function(t){var i,n,r,s,e,h=this.clone().normalize();if(h.uy.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t=new p(t).normalize(),i=h.uy,n=t.uy,s=h.path(),e=t.path(),"/"!==s.charAt(0))throw new Error("URI is already relative");if("/"!==e.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(i.protocol===n.protocol&&(i.protocol=null),i.username!==n.username||i.password!==n.password)return h.mv();if(null!==i.protocol||null!==i.username||null!==i.password)return h.mv();if(i.hostname!==n.hostname||i.port!==n.port)return h.mv();if(i.hostname=null,i.port=null,s===e)return i.path="",h.mv();if(!(r=p.DT(s,e)))return h.mv();var o=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return i.path=o+i.path.substring(r.length)||"./",h.mv()},t.Ae=function(t){var i,n,r,s,e,h=this.clone(),o=new p(t),u={};if(h.normalize(),o.normalize(),h.toString()===o.toString())return!0;if(r=h.query(),s=o.query(),h.query(""),o.query(""),h.toString()!==o.toString())return!1;if(r.length!==s.length)return!1;for(e in i=p.yT(r,this.uy.Ey),n=p.yT(s,this.uy.Ey),i)if(f.call(i,e)){if(c(i[e])){if(!d(i[e],n[e]))return!1}else if(i[e]!==n[e])return!1;u[e]=!0}for(e in n)if(f.call(n,e)&&!u[e])return!1;return!0},t.ly=function(t){return this.uy.ly=!!t,this},t.vy=function(t){return this.uy.vy=!!t,this},t.Ey=function(t){return this.uy.Ey=!!t,this},p})},function(t,i){var g,E,e,a,n,h,r,o={userAgent:!1},u={};if(void 0===f||!f)var f={};f.lm=function(){var t,i,n,r=arguments,s=null;for(t=0;t<r.length;t+=1)for(n=(""+r[t]).split("."),s=f,i="YAHOO"==n[0]?1:0;i<n.length;i+=1)s[n[i]]=s[n[i]]||{},s=s[n[i]];return s},f.log=function(t,i,n){var r=f.dm.vm;return!(!r||!r.log)&&r.log(t,i,n)},f.register=function(t,i,n){var r,s,e,h,o,u=f.Ye.Em;for(u[t]||(u[t]={wm:[],pm:[]}),r=u[t],s=n.version,e=n.mv,h=f.Ye.gm,r.name=t,r.version=s,r.mv=e,r.wm.push(s),r.pm.push(e),r.bm=i,o=0;o<h.length;o+=1)h[o](r);i?(i.VERSION=s,i.ym=e):f.log("mainClass is undefined for module "+t,"warn")},f.Ye=f.Ye||{Em:[],gm:[]},f.Ye.getVersion=function(t){return f.Ye.Em[t]||null},f.Ye.Tm=function(t){function i(t){var i=0;return parseFloat(t.replace(/\./g,function(){return 1==i++?"":"."}))}var n,r={mm:0,opera:0,Om:0,Sm:0,chrome:0,Rm:null,_m:0,Im:0,Am:0,Nm:0,km:null,Cm:0,Dm:0,Mm:o&&o.jm,Pm:!1,os:null},s=t||o&&o.userAgent,e=u.location,h=e&&e.href;return r.Pm=h&&0===h.toLowerCase().indexOf("https"),s&&(/windows|win32/i.test(s)?r.os="windows":/macintosh/i.test(s)?r.os="macintosh":/rhino/i.test(s)&&(r.os="rhino"),/KHTML/.test(s)&&(r.Sm=1),(n=s.match(/AppleWebKit\/([^\s]*)/))&&n[1]&&(r.Sm=i(n[1]),/ Mobile\//.test(s)?(r.Rm="Apple",(n=s.match(/OS ([^\s]*)/))&&n[1]&&(n=i(n[1].replace("_","."))),r.km=n,r.Im=r.Nm=r.Am=0,(n=s.match(/iPad|iPod|iPhone/))&&n[0]&&(r[n[0].toLowerCase()]=r.km)):((n=s.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))&&(r.Rm=n[0]),/webOS/.test(s)&&(r.Rm="WebOS",(n=s.match(/webOS\/([^\s]*);/))&&n[1]&&(r.Dm=i(n[1]))),/ Android/.test(s)&&(r.Rm="Android",(n=s.match(/Android ([^\s]*);/))&&n[1]&&(r.Cm=i(n[1])))),(n=s.match(/Chrome\/([^\s]*)/))&&n[1]?r.chrome=i(n[1]):(n=s.match(/AdobeAIR\/([^\s]*)/))&&(r._m=n[0])),r.Sm||((n=s.match(/Opera[\s\/]([^\s]*)/))&&n[1]?(r.opera=i(n[1]),(n=s.match(/Version\/([^\s]*)/))&&n[1]&&(r.opera=i(n[1])),(n=s.match(/Opera Mini[^;]*/))&&(r.Rm=n[0])):(n=s.match(/MSIE\s([^;]*)/))&&n[1]?r.mm=i(n[1]):(n=s.match(/Gecko\/([^\s]*)/))&&(r.Om=1,(n=s.match(/rv:([^\s\)]*)/))&&n[1]&&(r.Om=i(n[1]))))),r},f.Ye.Lm=f.Ye.Tm(),(function(){if(f.lm("util","widget","example"),"undefined"!=typeof YAHOO_config){var t,i=YAHOO_config.listener,n=f.Ye.gm,r=!0;if(i){for(t=0;t<n.length;t++)if(n[t]==i){r=!1;break}r&&n.push(i)}}})(),f.lang=f.lang||{},E=f.lang,e=Object.prototype,a=[],n={Hm:"&amp;",Um:"&lt;",Fm:"&gt;",Gm:"&quot;",xm:"&#x27;",Yy:"&#x2F;",Bm:"&#x60;"},h=["toString","valueOf"],r={isArray:function(t){return"[object Array]"===e.toString.apply(t)},Vm:function(t){return"boolean"==typeof t},qm:function(t){return"function"==typeof t||"[object Function]"===e.toString.apply(t)},Qm:function(t){return null===t},Ym:function(t){return"number"==typeof t&&isFinite(t)},dc:function(t){return t&&("object"==typeof t||E.qm(t))||!1},Km:function(t){return"string"==typeof t},Wm:function(t){return void 0===t},$m:f.Ye.Lm.mm?function(t,i){var n,r,s;for(n=0;n<h.length;n+=1)s=i[r=h[n]],E.qm(s)&&s!=e[r]&&(t[r]=s)}:function(){},Xm:function(t){return t.replace(/[&<>"'\/`]/g,function(t){return n[t]})},extend:function(t,i,n){if(!i||!t)throw new Error("extend failed, please check that all dependencies are included.");function r(){}var s;if(r.prototype=i.prototype,t.prototype=new r(),(t.prototype.constructor=t).Jm=i.prototype,i.prototype.constructor==e.constructor&&(i.prototype.constructor=i),n){for(s in n)E.hasOwnProperty(n,s)&&(t.prototype[s]=n[s]);E.$m(t.prototype,n)}},zm:function(t,i){if(!i||!t)throw new Error("Absorb failed, verify dependencies.");var n,r,s=arguments,e=s[2];if(e&&!0!==e)for(n=2;n<s.length;n+=1)t[s[n]]=i[s[n]];else{for(r in i)!e&&r in t||(t[r]=i[r]);E.$m(t,i)}return t},Zm:function(t,i){if(!i||!t)throw new Error("Augment failed, verify dependencies.");var n,r=[t.prototype,i.prototype];for(n=2;n<arguments.length;n+=1)r.push(arguments[n]);return E.zm.apply(this,r),t},dump:function(t,i){var n,r,s=[];if(!E.dc(t))return t+"";if(t instanceof Date||"nodeType"in t&&"tagName"in t)return t;if(E.qm(t))return"f(){...}";if(i=E.Ym(i)?i:3,E.isArray(t)){for(s.push("["),n=0,r=t.length;n<r;n+=1)E.dc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", ");1<s.length&&s.pop(),s.push("]")}else{for(n in s.push("{"),t)E.hasOwnProperty(t,n)&&(s.push(n+" => "),E.dc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", "));1<s.length&&s.pop(),s.push("}")}return s.join("")},tO:function(t,i,n,r){for(var s,e,h,o,u,a,f,c,l,v=[],d=t.length;!((s=t.lastIndexOf("{",d))<0)&&!((e=t.indexOf("}",s))<s+1);)a=null,-1<(h=(o=f=t.substring(s+1,e)).indexOf(" "))&&(a=o.substring(h+1),o=o.substring(0,h)),u=i[o],n&&(u=n(o,u,a)),E.dc(u)?u=E.isArray(u)?E.dump(u,parseInt(a,10)):(-1<(c=(a=a||"").indexOf("dump"))&&(a=a.substring(4)),"[object Object]"===(l=u.toString())||-1<c?E.dump(u,parseInt(a,10)):l):E.Km(u)||E.Ym(u)||(u="~-"+v.length+"-~",v[v.length]=f),t=t.substring(0,s)+u+t.substring(e+1),!1===r&&(d=s-1);for(s=v.length-1;0<=s;s-=1)t=t.replace(new RegExp("~-"+s+"-~"),"{"+v[s]+"}","g");return t},trim:function(i){try{return i.replace(/^\s+|\s+$/g,"")}catch(t){return i}},iO:function(){var t,i={},n=arguments,r=n.length;for(t=0;t<r;t+=1)E.zm(i,n[t],!0);return i},nO:function(t,i,n,r,s){t=t||0,i=i||{};var e,h,o=n,u=r;if(E.Km(n)&&(o=i[n]),!o)throw new TypeError("method undefined");return E.Wm(r)||E.isArray(u)||(u=[r]),e=function(){o.apply(i,u||a)},h=s?setInterval(e,t):setTimeout(e,t),{interval:s,cancel:function(){this.interval?clearInterval(h):clearTimeout(h)}}},rO:function(t){return E.dc(t)||E.Km(t)||E.Ym(t)||E.Vm(t)}},E.hasOwnProperty=e.hasOwnProperty?function(t,i){return t&&t.hasOwnProperty&&t.hasOwnProperty(i)}:function(t,i){return!E.Wm(t[i])&&t.constructor.prototype[i]!==t[i]},r.zm(E,r,!0),(f.util.Lang=E).sO=E.Zm,f.sO=E.Zm,f.extend=E.extend,f.register("yahoo",f,{version:"2.9.0",mv:"2800"});var c,s,l,v,d,w,p,b,y,T,m,O,S,R,_,I,A=A||(c=Math,l=(s={}).rv={},v=l.eO={extend:function(t){N.prototype=this;var i=new N();return t&&i.hO(t),i.hasOwnProperty("init")||(i.init=function(){i.oO.init.apply(this,arguments)}),(i.init.prototype=i).oO=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},hO:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},d=l.nv=v.extend({init:function(t,i){t=this.uO=t||[],this.aO=null!=i?i:4*t.length},toString:function(t){return(t||p).stringify(this)},concat:function(t){var i=this.uO,n=t.uO,r=this.aO,s=t.aO;if(this.fO(),r%4)for(var e=0;e<s;e++){var h=n[e>>>2]>>>24-e%4*8&255;i[r+e>>>2]|=h<<24-(r+e)%4*8}else for(e=0;e<s;e+=4)i[r+e>>>2]=n[e>>>2];return this.aO+=s,this},fO:function(){var t=this.uO,i=this.aO;t[i>>>2]&=4294967295<<32-i%4*8,t.length=c.ceil(i/4)},clone:function(){var t=v.clone.call(this);return t.uO=this.uO.slice(0),t},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*c.random()|0);return new d.init(i,t)}}),w=s.cO={},p=w.lO={stringify:function(t){for(var i=t.uO,n=t.aO,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push((e>>>4).toString(16)),r.push((15&e).toString(16))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new d.init(n,i/2)}},b=w.vO={stringify:function(t){for(var i=t.uO,n=t.aO,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push(String.fromCharCode(e))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new d.init(n,i)}},y=w.dO={stringify:function(t){try{return decodeURIComponent(escape(b.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return b.parse(unescape(encodeURIComponent(t)))}},T=l.EO=v.extend({reset:function(){this.wO=new d.init(),this.pO=0},gO:function(t){"string"==typeof t&&(t=y.parse(t)),this.wO.concat(t),this.pO+=t.aO},bO:function(t){var i=this.wO,n=i.uO,r=i.aO,s=this.blockSize,e=r/(4*s),h=(e=t?c.ceil(e):c.max((0|e)-this.yO,0))*s,o=c.min(4*h,r);if(h){for(var u=0;u<h;u+=s)this.TO(n,u);var a=n.splice(0,h);i.aO-=o}return new d.init(a,o)},clone:function(){var t=v.clone.call(this);return t.wO=this.wO.clone(),t},yO:0}),l.mO=T.extend({OO:v.extend(),init:function(t){this.OO=this.OO.extend(t),this.reset()},reset:function(){T.reset.call(this),this.SO()},update:function(t){return this.gO(t),this.bO(),this},RO:function(t){return t&&this.gO(t),this._O()},blockSize:16,IO:function(n){return function(t,i){return new n.init(i).RO(t)}},AO:function(n){return function(t,i){return new m.NO.init(n,i).RO(t)}}}),m=s.kO={},s);function N(){}!function(e){function O(t,i,n,r,s,e,h){return((t=t+(i&n|~i&r)+s+h)<<e|t>>>32-e)+i}function S(t,i,n,r,s,e,h){return((t=t+(i&r|n&~r)+s+h)<<e|t>>>32-e)+i}function R(t,i,n,r,s,e,h){return((t=t+(i^n^r)+s+h)<<e|t>>>32-e)+i}function _(t,i,n,r,s,e,h){return((t=t+(n^(i|~r))+s+h)<<e|t>>>32-e)+i}for(var t=A,i=(r=t.rv).nv,n=r.mO,r=t.kO,I=[],s=0;s<64;s++)I[s]=4294967296*e.abs(e.sin(s+1))|0;r=r.ev=n.extend({SO:function(){this.CO=new i.init([1732584193,4023233417,2562383102,271733878])},TO:function(t,i){for(var n=0;n<16;n++){var r=t[h=i+n];t[h]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}n=this.CO.uO;var s,e,h=t[i+0],o=(r=t[i+1],t[i+2]),u=t[i+3],a=t[i+4],f=t[i+5],c=t[i+6],l=t[i+7],v=t[i+8],d=t[i+9],E=t[i+10],w=t[i+11],p=t[i+12],g=t[i+13],b=t[i+14],y=t[i+15],T=n[0],m=_(m=_(m=_(m=_(m=R(m=R(m=R(m=R(m=S(m=S(m=S(m=S(m=O(m=O(m=O(m=O(m=n[1],e=O(e=n[2],s=O(s=n[3],T=O(T,m,e,s,h,7,I[0]),m,e,r,12,I[1]),T,m,o,17,I[2]),s,T,u,22,I[3]),e=O(e,s=O(s,T=O(T,m,e,s,a,7,I[4]),m,e,f,12,I[5]),T,m,c,17,I[6]),s,T,l,22,I[7]),e=O(e,s=O(s,T=O(T,m,e,s,v,7,I[8]),m,e,d,12,I[9]),T,m,E,17,I[10]),s,T,w,22,I[11]),e=O(e,s=O(s,T=O(T,m,e,s,p,7,I[12]),m,e,g,12,I[13]),T,m,b,17,I[14]),s,T,y,22,I[15]),e=S(e,s=S(s,T=S(T,m,e,s,r,5,I[16]),m,e,c,9,I[17]),T,m,w,14,I[18]),s,T,h,20,I[19]),e=S(e,s=S(s,T=S(T,m,e,s,f,5,I[20]),m,e,E,9,I[21]),T,m,y,14,I[22]),s,T,a,20,I[23]),e=S(e,s=S(s,T=S(T,m,e,s,d,5,I[24]),m,e,b,9,I[25]),T,m,u,14,I[26]),s,T,v,20,I[27]),e=S(e,s=S(s,T=S(T,m,e,s,g,5,I[28]),m,e,o,9,I[29]),T,m,l,14,I[30]),s,T,p,20,I[31]),e=R(e,s=R(s,T=R(T,m,e,s,f,4,I[32]),m,e,v,11,I[33]),T,m,w,16,I[34]),s,T,b,23,I[35]),e=R(e,s=R(s,T=R(T,m,e,s,r,4,I[36]),m,e,a,11,I[37]),T,m,l,16,I[38]),s,T,E,23,I[39]),e=R(e,s=R(s,T=R(T,m,e,s,g,4,I[40]),m,e,h,11,I[41]),T,m,u,16,I[42]),s,T,c,23,I[43]),e=R(e,s=R(s,T=R(T,m,e,s,d,4,I[44]),m,e,p,11,I[45]),T,m,y,16,I[46]),s,T,o,23,I[47]),e=_(e,s=_(s,T=_(T,m,e,s,h,6,I[48]),m,e,l,10,I[49]),T,m,b,15,I[50]),s,T,f,21,I[51]),e=_(e,s=_(s,T=_(T,m,e,s,p,6,I[52]),m,e,u,10,I[53]),T,m,E,15,I[54]),s,T,r,21,I[55]),e=_(e,s=_(s,T=_(T,m,e,s,v,6,I[56]),m,e,y,10,I[57]),T,m,c,15,I[58]),s,T,g,21,I[59]),e=_(e,s=_(s,T=_(T,m,e,s,a,6,I[60]),m,e,w,10,I[61]),T,m,o,15,I[62]),s,T,d,21,I[63]);n[0]=n[0]+T|0,n[1]=n[1]+m|0,n[2]=n[2]+e|0,n[3]=n[3]+s|0},_O:function(){var t=this.wO,i=t.uO,n=8*this.pO,r=8*t.aO;i[r>>>5]|=128<<24-r%32;var s=e.floor(n/4294967296);for(i[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.aO=4*(i.length+1),this.bO(),i=(t=this.CO).uO,n=0;n<4;n++)r=i[n],i[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var t=n.clone.call(this);return t.CO=this.CO.clone(),t}}),t.ev=n.IO(r),t.DO=n.AO(r)}(Math),S=(I=(O=A).rv).nv,R=I.mO,_=[],I=O.kO.MO=R.extend({SO:function(){this.CO=new S.init([1732584193,4023233417,2562383102,271733878,3285377520])},TO:function(t,i){for(var n=this.CO.uO,r=n[0],s=n[1],e=n[2],h=n[3],o=n[4],u=0;u<80;u++){if(u<16)_[u]=0|t[i+u];else{var a=_[u-3]^_[u-8]^_[u-14]^_[u-16];_[u]=a<<1|a>>>31}a=(r<<5|r>>>27)+o+_[u],a=u<20?a+(1518500249+(s&e|~s&h)):u<40?a+(1859775393+(s^e^h)):u<60?a+((s&e|s&h|e&h)-1894007588):a+((s^e^h)-899497514),o=h,h=e,e=s<<30|s>>>2,s=r,r=a}n[0]=n[0]+r|0,n[1]=n[1]+s|0,n[2]=n[2]+e|0,n[3]=n[3]+h|0,n[4]=n[4]+o|0},_O:function(){var t=this.wO,i=t.uO,n=8*this.pO,r=8*t.aO;return i[r>>>5]|=128<<24-r%32,i[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),i[15+(64+r>>>9<<4)]=n,t.aO=4*i.length,this.bO(),this.CO},clone:function(){var t=R.clone.call(this);return t.CO=this.CO.clone(),t}}),O.MO=R.IO(I),O.jO=R.AO(I);var k,C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D="=";function M(t){var i,n,r,s="",e=0;for(i=0;i<t.length&&t.charAt(i)!=D;++i)(r=C.indexOf(t.charAt(i)))<0||(e=0==e?(s+=G(r>>2),n=3&r,1):1==e?(s+=G(n<<2|r>>4),n=15&r,2):2==e?(s+=G(n),s+=G(r>>2),n=3&r,3):(s+=G(n<<2|r>>4),s+=G(15&r),0));return 1==e&&(s+=G(n<<2)),s}function j(t,i,n){null!=t&&("number"==typeof t?this.PO(t,i,n):null==i&&"string"!=typeof t?this.LO(t,256):this.LO(t,i))}function P(){return new j(null)}k="Microsoft Internet Explorer"==o.appName?(j.prototype.HO=function(t,i,n,r,s,e){for(var h=32767&i,o=i>>15;0<=--e;){var u=32767&this[t],a=this[t++]>>15,f=o*u+a*h;s=((u=h*u+((32767&f)<<15)+n[r]+(1073741823&s))>>>30)+(f>>>15)+o*a+(s>>>30),n[r++]=1073741823&u}return s},30):"Netscape"!=o.appName?(j.prototype.HO=function(t,i,n,r,s,e){for(;0<=--e;){var h=i*this[t++]+n[r]+s;s=Math.floor(h/67108864),n[r++]=67108863&h}return s},26):(j.prototype.HO=function(t,i,n,r,s,e){for(var h=16383&i,o=i>>14;0<=--e;){var u=16383&this[t],a=this[t++]>>14,f=o*u+a*h;s=((u=h*u+((16383&f)<<14)+n[r]+s)>>28)+(f>>14)+o*a,n[r++]=268435455&u}return s},28),j.prototype.UO=k,j.prototype.FO=(1<<k)-1,j.prototype.GO=1<<k;j.prototype.xO=Math.pow(2,52),j.prototype.BO=52-k,j.prototype.VO=2*k-52;var L,H,U="0123456789abcdefghijklmnopqrstuvwxyz",F=new Array();for(L="0".charCodeAt(0),H=0;H<=9;++H)F[L++]=H;for(L="a".charCodeAt(0),H=10;H<36;++H)F[L++]=H;for(L="A".charCodeAt(0),H=10;H<36;++H)F[L++]=H;function G(t){return U.charAt(t)}function x(t){var i=P();return i.qO(t),i}function B(t){var i,n=1;return 0!=(i=t>>>16)&&(t=i,n+=16),0!=(i=t>>8)&&(t=i,n+=8),0!=(i=t>>4)&&(t=i,n+=4),0!=(i=t>>2)&&(t=i,n+=2),0!=(i=t>>1)&&(t=i,n+=1),n}function V(t){this.QO=t}function q(t){this.QO=t,this.YO=t.KO(),this.WO=32767&this.YO,this.$O=this.YO>>15,this.XO=(1<<t.UO-15)-1,this.JO=2*t.t}function Q(t,i){return new j(t,i)}function Y(t,i,n){for(var r="",s=0;r.length<i;)r+=n(String.fromCharCode.apply(String,t.concat([(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s]))),s+=1;return r}V.prototype.zO=function(t){return t.ZO<0||0<=t.tS(this.QO)?t.iS(this.QO):t},V.prototype.nS=function(t){return t},V.prototype.reduce=function(t){t.rS(this.QO,null,t)},V.prototype.sS=function(t,i,n){t.eS(i,n),this.reduce(n)},V.prototype.hS=function(t,i){t.oS(i),this.reduce(i)},q.prototype.zO=function(t){var i=P();return t.abs().uS(this.QO.t,i),i.rS(this.QO,null,i),t.ZO<0&&0<i.tS(j.ZERO)&&this.QO.aS(i,i),i},q.prototype.nS=function(t){var i=P();return t.fS(i),this.reduce(i),i},q.prototype.reduce=function(t){for(;t.t<=this.JO;)t[t.t++]=0;for(var i=0;i<this.QO.t;++i){var n=32767&t[i],r=n*this.WO+((n*this.$O+(t[i]>>15)*this.WO&this.XO)<<15)&t.FO;for(t[n=i+this.QO.t]+=this.QO.HO(0,r,t,i,0,this.QO.t);t[n]>=t.GO;)t[n]-=t.GO,t[++n]++}t.fO(),t.cS(this.QO.t,t),0<=t.tS(this.QO)&&t.aS(this.QO,t)},q.prototype.sS=function(t,i,n){t.eS(i,n),this.reduce(n)},q.prototype.hS=function(t,i){t.oS(i),this.reduce(i)},j.prototype.fS=function(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.ZO=this.ZO},j.prototype.qO=function(t){this.t=1,this.ZO=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.GO:this.t=0},j.prototype.LO=function(t,i){var n;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i)return void this.lS(t,i);n=2}this.t=0,this.ZO=0;for(var r,s,e=t.length,h=!1,o=0;0<=--e;){var u=8==n?255&t[e]:(r=e,void 0,null==(s=F[t.charCodeAt(r)])?-1:s);u<0?"-"==t.charAt(e)&&(h=!0):(h=!1,0==o?this[this.t++]=u:o+n>this.UO?(this[this.t-1]|=(u&(1<<this.UO-o)-1)<<o,this[this.t++]=u>>this.UO-o):this[this.t-1]|=u<<o,(o+=n)>=this.UO&&(o-=this.UO))}8==n&&0!=(128&t[0])&&(this.ZO=-1,0<o&&(this[this.t-1]|=(1<<this.UO-o)-1<<o)),this.fO(),h&&j.ZERO.aS(this,this)},j.prototype.fO=function(){for(var t=this.ZO&this.FO;0<this.t&&this[this.t-1]==t;)--this.t},j.prototype.uS=function(t,i){var n;for(n=this.t-1;0<=n;--n)i[n+t]=this[n];for(n=t-1;0<=n;--n)i[n]=0;i.t=this.t+t,i.ZO=this.ZO},j.prototype.cS=function(t,i){for(var n=t;n<this.t;++n)i[n-t]=this[n];i.t=Math.max(this.t-t,0),i.ZO=this.ZO},j.prototype.vS=function(t,i){var n,r=t%this.UO,s=this.UO-r,e=(1<<s)-1,h=Math.floor(t/this.UO),o=this.ZO<<r&this.FO;for(n=this.t-1;0<=n;--n)i[n+h+1]=this[n]>>s|o,o=(this[n]&e)<<r;for(n=h-1;0<=n;--n)i[n]=0;i[h]=o,i.t=this.t+h+1,i.ZO=this.ZO,i.fO()},j.prototype.dS=function(t,i){i.ZO=this.ZO;var n=Math.floor(t/this.UO);if(n>=this.t)i.t=0;else{var r=t%this.UO,s=this.UO-r,e=(1<<r)-1;i[0]=this[n]>>r;for(var h=n+1;h<this.t;++h)i[h-n-1]|=(this[h]&e)<<s,i[h-n]=this[h]>>r;0<r&&(i[this.t-n-1]|=(this.ZO&e)<<s),i.t=this.t-n,i.fO()}},j.prototype.aS=function(t,i){for(var n=0,r=0,s=Math.min(t.t,this.t);n<s;)r+=this[n]-t[n],i[n++]=r&this.FO,r>>=this.UO;if(t.t<this.t){for(r-=t.ZO;n<this.t;)r+=this[n],i[n++]=r&this.FO,r>>=this.UO;r+=this.ZO}else{for(r+=this.ZO;n<t.t;)r-=t[n],i[n++]=r&this.FO,r>>=this.UO;r-=t.ZO}i.ZO=r<0?-1:0,r<-1?i[n++]=this.GO+r:0<r&&(i[n++]=r),i.t=n,i.fO()},j.prototype.eS=function(t,i){var n=this.abs(),r=t.abs(),s=n.t;for(i.t=s+r.t;0<=--s;)i[s]=0;for(s=0;s<r.t;++s)i[s+n.t]=n.HO(0,r[s],i,s,0,n.t);i.ZO=0,i.fO(),this.ZO!=t.ZO&&j.ZERO.aS(i,i)},j.prototype.oS=function(t){for(var i=this.abs(),n=t.t=2*i.t;0<=--n;)t[n]=0;for(n=0;n<i.t-1;++n){var r=i.HO(n,i[n],t,2*n,0,1);(t[n+i.t]+=i.HO(n+1,2*i[n],t,2*n+1,r,i.t-n-1))>=i.GO&&(t[n+i.t]-=i.GO,t[n+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.HO(n,i[n],t,2*n,0,1)),t.ZO=0,t.fO()},j.prototype.rS=function(t,i,n){var r=t.abs();if(!(r.t<=0)){var s=this.abs();if(s.t<r.t)return null!=i&&i.qO(0),void (null!=n&&this.fS(n));null==n&&(n=P());var e=P(),h=this.ZO,o=t.ZO,u=this.UO-B(r[r.t-1]);0<u?(r.vS(u,e),s.vS(u,n)):(r.fS(e),s.fS(n));var a=e.t,f=e[a-1];if(0!=f){var c=f*(1<<this.BO)+(1<a?e[a-2]>>this.VO:0),l=this.xO/c,v=(1<<this.BO)/c,d=1<<this.VO,E=n.t,w=E-a,p=null==i?P():i;for(e.uS(w,p),0<=n.tS(p)&&(n[n.t++]=1,n.aS(p,n)),j.ONE.uS(a,p),p.aS(e,e);e.t<a;)e[e.t++]=0;for(;0<=--w;){var g=n[--E]==f?this.FO:Math.floor(n[E]*l+(n[E-1]+d)*v);if((n[E]+=e.HO(0,g,n,w,0,a))<g)for(e.uS(w,p),n.aS(p,n);n[E]<--g;)n.aS(p,n)}null!=i&&(n.cS(a,i),h!=o&&j.ZERO.aS(i,i)),n.t=a,n.fO(),0<u&&n.dS(u,n),h<0&&j.ZERO.aS(n,n)}}},j.prototype.KO=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.GO)%this.GO)?this.GO-i:-i},j.prototype.ES=function(){return 0==(0<this.t?1&this[0]:this.ZO)},j.prototype.exp=function(t,i){if(4294967295<t||t<1)return j.ONE;var n=P(),r=P(),s=i.zO(this),e=B(t)-1;for(s.fS(n);0<=--e;)if(i.hS(n,r),0<(t&1<<e))i.sS(r,s,n);else{var h=n;n=r,r=h}return i.nS(n)},j.prototype.toString=function(t){if(this.ZO<0)return"-"+this.wS().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.pS(t);i=2}var n,r=(1<<i)-1,s=!1,e="",h=this.t,o=this.UO-h*this.UO%i;if(0<h--)for(o<this.UO&&0<(n=this[h]>>o)&&(s=!0,e=G(n));0<=h;)o<i?(n=(this[h]&(1<<o)-1)<<i-o,n|=this[--h]>>(o+=this.UO-i)):(n=this[h]>>(o-=i)&r,o<=0&&(o+=this.UO,--h)),0<n&&(s=!0),s&&(e+=G(n));return s?e:"0"},j.prototype.wS=function(){var t=P();return j.ZERO.aS(this,t),t},j.prototype.abs=function(){return this.ZO<0?this.wS():this},j.prototype.tS=function(t){var i=this.ZO-t.ZO;if(0!=i)return i;var n=this.t;if(0!=(i=n-t.t))return this.ZO<0?-i:i;for(;0<=--n;)if(0!=(i=this[n]-t[n]))return i;return 0},j.prototype.gS=function(){return this.t<=0?0:this.UO*(this.t-1)+B(this[this.t-1]^this.ZO&this.FO)},j.prototype.iS=function(t){var i=P();return this.abs().rS(t,null,i),this.ZO<0&&0<i.tS(j.ZERO)&&t.aS(i,i),i},j.prototype.bS=function(t,i){var n;return n=t<256||i.ES()?new V(i):new q(i),this.exp(t,n)},j.ZERO=x(0),j.ONE=x(1);var K=20;function W(){this.n=null,this.e=0,this.d=null,this.yS=null,this.TS=null,this.mS=null,this.OS=null,this.RS=null}W.prototype._S=function(t){return t.bS(this.e,this.n)},W.prototype.IS=function(t,i){this.NS=!0,"string"!=typeof t?(this.n=t,this.e=i):null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=Q(t,16),this.e=parseInt(i,16)):alert("Invalid RSA public key")},W.prototype.encrypt=function(t){var i=function(t,i){if(i<t.length+11)return alert("Message too long for RSA"),null;for(var n=new Array(),r=t.length-1;0<=r&&0<i;){var s=t.charCodeAt(r--);s<128?n[--i]=s:127<s&&s<2048?(n[--i]=63&s|128,n[--i]=s>>6|192):(n[--i]=63&s|128,n[--i]=s>>6&63|128,n[--i]=s>>12|224)}n[--i]=0;for(var e=new SecureRandom(),h=new Array();2<i;){for(h[0]=0;0==h[0];)e.kS(h);n[--i]=h[0]}return n[--i]=2,n[--i]=0,new j(n)}(t,this.n.gS()+7>>3);if(null==i)return null;var n=this._S(i);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},W.prototype.CS=function(t,i){var n=function(t,i,n){if(t.length+2*K+2>i)throw"Message too long for RSA";var r,s="";for(r=0;r<i-t.length-2*K-2;r+=1)s+="\0";var e=rstr_sha1("")+s+"\x01"+t,h=new Array(K);new SecureRandom().kS(h);var o=Y(h,e.length,n||rstr_sha1),u=[];for(r=0;r<e.length;r+=1)u[r]=e.charCodeAt(r)^o.charCodeAt(r);var a=Y(u,h.length,rstr_sha1),f=[0];for(r=0;r<h.length;r+=1)f[r+1]=h[r]^a.charCodeAt(r);return new j(f.concat(u))}(t,this.n.gS()+7>>3,i);if(null==n)return null;var r=this._S(n);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},W.prototype.type="RSA",void 0!==g&&g||(g={}),void 0!==g.DS&&g.DS||(g.DS={}),g.DS.MS=new(function(){this.jS=function(t){var i=t.toString(16);return i.length%2==1&&(i="0"+i),i},this.PS=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var n=i.substr(1).length;n%2==1?n+=1:i.match(/^[0-7]/)||(n+=2);for(var r="",s=0;s<n;s++)r+="f";i=new j(r,16).xor(t).add(j.ONE).toString(16).replace(/^-/,"")}return i},this.LS=function(t,i){g.DS;var n=A.cO.lO.parse(t),r=A.cO.HS.stringify(n).replace(/(.{64})/g,"$1\r\n");return"-----BEGIN "+i+"-----\r\n"+(r=r.replace(/\r\n$/,""))+"\r\n-----END "+i+"-----\r\n"},this.US=function(t){var i=g.DS,n=Object.keys(t);if(1!=n.length)throw"key of param shall be only one.";var r=n[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+r+":"))throw"undefined key: "+r;if("bool"==r)return new i.FS(t[r]);if("int"==r)return new i.GS(t[r]);if("bitstr"==r)return new i.xS(t[r]);if("octstr"==r)return new i.BS(t[r]);if("null"==r)return new i.VS(t[r]);if("oid"==r)return new i.qS(t[r]);if("enum"==r)return new i.QS(t[r]);if("utf8str"==r)return new i.YS(t[r]);if("numstr"==r)return new i.KS(t[r]);if("prnstr"==r)return new i.WS(t[r]);if("telstr"==r)return new i.$S(t[r]);if("ia5str"==r)return new i.XS(t[r]);if("utctime"==r)return new i.JS(t[r]);if("gentime"==r)return new i.zS(t[r]);if("seq"==r){for(var s=t[r],e=[],h=0;h<s.length;h++){var o=i.MS.US(s[h]);e.push(o)}return new i.ZS({tR:e})}if("set"==r){for(s=t[r],e=[],h=0;h<s.length;h++)o=i.MS.US(s[h]),e.push(o);return new i.iR({tR:e})}if("tag"==r){var u=t[r];if("[object Array]"===Object.prototype.toString.call(u)&&3==u.length){var a=i.MS.US(u[2]);return new i.nR({tag:u[0],rR:u[1],sR:a})}var f={};if(void 0!==u.rR&&(f.rR=u.rR),void 0!==u.tag&&(f.tag=u.tag),void 0===u.sR)throw"obj shall be specified for 'tag'.";return f.sR=i.MS.US(u.sR),new i.nR(f)}},this.eR=function(t){return this.US(t).hR()}})(),g.DS.MS.oR=function(t){for(var i="",n=parseInt(t.substr(0,2),16),r=(i=Math.floor(n/40)+"."+n%40,""),s=2;s<t.length;s+=2){var e=("00000000"+parseInt(t.substr(s,2),16).toString(2)).slice(-8);(r+=e.substr(1,7),"0"==e.substr(0,1))&&(i=i+"."+new j(r,2).toString(10),r="")}return i},g.DS.MS.uR=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function i(t){var i="",n=new j(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=o(s),r.splice(0,2);for(var e=0;e<r.length;e++)n+=i(r[e]);return n},g.DS.aR=function(){this.fR=function(){if(void 0===this.cR||null==this.cR)throw"this.hV is null or undefined.";if(this.cR.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.cR;var t=this.cR.length/2,i=t.toString(16);if(i.length%2==1&&(i="0"+i),t<128)return i;var n=i.length/2;if(15<n)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+i},this.hR=function(){return null!=this.lR&&!this.vR||(this.cR=this.dR(),this.ER=this.fR(),this.lR=this.wR+this.ER+this.cR,this.vR=!1),this.lR},this.pR=function(){return this.hR(),this.cR},this.dR=function(){return""}},g.DS.gR=function(t){g.DS.gR.Jm.constructor.call(this),(this.bR=function(){return this.ZO},this.yR=function(t){this.lR=null,this.vR=!0,this.ZO=t,this.cR=stohex(this.ZO)},this.TR=function(t){this.lR=null,this.vR=!0,this.ZO=null,this.cR=t},this.dR=function(){return this.cR},void 0!==t&&("string"==typeof t?this.yR(t):void 0!==t.str?this.yR(t.str):void 0!==t.mR&&this.TR(t.mR)))},f.lang.extend(g.DS.gR,g.DS.aR),g.DS.OR=function(t){g.DS.OR.Jm.constructor.call(this),(this.SR=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.RR=function(t,i,n){var r=this._R,s=this.SR(t),e=String(s.getFullYear());"utc"==i&&(e=e.substr(2,2));var h=e+r(String(s.getMonth()+1),2)+r(String(s.getDate()),2)+r(String(s.getHours()),2)+r(String(s.getMinutes()),2)+r(String(s.getSeconds()),2);if(!0===n){var o=s.getMilliseconds();if(0!=o){var u=r(String(o),3);h=h+"."+(u=u.replace(/[0]+$/,""))}}return h+"Z"},this._R=function(t,i){return t.length>=i?t:new Array(i-t.length+1).join("0")+t},this.bR=function(){return this.ZO},this.yR=function(t){this.lR=null,this.vR=!0,this.ZO=t,this.cR=stohex(t)},this.IR=function(t,i,n,r,s,e){var h=new Date(Date.UTC(t,i-1,n,r,s,e,0));this.AR(h)},this.dR=function(){return this.cR})},f.lang.extend(g.DS.OR,g.DS.aR),g.DS.NR=function(t){g.DS.gR.Jm.constructor.call(this),(this.kR=function(t){this.lR=null,this.vR=!0,this.CR=t},this.DR=function(t){this.lR=null,this.vR=!0,this.CR.push(t)},this.CR=new Array(),void 0!==t&&void 0!==t.tR&&(this.CR=t.tR))},f.lang.extend(g.DS.NR,g.DS.aR),g.DS.FS=function(){g.DS.FS.Jm.constructor.call(this),this.wR="01",this.lR="0101ff"},f.lang.extend(g.DS.FS,g.DS.aR),g.DS.GS=function(t){g.DS.GS.Jm.constructor.call(this),this.wR="02",this.MR=function(t){this.lR=null,this.vR=!0,this.cR=g.DS.MS.PS(t)},this.jR=function(t){var i=new j(String(t),10);this.MR(i)},this.PR=function(t){this.cR=t},this.dR=function(){return this.cR},void 0!==t&&(void 0!==t.LR?this.MR(t.LR):void 0!==t.HR?this.jR(t.HR):"number"==typeof t?this.jR(t):void 0!==t.mR&&this.PR(t.mR))},f.lang.extend(g.DS.GS,g.DS.aR),g.DS.xS=function(t){g.DS.xS.Jm.constructor.call(this),this.wR="03",this.UR=function(t){this.lR=null,this.vR=!0,this.cR=t},this.FR=function(t,i){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.lR=null,this.vR=!0,this.cR=n+i},this.GR=function(t){var i=8-(t=t.replace(/0+$/,"")).length%8;8==i&&(i=0);for(var n=0;n<=i;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var s=t.substr(n,8),e=parseInt(s,2).toString(16);1==e.length&&(e="0"+e),r+=e}this.lR=null,this.vR=!0,this.cR="0"+i+r},this.xR=function(t){for(var i="",n=0;n<t.length;n++)1==t[n]?i+="1":i+="0";this.GR(i)},this.BR=function(t){for(var i=new Array(t),n=0;n<t;n++)i[n]=!1;return i},this.dR=function(){return this.cR},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.UR(t):void 0!==t.mR?this.UR(t.mR):void 0!==t.VR?this.GR(t.VR):void 0!==t.tR&&this.xR(t.tR))},f.lang.extend(g.DS.xS,g.DS.aR),g.DS.BS=function(t){g.DS.BS.Jm.constructor.call(this,t),this.wR="04"},f.lang.extend(g.DS.BS,g.DS.gR),g.DS.VS=function(){g.DS.VS.Jm.constructor.call(this),this.wR="05",this.lR="0500"},f.lang.extend(g.DS.VS,g.DS.aR),g.DS.qS=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function e(t){var i="",n=new j(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}g.DS.qS.Jm.constructor.call(this),this.wR="06",this.PR=function(t){this.lR=null,this.vR=!0,this.ZO=null,this.cR=t},this.qR=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",n=t.split("."),r=40*parseInt(n[0])+parseInt(n[1]);i+=o(r),n.splice(0,2);for(var s=0;s<n.length;s++)i+=e(n[s]);this.lR=null,this.vR=!0,this.ZO=null,this.cR=i},this.QR=function(t){if(void 0===g.DS.WR.KR.YR[t])throw"DERObjectIdentifier oidName undefined: "+t;var i=g.DS.WR.KR.YR[t];this.qR(i)},this.dR=function(){return this.cR},void 0!==t&&("string"==typeof t&&t.match(/^[0-2].[0-9.]+$/)?this.qR(t):void 0!==g.DS.WR.KR.YR[t]?this.qR(g.DS.WR.KR.YR[t]):void 0!==t.$R?this.qR(t.$R):void 0!==t.mR?this.PR(t.mR):void 0!==t.name&&this.QR(t.name))},f.lang.extend(g.DS.qS,g.DS.aR),g.DS.QS=function(t){g.DS.QS.Jm.constructor.call(this),this.wR="0a",this.MR=function(t){this.lR=null,this.vR=!0,this.cR=g.DS.MS.PS(t)},this.jR=function(t){var i=new j(String(t),10);this.MR(i)},this.PR=function(t){this.cR=t},this.dR=function(){return this.cR},void 0!==t&&(void 0!==t.HR?this.jR(t.HR):"number"==typeof t?this.jR(t):void 0!==t.mR&&this.PR(t.mR))},f.lang.extend(g.DS.QS,g.DS.aR),g.DS.YS=function(t){g.DS.YS.Jm.constructor.call(this,t),this.wR="0c"},f.lang.extend(g.DS.YS,g.DS.gR),g.DS.KS=function(t){g.DS.KS.Jm.constructor.call(this,t),this.wR="12"},f.lang.extend(g.DS.KS,g.DS.gR),g.DS.WS=function(t){g.DS.WS.Jm.constructor.call(this,t),this.wR="13"},f.lang.extend(g.DS.WS,g.DS.gR),g.DS.$S=function(t){g.DS.$S.Jm.constructor.call(this,t),this.wR="14"},f.lang.extend(g.DS.$S,g.DS.gR),g.DS.XS=function(t){g.DS.XS.Jm.constructor.call(this,t),this.wR="16"},f.lang.extend(g.DS.XS,g.DS.gR),g.DS.JS=function(t){g.DS.JS.Jm.constructor.call(this,t),this.wR="17",this.AR=function(t){this.lR=null,this.vR=!0,this.XR=t,this.ZO=this.RR(this.XR,"utc"),this.cR=stohex(this.ZO)},this.dR=function(){return void 0===this.XR&&void 0===this.ZO&&(this.XR=new Date(),this.ZO=this.RR(this.XR,"utc"),this.cR=stohex(this.ZO)),this.cR},void 0!==t&&(void 0!==t.str?this.yR(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.yR(t):void 0!==t.mR?this.TR(t.mR):void 0!==t.XR&&this.AR(t.XR))},f.lang.extend(g.DS.JS,g.DS.OR),g.DS.zS=function(t){g.DS.zS.Jm.constructor.call(this,t),this.wR="18",this.JR=!1,this.AR=function(t){this.lR=null,this.vR=!0,this.XR=t,this.ZO=this.RR(this.XR,"gen",this.JR),this.cR=stohex(this.ZO)},this.dR=function(){return void 0===this.XR&&void 0===this.ZO&&(this.XR=new Date(),this.ZO=this.RR(this.XR,"gen",this.JR),this.cR=stohex(this.ZO)),this.cR},void 0!==t&&(void 0!==t.str?this.yR(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.yR(t):void 0!==t.mR?this.TR(t.mR):void 0!==t.XR&&this.AR(t.XR),!0===t.zR&&(this.JR=!0))},f.lang.extend(g.DS.zS,g.DS.OR),g.DS.ZS=function(t){g.DS.ZS.Jm.constructor.call(this,t),this.wR="30",this.dR=function(){for(var t="",i=0;i<this.CR.length;i++)t+=this.CR[i].hR();return this.cR=t,this.cR}},f.lang.extend(g.DS.ZS,g.DS.NR),g.DS.iR=function(t){g.DS.iR.Jm.constructor.call(this,t),this.wR="31",this.ZR=!0,this.dR=function(){for(var t=new Array(),i=0;i<this.CR.length;i++){var n=this.CR[i];t.push(n.hR())}return 1==this.ZR&&t.sort(),this.cR=t.join(""),this.cR},void 0!==t&&void 0!==t.t_&&0==t.t_&&(this.ZR=!1)},f.lang.extend(g.DS.iR,g.DS.NR),g.DS.nR=function(t){g.DS.nR.Jm.constructor.call(this),this.wR="a0",this.cR="",this.i_=!0,this.n_=null,this.r_=function(t,i,n){this.wR=i,this.i_=t,this.n_=n,this.i_?(this.cR=this.n_.hR(),this.lR=null,this.vR=!0):(this.cR=null,this.lR=n.hR(),this.lR=this.lR.replace(/^../,i),this.vR=!1)},this.dR=function(){return this.cR},void 0!==t&&(void 0!==t.tag&&(this.wR=t.tag),void 0!==t.rR&&(this.i_=t.rR),void 0!==t.sR&&(this.n_=t.sR,this.r_(this.i_,this.wR,this.n_)))},f.lang.extend(g.DS.nR,g.DS.aR),void 0!==g&&g||(g={}),void 0!==g.crypto&&g.crypto||(g.crypto={}),g.crypto.s_=new(function(){this.e_={sha1:"3021300906052b0e03021a05000414",h_:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",o_:"3041300d060960864801650304020205000430",u_:"3051300d060960864801650304020305000440",a_:"3020300c06082a864886f70d020205000410",f_:"3020300c06082a864886f70d020505000410",c_:"3021300906052b2403020105000414"},this.l_={f_:"cryptojs",sha1:"cryptojs",h_:"cryptojs",sha256:"cryptojs",o_:"cryptojs",u_:"cryptojs",c_:"cryptojs",v_:"cryptojs",d_:"cryptojs",E_:"cryptojs",w_:"cryptojs",p_:"cryptojs",g_:"cryptojs",b_:"cryptojs",y_:"cryptojs/jsrsa",T_:"cryptojs/jsrsa",m_:"cryptojs/jsrsa",O_:"cryptojs/jsrsa",S_:"cryptojs/jsrsa",R_:"cryptojs/jsrsa",__:"cryptojs/jsrsa",I_:"cryptojs/jsrsa",A_:"cryptojs/jsrsa",N_:"cryptojs/jsrsa",k_:"cryptojs/jsrsa",C_:"cryptojs/jsrsa",D_:"cryptojs/jsrsa",M_:"cryptojs/jsrsa",j_:"cryptojs/jsrsa",P_:"cryptojs/jsrsa",L_:"cryptojs/jsrsa",H_:"cryptojs/jsrsa",U_:"cryptojs/jsrsa",F_:"cryptojs/jsrsa",G_:"cryptojs/jsrsa",x_:"cryptojs/jsrsa",B_:"cryptojs/jsrsa",V_:"cryptojs/jsrsa"},this.q_={f_:A.kO.ev,sha1:A.kO.MO,h_:A.kO.Q_,sha256:A.kO.Y_,o_:A.kO.K_,u_:A.kO.W_,c_:A.kO.X_},this.J_=function(t,i){if(void 0===this.e_[i])throw"alg not supported in Util.DIGESTINFOHEAD: "+i;return this.e_[i]+t},this.z_=function(t,i,n){var r=this.J_(t,i),s=n/4;if(r.length+22>s)throw"key is too short for SigAlg: keylen="+n+","+i;for(var e="00"+r,h="",o=s-"0001".length-e.length,u=0;u<o;u+=2)h+="ff";return"0001"+h+e},this.Z_=function(t,i){return new g.crypto.iI({nI:i}).tI(t)},this.rI=function(t,i){return new g.crypto.iI({nI:i}).sI(t)},this.sha1=function(t){return new g.crypto.iI({nI:"sha1",eI:"cryptojs"}).tI(t)},this.sha256=function(t){return new g.crypto.iI({nI:"sha256",eI:"cryptojs"}).tI(t)},this.hI=function(t){return new g.crypto.iI({nI:"sha256",eI:"cryptojs"}).sI(t)},this.u_=function(t){return new g.crypto.iI({nI:"sha512",eI:"cryptojs"}).tI(t)},this.oI=function(t){return new g.crypto.iI({nI:"sha512",eI:"cryptojs"}).sI(t)},this.f_=function(t){return new g.crypto.iI({nI:"md5",eI:"cryptojs"}).tI(t)},this.c_=function(t){return new g.crypto.iI({nI:"ripemd160",eI:"cryptojs"}).tI(t)},this.uI=function(t){}})(),g.crypto.iI=function(t){this.aI=function(i,t){if(null!=i&&void 0===t&&(t=g.crypto.s_.l_[i]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)&&"cryptojs"==t){try{this.fI=g.crypto.s_.q_[i].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.cI=function(t){this.fI.update(t)},this.lI=function(t){var i=A.cO.lO.parse(t);this.fI.update(i)},this.digest=function(){return this.fI.RO().toString(A.cO.lO)},this.tI=function(t){return this.cI(t),this.digest()},this.sI=function(t){return this.lI(t),this.digest()}}if(-1!=":sha256:".indexOf(i)&&"sjcl"==t){try{this.fI=new sjcl.hash.sha256()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.cI=function(t){this.fI.update(t)},this.lI=function(t){var i=sjcl.dI.mR.vI(t);this.fI.update(i)},this.digest=function(){var t=this.fI.RO();return sjcl.dI.mR.EI(t)},this.tI=function(t){return this.cI(t),this.digest()},this.sI=function(t){return this.lI(t),this.digest()}}},this.cI=function(t){throw"updateString(str) not supported for this alg/prov: "+this.wI+"/"+this.pI},this.lI=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.wI+"/"+this.pI},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.wI+"/"+this.pI},this.tI=function(t){throw"digestString(str) not supported for this alg/prov: "+this.wI+"/"+this.pI},this.sI=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.wI+"/"+this.pI},void 0!==t&&void 0!==t.nI&&(this.wI=t.nI,void 0===t.eI&&(this.pI=g.crypto.s_.l_[this.wI]),this.aI(this.wI,this.pI))},g.crypto.gI=function(t){this.aI=function(t,i){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===i&&(i=g.crypto.s_.l_[t]),this.bI=t+"/"+i;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==i){try{var r=g.crypto.s_.q_[n];this.mac=A.kO.NO.create(r,this.yI)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.cI=function(t){this.mac.update(t)},this.lI=function(t){var i=A.cO.lO.parse(t);this.mac.update(i)},this.TI=function(){return this.mac.RO().toString(A.cO.lO)},this.mI=function(t){return this.cI(t),this.TI()},this.OI=function(t){return this.lI(t),this.TI()}}},this.cI=function(t){throw"updateString(str) not supported for this alg/prov: "+this.bI},this.lI=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.bI},this.TI=function(){throw"digest() not supported for this alg/prov: "+this.bI},this.mI=function(t){throw"digestString(str) not supported for this alg/prov: "+this.bI},this.OI=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.bI},this.SI=function(t){if("string"==typeof t){var i=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(i=rstrtohex(t)),void (this.yI=A.cO.lO.parse(i))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;i=null;if(void 0!==t.mR){if(t.mR.length%2!=0||!t.mR.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.mR;i=t.mR}if(void 0!==t.RI&&(i=utf8tohex(t.RI)),void 0!==t._I&&(i=rstrtohex(t._I)),void 0!==t.II&&(i=M(t.II)),void 0!==t.AI&&(i=b64utohex(t.AI)),null==i)throw"KJUR.crypto.Mac unsupported password type: "+t;this.yI=A.cO.lO.parse(i)},void 0!==t&&(void 0!==t.yI&&this.SI(t.yI),void 0!==t.nI&&(this.wI=t.nI,void 0===t.eI&&(this.pI=g.crypto.s_.l_[this.wI]),this.aI(this.wI,this.pI)))},g.crypto.Signature=function(t){var i=null;if(this.NI=function(){this.wI.match(/^(.+)with(.+)$/)&&(this.kI=RegExp.$1.toLowerCase(),this.CI=RegExp.$2.toLowerCase())},this.DI=function(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t},this.aI=function(t,i){if(this.NI(),"cryptojs/jsrsa"!=i)throw"provider not supported: "+i;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.kI)){try{this.fI=new g.crypto.iI({nI:this.kI})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.kI+"/"+t}this.init=function(t,i){var n=null;try{n=void 0===i?KEYUTIL.getKey(t):KEYUTIL.getKey(t,i)}catch(t){throw"init failed:"+t}if(!0===n.MI)this.jI=n,this.state="SIGN";else{if(!0!==n.NS)throw"init failed.:"+n;this.LI=n,this.state="VERIFY"}},this.HI=function(t){"string"==typeof t.UI&&"string"==typeof t.FI?(this.UI=t.UI,this.FI=t.FI):this.jI=t,this.state="SIGN"},this.GI=function(t){"string"==typeof t.xI&&"string"==typeof t.FI?(this.xI=t.xI,this.FI=t.FI):t instanceof g.crypto.BI?this.LI=t:t instanceof W&&(this.LI=t),this.state="VERIFY"},this.VI=function(t){var i=new X509();i.qI(t),this.LI=i.QI,this.state="VERIFY"},this.cI=function(t){this.fI.cI(t)},this.lI=function(t){this.fI.lI(t)},this.sign=function(){if(this.YI=this.fI.digest(),void 0!==this.UI&&void 0!==this.FI){var t=new g.crypto.BI({curve:this.FI});this.KI=t.WI(this.YI,this.UI)}else if(this.jI instanceof W&&"rsaandmgf1"==this.CI)this.KI=this.jI.$I(this.YI,this.kI,this.XI);else if(this.jI instanceof W&&"rsa"==this.CI)this.KI=this.jI.JI(this.YI,this.kI);else if(this.jI instanceof g.crypto.BI)this.KI=this.jI.JI(this.YI);else{if(!(this.jI instanceof g.crypto.zI))throw"Signature: unsupported public key alg: "+this.CI;this.KI=this.jI.JI(this.YI)}return this.KI},this.ZI=function(t){return this.cI(t),this.sign()},this.WI=function(t){return this.lI(t),this.sign()},this.verify=function(t){if(this.YI=this.fI.digest(),void 0!==this.xI&&void 0!==this.FI)return new g.crypto.BI({curve:this.FI}).tA(this.YI,t,this.xI);if(this.LI instanceof W&&"rsaandmgf1"==this.CI)return this.LI.iA(this.YI,t,this.kI,this.XI);if(this.LI instanceof W&&"rsa"==this.CI)return this.LI.nA(this.YI,t);if(this.LI instanceof g.crypto.BI)return this.LI.nA(this.YI,t);if(this.LI instanceof g.crypto.zI)return this.LI.nA(this.YI,t);throw"Signature: unsupported public key alg: "+this.CI}}},this.init=function(t,i){throw"init(key, pass) not supported for this alg:prov="+this.rA},this.GI=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.rA},this.VI=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.rA},this.HI=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.rA},this.cI=function(t){throw"updateString(str) not supported for this alg:prov="+this.rA},this.lI=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.rA},this.sign=function(){throw"sign() not supported for this alg:prov="+this.rA},this.ZI=function(t){throw"digestString(str) not supported for this alg:prov="+this.rA},this.WI=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.rA},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.rA},void 0!==(this.sA=t)&&(void 0!==t.nI&&(this.wI=t.nI,void 0===t.eI?this.pI=g.crypto.s_.l_[this.wI]:this.pI=t.eI,this.rA=this.wI+":"+this.pI,this.aI(this.wI,this.pI),this.NI()),void 0!==t.eA&&(this.XI=t.eA),void 0!==t.hA)){if(void 0!==t.oA)throw"both prvkeypem and prvkeypas parameters not supported";try{(i=new W()).uA(t.hA),this.HI(i)}catch(t){throw"fatal error to load pem private key: "+t}}},g.crypto.KR=new function(){this.aA={fA:"rsaEncryption",cA:"ecPublicKey",lA:"dsa",vA:"secp256r1",dA:"secp192k1",EA:"secp224r1",wA:"secp256k1",pA:"secp521r1",gA:"secp384r1",bA:"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}}();var $=new RegExp("");function X(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t}function J(t,i){var n,r=(n=t,g.crypto.s_.Z_(n,i));return this.JI(r,i)}function z(t){return J.call(this,t,"sha1")}function Z(t){return J.call(this,t,"sha256")}function tt(t,i,n){for(var r="",s=0;r.length<i;)r+=hextorstr(n(rstrtohex(t+String.fromCharCode.apply(String,[(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s])))),s+=1;return r}function it(t,i,n){var r,s=(r=rstrtohex(t),g.crypto.s_.rI(r,i));return void 0===n&&(n=-1),this.$I(s,i,n)}function nt(t,i,n){return function(t,i,n){var r=new W();return r.IS(i,n),r._S(t)}(t,i,n).toString(16).replace(/^1f+00/,"")}function rt(t){for(var i in g.crypto.s_.e_){var n=g.crypto.s_.e_[i],r=n.length;if(t.substring(0,r)==n)return[i,t.substring(r)]}return[]}function st(t,i){return function(t,i,n,r){var s=rt(nt(i,n,r));if(0==s.length)return!1;var e,h=s[0];return s[1]==(e=t,g.crypto.s_.Z_(e,h))}(i,Q(t,16),this.n.toString(16),this.e.toString(16))}function et(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.gS()>this.n.gS())return 0;var r=rt(this._S(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var s,e=r[0];return r[1]==(s=t,g.crypto.s_.Z_(s,e))}function ht(t,i,n,r){var s,e=(s=rstrtohex(t),g.crypto.s_.rI(s,n));return void 0===r&&(r=-1),this.iA(e,i,n,r)}$.compile("[^0-9a-f]","gi"),W.prototype.JI=function(t,i){var n=Q(g.crypto.s_.z_(t,i,this.n.gS()),16);return X(this.yA(n).toString(16),this.n.gS())},W.prototype.ZI=J,W.prototype.TA=z,W.prototype.mA=Z,W.prototype.sign=J,W.prototype.OA=z,W.prototype.SA=Z,W.prototype.$I=function(t,i,n){function r(t){return g.crypto.s_.rI(t,i)}var s,e=hextorstr(t),h=e.length,o=this.n.gS()-1,u=Math.ceil(o/8);if(-1===n||void 0===n)n=h;else if(-2===n)n=u-h-2;else if(n<-2)throw"invalid salt length";if(u<h+n+2)throw"data too long";var a="";0<n&&(a=new Array(n),new SecureRandom().kS(a),a=String.fromCharCode.apply(String,a));var f=hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+e+a))),c=[];for(s=0;s<u-n-h-2;s+=1)c[s]=0;var l=String.fromCharCode.apply(String,c)+"\x01"+a,v=tt(f,l.length,r),d=[];for(s=0;s<l.length;s+=1)d[s]=l.charCodeAt(s)^v.charCodeAt(s);var E=65280>>8*u-o&255;for(d[0]&=~E,s=0;s<h;s++)d.push(f.charCodeAt(s));return d.push(188),X(this.yA(new j(d)).toString(16),this.n.gS())},W.prototype.RA=it,W.prototype._A=it,W.IA=-1,W.AA=-2,W.prototype.nA=function(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.gS()>this.n.gS())return 0;var r=rt(this._S(n).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==t)},W.prototype.NA=et,W.prototype.kA=st,W.prototype.verify=et,W.prototype.CA=st,W.prototype.iA=function(t,i,n,r){var s=new j(i,16);if(s.gS()>this.n.gS())return!1;function e(t){return g.crypto.s_.rI(t,n)}var h,o=hextorstr(t),u=o.length,a=this.n.gS()-1,f=Math.ceil(a/8);if(-1===r||void 0===r)r=u;else if(-2===r)r=f-u-2;else if(r<-2)throw"invalid salt length";if(f<u+r+2)throw"data too long";var c=this._S(s).DA();for(h=0;h<c.length;h+=1)c[h]&=255;for(;c.length<f;)c.unshift(0);if(188!==c[f-1])throw"encoded message does not end in 0xbc";var l=(c=String.fromCharCode.apply(String,c)).substr(0,f-u-1),v=c.substr(l.length,u),d=65280>>8*f-a&255;if(0!=(l.charCodeAt(0)&d))throw"bits beyond keysize not zero";var E=tt(v,l.length,e),w=[];for(h=0;h<l.length;h+=1)w[h]=l.charCodeAt(h)^E.charCodeAt(h);w[0]&=~d;var p=f-u-r-2;for(h=0;h<p;h+=1)if(0!==w[h])throw"leftmost octets not zero";if(1!==w[p])throw"0x01 marker not found";return v===hextorstr(e(rstrtohex("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,w.slice(-r)))))},W.prototype.MA=ht,W.prototype.jA=ht,W.PA=-2,i.LA=j,i.HA=W,i.Signature=g.crypto.Signature,i.iI=g.crypto.iI,i.sv=A,i.UA=M,i.FA=function(t){var i,n=M(t),r=new Array();for(i=0;2*i<n.length;++i)r[i]=parseInt(n.substring(2*i,2*i+2),16);return r}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(141),s=n(151),e=(h.GA=function(t,i,n){return this.xA(t,i,n)||-1!=t.indexOf(h.BA)},h.xA=function(t,i,n){var r=-1!=t.toLowerCase().indexOf(h.VA.toLowerCase())||-1!=t.toLowerCase().indexOf(h.qA.toLowerCase());if(n){if(n.test(t))return!0;!r&&i&&i.warn(this.loggerId+"Context matcher set to "+n+" failed against "+t)}return r},h.QA=function(t,i){var n=i.replace("_definst_/","").match(new RegExp(t.replace(".mpd","")+h.YA));return n&&0<n.length},h.KA=function(t,i,n){return 0<t.indexOf(h.qA)?new s.WA(i,n):new r.$A(i,n)},h.loggerId="[DASH] ",h.XA=1,h.JA=2,h.zA=2e3,h.ZA=3e4,h.tN=1e4,h.iN=!0,h.nN=!0,h.rN=500,h.sN=16,h.eN=3,h.hN=10,h.DASH_METADATA_MIN_FRAGMENTS=3,h.VA="(format=mpd-time-csf)",h.qA=".mpd",h.YA="_.*.mpd",h.BA=".m4s",h.oN=".ism/",h);function h(){}i.DASH=e},function(t,i,n){"use strict";n(10);var s=n(142),r=n(11),e=n(56),h=n(12);function o(t,n,r,i){if(!(this instanceof o))return new o(t,n,r,i);n=n||Object.Ae,r=r||Object.compare,i=i||Function.Ne,this.ke=n,this.Hf=r,this.De=i,this.store=new s(null,function(t,i){return n(t.key,i.key)},function(t,i){return r(t.key,i.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).SortedMap=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.je=function(t){return new this.constructor(t,this.ke,this.Hf,this.De)},o.prototype.log=function(t,r,i,n){r=r||this.Pe,this.store.log(t,function(t,i,n){r(t.value,i,n)},i,n)},o.prototype.Pe=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(88),o=n(89),u=(e=o.uN,s(a,e),a.prototype.send=function(){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");if(!this.pluginId){var t=Object.keys(a.aN);0<t.length&&(this.pluginId=a.aN[t[0]])}h["default"].Z().request(this,this.pluginId)},a.prototype.abort=function(){h["default"].Z().abort(this,this.pluginId)},a.Sv=0,a);function a(t){var i=e.call(this,t)||this;return i.DONE=4,i.LOADING=3,i.HEADERS_RECEIVED=2,i.OPENED=1,i.UNSENT=0,i.internal=!1,i.id=a.Sv++,i}i.HiveRequest=u},function(t,i,n){var r,s,e;s=[n(176)],void 0===(e="function"==typeof (r=function(u){"use strict";var d=function(t,i,n){if(void 0===t&&(t=d.fN),void 0===i&&(i=d.cN),void 0===n&&(n=d.lN),!n){if((t|=0)<0)throw RangeError("Illegal capacity");i=!!i,n=!!n}this.buffer=0===t?e:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.vN=-1,this.dN=t,this.EN=void 0!==i&&!!i,this.wN=!!n};d.VERSION="4.1.0",d.pN=!0,d.gN=!1,d.fN=16,d.cN=d.gN,d.lN=!1,d.bN=u||null;var h=d.prototype;h.yN,Object.defineProperty(h,"yN",{value:!0,enumerable:!1,configurable:!1});var e=new ArrayBuffer(0),n=String.fromCharCode;function o(t){var i=0;return function(){return i<t.length?t.charCodeAt(i++):null}}function a(){var t=[],i=[];return function(){if(0===arguments.length)return i.join("")+n.apply(String,t);1024<t.length+arguments.length&&(i.push(n.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}}function r(t,i,n,r,s){var e,h,o=8*s-r-1,u=(1<<o)-1,a=u>>1,f=-7,c=n?s-1:0,l=n?-1:1,v=t[i+c];for(c+=l,e=v&(1<<-f)-1,v>>=-f,f+=o;0<f;e=256*e+t[i+c],c+=l,f-=8);for(h=e&(1<<-f)-1,e>>=-f,f+=r;0<f;h=256*h+t[i+c],c+=l,f-=8);if(0===e)e=1-a;else{if(e===u)return h?NaN:1/0*(v?-1:1);h+=Math.pow(2,r),e-=a}return(v?-1:1)*h*Math.pow(2,e-r)}function s(t,i,n,r,s,e){var h,o,u,a=8*e-s-1,f=(1<<a)-1,c=f>>1,l=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,v=r?0:e-1,d=r?1:-1,E=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(o=isNaN(i)?1:0,h=f):(h=Math.floor(Math.log(i)/Math.LN2),i*(u=Math.pow(2,-h))<1&&(h--,u*=2),2<=(i+=1<=h+c?l/u:l*Math.pow(2,1-c))*u&&(h++,u/=2),f<=h+c?(o=0,h=f):1<=h+c?(o=(i*u-1)*Math.pow(2,s),h+=c):(o=i*Math.pow(2,c-1)*Math.pow(2,s),h=0));8<=s;t[n+v]=255&o,v+=d,o/=256,s-=8);for(h=h<<s|o,a+=s;0<a;t[n+v]=255&h,v+=d,h/=256,a-=8);t[n+v-d]|=128*E}d.TN=function(){return Uint8Array},d.mN=function(t,i,n){return new d(t,i,n)},d.concat=function(t,i,n,r){"boolean"!=typeof i&&"string"==typeof i||(r=n,n=i,i=void 0);for(var s,e=0,h=0,o=t.length;h<o;++h)d.ON(t[h])||(t[h]=d.wrap(t[h],i)),0<(s=t[h].dN-t[h].offset)&&(e+=s);if(0===e)return new d(0,n,r);var u,a=new d(e,n,r);for(h=0;h<o;)(s=(u=t[h++]).dN-u.offset)<=0||(a.view.set(u.view.subarray(u.offset,u.dN),a.offset),a.offset+=s);return a.dN=a.offset,a.offset=0,a},d.ON=function(t){return!0===(t&&t.yN)},d.type=function(){return ArrayBuffer},d.wrap=function(t,i,n,r){if("string"!=typeof i&&(r=n,n=i,i=void 0),"string"==typeof t)switch(void 0===i&&(i="utf8"),i){case"base64":return d.SN(t,n);case"hex":return d.RN(t,n);case"binary":return d._N(t,n);case"utf8":return d.IN(t,n);case"debug":return d.AN(t,n);default:throw Error("Unsupported encoding: "+i)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var s;if(d.ON(t))return(s=h.clone.call(t)).vN=-1,s;if(t instanceof Uint8Array)s=new d(0,n,r),0<t.length&&(s.buffer=t.buffer,s.offset=t.byteOffset,s.dN=t.byteOffset+t.byteLength,s.view=new Uint8Array(t.buffer));else if(t instanceof ArrayBuffer)s=new d(0,n,r),0<t.byteLength&&(s.buffer=t,s.offset=0,s.dN=t.byteLength,s.view=0<t.byteLength?new Uint8Array(t):null);else{if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");(s=new d(t.length,n,r)).dN=t.length;for(var e=0;e<t.length;++e)s.view[e]=t[e]}return s},h.NN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+"+t+") <= "+this.buffer.byteLength)}var r=this.slice(i,i+t);return n&&(this.offset+=t),r},h.kN=h.append,h.CN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.Fw=h.CN,h.DN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return 128==(128&n)&&(n=-(255-n+1)),i&&(this.offset+=1),n},h.op=h.DN,h.MN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.jN=h.MN,h.PN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return i&&(this.offset+=1),n},h.LN=h.PN,h.HN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.EN?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.UN=h.HN,h.FN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.EN?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),32768==(32768&n)&&(n=-(65535-n+1)),i&&(this.offset+=2),n},h.GN=h.FN,h.xN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.EN?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.BN=h.xN,h.VN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.EN?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),i&&(this.offset+=2),n},h.qN=h.VN,h.QN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.EN?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.hv=h.QN,h.YN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.EN?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),n|=0,i&&(this.offset+=4),n},h.Ev=h.YN,h.KN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.EN?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.WN=h.KN,h.$N=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.EN?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i&&(this.offset+=4),n},h.XN=h.$N,u&&(h.JN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"==typeof t)t=u.PO(t);else if("string"==typeof t)t=u.LO(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.PO(t):"string"==typeof t&&(t=u.LO(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.EN?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.zN=h.JN,h.ZN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.EN?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!1);return i&&(this.offset+=8),s},h.tk=h.ZN,h.ik=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"==typeof t)t=u.PO(t);else if("string"==typeof t)t=u.LO(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.PO(t):"string"==typeof t&&(t=u.LO(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.EN?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.nk=h.ik,h.rk=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.EN?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!0);return i&&(this.offset+=8),s},h.sk=h.rk),h.ek=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,s(this.view,t,i,this.EN,23,4),n&&(this.offset+=4),this},h.hk=h.ek,h.uk=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.EN,23,4);return i&&(this.offset+=4),n},h.ak=h.uk,h.fk=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=8;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=8,s(this.view,t,i,this.EN,52,8),n&&(this.offset+=8),this},h.Bw=h.fk,h.ck=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.EN,52,8);return i&&(this.offset+=8),n},h.fp=h.ck,d.lk=5,d.vk=function(t){return(t>>>=0)<128?1:t<16384?2:t<1<<21?3:t<1<<28?4:5},d.dk=function(t){return((t|=0)<<1^t>>31)>>>0},d.Ek=function(t){return t>>>1^-(1&t)|0},h.wk=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=d.vk(t);i+=s;var e=this.buffer.byteLength;for(e<i&&this.resize((e*=2)>i?e:i),i-=s,t>>>=0;128<=t;)r=127&t|128,this.view[i++]=r,t>>>=7;return this.view[i++]=t,n?(this.offset=i,this):s},h.pk=function(t,i){return this.wk(d.dk(t),i)},h.gk=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=0,s=0;do{if(!this.wN&&t>this.dN){var e=Error("Truncated");throw e.bk=!0,e}n=this.view[t++],r<5&&(s|=(127&n)<<7*r),++r}while(0!=(128&n));return s|=0,i?(this.offset=t,s):{value:s,length:r}},h.yk=function(t){var i=this.gk(t);return"object"==typeof i?i.value=d.Ek(i.value):i=d.Ek(i),i},u&&(d.Tk=10,d.mk=function(t){"number"==typeof t?t=u.PO(t):"string"==typeof t&&(t=u.LO(t));var i=t.Ok()>>>0,n=t.Sk(28).Ok()>>>0,r=t.Sk(56).Ok()>>>0;return 0==r?0==n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10},d.Rk=function(t){return"number"==typeof t?t=u.PO(t,!1):"string"==typeof t?t=u.LO(t,!1):!1!==t._k&&(t=t.Ik()),t.shiftLeft(1).xor(t.Nk(63)).Ak()},d.kk=function(t){return"number"==typeof t?t=u.PO(t,!1):"string"==typeof t?t=u.LO(t,!1):!1!==t._k&&(t=t.Ik()),t.Sk(1).xor(t.and(u.ONE).Ik().wS()).Ik()},h.Ck=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("number"==typeof t)t=u.PO(t);else if("string"==typeof t)t=u.LO(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.PO(t,!1):"string"==typeof t?t=u.LO(t,!1):!1!==t._k&&(t=t.Ik());var r=d.mk(t),s=t.Ok()>>>0,e=t.Sk(28).Ok()>>>0,h=t.Sk(56).Ok()>>>0;i+=r;var o=this.buffer.byteLength;switch(o<i&&this.resize((o*=2)>i?o:i),i-=r,r){case 10:this.view[i+9]=h>>>7&1;case 9:this.view[i+8]=9!==r?128|h:127&h;case 8:this.view[i+7]=8!==r?e>>>21|128:e>>>21&127;case 7:this.view[i+6]=7!==r?e>>>14|128:e>>>14&127;case 6:this.view[i+5]=6!==r?e>>>7|128:e>>>7&127;case 5:this.view[i+4]=5!==r?128|e:127&e;case 4:this.view[i+3]=4!==r?s>>>21|128:s>>>21&127;case 3:this.view[i+2]=3!==r?s>>>14|128:s>>>14&127;case 2:this.view[i+1]=2!==r?s>>>7|128:s>>>7&127;case 1:this.view[i]=1!==r?128|s:127&s}return n?(this.offset+=r,this):r},h.Dk=function(t,i){return this.Ck(d.Rk(t),i)},h.Mk=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=t,r=0,s=0,e=0,h=0;if(h=this.view[t++],r=127&h,128&h&&(h=this.view[t++],r|=(127&h)<<7,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<14,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<21,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],s=127&h,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<7,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<14,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<21,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],e=127&h,(128&h||this.wN&&void 0===h)&&(h=this.view[t++],e|=(127&h)<<7,128&h||this.wN&&void 0===h))))))))))throw Error("Buffer overrun");var o=u.EI(r|s<<28,s>>>4|e<<24,!1);return i?(this.offset=t,o):{value:o,length:t-n}},h.jk=function(t){var i=this.Mk(t);return i&&i.value instanceof u?i.value=d.kk(i.value):i=d.kk(i),i}),h.ov=function(t,i){var n=void 0===i;n&&(i=this.offset);var r,s=t.length;if(!this.wN){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(r=0;r<s;++r)if(0===t.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}s=c.Pk(o(t))[1],i+=s+1;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=s+1,c.Lk(o(t),function(t){this.view[i++]=t}.bind(this)),this.view[i++]=0,n?(this.offset=i,this):s},h.gv=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=t,s=-1;return c.Hk(function(){if(0===s)return null;if(t>=this.dN)throw RangeError("Illegal range: Truncated data, "+t+" < "+this.dN);return 0===(s=this.view[t++])?null:s}.bind(this),n=a(),!0),i?(this.offset=t,n()):{string:n(),length:t-r}},h.Uk=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=i;r=c.Pk(o(t),this.wN)[1],i+=4+r;var e=this.buffer.byteLength;if(e<i&&this.resize((e*=2)>i?e:i),i-=4+r,this.EN?(this.view[i+3]=r>>>24&255,this.view[i+2]=r>>>16&255,this.view[i+1]=r>>>8&255,this.view[i]=255&r):(this.view[i]=r>>>24&255,this.view[i+1]=r>>>16&255,this.view[i+2]=r>>>8&255,this.view[i+3]=255&r),i+=4,c.Lk(o(t),function(t){this.view[i++]=t}.bind(this)),i!==s+4+r)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+r));return n?(this.offset=i,this):i-s},h.Fk=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n,r=0,s=t;this.EN?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var e,h=(t+=4)+r;return c.Hk(function(){return t<h?this.view[t++]:null}.bind(this),e=a(),this.wN),n=e(),i?(this.offset=t,n):{string:n,length:t-s}},d.Gk="c",d.xk="b",h.Bk=function(t,i){var n,r=void 0===i;if(r&&(i=this.offset),!this.wN){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var s=i;n=c.Pk(o(t))[1],i+=n;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=n,c.Lk(o(t),function(t){this.view[i++]=t}.bind(this)),r?(this.offset=i,this):i-s},h.xE=h.Bk,d.Vk=function(t){return c.Pk(o(t))[0]},d.qk=function(t){return c.Pk(o(t))[1]},d.Qk=d.qk,h.Yk=function(t,i,n){"number"==typeof i&&(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),void 0===i&&(i=d.Gk),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");if(t|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var s,e=0,h=n;if(i===d.Gk){if(s=a(),c.Kk(function(){return e<t&&n<this.dN?this.view[n++]:null}.bind(this),function(t){++e,c.Wk(t,s)}),e!==t)throw RangeError("Illegal range: Truncated data, "+e+" == "+t);return r?(this.offset=n,s()):{string:s(),length:n-h}}if(i!==d.xk)throw TypeError("Unsupported metrics: "+i);if(!this.wN){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+t+") <= "+this.buffer.byteLength)}var o=n+t;if(c.Hk(function(){return n<o?this.view[n++]:null}.bind(this),s=a(),this.wN),n!==o)throw RangeError("Illegal range: Truncated data, "+n+" == "+o);return r?(this.offset=n,s()):{string:s(),length:n-h}},h.jE=h.Yk,h.$k=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.wN){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s,e=i;r=c.Pk(o(t),this.wN)[1],s=d.vk(r),i+=s+r;var h=this.buffer.byteLength;if(h<i&&this.resize((h*=2)>i?h:i),i-=s+r,i+=this.wk(r,i),c.Lk(o(t),function(t){this.view[i++]=t}.bind(this)),i!==e+r+s)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+r+s));return n?(this.offset=i,this):i-e},h.Xk=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=this.gk(t),s=t;t+=r.length,r=r.value;var e=t+r,h=a();return c.Hk(function(){return t<e?this.view[t++]:null}.bind(this),h,this.wN),n=h(),i?(this.offset=t,n):{string:n,length:t-s}},h.append=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.wN){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.dN-t.offset;if(s<=0)return this;n+=s;var e=this.buffer.byteLength;return e<n&&this.resize((e*=2)>n?e:n),n-=s,this.view.set(t.view.subarray(t.offset,t.dN),n),t.offset+=s,r&&(this.offset+=s),this},h.Jk=function(t,i){return t.append(this,i),this},h.assert=function(t){return this.wN=!t,this},h.zk=function(){return this.buffer.byteLength},h.clear=function(){return this.offset=0,this.dN=this.buffer.byteLength,this.vN=-1,this},h.clone=function(t){var i=new d(0,this.EN,this.wN);return t?(i.buffer=new ArrayBuffer(this.buffer.byteLength),i.view=new Uint8Array(i.buffer)):(i.buffer=this.buffer,i.view=this.view),i.offset=this.offset,i.vN=this.vN,i.dN=this.dN,i},h.compact=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.dN),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(0===t&&i===this.buffer.byteLength)return this;var n=i-t;if(0==n)return this.buffer=e,this.view=null,0<=this.vN&&(this.vN-=t),this.offset=0,this.dN=0,this;var r=new ArrayBuffer(n),s=new Uint8Array(r);return s.set(this.view.subarray(t,i)),this.buffer=r,this.view=s,0<=this.vN&&(this.vN-=t),this.offset=0,this.dN=n,this},h.Zk=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.dN),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t===i)return new d(0,this.EN,this.wN);var n=i-t,r=new d(n,this.EN,this.wN);return r.offset=0,r.dN=n,0<=r.vN&&(r.vN-=t),this.fS(r,0,t,i),r},h.fS=function(t,i,n,r){var s,e;if(!this.wN&&!d.ON(t))throw TypeError("Illegal target: Not a ByteBuffer");if(i=(e=void 0===i)?t.offset:0|i,n=(s=void 0===n)?this.offset:0|n,r=void 0===r?this.dN:0|r,i<0||i>t.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+i+" <= "+t.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var h=r-n;return 0==h?t:(t.tC(i+h),t.view.set(this.view.subarray(n,r),i),s&&(this.offset+=h),e&&(t.offset+=h),this)},h.tC=function(t){var i=this.buffer.byteLength;return i<t?this.resize((i*=2)>t?i:t):this},h.fill=function(t,i,n){var r=void 0===i;if(r&&(i=this.offset),"string"==typeof t&&0<t.length&&(t=t.charCodeAt(0)),void 0===i&&(i=this.offset),void 0===n&&(n=this.dN),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(n<=i)return this;for(;i<n;)this.view[i++]=t;return r&&(this.offset=i),this},h.uv=function(){return this.dN=this.offset,this.offset=0,this},h.mark=function(t){if(t=void 0===t?this.offset:t,!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return this.vN=t,this},h.order=function(t){if(!this.wN&&"boolean"!=typeof t)throw TypeError("Illegal littleEndian: Not a boolean");return this.EN=!!t,this},h.iC=function(t){return this.EN=void 0===t||!!t,this},h.nC=function(t){return this.EN=void 0!==t&&!t,this},h.prepend=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.wN){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.dN-t.offset;if(s<=0)return this;var e=s-n;if(0<e){var h=new ArrayBuffer(this.buffer.byteLength+e),o=new Uint8Array(h);o.set(this.view.subarray(n,this.buffer.byteLength),s),this.buffer=h,this.view=o,this.offset+=e,0<=this.vN&&(this.vN+=e),this.dN+=e,n+=e}else new Uint8Array(this.buffer);return this.view.set(t.view.subarray(t.offset,t.dN),n-s),t.offset=t.dN,r&&(this.offset-=s),this},h.rC=function(t,i){return t.prepend(this,i),this},h.sC=function(t){"function"!=typeof t&&(t=emptyFunction.bind(console)),t(this.toString()+"\n-------------------------------------------------------------------\n"+this.eC(!0))},h.hC=function(){return this.dN-this.offset},h.reset=function(){return 0<=this.vN?(this.offset=this.vN,this.vN=-1):this.offset=0,this},h.resize=function(t){if(!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if((t|=0)<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.byteLength<t){var i=new ArrayBuffer(t),n=new Uint8Array(i);n.set(this.view),this.buffer=i,this.view=n}return this},h.reverse=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.dN),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}return t===i||Array.prototype.reverse.call(this.view.subarray(t,i)),this},h.PE=function(t){if(!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");t|=0}var i=this.offset+t;if(!this.wN&&(i<0||i>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+t+" <= "+this.buffer.byteLength);return this.offset=i,this},h.slice=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.dN),!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=t,n.dN=i,n},h.oC=function(t){var i=this.offset,n=this.dN;if(!this.wN){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(!t&&0===i&&n===this.buffer.byteLength)return this.buffer;if(i===n)return e;var r=new ArrayBuffer(n-i);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(i,n),0),r},h.Wa=h.oC,h.toString=function(t,i,n){if(void 0===t)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.vN+",limit="+this.dN+",capacity="+this.zk()+")";switch("number"==typeof t&&(n=i=t="utf8"),t){case"utf8":return this.uC(i,n);case"base64":return this.aC(i,n);case"hex":return this.fC(i,n);case"binary":return this.cC(i,n);case"debug":return this.eC();case"columns":return this.lC();default:throw Error("Unsupported encoding: "+t)}};var f=function(){for(var t={},s=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],h=[],i=0,n=s.length;i<n;++i)h[s[i]]=i;return t.encode=function(t,i){for(var n,r;null!==(n=t());)i(s[n>>2&63]),r=(3&n)<<4,null!==(n=t())?(i(s[63&((r|=n>>4&15)|n>>4&15)]),r=(15&n)<<2,null!==(n=t())?(i(s[63&(r|n>>6&3)]),i(s[63&n])):(i(s[63&r]),i(61))):(i(s[63&r]),i(61),i(61))},t.decode=function(t,i){var n,r,s;function e(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(r=h[n])&&e(n),null!==(n=t())&&(void 0===(s=h[n])&&e(n),i(r<<2>>>0|(48&s)>>4),null!==(n=t()))){if(void 0===(r=h[n])){if(61===n)break;e(n)}if(i((15&s)<<4>>>0|(60&r)>>2),null!==(n=t())){if(void 0===(s=h[n])){if(61===n)break;e(n)}i((3&r)<<6>>>0|s)}}},t.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},t}();h.aC=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.dN),i|=0,(t|=0)<0||i>this.zk||i<t)throw RangeError("begin, end");var n;return f.encode(function(){return t<i?this.view[t++]:null}.bind(this),n=a()),n()},d.SN=function(t,i){if("string"!=typeof t)throw TypeError("str");var n=new d(t.length/4*3,i),r=0;return f.decode(o(t),function(t){n.view[r++]=t}),n.dN=r,n},d.btoa=function(t){return d._N(t).aC()},d.atob=function(t){return d.SN(t).cC()},h.cC=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.dN),i|=0,(t|=0)<0||i>this.zk()||i<t)throw RangeError("begin, end");if(t===i)return"";for(var n=[],r=[];t<i;)n.push(this.view[t++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},d._N=function(t,i){if("string"!=typeof t)throw TypeError("str");for(var n,r=0,s=t.length,e=new d(s,i);r<s;){if(255<(n=t.charCodeAt(r)))throw RangeError("illegal char code: "+n);e.view[r++]=n}return e.dN=s,e},h.eC=function(t){for(var i,n=-1,r=this.buffer.byteLength,s="",e="",h="";n<r;){if(-1!==n&&(i=this.view[n],s+=i<16?"0"+i.toString(16).toUpperCase():i.toString(16).toUpperCase(),t&&(e+=32<i&&i<127?String.fromCharCode(i):".")),++n,t&&0<n&&n%16==0&&n!==r){for(;s.length<51;)s+=" ";h+=s+e+"\n",s=e=""}n===this.offset&&n===this.dN?s+=n===this.vN?"!":"|":n===this.offset?s+=n===this.vN?"[":"<":n===this.dN?s+=n===this.vN?"]":">":s+=n===this.vN?"'":t||0!==n&&n!==r?" ":""}if(t&&" "!==s){for(;s.length<51;)s+=" ";h+=s+e+"\n"}return t?h:s},d.AN=function(t,i,n){for(var r,s,e=t.length,h=new d((e+1)/3|0,i,n),o=0,u=0,a=!1,f=!1,c=!1,l=!1,v=!1;o<e;){switch(r=t.charAt(o++)){case"!":if(!n){if(f||c||l){v=!0;break}f=c=l=!0}h.offset=h.vN=h.dN=u,a=!1;break;case"|":if(!n){if(f||l){v=!0;break}f=l=!0}h.offset=h.dN=u,a=!1;break;case"[":if(!n){if(f||c){v=!0;break}f=c=!0}h.offset=h.vN=u,a=!1;break;case"<":if(!n){if(f){v=!0;break}f=!0}h.offset=u,a=!1;break;case"]":if(!n){if(l||c){v=!0;break}l=c=!0}h.dN=h.vN=u,a=!1;break;case">":if(!n){if(l){v=!0;break}l=!0}h.dN=u,a=!1;break;case"'":if(!n){if(c){v=!0;break}c=!0}h.vN=u,a=!1;break;case" ":a=!1;break;default:if(!n&&a){v=!0;break}if(s=parseInt(r+t.charAt(o++),16),!n&&(isNaN(s)||s<0||255<s))throw TypeError("Illegal str: Not a debug encoded string");h.view[u++]=s,a=!0}if(v)throw TypeError("Illegal str: Invalid symbol at "+o)}if(!n){if(!f||!l)throw TypeError("Illegal str: Missing offset or limit");if(u<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+e)}return h},h.fC=function(t,i){if(t=void 0===t?this.offset:t,i=void 0===i?this.dN:i,!this.wN){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}for(var n,r=new Array(i-t);t<i;)(n=this.view[t++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},d.RN=function(t,i,n){if(!n){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,s=t.length,e=new d(s/2|0,i),h=0,o=0;h<s;h+=2){if(r=parseInt(t.substring(h,h+2),16),!n&&(!isFinite(r)||r<0||255<r))throw TypeError("Illegal str: Contains non-hex characters");e.view[o++]=r}return e.dN=o,e};var c=function(){var r={vC:1114111,dC:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?i(127&n):(n<2048?i(n>>6&31|192):(n<65536?i(n>>12&15|224):(i(n>>18&7|240),i(n>>12&63|128)),i(n>>6&63|128)),i(63&n|128)),n=null},Kk:function(t,i){for(var n,r,s,e,h=function(t){t=t.slice(0,t.indexOf(null));var i=Error(t.toString());throw i.name="TruncatedError",i.bytes=t,i};null!==(n=t());)if(0==(128&n))i(n);else if(192==(224&n))null===(r=t())&&h([n,r]),i((31&n)<<6|63&r);else if(224==(240&n))null!==(r=t())&&null!==(s=t())||h([n,r,s]),i((15&n)<<12|(63&r)<<6|63&s);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=t())&&null!==(s=t())&&null!==(e=t())||h([n,r,s,e]),i((7&n)<<18|(63&r)<<12|(63&s)<<6|63&e)}},EC:function(t,i){for(var n,r=null;null!==(n=null!==r?r:t());)55296<=n&&n<=57343&&null!==(r=t())&&56320<=r&&r<=57343?(i(1024*(n-55296)+r-56320+65536),r=null):i(n);null!==r&&i(r)},Wk:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<=65535?i(n):(i(55296+((n-=65536)>>10)),i(n%1024+56320)),n=null},Lk:function(t,i){r.EC(t,function(t){r.dC(t,i)})},Hk:function(t,i){r.Kk(t,function(t){r.Wk(t,i)})},wC:function(t){return t<128?1:t<2048?2:t<65536?3:4},pC:function(t){for(var i,n=0;null!==(i=t());)n+=i<128?1:i<2048?2:i<65536?3:4;return n},Pk:function(t){var i=0,n=0;return r.EC(t,function(t){++i,n+=t<128?1:t<2048?2:t<65536?3:4}),[i,n]}};return r}();return h.uC=function(i,n){if(void 0===i&&(i=this.offset),void 0===n&&(n=this.dN),!this.wN){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}var t;try{c.Hk(function(){return i<n?this.view[i++]:null}.bind(this),t=a())}catch(t){if(i!==n)throw RangeError("Illegal range: Truncated data, "+i+" != "+n)}return t()},d.IN=function(t,i,n){if(!n&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var r=new d(c.Pk(o(t),!0)[1],i,n),s=0;return c.Lk(o(t),function(t){r.view[s++]=t}),r.dN=s,r},d})?r.apply(i,s):r)||(t.exports=e)},function(t,i){var n,r,s=t.exports={};function e(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function o(i){if(n===setTimeout)return setTimeout(i,0);if((n===e||!n)&&setTimeout)return n=setTimeout,setTimeout(i,0);try{return n(i,0)}catch(t){try{return n.call(null,i,0)}catch(t){return n.call(this,i,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:e}catch(t){n=e}try{r="function"==typeof clearTimeout?clearTimeout:h}catch(t){r=h}}();var u,a=[],f=!1,c=-1;function l(){f&&u&&(f=!1,u.length?a=u.concat(a):c=-1,a.length&&v())}function v(){if(!f){var t=o(l);f=!0;for(var i=a.length;i;){for(u=a,a=[];++c<i;)u&&u[c].gC();c=-1,i=a.length}u=null,f=!1,(function(i){if(r===clearTimeout)return clearTimeout(i);if((r===h||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(i);try{r(i)}catch(t){try{return r.call(null,i)}catch(t){return r.call(this,i)}}})(t)}}function d(t,i){this.bC=t,this.tR=i}function E(){}s.Fe=function(t){var i=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)i[n-1]=arguments[n];a.push(new d(t,i)),1!==a.length||f||o(v)},d.prototype.gC=function(){this.bC.apply(null,this.tR)},s.title="browser",s.yC=!0,s.Ye={},s.TC=[],s.version="",s.wm={},s.on=E,s.addListener=E,s.mC=E,s.off=E,s.removeListener=E,s.OC=E,s.uh=E,s.SC=E,s.RC=E,s.gm=function(t){return[]},s._C=function(t){throw new Error("process.binding is not supported")},s.IC=function(){return"/"},s.AC=function(t){throw new Error("process.chdir is not supported")},s.NC=function(){return 0}},function(t,i,n){"use strict";var h=n(38);t.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.dc=function(t){return Object(t)===t},Object.kC=function(t){return t&&"function"==typeof t.valueOf&&(t=t.valueOf()),t};var r=new h();Object.hash=function(t){return t&&"function"==typeof t.hash?""+t.hash():Object(t)===t?(r.has(t)||r.set(t,Math.random().toString(36).slice(2)),r.get(t)):""+t};var s=Object.prototype.hasOwnProperty;Object.CC=function(t,i){return s.call(t,i)},Object.has=function(t,i){if("object"!=typeof t)throw new Error("Object.has can't accept non-object: "+typeof t);if(t&&"function"==typeof t.has)return t.has(i);if("string"==typeof i)return i in t&&t[i]!==Object.prototype[i];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(t,i,n){if("object"!=typeof t)throw new Error("Object.get can't accept non-object: "+typeof t);return t&&"function"==typeof t.get?t.get(i,n):Object.has(t,i)?t[i]:n},Object.set=function(t,i,n){t&&"function"==typeof t.set?t.set(i,n):t[i]=n},Object.hiveAddEach=function(n,i){if(i)if("function"!=typeof i.forEach||i.hasOwnProperty("forEach"))if("number"==typeof i.length)for(var t=0;t<i.length;t++)n[t]=i[t];else Object.keys(i).forEach(function(t){n[t]=i[t]});else!0===i.isMap?i.forEach(function(t,i){n[i]=t}):i.forEach(function(t){n[t[0]]=t[1]});return n},Object.forEach=function(t,i,n){for(var r,s=Object.keys(t),e=0;r=s[e];e++)i.call(n,t[r],r,t)},Object.map=function(t,i,n){for(var r,s=Object.keys(t),e=0,h=[];r=s[e];e++)h.push(i.call(n,t[r],r,t));return h},Object.values=function(t){return Object.map(t,Function.identity)},Object.concat=function(){for(var t={},i=0;i<arguments.length;i++)Object.hiveAddEach(t,arguments[i]);return t},Object.from=Object.concat,Object.is=function(t,i){return t===i?0!==t||1/t==1/i:t!=t&&i!=i},Object.Ae=function(t,i,n,r){if(n=n||Object.Ae,(t=Object.kC(t))===(i=Object.kC(i)))return!0;if(Object.dc(t)){if((r=r||new h()).has(t))return!0;r.set(t,!0)}if(Object.dc(t)&&"function"==typeof t.Ae)return t.Ae(i,n,r);if(Object.dc(i)&&"function"==typeof i.Ae)return i.Ae(t,n,r);if(Object.dc(t)&&Object.dc(i)&&Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(i)===Object.prototype){for(var s in t)if(!n(t[s],i[s],n,r))return!1;for(var s in i)if(!(s in t&&n(i[s],t[s],n,r)))return!1;return!0}return t!=t&&i!=i||(!t||!i)&&t===i},Object.compare=function(t,i){if((t=Object.kC(t))===(i=Object.kC(i)))return 0;var n=typeof t,r=typeof i;return"number"==n&&"number"==r?t-i:"string"==n&&"string"==r?t<i?-1/0:1/0:t&&"function"==typeof t.compare?t.compare(i):i&&"function"==typeof i.compare?-i.compare(t):0},Object.clone=function(t,i,n){if(t=Object.kC(t),n=n||new h(),void 0===i)i=1/0;else if(0===i)return t;if(Object.dc(t)){if(!n.has(t))if(t&&"function"==typeof t.clone)n.set(t,t.clone(i,n));else{var r=Object.getPrototypeOf(t);if(null!==r&&r!==Object.prototype)throw new Error("Can't clone "+t);var s=Object.create(r);for(var e in n.set(t,s),t)s[e]=Object.clone(t[e],i-1,n)}return n.get(t)}return t},Object.clear=function(t){if(t&&"function"==typeof t.clear)t.clear();else for(var i=Object.keys(t),n=i.length;n;)delete t[i[--n]];return t}},function(T,t){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.DC=E);var i=!1;if("function"==typeof WeakMap){var n=WeakMap;if(!("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent))){var t=new n(),r=Object.freeze({});if(t.set(r,1),1===t.get(r))return T.exports=WeakMap;i=!0}}Object.prototype.hasOwnProperty;var s=Object.getOwnPropertyNames,e=Object.defineProperty,h=Object.isExtensible,o="weakmap:",u=o+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var a=new ArrayBuffer(25),f=new Uint8Array(a);crypto.getRandomValues(f),u=o+"rand:"+Array.prototype.map.call(f,function(t){return(t%36).toString(36)}).join("")+"___"}if(e(Object,"getOwnPropertyNames",{value:function(t){return s(t).filter(w)}}),"getPropertyNames"in Object){var c=Object.MC;e(Object,"getPropertyNames",{value:function(t){return c(t).filter(w)}})}!function(){var i=Object.freeze;e(Object,"freeze",{value:function(t){return p(t),i(t)}});var n=Object.seal;e(Object,"seal",{value:function(t){return p(t),n(t)}});var r=Object.preventExtensions;e(Object,"preventExtensions",{value:function(t){return p(t),r(t)}})}();var l=!1,v=0,d=function(){this instanceof d||b();var s=[],e=[],h=v++;return Object.create(d.prototype,{jC:{value:g(function(t,i){var n,r=p(t);return r?h in r?r[h]:i:0<=(n=s.indexOf(t))?e[n]:i})},PC:{value:g(function(t){var i=p(t);return i?h in i:0<=s.indexOf(t)})},LC:{value:g(function(t,i){var n,r=p(t);return r?r[h]=i:0<=(n=s.indexOf(t))?e[n]=i:(n=s.length,e[n]=i,s[n]=t),this})},HC:{value:g(function(t){var i,n,r=p(t);return r?h in r&&delete r[h]:!((i=s.indexOf(t))<0)&&(n=s.length-1,s[i]=void 0,e[i]=e[n],s[i]=s[n],s.length=n,e.length=n,!0)})}})};d.prototype=Object.create(Object.prototype,{get:{value:function(t,i){return this.jC(t,i)},writable:!0,configurable:!0},has:{value:function(t){return this.PC(t)},writable:!0,configurable:!0},set:{value:function(t,i){return this.LC(t,i)},writable:!0,configurable:!0},"delete":{value:function(t){return this.HC(t)},writable:!0,configurable:!0}}),"function"==typeof n?(i&&"undefined"!=typeof Proxy&&(Proxy=void 0),y.prototype=d.prototype,T.exports=y,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})):("undefined"!=typeof Proxy&&(Proxy=void 0),T.exports=d)}function E(t){t.UC&&t.UC(E)}function w(t){return!(t.substr(0,o.length)==o&&"___"===t.substr(t.length-3))}function p(t){if(t!==Object(t))throw new TypeError("Not an object: "+t);var i=t[u];if(i&&i.key===t)return i;if(h(t)){i={key:t};try{return e(t,u,{value:i,writable:!1,enumerable:!1,configurable:!1}),i}catch(t){return}}}function g(t){return t.prototype=null,Object.freeze(t)}function b(){l||"undefined"==typeof console||(l=!0,!1)}function y(){this instanceof d||b();var t,r=new n(),s=void 0,e=!1;return t=i?function(t,i){return r.set(t,i),r.has(t)||(s=s||new d()).set(t,i),this}:function(i,n){if(e)try{r.set(i,n)}catch(t){(s=s||new d()).LC(i,n)}else r.set(i,n);return this},Object.create(d.prototype,{jC:{value:g(function(t,i){return s?r.has(t)?r.get(t):s.jC(t,i):r.get(t,i)})},PC:{value:g(function(t){return r.has(t)||!!s&&s.PC(t)})},LC:{value:g(t)},HC:{value:g(function(t){var i=!!r["delete"](t);return s&&s.HC(t)||i})},UC:{value:g(function(t){if(t!==E)throw new Error("bogus call to permitHostObjects___");e=!0})}})}}()},function(t,i,n){"use strict";var r=n(38),s=n(55),e=new r();function h(){throw new Error("Can't construct. RangeChanges is a mixin.")}(t.exports=h).prototype.FC=function(){return e.has(this)||e.set(this,s()),e.get(this)},h.prototype.GC=function(t){var i=this.FC();return t=t||"",i.has(t)||i.set(t,{isActive:!1,tc:[],Zf:[]}),i.get(t)},h.prototype.xC=function(t,i,n){!this.ec&&this.sc&&this.sc();var r=this.GC(i);(n?r.Zf:r.tc).push(t),Object.defineProperty(this,"BC",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.VC(t,i,n),s=null)}},h.prototype.VC=function(t,i,n){var r,s=this.GC(i),e=(r=n?s.Zf:s.tc).lastIndexOf(t);if(-1===e)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(i));r.splice(e,1)},h.prototype.qC=function(s,e,h,o){var t=this.FC(),u="Range"+(o?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=o?t.Zf:t.tc;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+u;try{n.slice().forEach(function(t){if(!(n.indexOf(t)<0))if(t[r])t[r](s,e,h,this,o);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(this,s,e,h,this,o)}},this)}finally{t.isActive=!1}}},this)},h.prototype.QC=function(t,i){return this.xC(t,i,!0)},h.prototype.YC=function(t,i){return this.VC(t,i,!0)},h.prototype.KC=function(t,i,n){return this.qC(t,i,n,!0)}},function(t,i){function n(){throw new Error("Can't construct. GenericSet is a mixin.")}(t.exports=n).prototype.WC=!0,n.prototype.$C=function(t){var i=this.je(this);return i.hiveAddEach(t),i},n.prototype.XC=function(i){return this.je(this.filter(function(t){return i.has(t)}))},n.prototype.JC=function(t){var i=this.je(this);return i.Pf(t),i},n.prototype.zC=function(t){var i=this.$C(t),n=this.XC(t);return i.JC(n)},n.prototype.ZC=function(t){return+this["delete"](t)},n.prototype.Ae=function(t,n){var r=this;return t&&"function"==typeof t.reduce&&this.length===t.length&&t.reduce(function(t,i){return t&&r.has(i,n)},!0)},n.prototype.toJSON=function(){return this.toArray()},n.prototype.contains=function(t){return this.has(t)},n.prototype.remove=function(t){return this["delete"](t)},n.prototype.toggle=function(t){this.has(t)?this["delete"](t):this.hiveAdd(t)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.tD="CACHE",s.iD="CENTRAL_FRAGMENT",s.Jd="CONNECTIVITY_INFO_PROVIDER",s.nD="CONTEXT_RESOLVER",s.rD="DCACHE",s.sD="FALLBACK_REQUESTER",s.eD="HTTP_MANAGER",s.hD="HTTP_REQUEST",s.il="IDENTITY_PROVIDER",s.oD="IN_PARTNERSHIP",s.uD="IN_PREFETCHER_PARTNERSHIP",s.aD="IP_SPOOFING",s.fD="LIVE_CACHE",s.cD="LOCALITY_CLIENT",s.lD="LOCALITY_SCORE",s.T="LOGGER",s.vD="MEMBERSHIP",s.NETWORK="NETWORK",s.dD="NODE_INFO",s.ED="OBJECT_INDEX",s.wD="OUT_PARTNERSHIP",s.pD="OUT_PREFETCHER_PARTNERSHIP",s.gD="P2P_REQUESTER",s.bD="P2P_VIDEO_PREFETCHER",s.yD="PARTNERSHIP",s.xl="PEER",s.TD="PEER_CONNECTIVITY_INFO",s.mD="PICKER",s.OD="PREFETCH_MANAGER",s.SD="RENDER_STATS",s.RD="REPORTING",s._D="REQUEST_TRACKER",s.ID="RESPONDER",s.$l="RTC_MANAGER",s.AD="SCORE_UPDATER",s.ND="SERVER_MANAGER",s.Zc="SERVICES_CLIENT",s.kD="SNAP_STATS_MANAGER",s.El="STATS_CLIENT",s.dl="STATS_STORE",s.CD="STREAM_INFO_PROVIDER",s.Al="TICKET_RESOLVER",s.v="TIMER",s.DD="TRACKER_CLIENT",s.MD="TRACKER_MANAGER",s.jD="TRACK_CLIENT",s.wl="TRACK_MANAGER",s.PD="TRANSPORT",s.LD="UDP_BROADCASTER",s.HD="UDP_DISCOVERY",s.af="UDP_LEADER_ELECTION",s.UD="VOD_CACHE",s);function s(){}i.p=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.LoggerTimestamp=!0,s);function s(){}var e=(h.MetricSnapshotLogs=0,h.TrackSnapshotLogs=0,h);function h(){}var o=(u.Framework=r,u.DebugLogs=e,u);function u(){}i.HiveConfig=o,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Framework=o.Framework,window.HiveConfig.DebugLogs=o.DebugLogs)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.FD="127.0.0.1",s.Cv=8999,s.kv=8998,s.Nv=8899,s.Iv=8898,s.GD="//{0}:{1}/?callback={2}{3}hivePluginId={4}",s.xD="//{0}:{1}/?callback={2}",s.Dv=!0,s.BD=/((http|https):\/\/(.*):([0-9]*)\/([0-9a-z-]*).ism\/)(.*)/,s.VD="2013.1.1",s.qD="2018.1",s);function s(){}i.Av=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(42),h=n(3);(s=r=i.QD||(i.QD={}))[s.off=0]="off",s[s.error=1]="error",s[s.warn=2]="warn",s[s.notice=3]="notice",s[s.info=4]="info",s[s.debug=5]="debug",s[s.trace=6]="trace";var o=(u.prototype.vg=function(t,i){e.HiveConfig.Framework.HiveDebugLevel&&null!=r[e.HiveConfig.Framework.HiveDebugLevel]?this.level=r[e.HiveConfig.Framework.HiveDebugLevel]:null!=r[t]?this.level=r[t]:!1,this.YD(i)},u.prototype.YD=function(t){var i={log:this.KD(this.logger.log,r.error,t),error:this.KD(this.logger.error,r.error,t),warn:this.KD(this.logger.warn,r.warn,t),notice:this.KD(this.logger.info,r.notice,t),info:this.KD(this.logger.info,r.info,t),debug:this.KD(this.logger.debug,r.debug,t),trace:this.KD(this.logger.trace,r.trace,t)};t?this.WD.set(t,i):this.$D=i},u.prototype.KD=function(t,i,n){if(!(this.level>=i))return function(){};try{return e.HiveConfig.Framework.LoggerTimestamp?n?Function.prototype.bind.call(t,console,"S["+n+"] %s",this.timestamp):Function.prototype.bind.call(t,console,"%s",this.timestamp):n?Function.prototype.bind.call(t,console,"S["+n+"]"):Function.prototype.bind.call(t,console)}catch(t){}},u.prototype.log=function(t){return t?(this.WD.has(t)||this.vg(r[this.level],t),this.WD.get(t)):this.$D},u);function u(){this.timestamp=function(){},this.WD=new h(),this.level=r.debug,this.timestamp.toString=function(){var t=new Date();return"["+(("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)+":"+("00"+t.getUTCMilliseconds()).slice(-3))+"]"},this.logger="undefined"==typeof console?{log:function(){}}:console,this.logger.trace||(this.logger.trace=this.logger.log),this.logger.debug||(this.logger.debug=this.logger.log),this.logger.info||(this.logger.info=this.logger.log),this.logger.warn||(this.logger.warn=this.logger.log),this.logger.error||(this.logger.error=this.logger.log),this.vg(r[this.level])}i.XD=o},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(75),o=n(0),u=(e=h["default"],s(a,e),a);function a(){return e.call(this,"STATS",o.Framework.p.RD)||this}i["default"]=new u()},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(52),h=n(30),s=n(31),e=(o.prototype.Ug=function(t,i,n){this.SiteId=t,this.CROId=i,this.ContentId=n,this.JD()},o.prototype.zD=function(t){for(var i in t)if("SourceURLParams"===i)for(var n in t[i])this[i][n]=t[i][n];else this[i]=t[i];this.JD()},o.prototype.ZD=function(){var t=this.ContentId+this.SiteId+this.CROId+this.SourceURL,i=new s.HA();i.IS("b6614c3e4cd1d14eed6b39ef2bf6b9a3e3d6dfcd26699d7270d887923bcbf83efb3dadb717c0bafb1d48dce361eb369b7cc46e57405ebfbdd86c3175532fe56cc77f473d345b2cb6feafb5ab0e24f364a3d259f27e4a2fd97468265bddfd3ddd3ac64251db650ca0280af2b2c45e8b1c8f040f2c433ac0a157d2b3fd91517253","010001");var n=s.UA(this.Signature);return i.NA(t,n)},o.prototype.Vg=function(t){this.ticketUrl=t;var i=h.parse(t),n=i.path.split("/").slice(3);if(this.SiteId=n[0],this.CROId=n[1],this.ContentId=n[2],this.tM=n[3],i.query)try{var r=i.query.split("&");for(var s in r){var e=r[s].split(/=(.+)/);this.SourceURLParams[e[0]]=e[1]}}catch(t){}this.iM=-1<t.indexOf("api-test")},o.prototype.Pd=function(){return this.SiteId},o.prototype.Ld=function(){return this.CROId},o.prototype.qg=function(){return this.ContentId},o.prototype.nM=function(){return this.tM},o.prototype.rM=function(){return this.SourceURL},o.prototype.sM=function(){if(this.Fg=this.SourceURL,null!=this.SourceURLParams){var t=new Array();for(var i in this.SourceURLParams)t.push(i+"="+this.SourceURLParams[i]);0<t.length&&this.Fg&&(this.Fg+=(0<this.Fg.indexOf("?")?"&":"?")+t.join("&"))}},o.prototype.JD=function(){this.sessionId=r.Rb()},o.prototype.eM=function(){return this.Fg||this.sM(),this.Fg},o.prototype.Vd=function(){return"["+this.SiteId+"/"+this.CROId+"/"+this.ContentId+"]"},o.prototype.hM=function(){return[this.SiteId,this.CROId,this.ContentId]},o.prototype.oM=function(){return this.SourceURL+"-["+this.SiteId+"/"+this.CROId+"/"+this.ContentId+"]"},o.prototype.toString=function(){return this.Vd()},o.uM="^https?://api(?:-test)?.hivestreaming.com/v1/events/(?:wildcard/)?",o.aM="CROId",o.fM="SiteId",o.cM="ContentId",o);function o(){this.SourceURLParams={},this.testId=null,this.originalManifest=null}i.Ticket=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(74),o=n(0),r=n(16),s=n(3),e=(u.wd=function(t,i,n){this.client=t,this.lM=i,this.guid=n},u.vM=function(t,i,n,r,s){var e=new h.Bd();e.app=t||"CustomSnapshot",e.guid=r||this.guid,e.createdAt=o.Framework.time(),e.name=n,e.tags=i||this.lM,e.data="string"==typeof s?JSON.parse(s):s,this.send(e)},u.send=function(t){var i=new r.Yc(HiveStreamingServices.eE,2,JSON.stringify(t));this.client&&this.client.rE().send(i)},u.dM=function(t,i,n,r,s,e){try{var h=t+(i?i.join():"")+n+r,o=this.EM.has(h)?this.EM.get(h):[];o.push("string"==typeof s?JSON.parse(s):s),o.length>=e?(this.vM(t,i,n,r,{buffer:o}),this.EM["delete"](h)):this.EM.set(h,o)}catch(t){}},u.EM=new s(),u);function u(){}i.wM=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(138),s=(e.GA=function(t,i,n){return this.xA(t,i,n)||-1!=t.indexOf(e.BA)},e.xA=function(t,i,n){var r=-1!=t.toLowerCase().indexOf(e.VA.toLowerCase())||-1!=t.toLowerCase().indexOf(e.pM.toLowerCase())||-1!=t.toLowerCase().indexOf(e.gM.toLowerCase());if(n){if(n.test(t))return!0;!r&&i&&i.warn(this.loggerId+"Context matcher set to "+n+" failed against "+t)}return r},e.KA=function(){return new r.bM()},e.loggerId="[HLS] ",e.yM=1,e.TM=2,e.mM=3e4,e.OM=4e3,e.SM=500,e.RM=!0,e._M=1e4,e.IM=16,e.AM=3,e.VA=".m3u8",e.pM="(format=m3u8-aapl-v3)",e.gM="(video,format=m3u8-aapl-v3,audiotrack=audio)",e.BA=".ts",e);function e(){}i.HLS=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.NM=55,s.kM=6e5,s.CM=5,s.DM=10,s.MM=2,s.jM=10,s.PM="dist",s.LM="../scenarios/BrokenUdp",s.HM=null,s.UM=null,s.FM=null,s.GM=!0,s.xM=!0,s.BM=6e4,s);function s(){}i.VM=r;var e=(h.qM="BwEmulation",h);function h(){}i.QM=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(8),f=n(31),s=(e.prototype.Bp=function(){return this.YM},e.prototype.KM=function(){return this.WM},e.prototype.getDuration=function(){return this.duration},e.prototype.getBitrate=function(){return this.bitrate},e.prototype.Xp=function(){return this.$M},e.prototype.XM=function(){return this.JM},e.prototype.qp=function(){return this.zM},e.prototype.Wp=function(){return this.url},e.prototype.toString=function(){return r.yf[this.Bp()]+"-"+this.qp()},e);function e(t,i,n,r,s,e,h,o){this.contextId=o,this.url=t,this.JM=n,this.YM=i,this.WM=r,this.duration=s,this.bitrate=e,this.$M=h;var u=(this.contextId?this.contextId:this.url).replace(/http(s)?:\/\//,""),a=f.sv.MO(u).toString(f.sv.cO.lO);this.zM=a+"-"+this.WM+"-"+this.bitrate}i.ZM=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var a,r,v,s,f=n(61),c=n(3),l=n(24),d=n(0),E=n(5),e=n(8),w=n(34),p=n(9),g=n(1),b=n(2);(r=a=i.tj||(i.tj={}))[r.Nf=0]="PLAYER",r[r.ij=1]="LAN",r[r.nj=2]="SITE",(s=v=v||{})[s.ij=0]="LAN",s[s.nj=1]="SITE",s[s.AS=2]="AS",s[s.Sf=3]="OTHER";var h=function(){this.rj=!1,this.YM=null,this.sj=-1,this.ej=0};i.hj=h;var o=(u.prototype.init=function(t){this.logger=d.Framework.resolve(d.Framework.p.T).log(t.sessionId),this.oj=t.uj,this.aj=t.aj,this.fj=t.fj,this.rw=t.rw,this.pluginId=t.sb.ticket.pluginId,this.cj=t.cj,this.lj=t.lj,this.vj=t.vj,this.dj=t.dj},u.prototype.eb=function(){this.isActive=!0},u.prototype.Ej=function(t,i){this.context=t,this.wj=i,this.vj.Ej(i)},u.prototype.pj=function(t){return this.gj.has(t)},u.prototype.bj=function(){return this.wj},u.prototype.yj=function(i,t,n){var r=this;try{var s=new f();this.gj.forEach(function(t,i){s.hiveAdd(i)});var e=new f();if(e.hiveAddEach(i.keys()),this.wj.Tj()){var h=this.wj.Tj().bitrate;if(e.hiveAdd(h),e.forEach(function(t){s["delete"](t)}),n){var o=[];s.forEach(function(t){r.gj.has(t)&&r.gj.get(t).mj==a.nj&&(o.push(t),e.hiveAdd(t))}),o.forEach(function(t){s["delete"](t)})}var u=new c();e.forEach(function(t){r.gj.has(t)&&r.gj.get(t).mj==a.nj?u.set(t,a.nj):u.set(t,i.get(t))}),this.Oj(s),this.Sj(u,t)}}catch(t){g.ErrorMonitor.Z().logError("Error updating the prefetch sessions",this.loggerId,b.Ms.js,t)}},u.prototype.Sj=function(t,n){var r=this;t.forEach(function(t,i){0!=i&&r.Rj(i,t,n)})},u.prototype.Oj=function(t){var i=this;t.forEach(function(t){i.cj._j(t),i.logger.debug(i.loggerId+"Remove unwanted bitrate "+t),i.gj["delete"](t)})},u.prototype.Rj=function(t,i,n){this.gj.has(t)?this.Ij(t,n):this.gj.has(t)||this.Aj(t,i,n)},u.prototype.Ij=function(t,i){try{var n=this.gj.get(t);n.type=i,n.type!=a.nj&&(n.sj=-1),this.cj.Nj(t,n)}catch(t){g.ErrorMonitor.Z().logError("Error configuring already existing prefetch sessions",this.loggerId,b.Ms.Ps,t)}},u.prototype.Aj=function(t,i,n){var r=this;try{var s=new h();s.YM=null,s.type=n,s.bitrate=t,s.mj=i,this.gj.set(t,s),this.gj.forEach(function(t,i){r.logger.debug(r.loggerId+"ABT "+i+" S "+a[t.type]+" PREF REASON "+a[t.mj])}),this.cj.Nj(t,s)}catch(t){g.ErrorMonitor.Z().logError("Error constructing a new prefetch session",this.loggerId,b.Ms.Ls,t)}},u.prototype.kj=function(n){var r=this;if(this.gj.has(n.getBitrate())){var t=this.gj.get(n.getBitrate());0<t.sj&&t.Cj&&(t.sj=n.duration-(d.Framework.time()-t.Cj)-t.ej,t.ej=50),t.YM=n,this.Dj(n.getBitrate()),this.gj.forEach(function(t,i){t&&t.type!=a.Nf&&i!=n.getBitrate()&&r.Mj(t,i)})}},u.prototype.jj=function(t){var i=this.gj.keys(),n=i.indexOf(t);return-1!=n&&i.splice(n,1),i},u.prototype.Pj=function(t){var n=this;t.forEach(function(t){var i=n.gj.get(t);i&&i.type!=a.Nf&&n.Mj(i,i.bitrate)})},u.prototype.Mj=function(t,i){if(t.type!=a.Nf){var n=this.wj.Tj();if(null!=n){var r=this.wj.Lj(n.WM,i,e.yf.mf);null==r?(this.logger.debug(this.loggerId+"PREFETCHING "+i+" MISSING METADATA "),this.rj(i)):(t.YM=r,this.Dj(r.getBitrate()))}else this.logger.debug(this.loggerId+"PLAYER NOT PLAYING "),this.rj(i)}},u.prototype.Hj=function(t){var i=this.gj.get(t);i&&i.rj&&(null!=i.YM?(this.logger.debug(this.loggerId+"RESTART PREFETCHING ON AVAILABLE METADATA"),i.rj=!1,this.Dj(i.bitrate)):(i.rj=!1,this.Mj(i,t)))},u.prototype.Uj=function(t){var n=this;t?this.Hj(t):this.gj.forEach(function(t,i){n.Hj(i)})},u.prototype.Dj=function(t){var i=this.wj.Tj();if(i){var n=this.gj.get(t);if(n){if(n.YM&&i.getBitrate()==t){var r=this.Fj(n.YM.KM(),t);this.cj.setDelta(r)}this.Gj(n)}}else g.ErrorMonitor.Z().logError("Error attempting prefetch before having a player request",this.loggerId,b.Ms.Us)},u.prototype.Gj=function(t){if(t.YM){var i=this.xj(t.YM);if(null!=i)this.Bj(i,t);else{var n=t.bitrate;this.logger.debug(this.loggerId+"PREFETCHING "+n+" STOPPED BECAUSE OF MISSING METADATA "),this.gj.get(n).rj=!0,this.rj(n)}}else t.rj=!0,this.rj(t.bitrate)},u.prototype.Bj=function(h,t){var o=this,i=this.Vj(h,t.type);if(i.qj)try{this.Qj.has(h.qp())&&d.Framework.clearTimeout(this.Qj.get(h.qp()));var n=i.type==l.yp.Op,r=1;if(n){var s=Math.max(0,t.sj);r=this.vj.Yj(t.type,h.getBitrate(),h.KM(),s)}this.logger.debug(this.loggerId+"PREFETCHING "+h.url+" CDN PREFETCH "+n+" IN "+r+" MSECS");var u=this.gj.get(h.getBitrate());u.YM=h;var e=d.Framework.setTimeout(function(){o.Qj["delete"](h.qp());var s=new w.HiveRequest(o.pluginId);s.url=h.url,u.Cj=d.Framework.time(),o.Kj=0;var e=o.aj.Wj(s,h,o.context,i.type);e&&(e.rg=t.type==a.nj||t.type==a.ij,s.onerror=s.onload=function(){if(e.xp()==l.yp.Op&&(!s.status||s.status<200||299<s.status)){var t=o.gj.get(h.getBitrate());s=null;var i=t.YM.duration,n=t.YM.duration+E.Ku.Pu["do"],r=Math.floor(d.Framework.random()*(n-i))+i;t.sj=r-(d.Framework.time()-t.Cj),t.ej=0,o.Dj(t.YM.bitrate)}})},r);this.Qj.set(h.qp(),e)}catch(t){g.ErrorMonitor.Z().logError("Error requesting for prefetch",this.loggerId,b.Ms.xs,t)}},u.prototype.$j=function(){var n=this;this.Qj.forEach(function(t,i){n.logger.debug(n.loggerId+"Clearing delayed prefetch timer id "+t),d.Framework.clearTimeout(t),n.Qj["delete"](i)}),this.isActive=!1},u.prototype.rj=function(t){this.gj.has(t)&&(this.gj.get(t).rj=!0,this.wj.Xj(t))},u.prototype.xj=function(t){try{var i=this.gj.get(t.getBitrate()),n=t,r=this.Jj(n);return r&&r.qp()!=t.qp()?r:r&&r.qp()==i.YM.qp()?t:null}catch(t){return g.ErrorMonitor.Z().logError("Error forwarding to next segment",this.loggerId,b.Ms.Fs,t),null}},u.prototype.Jj=function(t){if(null==t)return null;var i=this.rw.zj(),n=t;if(i)for(;null!=n&&-1!=i.indexOf(n.qp());)if(!(n=this.wj.Zj(n)))return n;return n},u.prototype.Vj=function(t,i){try{var n=this.tP(t),r=n?l.yp._p:l.yp.Op,s=!1;s=i!=a.Nf?!this.Qj.has(t.qp())||r!=l.yp.Op:r==l.yp._p;var e=this.wj.iP(),h=this.nP(t.KM(),t.getBitrate(),r),o=i==a.nj;return this.logger.debug(this.loggerId+"PREFETCHING "+l.yp[r]+" (LAN LEADER: "+this.cj.rP()+" SITE LEADER: "+o+") CHECKS FOR "+t.qp()+" [HAVES:"+n+" NOTBUFFERING:"+e+" DISTANCE:"+h.valid+"("+h.sP+")]"),{qj:s&&e&&h.valid&&this.isActive,type:r}}catch(t){return g.ErrorMonitor.Z().logError("Error checking if allowed to prefetch",this.loggerId,b.Ms.Gs,t),{qj:!1,type:l.yp.Op}}},u.prototype.nP=function(t,i,n){try{var r=this.wj.eP(t,i);return r<=this.wj.hP()?{sP:r,valid:!0}:{sP:r,valid:!1}}catch(t){return g.ErrorMonitor.Z().logError("Error checking the player distance",this.loggerId,b.Ms.Bs,t),{sP:0,valid:!1}}},u.prototype.Fj=function(t,i){var n=this.wj.Tj();if(null==n)return-1;var r=n.KM();return this.wj.oP(r,i,t,i)},u.prototype.tP=function(t){var i=t.qp(),n=t.getDuration(),r=t.KM(),s=t.getBitrate();if(this.oj.contains(i)){var e=this.oj.uP(i),h=this.oj.aP(i);if(h.length>=E.Ku.Pu.bo){if(E.Ku.Pu.mo){var o=[];o[v.ij]=[],o[v.nj]=[],o[v.AS]=[],o[v.Sf]=[];var u=this.cj.fP(),a=this.cj.cP();h.forEach(function(t){if(t.lP.peerInfo.type!=p.Rf.If){var i=t.lP.peerInfo.internalAs;if(0!=u&&i&&u==i)o[v.nj].push(t);else{if(E.Ku.Pu.Mo){var n=t.lP.peerInfo.externalAs;if(0!=a&&a===n)return void o[v.AS].push(t)}t.lP.peerInfo.type==p.Rf._f&&o[v.Sf].push(t)}}else o[v.ij].push(t)});var f=null,c=!1,l=!0;return 0<o[v.ij].length&&(c=this.vP?!this.dP(o[v.ij],i):(f=v.ij,!0)),!this.cj.rP()&&this.cj.EP()||0<o[v.nj].length&&(f=v.nj,c=!0),!this.cj.wP()&&this.cj.pP()&&0<o[v.AS].length&&(f=v.AS,c=!0),0<o[v.Sf].length&&(this.cj.gP()||!(this.cj.wP()||this.cj.pP()&&E.Ku.Pu.Mo))&&(f=v.Sf,c=!0),c&&f>=E.Ku.Pu.jo&&(l=this.bP(o[f],e,n,r,s)),!(!c||!l||(this.logger.debug("down from "+v[f]+" with haves : "+o[v.ij].length+" "+o[v.nj].length+" "+o[v.AS].length+" "+o[v.Sf].length),0))}return!0}}return!1},u.prototype.bP=function(t,e,h,o,u){var a=this;return t.some(function(t){var i=t.yP();if(0<i){var n=e.size/i,r=a.wj.eP(o,u),s=!1;return r<h?(s=n<=r*E.Ku.Pu.Po,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDistance: "+r*E.Ku.Pu.Po)):(s=n<=h*E.Ku.Pu.Po,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDuration: "+h*E.Ku.Pu.Po)),s}})},u.prototype.dP=function(t,i){try{return this.cj.TP().length>E.Ku.Pu.ko&&(this.cj.mP(),t.length==E.Ku.Pu.No&&t[0].guid==this.cj.OP().uuid&&d.Framework.random()>E.Ku.Pu.Co&&this.Kj<E.Ku.Pu.Do&&(this.logger.debug("SKIP PREFETCH CYCLE "+this.Kj+" TO OFFLOAD LEADER"),this.Kj++,!0))}catch(t){return g.ErrorMonitor.Z().logError("Error deciding to offload the leader",this.loggerId,b.Ms.Vs,t),!1}},u.prototype.SP=function(t,i){try{t.RP=t.ug.id,t.ug=i,this.logger.debug(this.loggerId+"UPGRADE "+l.yp[t.xp()]+" REQ "+t.Yp+" FOR "+t.Vp.qp()),t.xp()==l.yp._p?(t.Zp.p2pAgenTrafficSuccessQt=t.og,t.sg?(t.type=l.yp.Rp,this.fj._P(t)||(this.logger.debug(this.loggerId+"SET REQUEST TIMED-OUT WAS 0. CDN COMPENSATION"),this.fj.IP(t.AP,"TIMED-OUT"))):(t.type=l.yp.Tp,this.logger.debug(this.loggerId+"THE HIVE REQ "+t.qp()+" ARRIVED BEFORE THE P2P_PREFETCH INITIALIZED. CHANGE REQUEST TYPE TO "+l.yp[t.xp()]))):t.xp()==l.yp.Op&&(t.type=l.yp.Tp)}catch(t){g.ErrorMonitor.Z().logError("Error upgrading prefetch",this.loggerId,b.Ms.qs,t)}},u);function u(){this.loggerId="[Prefetcher] ",this.vP=!0,this.Kj=0,this.isActive=!0,this.Qj=new c(),this.gj=new c()}i.NP=o},function(t,i,n){var r=n(104),s=n(105),e=s;e.kP=r,e.Rb=s,t.exports=e},function(t,i){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,i,n){"use strict";t.exports=o;n(10);var r=n(11),s=n(69),e=n(12),h=n(39);function o(t,i,n){if(!(this instanceof o))return new o(t,i,n);var r=this.head=new this.Node();(r.next=r).CP=r,this.ke=i||Object.Ae,this.De=n||Function.Ne,this.length=0,this.hiveAddEach(t)}function u(t){this.head=t,this.DP=t.next}function a(t){this.value=t,this.CP=null,this.next=null}o.MP=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,s.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.je=function(t){return new this.constructor(t,this.ke,this.De)},o.prototype.find=function(t,i,n){i=i||this.ke;for(var r=this.head,s=this.jP(n,r.next);s!==r;){if(i(s.value,t))return s;s=s.next}},o.prototype.findLast=function(t,i,n){i=i||this.ke;for(var r=this.head,s=this.jP(n,r.CP);s!==r;){if(i(s.value,t))return s;s=s.CP}},o.prototype.has=function(t,i){return!!this.find(t,i)},o.prototype.get=function(t,i){var n=this.find(t,i);return n?n.value:this.De(t)},o.prototype["delete"]=function(t,i){var n=this.findLast(t,i);if(n){if(this.BC){var r=[],s=[t];this.KC(r,s,n.index)}return n["delete"](),this.length--,this.BC&&(this.PP(n.next,n.index),this.qC(r,s,n.index)),!0}return!1},o.prototype.ZC=function(t,i){i=i||this.ke;for(var n=this.head,r=n.next,s=0;r!==n;)i(t,r.value)&&(r["delete"](),s++),r=r.next;return this.length-=s,s},o.prototype.clear=function(){var t,i;this.BC&&(i=this.toArray(),t=[],this.KC(t,i,0)),this.head.next=this.head.CP=this.head,this.length=0,this.BC&&this.qC(t,i,0)},o.prototype.hiveAdd=function(t){var i=new this.Node(t);return this.BC&&(i.index=this.length,this.KC([t],[],i.index)),this.head.LP(i),this.length++,this.BC&&this.qC([t],[],i.index),!0},o.prototype.push=function(){var t=this.head;if(this.BC){var i=Array.prototype.slice.call(arguments),n=[],r=this.length;this.KC(i,n,r);var s=this.head.CP}for(var e=0;e<arguments.length;e++){var h=arguments[e],o=new this.Node(h);t.LP(o)}this.length+=arguments.length,this.BC&&(this.PP(s.next,void 0===s.index?0:s.index+1),this.qC(i,n,r))},o.prototype.unshift=function(){if(this.BC){var t=Array.prototype.slice.call(arguments),i=[];this.KC(t,i,0)}for(var n=this.head,r=0;r<arguments.length;r++){var s=arguments[r],e=new this.Node(s);n.HP(e),n=e}this.length+=arguments.length,this.BC&&(this.PP(this.head.next,0),this.qC(t,i,0))},o.prototype.pop=function(){var t,i=this.head;if(i.CP!==i){if(t=i.CP.value,this.BC){var n=[],r=[t],s=this.length-1;this.KC(n,r,s)}i.CP["delete"](),this.length--,this.BC&&this.qC(n,r,s)}return t},o.prototype.shift=function(){var t,i=this.head;if(i.CP!==i){if(t=i.next.value,this.BC){var n=[],r=[t];this.KC(n,r,0)}i.next["delete"](),this.length--,this.BC&&(this.PP(this.head.next,0),this.qC(n,r,0))}return t},o.prototype.UP=function(){if(this.head!==this.head.next)return this.head.next.value},o.prototype.FP=function(t){this.head!==this.head.next?this.head.next.value=t:this.push(t)},o.prototype.qf=function(){return this.UP()},o.prototype.jP=function(t,i){var n=this.head;if("number"!=typeof t)return t||i;var r=t;if(0<=r)for(t=n.next;r&&(r--,(t=t.next)!=n););else for(t=n;r<0&&(r++,(t=t.CP)!=n););return t},o.prototype.slice=function(t,i){var n=[],r=this.head;for(t=this.jP(t,r.next),i=this.jP(i,r);t!==i&&t!==r;)n.push(t.value),t=t.next;return n},o.prototype.splice=function(t,i){return this.GP(t,i,Array.prototype.slice.call(arguments,2))},o.prototype.GP=function(t,i,n){var r=t;t=this.jP(t,this.head),null==i&&(i=1/0),n=Array.from(n);for(var s,e,h=[],o=t;i--&&0<=i&&o!==this.head;)h.push(o.value),o=o.next;this.BC&&(s=t===this.head?this.length:t.CP===this.head?0:t.index,e=t.CP,this.KC(n,h,s));o=t;var u=0;for(o=t;u<h.length;u++,o=o.next)o["delete"]();null==r&&o===this.head&&(o=this.head.next);for(u=0;u<n.length;u++){var a=new this.Node(n[u]);o.LP(a)}return this.length+=n.length-h.length,this.BC&&(t===this.head?this.PP(this.head.next,0):this.PP(e.next,e.index+1),this.qC(n,h,s)),h},o.prototype.reverse=function(){if(this.BC){var t=this.toArray(),i=t.reversed();this.KC(i,t,0)}var n=this.head;do{var r=n.next;n.next=n.CP,n.CP=r,n=n.next}while(n!==this.head);return this.BC&&this.qC(i,t,0),this},o.prototype.sort=function(){this.GP(0,this.length,this.Bf())},o.prototype.reduce=function(t,i){for(var n=arguments[2],r=this.head,s=r.next;s!==r;)i=t.call(n,i,s.value,s,this),s=s.next;return i},o.prototype.reduceRight=function(t,i){for(var n=arguments[2],r=this.head,s=r.CP;s!==r;)i=t.call(n,i,s.value,s,this),s=s.CP;return i},o.prototype.PP=function(t,i){for(;t!==this.head;)t.index=i++,t=t.next},o.prototype.sc=function(){this.head.index=-1,this.PP(this.head.next,0),this.BC=!0},o.prototype.Qf=function(){return new u(this.head)},u.prototype.xP=null,Object.defineProperty(u.prototype,"BP",{get:function(){return this.xP||(this.xP={done:!1,value:null})}}),u.prototype.next=function(){if(this.DP===this.head)this.BP.done=!0,this.BP.value=void 0;else{var t=this.DP.value;this.DP=this.DP.next,this.BP.value=t}return this.BP},(o.prototype.Node=a).prototype["delete"]=function(){this.CP.next=this.next,this.next.CP=this.CP},a.prototype.LP=function(t){var i=this.CP;(((this.CP=t).CP=i).next=t).next=this},a.prototype.HP=function(t){var i=this.next;(((this.next=t).next=i).CP=t).CP=this}},function(t,i,n){"use strict";n(10);var r=n(11),s=n(56),e=n(12);function h(t,i){if(!(this instanceof h))return new h(t,i);i=i||Function.Ne,this.De=i,this.store=Object.create(null),this.length=0,this.hiveAddEach(t)}(t.exports=h).VP=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.je=function(t){return new this.constructor(t,this.De)},h.prototype.qP=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t)},Object.defineProperty(h.prototype,"QP",{writable:!0}),Object.defineProperty(h.prototype,"YP",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this.KP}}),Object.defineProperty(h.prototype,"KP",{get:function(){return this.QP},set:function(t){this.QP=t}}),h.prototype.get=function(t,i){return this.qP(t),"__proto__"===t?this.YP?this.KP:1<arguments.length?i:this.De(t):t in this.store?this.store[t]:1<arguments.length?i:this.De(t)},h.prototype.set=function(t,i){this.qP(t);var n="__proto__"===t;return(n?this.YP:t in this.store)?(this.WP&&this.$P(t,n?this.KP:this.store[t]),n?this.KP=i:this.store[t]=i,this.WP&&this.XP(t,i),!1):(this.WP&&this.$P(t,void 0),this.length++,n?this.KP=i:this.store[t]=i,this.WP&&this.XP(t,i),!0)},h.prototype.has=function(t){return this.qP(t),"__proto__"===t?this.YP:t in this.store},h.prototype["delete"]=function(t){return this.qP(t),"__proto__"===t?!!this.YP&&(this.WP&&this.$P(t,this.KP),this.KP=void 0,this.length--,this.WP&&this.XP(t,void 0),!0):t in this.store&&(this.WP&&this.$P(t,this.store[t]),delete this.store[t],this.length--,this.WP&&this.XP(t,void 0),!0)},h.prototype.clear=function(){var t;for(t in this.YP&&(this.WP&&this.$P("__proto__",this.KP),this.KP=void 0,this.WP&&this.XP("__proto__",void 0)),this.store)this.WP&&this.$P(t,this.store[t]),delete this.store[t],this.WP&&this.XP(t,void 0);this.length=0},h.prototype.reduce=function(t,i,n){this.YP&&(i=t.call(n,i,"$__proto__","__proto__",this));var r=this.store;for(var s in this.store)i=t.call(n,i,r[s],s,this);return i},h.prototype.reduceRight=function(n,t,r){var s=this,e=this.store;return t=Object.keys(this.store).reduceRight(function(t,i){return n.call(r,t,e[i],i,s)},t),this.YP?n.call(r,t,this.KP,"__proto__",s):t},h.prototype.qf=function(){var t;for(t in this.store)return this.store[t];return this.KP},h.prototype.toJSON=function(){return this.Lf()}},function(t,i,n){"use strict";var r=n(37),s=n(109),e=n(12);function h(){throw new Error("Can't construct. GenericMap is a mixin.")}function o(t,i){this.key=t,this.value=i}t.exports=h,r.hiveAddEach(h.prototype,s.prototype),r.hiveAddEach(h.prototype,e.prototype),h.prototype.isMap=!0,h.prototype.hiveAddEach=function(i){if(i&&r(i)===i)if("function"==typeof i.forEach)!0===i.isMap?i.forEach(function(t,i){this.set(i,t)},this):i.forEach(function(t){this.set(t[0],t[1])},this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else r.keys(i).forEach(function(t){this.set(t,i[t])},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},h.prototype.get=function(t,i){var n=this.store.get(new this.JP(t));return n?n.value:1<arguments.length?i:this.De(t)},h.prototype.set=function(t,i){var n=new this.JP(t,i),r=this.store.get(n),s=!1;return r?(this.WP&&this.$P(t,r.value),r.value=i):(this.WP&&this.$P(t,void 0),this.store.hiveAdd(n)&&(this.length++,s=!0)),this.WP&&this.XP(t,i),s},h.prototype.hiveAdd=function(t,i){return this.set(i,t)},h.prototype.has=function(t){return this.store.has(new this.JP(t))},h.prototype["delete"]=function(t){var i=new this.JP(t);if(this.store.has(i)){var n=this.store.get(i).value;return this.WP&&this.$P(t,n),this.store["delete"](i),this.length--,this.WP&&this.XP(t,void 0),!0}return!1},h.prototype.clear=function(){var t;this.WP&&(this.forEach(function(t,i){this.$P(i,t)},this),t=this.keys()),this.store.clear(),this.length=0,this.WP&&t.forEach(function(t){this.XP(t)},this)},h.prototype.reduce=function(n,t,r){return this.store.reduce(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.reduceRight=function(n,t,r){return this.store.reduceRight(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.keys=function(){return this.map(function(t,i){return i})},h.prototype.values=function(){return this.map(Function.identity)},h.prototype.entries=function(){return this.map(function(t,i){return[i,t]})},h.prototype.items=function(){return this.entries()},h.prototype.Ae=function(i,n){return n=n||r.Ae,this===i||(i&&"function"==typeof i.every?i.length===this.length&&i.every(function(t,i){return n(this.get(i),t)},this):r.keys(i).length===this.length&&r.keys(i).every(function(t){return n(this.get(t),i[t])},this))},h.prototype.toJSON=function(){return this.entries()},(h.prototype.JP=o).prototype.Ae=function(t){return r.Ae(this.key,t.key)&&r.Ae(this.value,t.value)},o.prototype.compare=function(t){return r.compare(this.key,t.key)}},function(T,m,O){var S;!function(s,c){"use strict";var t="undefined",i="model",n="name",r="type",e="vendor",h="version",o="architecture",u="console",a="mobile",f="tablet",l="smarttv",v="wearable",d={extend:function(t,i){var n={};for(var r in t)i[r]&&i[r].length%2==0?n[r]=i[r].concat(t[r]):n[r]=t[r];return n},has:function(t,i){return"string"==typeof t&&-1!==i.toLowerCase().indexOf(t.toLowerCase())},zP:function(t){return t.toLowerCase()},ZP:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:c},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={tL:function(t,i){for(var n,r,s,e,h,o,u=0;u<i.length&&!h;){var a=i[u],f=i[u+1];for(n=r=0;n<a.length&&!h;)if(h=a[n++].exec(t))for(s=0;s<f.length;s++)o=h[++r],"object"==typeof (e=f[s])&&0<e.length?2==e.length?"function"==typeof e[1]?this[e[0]]=e[1].call(this,o):this[e[0]]=e[1]:3==e.length?"function"!=typeof e[1]||e[1].exec&&e[1].test?this[e[0]]=o?o.replace(e[1],e[2]):c:this[e[0]]=o?e[1].call(this,o,e[2]):c:4==e.length&&(this[e[0]]=o?e[3].call(this,o.replace(e[1],e[2])):c):this[e]=o||c;u+=2}},str:function(t,i){for(var n in i)if("object"==typeof i[n]&&0<i[n].length){for(var r=0;r<i[n].length;r++)if(d.has(i[n][r],t))return"?"===n?c:n}else if(d.has(i[n],t))return"?"===n?c:n;return t}},w={yC:{iL:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419",Ky:"/"}}},nL:{rL:{sL:{eL:["SD","KF"]}},hL:{sL:{oL:"7373KT"},vendor:{uL:"APA",aL:"Sprint"}}},os:{fL:{version:{cL:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",lL:["NT 5.1","NT 5.2"],vL:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],dL:"ARM"}}}},p={yC:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,h],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[n,h],[/(konqueror)\/([\w\.]+)/i],[[n,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[n,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],h],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[n,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[n,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[n,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[n,"Brave"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[n,h],[/(QQ)\/([\d\.]+)/i],[n,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[n,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[n],[/(LBBROWSER)/i],[n],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[n,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[n,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[n,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[n,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,h],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],h],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[h,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[h,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[h,E.str,w.yC.iL.version]],[/(webkit|khtml)\/([\w\.]+)/i],[n,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,h]],EL:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[o,"amd64"]],[/(ia32(?=;))/i],[[o,d.zP]],[/((?:i[346]|x)86)[;\)]/i],[[o,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[o,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[o,/ower/,"",d.zP]],[/(sun4\w)[;\)]/i],[[o,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[o,d.zP]]],nL:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[i,e,[r,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[e,"Apple"],[r,f]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[e,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[e,i,[r,f]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[i,[e,"Amazon"],[r,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[i,E.str,w.nL.rL.sL],[e,"Amazon"],[r,a]],[/android.+aft([bms])\sbuild/i],[i,[e,"Amazon"],[r,l]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,e,[r,a]],[/\((ip[honed|\s\w*]+);/i],[i,[e,"Apple"],[r,a]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[e,i,[r,a]],[/\(bb10;\s(\w+)/i],[i,[e,"BlackBerry"],[r,a]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[i,[e,"Asus"],[r,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[e,"Sony"],[i,"Xperia Tablet"],[r,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[e,"Sony"],[r,a]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[e,i,[r,u]],[/android.+;\s(shield)\sbuild/i],[i,[e,"Nvidia"],[r,u]],[/(playstation\s[34portablevi]+)/i],[i,[e,"Sony"],[r,u]],[/(sprint\s(\w+))/i],[[e,E.str,w.nL.hL.vendor],[i,E.str,w.nL.hL.sL],[r,a]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[e,[i,/_/g," "],[r,a]],[/(nexus\s9)/i],[i,[e,"HTC"],[r,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[i,[e,"Huawei"],[r,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[e,i,[r,a]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[e,"Microsoft"],[r,u]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[e,"Microsoft"],[r,a]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[e,"Motorola"],[r,a]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[e,"Motorola"],[r,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[e,d.trim],[i,d.trim],[r,l]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[e,"Samsung"],[r,l]],[/\(dtv[\);].+(aquos)/i],[i,[e,"Sharp"],[r,l]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[e,"Samsung"],i,[r,f]],[/smart-tv.+(samsung)/i],[e,[r,l],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[e,"Samsung"],i,[r,a]],[/sie-(\w*)/i],[i,[e,"Siemens"],[r,a]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[e,"Nokia"],i,[r,a]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[i,[e,"Acer"],[r,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[i,[e,"LG"],[r,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[e,"LG"],i,[r,f]],[/(lg) netcast\.tv/i],[e,i,[r,l]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[i,[e,"LG"],[r,a]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[e,i,[r,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[e,"Lenovo"],[r,f]],[/(lenovo)[_\s-]?([\w-]+)/i],[e,i,[r,a]],[/linux;.+((jolla));/i],[e,i,[r,a]],[/((pebble))app\/[\d\.]+\s/i],[e,i,[r,v]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[e,i,[r,a]],[/crkey/i],[[i,"Chromecast"],[e,"Google"]],[/android.+;\s(glass)\s\d/i],[i,[e,"Google"],[r,v]],[/android.+;\s(pixel c)[\s)]/i],[i,[e,"Google"],[r,f]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[i,[e,"Google"],[r,a]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,a]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,f]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[i,[e,"Meizu"],[r,a]],[/(mz)-([\w-]{2,})/i],[[e,"Meizu"],i,[r,a]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[i,[e,"OnePlus"],[r,a]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[i,[e,"RCA"],[r,f]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[i,[e,"Dell"],[r,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[i,[e,"Verizon"],[r,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[e,"Barnes & Noble"],i,[r,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[i,[e,"NuVision"],[r,f]],[/android.+;\s(k88)\sbuild/i],[i,[e,"ZTE"],[r,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[i,[e,"Swiss"],[r,a]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[i,[e,"Swiss"],[r,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[i,[e,"Zeki"],[r,f]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[e,"Dragon Touch"],i,[r,f]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[i,[e,"Insignia"],[r,f]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[i,[e,"NextBook"],[r,f]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[e,"Voice"],i,[r,a]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[e,"LvTel"],i,[r,a]],[/android.+;\s(PH-1)\s/i],[i,[e,"Essential"],[r,a]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[i,[e,"Envizen"],[r,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[i,[e,"MachSpeed"],[r,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[i,[e,"Rotor"],[r,f]],[/android.+(KS(.+))\s+build/i],[i,[e,"Amazon"],[r,f]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[e,i,[r,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[r,d.zP],e,i],[/[\s\/\(](smart-?tv)[;\)]/i],[[r,l]],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[e,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[n,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[n,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[h,E.str,w.os.fL.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[h,E.str,w.os.fL.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[n,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[n,"Symbian"],h],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],h],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[n,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[n,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[n,h],[/(haiku)\s(\w+)/i],[n,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[n,h]]},g=function(t,i){if("object"==typeof t&&(i=t,t=c),!(this instanceof g))return new g(t,i).wL();var n=t||(s&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:""),r=i?d.extend(p,i):p;return this.pL=function(){var t={name:c,version:c};return E.tL.call(t,n,r.yC),t.ZP=d.ZP(t.version),t},this.gL=function(){var t={bL:c};return E.tL.call(t,n,r.EL),t},this.yL=function(){var t={vendor:c,sL:c,type:c};return E.tL.call(t,n,r.nL),t},this.TL=function(){var t={name:c,version:c};return E.tL.call(t,n,r.engine),t},this.Fd=function(){var t={name:c,version:c};return E.tL.call(t,n,r.os),t},this.wL=function(){return{Lm:this.mL(),yC:this.pL(),engine:this.TL(),os:this.Fd(),nL:this.yL(),EL:this.gL()}},this.mL=function(){return n},this.Ud=function(t){return n=t,this},this};g.VERSION="0.7.20",g.OL={SL:n,RL:"major",VERSION:h},g._L={IL:o},g.AL={NL:i,VENDOR:e,kL:r,CL:u,DL:a,ML:l,jL:f,PL:v,LL:"embedded"},g.HL={SL:n,VERSION:h},g.UL={SL:n,VERSION:h},typeof m!=t?(typeof T!=t&&T.exports&&(m=T.exports=g),m.Hd=g):(S=function(){return g}.call(m,O,m,T))===c||(T.exports=S);var b=s&&(s.jQuery||s.FL);if(typeof b!=t&&!b.Lm){var y=new g();b.Lm=y.wL(),b.Lm.get=function(){return y.mL()},b.Lm.set=function(t){y.Ud(t);var i=y.wL();for(var n in i)b.Lm[n]=i[n]}}}("object"==typeof window?window:this)},function(t,A,N){(function(h){var i=Object.getOwnPropertyDescriptors||function(t){for(var i=Object.keys(t),n={},r=0;r<i.length;r++)n[i[r]]=Object.getOwnPropertyDescriptor(t,i[r]);return n},o=/%[sdj%]/g;A.format=function(t){if(!b(t)){for(var i=[],n=0;n<arguments.length;n++)i.push(u(arguments[n]));return i.join(" ")}n=1;for(var r=arguments,s=r.length,e=String(t).replace(o,function(t){if("%%"===t)return"%";if(s<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),h=r[n];n<s;h=r[++n])p(h)||!a(h)?e+=" "+h:e+=" "+u(h);return e},A.GL=function(t,i){if(void 0!==h&&!0===h.xL)return t;if(void 0===h)return function(){return A.GL(t,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(h.BL)throw new Error(i);h.VL?console.trace(i):!1,n=!0}return t.apply(this,arguments)}};var t,r={};function u(t,i){var n={qL:[],QL:e};return 3<=arguments.length&&(n.YL=arguments[2]),4<=arguments.length&&(n.KL=arguments[3]),w(i)?n.WL=i:i&&A.$L(n,i),y(n.WL)&&(n.WL=!1),y(n.YL)&&(n.YL=2),y(n.KL)&&(n.KL=!1),y(n.XL)&&(n.XL=!0),n.KL&&(n.QL=s),l(n,t,n.YL)}function s(t,i){var n=u.JL[i];return n?"\x1b["+u.KL[n][0]+"m"+t+"\x1b["+u.KL[n][1]+"m":t}function e(t,i){return t}function l(i,n,r){if(i.XL&&n&&S(n.Qe)&&n.Qe!==A.Qe&&(!n.constructor||n.constructor.prototype!==n)){var t=n.Qe(r,i);return b(t)||(t=l(i,t,r)),t}var s=function(t,i){if(y(i))return t.QL("undefined","undefined");if(b(i)){var n="'"+JSON.stringify(i).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.QL(n,"string")}if(g(i))return t.QL(""+i,"number");if(w(i))return t.QL(""+i,"boolean");if(p(i))return t.QL("null","null")}(i,n);if(s)return s;var e=Object.keys(n),h=function(t){var n={};return t.forEach(function(t,i){n[t]=!0}),n}(e);if(i.WL&&(e=Object.getOwnPropertyNames(n)),O(n)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return v(n);if(0===e.length){if(S(n)){var o=n.name?": "+n.name:"";return i.QL("[Function"+o+"]","special")}if(T(n))return i.QL(RegExp.prototype.toString.call(n),"regexp");if(m(n))return i.QL(Date.prototype.toString.call(n),"date");if(O(n))return v(n)}var u,a="",f=!1,c=["{","}"];E(n)&&(f=!0,c=["[","]"]),S(n)&&(a=" [Function"+(n.name?": "+n.name:"")+"]");return T(n)&&(a=" "+RegExp.prototype.toString.call(n)),m(n)&&(a=" "+Date.prototype.toUTCString.call(n)),O(n)&&(a=" "+v(n)),0!==e.length||f&&0!=n.length?r<0?T(n)?i.QL(RegExp.prototype.toString.call(n),"regexp"):i.QL("[Object]","special"):(i.qL.push(n),u=f?function(i,n,r,s,t){for(var e=[],h=0,o=n.length;h<o;++h)R(n,String(h))?e.push(d(i,n,r,s,String(h),!0)):e.push("");return t.forEach(function(t){t.match(/^\d+$/)||e.push(d(i,n,r,s,t,!0))}),e}(i,n,r,h,e):e.map(function(t){return d(i,n,r,h,t,f)}),i.qL.pop(),function(t,i,n){return 60<t.reduce(function(t,i){return 0<=i.indexOf("\n")&&0,t+i.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(""===i?"":i+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+i+" "+t.join(", ")+" "+n[1]}(u,a,c)):c[0]+a+c[1]}function v(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,i,n,r,s,e){var h,o,u;if((u=Object.getOwnPropertyDescriptor(i,s)||{value:i[s]}).get?o=u.set?t.QL("[Getter/Setter]","special"):t.QL("[Getter]","special"):u.set&&(o=t.QL("[Setter]","special")),R(r,s)||(h="["+s+"]"),o||(t.qL.indexOf(u.value)<0?-1<(o=p(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")&&(o=e?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.QL("[Circular]","special")),y(h)){if(e&&s.match(/^\d+$/))return o;h=(h=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.substr(1,h.length-2),t.QL(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.QL(h,"string"))}return h+": "+o}function E(t){return Array.isArray(t)}function w(t){return"boolean"==typeof t}function p(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return void 0===t}function T(t){return a(t)&&"[object RegExp]"===n(t)}function a(t){return"object"==typeof t&&null!==t}function m(t){return a(t)&&"[object Date]"===n(t)}function O(t){return a(t)&&("[object Error]"===n(t)||t instanceof Error)}function S(t){return"function"==typeof t}function n(t){return Object.prototype.toString.call(t)}function f(t){return t<10?"0"+t.toString(10):t.toString(10)}A.zL=function(i){if(y(t)&&(t=h.Ye.ZL||""),i=i.toUpperCase(),!r[i])if(new RegExp("\\b"+i+"\\b","i").test(t)){var n=h.tH;r[i]=function(){var t=A.format.apply(A,arguments)}}else r[i]=function(){};return r[i]},(A.Qe=u).KL={bold:[1,22],iH:[3,23],nH:[4,24],inverse:[7,27],rH:[37,39],sH:[90,39],eH:[30,39],blue:[34,39],hH:[36,39],green:[32,39],oH:[35,39],red:[31,39],uH:[33,39]},u.JL={aH:"cyan",number:"yellow",fH:"yellow",undefined:"grey","null":"bold",string:"green",XR:"magenta",cH:"red"},A.isArray=E,A.Vm=w,A.Qm=p,A.lH=function(t){return null==t},A.Ym=g,A.Km=b,A.vH=function(t){return"symbol"==typeof t},A.Wm=y,A.dH=T,A.dc=a,A.EH=m,A.wH=O,A.qm=S,A.pH=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},A.isBuffer=N(134);var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,i){return Object.prototype.hasOwnProperty.call(t,i)}A.log=function(){},A.pE=N(135),A.$L=function(t,i){if(!i||!a(i))return t;for(var n=Object.keys(i),r=n.length;r--;)t[n[r]]=i[n[r]];return t};var _="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(t,i){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return i(t)}A.gH=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(_&&e[_]){var t;if("function"!=typeof (t=e[_]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,_,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var n,r,t=new Promise(function(t,i){n=t,r=i}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,i){t?r(t):n(i)});try{e.apply(this,i)}catch(t){r(t)}return t}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),_&&Object.defineProperty(t,_,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},A.gH.bH=_,A.yH=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");function r(){return n.apply(s,arguments)}var s=this;e.apply(this,t).then(function(t){h.Fe(r,null,t)},function(t){h.Fe(I,t,r)})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}}).call(this,N(36))},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r,s){this.id=t,this.bitrate=i,this.duration=n,this.uri=r,this.TH=s}i.mH=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(33),e=n(50),h=n(0),a=n(160),s=n(8),u=n(24),f=n(51),o=n(5),d=n(2),E=n(1),c=(l.prototype.mP=function(){return null},l.prototype.OH=function(){return this.SH},l.prototype.RH=function(t,i){try{var n=0,r=0;if(this._H.length<i)return!0;for(var s=this._H.keys().reverse(),e=s[0],h=this._H.get(e).bitrate,o=s.slice(1),u=0;u<o.length;u++){var a=o[u],f=this._H.get(a),c=f.IH,l=f.bitrate,v=Math.abs(f.IH-e);if(l!=h)return!1;if(v<t){if(++r>=i)return!1}else{if(++n>i)return!0;r=Math.max(0,r-1),e=c,h=l}}return!1}catch(t){return E.ErrorMonitor.Z().logError("Error calculating if the player is in buffering mode",this.AH,d.br.yr,t),!1}},l.prototype.getContextId=function(){return null},l.prototype.NH=function(t,i){if(this.kH(i)){var n=this.Tj();if(n){var r=t.getBitrate(),s=n.getBitrate();s<r?this.DH.CH(!0):r<s&&this.DH.CH(!1)}else this.DH.CH(!0);if(this._H.length>o.Ku.Lu.Lo){var e=this._H.keys()[0];this._H["delete"](e)}this._H.set(h.Framework.time(),t)}return this.MH(t,i)},l.prototype.MH=function(t,i){var n=new a.jH();try{if(this.SH.pj(t.bitrate)){if(this.LH.PH(t.qp())){n.HH=!0;var r=this.LH.UH(t.qp());this.FH(i,r,n)}if(this.LH.GH(t.qp()))for(var s=this.LH.xH(t.qp()),e=0,h=s;e<h.length;e++){var o=h[e];this.FH(i,o.xp(),n),n.BH=!0}}else{var u=f.tj.Nf;this.cj.rP()&&(u=f.tj.ij),this.SH.Rj(t.bitrate,u,u)}return n}catch(t){return E.ErrorMonitor.Z().logError("Error configuring the request directive",this.AH,d.br.Tr,t),new a.jH()}},l.prototype.FH=function(t,i,n){t!=u.yp.Op&&t!=u.yp._p||i!=u.yp.Tp&&i!=u.yp._p&&i!=u.yp.Op||(n.VH=!0)},l.prototype.kH=function(t){return t!=u.yp._p&&t!=u.yp.Op},l.prototype.qH=function(t,i,n){var r=[];try{for(var s=this.LH.xH(i.qp()),e=0,h=s;e<h.length;e++){var o=h[e];o.xp()!=u.yp.Tp&&(this.SH.SP(o,t),r.push(o.RP))}return r}catch(t){return E.ErrorMonitor.Z().logError("Error attempting to upgrade prefetch",this.AH,d.br.mr,t),[]}},l.prototype.QH=function(t){this.LH.QH(t)},l.prototype.YH=function(t,i){this.LH.YH(t,i)},l.prototype.KH=function(t){this.LH.KH(t)},l.prototype.WH=function(t){this.LH.$H(t)},l.prototype.XH=function(t){this.LH.JH()||this.SH.Dj(t)},l.prototype.Tj=function(){var t=this._H.keys();return 0<t.length?this._H.get(t[t.length-1]):null},l.prototype.zH=function(){var t=this._H.keys();if(0<t.length)return t[t.length-1]},l.prototype.ZH=function(t){var i=this.tU(t);null!=i&&this.XH(i.bitrate)},l.prototype.tU=function(t){var i=t.fragmentId,n=i.slice(0,i.lastIndexOf("-")),r=n.slice(0,n.lastIndexOf("-")),s=t.getType();return new e.ZM(r,s,!0,t.id,t.duration,t.bitrate,!0,this.getContextId())},l.prototype.iU=function(t){t.Bp()===s.yf.mf&&this.YH(t.qp(),t.Qp())},l);function l(t,i){this.AH="[VideoContext] ",this._H=new r(),this.logger=h.Framework.resolve(h.Framework.p.T).log(t.sessionId),this.cj=t.cj,this.DH=t.nU,this.LH=t.LH,this.SH=t.rU,this.sU=i,this.SH.Ej(this,this)}i.eU=c},function(t,i,n){"use strict";t.exports=h;n(10);var s=n(161),r=n(40),e=n(12);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);s.call(this,t,i,n,r)}((h.SortedArraySet=h).prototype=Object.create(s.prototype)).constructor=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.hU=!0,h.prototype.hiveAdd=function(t){return!this.has(t)&&(s.prototype.hiveAdd.call(this,t),!0)},h.prototype.reduce=function(r,t){var s=this,e=arguments[2];return this.tR.reduce(function(t,i,n){return r.call(e,t,i,n,s)},t)},h.prototype.reduceRight=function(r,t){var s=this,e=arguments[2];return this.tR.reduceRight(function(t,i,n){return r.call(e,t,i,n,s)},t)}},function(t,i,n){var M=n(23),j=window.hive;void 0===j&&(j=window.hive={}),void 0===j.services&&(j.services={}),void 0===j.services.protocol&&(j.services.protocol={}),void 0===j.services.protocol.oU&&(j.services.protocol.oU={}),j.services.protocol.oU.Af={1:"PLAYER",Nf:1,2:"P2P_AGENT",kf:2,3:"PREFETCHER_FIRST_TIER",Cf:3,4:"PREFETCHER_SECOND_TIER",Df:4},j.services.protocol.oU.uU={1:"Global",Global:1,2:"InternalAs",aU:2,3:"ExternalAs",fU:3},j.services.protocol.oU.cU={1:"Internal",lU:1,2:"External",External:2},j.services.protocol.oU.TrackerPeerStreamInfo=function(t){this.state=null,this.bitrate=null,this.delta=null,this.vU=null,t&&(void 0!==t.state&&null!==t.state&&(this.state=t.state),void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.delta&&null!==t.delta&&(this.delta=t.delta),void 0!==t.vU&&null!==t.vU&&(this.vU=t.vU))},j.services.protocol.oU.TrackerPeerStreamInfo.prototype={},j.services.protocol.oU.TrackerPeerStreamInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.state=t.LE().value:t.PE(n);break;case 2:n==M.Type.I32?this.bitrate=t.LE().value:t.PE(n);break;case 3:n==M.Type.I32?this.delta=t.LE().value:t.PE(n);break;case 4:n==M.Type.STRING?this.vU=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerPeerStreamInfo.prototype.write=function(t){t.FE("TrackerPeerStreamInfo"),null!==this.state&&void 0!==this.state&&(t.GE("state",M.Type.I32,1),t.VE(this.state),t.BE()),null!==this.bitrate&&void 0!==this.bitrate&&(t.GE("bitrate",M.Type.I32,2),t.VE(this.bitrate),t.BE()),null!==this.delta&&void 0!==this.delta&&(t.GE("delta",M.Type.I32,3),t.VE(this.delta),t.BE()),null!==this.vU&&void 0!==this.vU&&(t.GE("qualityLevel",M.Type.STRING,4),t.xE(this.vU),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerPeerInfo=function(t){this.guid=null,this.internalAs=null,this.externalAs=null,this.nat=null,this.bandwidth=null,this.watchingBitrate=null,this.privateIp=null,this.publicIp=null,this.streams=null,this.rankValue=null,this.timestamp=null,this.publicIpString=null,this.privateIpString=null,this.dU=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.nat&&null!==t.nat&&(this.nat=t.nat),void 0!==t.bandwidth&&null!==t.bandwidth&&(this.bandwidth=t.bandwidth),void 0!==t.watchingBitrate&&null!==t.watchingBitrate&&(this.watchingBitrate=t.watchingBitrate),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.streams&&null!==t.streams&&(this.streams=t.streams),void 0!==t.rankValue&&null!==t.rankValue&&(this.rankValue=t.rankValue),void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.publicIpString&&null!==t.publicIpString&&(this.publicIpString=t.publicIpString),void 0!==t.privateIpString&&null!==t.privateIpString&&(this.privateIpString=t.privateIpString),void 0!==t.dU&&null!==t.dU&&(this.dU=t.dU))},j.services.protocol.oU.TrackerPeerInfo.prototype={},j.services.protocol.oU.TrackerPeerInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRING?this.guid=t.cp().value:t.PE(n);break;case 2:n==M.Type.I32?this.internalAs=t.LE().value:t.PE(n);break;case 3:n==M.Type.I32?this.externalAs=t.LE().value:t.PE(n);break;case 4:n==M.Type.I32?this.nat=t.LE().value:t.PE(n);break;case 5:n==M.Type.I32?this.bandwidth=t.LE().value:t.PE(n);break;case 6:n==M.Type.I32?this.watchingBitrate=t.LE().value:t.PE(n);break;case 7:n==M.Type.STRUCT?(this.privateIp=new InetAddress(),this.privateIp.read(t)):t.PE(n);break;case 8:n==M.Type.STRUCT?(this.publicIp=new InetAddress(),this.publicIp.read(t)):t.PE(n);break;case 9:if(n==M.Type.LIST){var s,e;this.streams=[];(e=t.tp()).np,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new j.services.protocol.oU.TrackerPeerStreamInfo()).read(t),this.streams.push(o)}t.rp()}else t.PE(n);break;case 10:n==M.Type.DOUBLE?this.rankValue=t.fp().value:t.PE(n);break;case 11:n==M.Type.I64?this.timestamp=t.ap().value:t.PE(n);break;case 12:n==M.Type.STRING?this.publicIpString=t.jE().value:t.PE(n);break;case 13:n==M.Type.STRING?this.privateIpString=t.jE().value:t.PE(n);break;case 14:n==M.Type.STRING?this.dU=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerPeerInfo.prototype.write=function(t){if(t.FE("TrackerPeerInfo"),null!==this.guid&&void 0!==this.guid&&(t.GE("guid",M.Type.STRING,1),t.Vw(this.guid),t.BE()),null!==this.internalAs&&void 0!==this.internalAs&&(t.GE("internalAs",M.Type.I32,2),t.VE(this.internalAs),t.BE()),null!==this.externalAs&&void 0!==this.externalAs&&(t.GE("externalAs",M.Type.I32,3),t.VE(this.externalAs),t.BE()),null!==this.nat&&void 0!==this.nat&&(t.GE("nat",M.Type.I32,4),t.VE(this.nat),t.BE()),null!==this.bandwidth&&void 0!==this.bandwidth&&(t.GE("bandwidth",M.Type.I32,5),t.VE(this.bandwidth),t.BE()),null!==this.watchingBitrate&&void 0!==this.watchingBitrate&&(t.GE("watchingBitrate",M.Type.I32,6),t.VE(this.watchingBitrate),t.BE()),null!==this.privateIp&&void 0!==this.privateIp&&(t.GE("privateIp",M.Type.STRUCT,7),this.privateIp.write(t),t.BE()),null!==this.publicIp&&void 0!==this.publicIp&&(t.GE("publicIp",M.Type.STRUCT,8),this.publicIp.write(t),t.BE()),null!==this.streams&&void 0!==this.streams){for(var i in t.GE("streams",M.Type.LIST,9),t.jw(M.Type.STRUCT,this.streams.length),this.streams)this.streams.hasOwnProperty(i)&&(i=this.streams[i]).write(t);t.Pw(),t.BE()}null!==this.rankValue&&void 0!==this.rankValue&&(t.GE("rankValue",M.Type.DOUBLE,10),t.Bw(this.rankValue),t.BE()),null!==this.timestamp&&void 0!==this.timestamp&&(t.GE("timestamp",M.Type.I64,11),t.xw(this.timestamp),t.BE()),null!==this.publicIpString&&void 0!==this.publicIpString&&(t.GE("publicIpString",M.Type.STRING,12),t.xE(this.publicIpString),t.BE()),null!==this.privateIpString&&void 0!==this.privateIpString&&(t.GE("privateIpString",M.Type.STRING,13),t.xE(this.privateIpString),t.BE()),null!==this.dU&&void 0!==this.dU&&(t.GE("watchingQualityLevel",M.Type.STRING,14),t.xE(this.dU),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.CustomerKey=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))},j.services.protocol.oU.CustomerKey.prototype={},j.services.protocol.oU.CustomerKey.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRING?this.partnerId=t.jE().value:t.PE(n);break;case 2:n==M.Type.STRING?this.customerId=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.CustomerKey.prototype.write=function(t){t.FE("CustomerKey"),null!==this.partnerId&&void 0!==this.partnerId&&(t.GE("partnerId",M.Type.STRING,1),t.xE(this.partnerId),t.BE()),null!==this.customerId&&void 0!==this.customerId&&(t.GE("customerId",M.Type.STRING,2),t.xE(this.customerId),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerAsQuery=function(t){this.asType=null,this.asn=null,t&&(void 0!==t.asType&&null!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn))},j.services.protocol.oU.TrackerAsQuery.prototype={},j.services.protocol.oU.TrackerAsQuery.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.asType=t.LE().value:t.PE(n);break;case 2:n==M.Type.I32?this.asn=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerAsQuery.prototype.write=function(t){t.FE("TrackerAsQuery"),null!==this.asType&&void 0!==this.asType&&(t.GE("asType",M.Type.I32,1),t.VE(this.asType),t.BE()),null!==this.asn&&void 0!==this.asn&&(t.GE("asn",M.Type.I32,2),t.VE(this.asn),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerBitrateQuery=function(t){this.bitrate=null,this.asn=null,this.streamState=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState))},j.services.protocol.oU.TrackerBitrateQuery.prototype={},j.services.protocol.oU.TrackerBitrateQuery.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.bitrate=t.LE().value:t.PE(n);break;case 2:n==M.Type.STRUCT?(this.asn=new j.services.protocol.oU.TrackerAsQuery(),this.asn.read(t)):t.PE(n);break;case 3:n==M.Type.I32?this.streamState=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerBitrateQuery.prototype.write=function(t){t.FE("TrackerBitrateQuery"),null!==this.bitrate&&void 0!==this.bitrate&&(t.GE("bitrate",M.Type.I32,1),t.VE(this.bitrate),t.BE()),null!==this.asn&&void 0!==this.asn&&(t.GE("asn",M.Type.STRUCT,2),this.asn.write(t),t.BE()),null!==this.streamState&&void 0!==this.streamState&&(t.GE("streamState",M.Type.I32,3),t.VE(this.streamState),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.EU=function(t){this.vU=null,this.asn=null,this.streamState=null,t&&(void 0!==t.vU&&null!==t.vU&&(this.vU=t.vU),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState))},j.services.protocol.oU.EU.prototype={},j.services.protocol.oU.EU.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRING?this.vU=t.jE().value:t.PE(n);break;case 2:n==M.Type.STRUCT?(this.asn=new j.services.protocol.oU.TrackerAsQuery(),this.asn.read(t)):t.PE(n);break;case 3:n==M.Type.I32?this.streamState=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.EU.prototype.write=function(t){t.FE("TrackerQualityLevelQuery"),null!==this.vU&&void 0!==this.vU&&(t.GE("qualityLevel",M.Type.STRING,1),t.xE(this.vU),t.BE()),null!==this.asn&&void 0!==this.asn&&(t.GE("asn",M.Type.STRUCT,2),this.asn.write(t),t.BE()),null!==this.streamState&&void 0!==this.streamState&&(t.GE("streamState",M.Type.I32,3),t.VE(this.streamState),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerRankQuery=function(t){this.rankType=null,this.asQuery=null,t&&(void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.asQuery&&null!==t.asQuery&&(this.asQuery=t.asQuery))},j.services.protocol.oU.TrackerRankQuery.prototype={},j.services.protocol.oU.TrackerRankQuery.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.rankType=t.LE().value:t.PE(n);break;case 2:n==M.Type.STRUCT?(this.asQuery=new j.services.protocol.oU.TrackerAsQuery(),this.asQuery.read(t)):t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerRankQuery.prototype.write=function(t){t.FE("TrackerRankQuery"),null!==this.rankType&&void 0!==this.rankType&&(t.GE("rankType",M.Type.I32,1),t.VE(this.rankType),t.BE()),null!==this.asQuery&&void 0!==this.asQuery&&(t.GE("asQuery",M.Type.STRUCT,2),this.asQuery.write(t),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerQuery=function(t){this.random=null,this.asns=null,this.watchers=null,this.streamers=null,this.rankings=null,this.wU=null,this.pU=null,t&&(void 0!==t.random&&null!==t.random&&(this.random=t.random),void 0!==t.asns&&null!==t.asns&&(this.asns=t.asns),void 0!==t.watchers&&null!==t.watchers&&(this.watchers=t.watchers),void 0!==t.streamers&&null!==t.streamers&&(this.streamers=t.streamers),void 0!==t.rankings&&null!==t.rankings&&(this.rankings=t.rankings),void 0!==t.wU&&null!==t.wU&&(this.wU=t.wU),void 0!==t.pU&&null!==t.pU&&(this.pU=t.pU))},j.services.protocol.oU.TrackerQuery.prototype={},j.services.protocol.oU.TrackerQuery.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.random=t.LE().value:t.PE(n);break;case 2:if(n==M.Type.MAP){var s,e;this.asns={};(e=t.Xw()).Jw,e.zw,s=e.size;for(var h=0;h<s;++h){0<h&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var o,u=null;(u=new j.services.protocol.oU.TrackerAsQuery()).read(t),o=t.LE().value,this.asns[u]=o}t.Zw()}else t.PE(n);break;case 3:if(n==M.Type.MAP){var a,f;this.watchers={};(f=t.Xw()).Jw,f.zw,a=f.size;for(var c=0;c<a;++c){0<c&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var l,v=null;(v=new j.services.protocol.oU.TrackerBitrateQuery()).read(t),l=t.LE().value,this.watchers[v]=l}t.Zw()}else t.PE(n);break;case 4:if(n==M.Type.MAP){var d,E;this.streamers={};(E=t.Xw()).Jw,E.zw,d=E.size;for(var w=0;w<d;++w){0<w&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var p,g=null;(g=new j.services.protocol.oU.TrackerBitrateQuery()).read(t),p=t.LE().value,this.streamers[g]=p}t.Zw()}else t.PE(n);break;case 5:if(n==M.Type.LIST){var b,y;this.rankings=[];(y=t.tp()).np,b=y.size;for(var T=0;T<b;++T){var m;m=t.LE().value,this.rankings.push(m)}t.rp()}else t.PE(n);break;case 6:if(n==M.Type.MAP){var O,S;this.wU={};(S=t.Xw()).Jw,S.zw,O=S.size;for(var R=0;R<O;++R){0<R&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var _,I=null;(I=new j.services.protocol.oU.EU()).read(t),_=t.LE().value,this.wU[I]=_}t.Zw()}else t.PE(n);break;case 7:if(n==M.Type.MAP){var A,N;this.pU={};(N=t.Xw()).Jw,N.zw,A=N.size;for(var k=0;k<A;++k){0<k&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var C,D=null;(D=new j.services.protocol.oU.EU()).read(t),C=t.LE().value,this.pU[D]=C}t.Zw()}else t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerQuery.prototype.write=function(t){if(t.FE("TrackerQuery"),null!==this.random&&void 0!==this.random&&(t.GE("random",M.Type.I32,1),t.VE(this.random),t.BE()),null!==this.asns&&void 0!==this.asns){for(var i in t.GE("asns",M.Type.MAP,2),t.Dw(M.Type.STRUCT,M.Type.I32,M.wE(this.asns)),this.asns)if(this.asns.hasOwnProperty(i)){var n=this.asns[i];n.key.write(t),t.VE(n.value)}t.Mw(),t.BE()}if(null!==this.watchers&&void 0!==this.watchers){for(var r in t.GE("watchers",M.Type.MAP,3),t.Dw(M.Type.STRUCT,M.Type.I32,M.wE(this.watchers)),this.watchers)if(this.watchers.hasOwnProperty(r)){var s=this.watchers[r];s.key.write(t),t.VE(s.value)}t.Mw(),t.BE()}if(null!==this.streamers&&void 0!==this.streamers){for(var e in t.GE("streamers",M.Type.MAP,4),t.Dw(M.Type.STRUCT,M.Type.I32,M.wE(this.streamers)),this.streamers)if(this.streamers.hasOwnProperty(e)){var h=this.streamers[e];h.key.write(t),t.VE(h.value)}t.Mw(),t.BE()}if(null!==this.rankings&&void 0!==this.rankings){for(var o in t.GE("rankings",M.Type.LIST,5),t.jw(M.Type.I32,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(o)&&(o=this.rankings[o],t.VE(o));t.Pw(),t.BE()}if(null!==this.wU&&void 0!==this.wU){for(var u in t.GE("watchersForQualityLevel",M.Type.MAP,6),t.Dw(M.Type.STRUCT,M.Type.I32,M.wE(this.wU)),this.wU)if(this.wU.hasOwnProperty(u)){var a=this.wU[u];a.key.write(t),t.VE(a.value)}t.Mw(),t.BE()}if(null!==this.pU&&void 0!==this.pU){for(var f in t.GE("streamersForQualityLevel",M.Type.MAP,7),t.Dw(M.Type.STRUCT,M.Type.I32,M.wE(this.pU)),this.pU)if(this.pU.hasOwnProperty(f)){var c=this.pU[f];c.key.write(t),t.VE(c.value)}t.Mw(),t.BE()}t.qE(),t.QE()},j.services.protocol.oU.TrackerPeerRankingKey=function(t){this.rankType=null,this.internalAs=null,this.externalAs=null,t&&(void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs))},j.services.protocol.oU.TrackerPeerRankingKey.prototype={},j.services.protocol.oU.TrackerPeerRankingKey.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.rankType=t.LE().value:t.PE(n);break;case 2:n==M.Type.I32?this.internalAs=t.LE().value:t.PE(n);break;case 3:n==M.Type.I32?this.externalAs=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerPeerRankingKey.prototype.write=function(t){t.FE("TrackerPeerRankingKey"),null!==this.rankType&&void 0!==this.rankType&&(t.GE("rankType",M.Type.I32,1),t.VE(this.rankType),t.BE()),null!==this.internalAs&&void 0!==this.internalAs&&(t.GE("internalAs",M.Type.I32,2),t.VE(this.internalAs),t.BE()),null!==this.externalAs&&void 0!==this.externalAs&&(t.GE("externalAs",M.Type.I32,3),t.VE(this.externalAs),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerPeerRanking=function(t){this.key=null,this.ranking=null,this.groupSize=null,this.cumulatedRankValue=null,this.totalOfRankValues=null,t&&(void 0!==t.key&&null!==t.key&&(this.key=t.key),void 0!==t.ranking&&null!==t.ranking&&(this.ranking=t.ranking),void 0!==t.groupSize&&null!==t.groupSize&&(this.groupSize=t.groupSize),void 0!==t.cumulatedRankValue&&null!==t.cumulatedRankValue&&(this.cumulatedRankValue=t.cumulatedRankValue),void 0!==t.totalOfRankValues&&null!==t.totalOfRankValues&&(this.totalOfRankValues=t.totalOfRankValues))},j.services.protocol.oU.TrackerPeerRanking.prototype={},j.services.protocol.oU.TrackerPeerRanking.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRUCT?(this.key=new j.services.protocol.oU.TrackerPeerRankingKey(),this.key.read(t)):t.PE(n);break;case 2:n==M.Type.I32?this.ranking=t.LE().value:t.PE(n);break;case 3:n==M.Type.I32?this.groupSize=t.LE().value:t.PE(n);break;case 4:n==M.Type.DOUBLE?this.cumulatedRankValue=t.fp().value:t.PE(n);break;case 5:n==M.Type.DOUBLE?this.totalOfRankValues=t.fp().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerPeerRanking.prototype.write=function(t){t.FE("TrackerPeerRanking"),null!==this.key&&void 0!==this.key&&(t.GE("key",M.Type.STRUCT,1),this.key.write(t),t.BE()),null!==this.ranking&&void 0!==this.ranking&&(t.GE("ranking",M.Type.I32,2),t.VE(this.ranking),t.BE()),null!==this.groupSize&&void 0!==this.groupSize&&(t.GE("groupSize",M.Type.I32,3),t.VE(this.groupSize),t.BE()),null!==this.cumulatedRankValue&&void 0!==this.cumulatedRankValue&&(t.GE("cumulatedRankValue",M.Type.DOUBLE,4),t.Bw(this.cumulatedRankValue),t.BE()),null!==this.totalOfRankValues&&void 0!==this.totalOfRankValues&&(t.GE("totalOfRankValues",M.Type.DOUBLE,5),t.Bw(this.totalOfRankValues),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerRequest=function(t){this.info=null,this.contentId=null,this.query=null,this.streamType=null,this.sessionId=null,this.customerKey=null,t&&(void 0!==t.info&&null!==t.info&&(this.info=t.info),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.query&&null!==t.query&&(this.query=t.query),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.customerKey&&null!==t.customerKey&&(this.customerKey=t.customerKey))},j.services.protocol.oU.TrackerRequest.prototype={},j.services.protocol.oU.TrackerRequest.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRUCT?(this.info=new j.services.protocol.oU.TrackerPeerInfo(),this.info.read(t)):t.PE(n);break;case 2:n==M.Type.STRING?this.contentId=t.jE().value:t.PE(n);break;case 3:n==M.Type.STRUCT?(this.query=new j.services.protocol.oU.TrackerQuery(),this.query.read(t)):t.PE(n);break;case 4:n==M.Type.I32?this.streamType=t.LE().value:t.PE(n);break;case 5:n==M.Type.STRING?this.sessionId=t.jE().value:t.PE(n);break;case 6:n==M.Type.STRUCT?(this.customerKey=new j.services.protocol.oU.CustomerKey(),this.customerKey.read(t)):t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerRequest.prototype.write=function(t){t.FE("TrackerRequest"),null!==this.info&&void 0!==this.info&&(t.GE("info",M.Type.STRUCT,1),this.info.write(t),t.BE()),null!==this.contentId&&void 0!==this.contentId&&(t.GE("contentId",M.Type.STRING,2),t.xE(this.contentId),t.BE()),null!==this.query&&void 0!==this.query&&(t.GE("query",M.Type.STRUCT,3),this.query.write(t),t.BE()),null!==this.streamType&&void 0!==this.streamType&&(t.GE("streamType",M.Type.I32,4),t.VE(this.streamType),t.BE()),null!==this.sessionId&&void 0!==this.sessionId&&(t.GE("sessionId",M.Type.STRING,5),t.xE(this.sessionId),t.BE()),null!==this.customerKey&&void 0!==this.customerKey&&(t.GE("customerKey",M.Type.STRUCT,6),this.customerKey.write(t),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TrackerResponse=function(t){this.infos=null,this.rankings=null,this.peerInfo=null,this.sessionId=null,t&&(void 0!==t.infos&&null!==t.infos&&(this.infos=t.infos),void 0!==t.rankings&&null!==t.rankings&&(this.rankings=t.rankings),void 0!==t.peerInfo&&null!==t.peerInfo&&(this.peerInfo=t.peerInfo),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId))},j.services.protocol.oU.TrackerResponse.prototype={},j.services.protocol.oU.TrackerResponse.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:if(n==M.Type.LIST){var s,e;this.infos=[];(e=t.tp()).np,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new j.services.protocol.oU.TrackerPeerInfo()).read(t),this.infos.push(o)}t.rp()}else t.PE(n);break;case 2:if(n==M.Type.LIST){var u,a;this.rankings=[];(a=t.tp()).np,u=a.size;for(var f=0;f<u;++f){var c=null;(c=new j.services.protocol.oU.TrackerPeerRanking()).read(t),this.rankings.push(c)}t.rp()}else t.PE(n);break;case 3:n==M.Type.STRUCT?(this.peerInfo=new j.services.protocol.oU.TrackerPeerInfo(),this.peerInfo.read(t)):t.PE(n);break;case 4:n==M.Type.STRING?this.sessionId=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TrackerResponse.prototype.write=function(t){if(t.FE("TrackerResponse"),null!==this.infos&&void 0!==this.infos){for(var i in t.GE("infos",M.Type.LIST,1),t.jw(M.Type.STRUCT,this.infos.length),this.infos)this.infos.hasOwnProperty(i)&&(i=this.infos[i]).write(t);t.Pw(),t.BE()}if(null!==this.rankings&&void 0!==this.rankings){for(var n in t.GE("rankings",M.Type.LIST,2),t.jw(M.Type.STRUCT,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(n)&&(n=this.rankings[n]).write(t);t.Pw(),t.BE()}null!==this.peerInfo&&void 0!==this.peerInfo&&(t.GE("peerInfo",M.Type.STRUCT,3),this.peerInfo.write(t),t.BE()),null!==this.sessionId&&void 0!==this.sessionId&&(t.GE("sessionId",M.Type.STRING,4),t.xE(this.sessionId),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.gU=function(t){this.timestamp=null,this.contentId=null,this.asType=null,this.asn=null,this.bitrate=null,this.streamState=null,this.rankType=null,this.vU=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.asType&&null!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState),void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.vU&&null!==t.vU&&(this.vU=t.vU))},j.services.protocol.oU.gU.prototype={},j.services.protocol.oU.gU.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I32?this.timestamp=t.LE().value:t.PE(n);break;case 2:n==M.Type.STRING?this.contentId=t.jE().value:t.PE(n);break;case 3:n==M.Type.I32?this.asType=t.LE().value:t.PE(n);break;case 4:n==M.Type.I32?this.asn=t.LE().value:t.PE(n);break;case 5:n==M.Type.I32?this.bitrate=t.LE().value:t.PE(n);break;case 6:n==M.Type.I32?this.streamState=t.LE().value:t.PE(n);break;case 7:n==M.Type.I32?this.rankType=t.LE().value:t.PE(n);break;case 8:n==M.Type.STRING?this.vU=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.gU.prototype.write=function(t){t.FE("TrackerStoreIndexKey"),null!==this.timestamp&&void 0!==this.timestamp&&(t.GE("timestamp",M.Type.I32,1),t.VE(this.timestamp),t.BE()),null!==this.contentId&&void 0!==this.contentId&&(t.GE("contentId",M.Type.STRING,2),t.xE(this.contentId),t.BE()),null!==this.asType&&void 0!==this.asType&&(t.GE("asType",M.Type.I32,3),t.VE(this.asType),t.BE()),null!==this.asn&&void 0!==this.asn&&(t.GE("asn",M.Type.I32,4),t.VE(this.asn),t.BE()),null!==this.bitrate&&void 0!==this.bitrate&&(t.GE("bitrate",M.Type.I32,5),t.VE(this.bitrate),t.BE()),null!==this.streamState&&void 0!==this.streamState&&(t.GE("streamState",M.Type.I32,6),t.VE(this.streamState),t.BE()),null!==this.rankType&&void 0!==this.rankType&&(t.GE("rankType",M.Type.I32,7),t.VE(this.rankType),t.BE()),null!==this.vU&&void 0!==this.vU&&(t.GE("qualityLevel",M.Type.STRING,8),t.xE(this.vU),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.bU=function(t){this.guid=null,this.yU=null,this.key=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.yU&&null!==t.yU&&(this.yU=t.yU),void 0!==t.key&&null!==t.key&&(this.key=t.key))},j.services.protocol.oU.bU.prototype={},j.services.protocol.oU.bU.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRING?this.guid=t.cp().value:t.PE(n);break;case 2:n==M.Type.DOUBLE?this.yU=t.fp().value:t.PE(n);break;case 3:n==M.Type.STRUCT?(this.key=new j.services.protocol.oU.TrackerPeerRankingKey(),this.key.read(t)):t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.bU.prototype.write=function(t){t.FE("TrackerStoreRankPeer"),null!==this.guid&&void 0!==this.guid&&(t.GE("guid",M.Type.STRING,1),t.Vw(this.guid),t.BE()),null!==this.yU&&void 0!==this.yU&&(t.GE("rank",M.Type.DOUBLE,2),t.Bw(this.yU),t.BE()),null!==this.key&&void 0!==this.key&&(t.GE("key",M.Type.STRUCT,3),this.key.write(t),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.TU=function(t){this.guid=null,this.contentId=null,this.mU=null,this.OU=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.mU&&null!==t.mU&&(this.mU=t.mU),void 0!==t.OU&&null!==t.OU&&(this.OU=t.OU))},j.services.protocol.oU.TU.prototype={},j.services.protocol.oU.TU.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.STRING?this.guid=t.cp().value:t.PE(n);break;case 2:n==M.Type.STRING?this.contentId=t.jE().value:t.PE(n);break;case 3:n==M.Type.STRING?this.mU=t.jE().value:t.PE(n);break;case 4:n==M.Type.STRING?this.OU=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.TU.prototype.write=function(t){t.FE("TrackerRequestQueueKey"),null!==this.guid&&void 0!==this.guid&&(t.GE("guid",M.Type.STRING,1),t.Vw(this.guid),t.BE()),null!==this.contentId&&void 0!==this.contentId&&(t.GE("contentId",M.Type.STRING,2),t.xE(this.contentId),t.BE()),null!==this.mU&&void 0!==this.mU&&(t.GE("partner",M.Type.STRING,3),t.xE(this.mU),t.BE()),null!==this.OU&&void 0!==this.OU&&(t.GE("customer",M.Type.STRING,4),t.xE(this.OU),t.BE()),t.qE(),t.QE()},j.services.protocol.oU.SU=function(t){this.timestamp=null,this.request=null,this.response=null,this.guid=null,this.contentId=null,this.mU=null,this.OU=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.request&&null!==t.request&&(this.request=t.request),void 0!==t.response&&null!==t.response&&(this.response=t.response),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.mU&&null!==t.mU&&(this.mU=t.mU),void 0!==t.OU&&null!==t.OU&&(this.OU=t.OU))},j.services.protocol.oU.SU.prototype={},j.services.protocol.oU.SU.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==M.Type.STOP)break;switch(r){case 1:n==M.Type.I64?this.timestamp=t.ap().value:t.PE(n);break;case 2:n==M.Type.STRUCT?(this.request=new j.services.protocol.oU.TrackerRequest(),this.request.read(t)):t.PE(n);break;case 3:n==M.Type.STRUCT?(this.response=new j.services.protocol.oU.TrackerResponse(),this.response.read(t)):t.PE(n);break;case 4:n==M.Type.STRING?this.guid=t.cp().value:t.PE(n);break;case 5:n==M.Type.STRING?this.contentId=t.jE().value:t.PE(n);break;case 6:n==M.Type.STRING?this.mU=t.jE().value:t.PE(n);break;case 7:n==M.Type.STRING?this.OU=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},j.services.protocol.oU.SU.prototype.write=function(t){t.FE("TrackerRequestQueueMessage"),null!==this.timestamp&&void 0!==this.timestamp&&(t.GE("timestamp",M.Type.I64,1),t.xw(this.timestamp),t.BE()),null!==this.request&&void 0!==this.request&&(t.GE("request",M.Type.STRUCT,2),this.request.write(t),t.BE()),null!==this.response&&void 0!==this.response&&(t.GE("response",M.Type.STRUCT,3),this.response.write(t),t.BE()),null!==this.guid&&void 0!==this.guid&&(t.GE("guid",M.Type.STRING,4),t.Vw(this.guid),t.BE()),null!==this.contentId&&void 0!==this.contentId&&(t.GE("contentId",M.Type.STRING,5),t.xE(this.contentId),t.BE()),null!==this.mU&&void 0!==this.mU&&(t.GE("partner",M.Type.STRING,6),t.xE(this.mU),t.BE()),null!==this.OU&&void 0!==this.OU&&(t.GE("customer",M.Type.STRING,7),t.xE(this.OU),t.BE()),t.qE(),t.QE()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.RU=function(t,i){var n=t.IU._U(!1),r=i.IU._U(!1);return r<n?1:n<r?0:-1},s);function s(){}i.AU=r;var e=(h.RU=function(t,i){var n=t.NU._U(!1),r=i.NU._U(!1);return r<n?1:n<r?0:-1},h);function h(){}i.kU=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.FD="127.0.0.1",s.CU=11983,s.GD="//{0}:{1}/proxy/?callback={2}{3}hivePluginId={4}",s.DU="//{0}:{1}/proxy/auth-token?hivePluginId={2}",s.MU="//{0}:{1}/proxy/{2}/session?manifest={3}",s.jU="//{0}:{1}/proxy/{2}/player?req={3}",s.PU="//{0}:{1}/proxy/{2}/info?{3}",s.LU="2018.1",s.HU="",s);function s(){}i.UU=r},function(t,i){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var s=new Array(16);t.exports=function(){for(var t,i=0;i<16;i++)0==(3&i)&&(t=4294967296*Math.random()),s[i]=t>>>((3&i)<<3)&255;return s}}},function(t,i){for(var s=[],n=0;n<256;++n)s[n]=(n+256).toString(16).substr(1);t.exports=function(t,i){var n=i||0,r=s;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}},function(t,i,n){"use strict";n(68);var r=n(11),e=n(69),s=n(38);t.exports=Array;var u=Array.prototype.splice,a=Array.prototype.slice;function h(t,i){Array.prototype[t]||Object.defineProperty(Array.prototype,t,{value:i,writable:!0,configurable:!0,enumerable:!1})}function o(t,i,n){this.tR=t,this.start=null==i?0:i,this.end=n}Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=Array.from||function(t){var i=[];return i.hiveAddEach(t),i},Array.xf=function(t){for(var i=[],n=1/0,r=0;r<t.length;r++){var s=t[r];t[r]=s.toArray(),s.length<n&&(n=s.length)}for(r=0;r<t.length;r++){s=t[r];for(var e=0;e<s.length;e++)e<n&&e in s&&(i[e]=i[e]||[],i[e][r]=s[e])}return i},h("hiveAddEach",r.prototype.hiveAddEach),h("deleteEach",r.prototype.Pf),h("toArray",r.prototype.toArray),h("toObject",r.prototype.Lf),h("all",r.prototype.all),h("any",r.prototype.Ih),h("min",r.prototype.min),h("max",r.prototype.max),h("sum",r.prototype.sa),h("average",r.prototype.Uf),h("only",r.prototype.only),h("flatten",r.prototype.Ff),h("zip",r.prototype.Gf),h("enumerate",r.prototype.enumerate),h("group",r.prototype.group),h("sorted",r.prototype.Bf),h("reversed",r.prototype.reversed),h("constructClone",function(t){var i=new this.constructor();return i.hiveAddEach(t),i}),h("has",function(t,i){return-1!==this.find(t,i)}),h("set",function(t,i){return this[t]=i,!0}),h("hiveAdd",function(t){return this.push(t),!0}),h("delete",function(t,i){var n=this.find(t,i);return-1!==n&&(this.splice(n,1),!0)}),h("deleteAll",function(t,i){i=i||this.ke||Object.Ae;for(var n=0,r=0;r<this.length;)i(t,this[r])?(this.GP(r,1),n++):r++;return n}),h("find",function(t,i){i=i||this.ke||Object.Ae;for(var n=0;n<this.length;n++)if(n in this&&i(t,this[n]))return n;return-1}),h("findLast",function(t,i){i=i||this.ke||Object.Ae;var n=this.length;do if(--n in this&&i(this[n],t))return n;while(0<n);return-1}),h("swap",function(t,i,n){var r,s,e,h,o;if(t>this.length&&(this.length=t),void 0===n)return void 0!==i?u.call(this,t,i):void 0!==t?u.call(this,t):[];if(r=[t,i],Array.isArray(n)||(n=a.call(n)),e=0,(s=n.length)<1e3){for(;e<s;e++)r[e+2]=n[e];return u.apply(this,r)}for(o=u.apply(this,r);e<s;){for(r=[t+e,0],h=2;h<1002&&e<s;h++,e++)r[h]=n[e];u.apply(this,r)}return o}),h("peek",function(){return this[0]}),h("poke",function(t){0<this.length&&(this[0]=t)}),h("peekBack",function(){if(0<this.length)return this[this.length-1]}),h("pokeBack",function(t){0<this.length&&(this[this.length-1]=t)}),h("one",function(){for(var t in this)if(Object.CC(this,t))return this[t]}),Array.prototype.clear||h("clear",function(){return this.length=0,this}),h("compare",function(t,i){var n,r,s;if(i=i||Object.compare,this===t)return 0;if(!t||!Array.isArray(t))return e.prototype.compare.call(this,t,i);for(r=Math.min(this.length,t.length),n=0;n<r;n++)if(n in this){if(!(n in t))return-1;if(s=i(this[n],t[n]))return s}else if(n in t)return 1;return this.length-t.length}),h("equals",function(t,i){i=i||Object.Ae;var n=0,r=this.length;if(this===t)return!0;if(!t||!Array.isArray(t))return e.prototype.Ae.call(this,t);if(r!==t.length)return!1;for(;n<r;++n)if(n in this){if(!(n in t))return!1;if(!i(this[n],t[n]))return!1}else if(n in t)return!1;return!0}),h("clone",function(t,i){if(null==t)t=1/0;else if(0===t)return this;if((i=i||new s()).has(this))return i.get(this);var n=new Array(this.length);for(var r in i.set(this,n),this)n[r]=Object.clone(this[r],t-1,i);return n}),h("iterate",function(t,i){return new o(this,t,i)}),h("Iterator",o),o.prototype.xP=null,Object.defineProperty(o.prototype,"BP",{get:function(){return this.xP||(this.xP={done:!1,value:null})}}),o.prototype.next=function(){return this.start===(null==this.end?this.tR.length:this.end)?(this.BP.done=!0,this.BP.value=void 0):this.BP.value=this.tR[this.start++],this.BP}},function(t,i){t.exports=Function,Function.Ne=function(){},Function.identity=function(t){return t},Function.Vf=function(n,r){r=r||Object.compare,n=n||Function.identity;function t(t,i){return r(n(t),n(i))}return t.compare=r,t.Vf=n,t},Function.get=function(i){return function(t){return Object.get(t,i)}}},function(t,i,n){var e=n(37);function r(){throw new Error("Can't construct. GenericOrder is a mixin.")}(t.exports=r).prototype.Ae=function(t,i){if(i=i||this.ke||e.Ae,this===t)return!0;return!t?!1:this.length===t.length&&this.Gf(t).every(function(t){return i(t[0],t[1])})},r.prototype.compare=function(t,r){if(r=r||this.Hf||e.compare,this===t)return 0;if(!t)return 1;var s=Math.min(this.length,t.length),i=this.Gf(t).reduce(function(t,i,n){return 0===t?s<=n?t:r(i[0],i[1]):t},0);return 0===i?this.length-t.length:i},r.prototype.toJSON=function(){return this.toArray()}},function(t,i,n){"use strict";n(10);var r=n(54),s=n(110),e=n(11),h=n(40),o=n(12),u=n(39),a=n(111);function f(t,n,i,r){if(!(this instanceof f))return new f(t,n,i,r);n=n||Object.Ae,i=i||Object.hash,r=r||Function.Ne,this.ke=n,this.Ce=i,this.De=r,this.order=new this.FU(void 0,n),this.store=new this.GU(void 0,function(t,i){return n(t.value,i.value)},function(t){return i(t.value)}),this.length=0,this.hiveAddEach(t)}(t.exports=f).Set=f,Object.hiveAddEach(f.prototype,e.prototype),Object.hiveAddEach(f.prototype,h.prototype),Object.hiveAddEach(f.prototype,o.prototype),Object.hiveAddEach(f.prototype,u.prototype),Object.defineProperty(f.prototype,"size",e.Me),f.prototype.FU=r,f.prototype.GU=s,f.prototype.je=function(t){return new this.constructor(t,this.ke,this.Ce,this.De)},f.prototype.has=function(t){var i=new this.order.Node(t);return this.store.has(i)},f.prototype.get=function(t,i){if(i)throw new Error("Set#get does not support second argument: equals");var n=new this.order.Node(t);return(n=this.store.get(n))?n.value:this.De(t)},f.prototype.hiveAdd=function(t){var i=new this.order.Node(t);if(this.store.has(i))return!1;var n=this.length;return this.BC&&this.KC([t],[],n),this.order.hiveAdd(t),i=this.order.head.CP,this.store.hiveAdd(i),this.length++,this.BC&&this.qC([t],[],n),!0},f.prototype["delete"]=function(t,i){if(i)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(t);return!!this.store.has(n)&&(n=this.store.get(n),this.BC&&this.KC([],[t],n.index),this.store["delete"](n),this.order.splice(n,1),this.length--,this.BC&&this.qC([],[t],n.index),!0)},f.prototype.pop=function(){if(this.length){var t=this.order.head.CP.value;return this["delete"](t),t}},f.prototype.shift=function(){if(this.length){var t=this.order.head.next.value;return this["delete"](t),t}},f.prototype.qf=function(){if(0<this.length)return this.store.qf().value},f.prototype.clear=function(){var t;this.BC&&(t=this.toArray(),this.KC([],t,0)),this.store.clear(),this.order.clear(),this.length=0,this.BC&&this.qC([],t,0)},f.prototype.reduce=function(n,t){var r=arguments[2],i=this.order,s=0;return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},f.prototype.reduceRight=function(n,t){var r=arguments[2],i=this.order,s=this.length-1;return i.reduceRight(function(t,i){return n.call(r,t,i,s--,this)},t,this)},f.prototype.Qf=function(){return this.order.Qf()},f.prototype.values=function(){return new a(this)},f.prototype.log=function(){var t=this.store;return t.log.apply(t,arguments)},f.prototype.sc=function(){this.order.sc()}},function(t,i,n){"use strict";function r(){}(t.exports=r).xU={XC:"+",BU:"-",VU:"+",qU:"+",QU:".",YU:"'",KU:"+",WU:"|"},r.$U={XC:"\u254b",BU:"\u2501",VU:"\u253b",qU:"\u2533",QU:"\u256d",YU:"\u2570",KU:"\u2523",WU:"\u2503"},r.XU={XC:"\u254b",BU:"\u2501",VU:"\u253b",qU:"\u2533",QU:"\u250f",YU:"\u2517",KU:"\u2523",WU:"\u2503"}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getItem=function(t){try{return window.sessionStorage?window.sessionStorage.getItem(t):null}catch(t){return null}},s.setItem=function(t,i){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(t,i),!0)}catch(t){return!1}},s.removeItem=function(t){try{window.sessionStorage&&window.sessionStorage.removeItem(t)}catch(t){return null}},s);function s(){}i.Ab=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(14),s=(e.getPrivateIp=function(t){var i=t.getPrivateIp();return r.HiveConfig.SensitiveInfo.restrictedConnectivityInfo&&i&&(i=i.replace(/[0-9]*$/,"0")),i},e.Wd=function(t){return r.HiveConfig.SensitiveInfo.restrictedConnectivityInfo?r.HiveConfig.SensitiveInfo.hiddenHostnameValue:t.getHostName()},e);function e(){}i.Kd=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.Bd=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(7),e=(h.prototype.Z=function(){return r.Framework.resolve(this.tag)},h.prototype.getName=function(){return this.name},h.prototype.getVersion=function(){return this.version},h.prototype._l=function(){return o.JU(this)},h);function h(t,i){this.version=s.W["if"],this.name=t,this.tag=i}i["default"]=e;var o=(u.JU=function(t){return new u(t.getName(),t.getVersion())},u);function u(t,i){this.name=t,this.version=i}i.zU=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(73),r=n(3),h=n(23);n(127),n(128);var c=n(0),s=n(15),o=n(16),u=n(17),e=n(14),a=n(1),l=n(13),v="[SNAP]",d=function(){this.metrics=new hive.snapshots.Metrics(),this.ZU=new hive.snapshots.Traffic(),this.tF=new r(),this.iF=new r(),this.nF=new r(),this.rF=new r(),this.player=new hive.snapshots.Player()};i.sF=d;var E=(w.prototype.init=function(t,i,n,r){this.logger=c.Framework.resolve(c.Framework.p.T).log(r),this.qd=c.Framework.resolve(c.Framework.p.Jd),this.logger.debug(v+" INIT STATS STORE - ID: "+t),this.pd=t,this.ticket=i,this.rl(n)},w.prototype.eF=function(t){this.testId=t},w.prototype.hF=function(t){this.oF=t},w.prototype.uF=function(t){this.aF=t},w.prototype.fF=function(t){this.cF=t},w.prototype.rl=function(t){this.sl=t},w.prototype.lF=function(t){this.cj=t},w.prototype.vF=function(){this.dF=new d(),this.pd=null,this.ticket=null,this.reset()},w.prototype.reset=function(){this.EF=new d(),this.wF(this.EF.ZU),this.pF(this.EF),this.gF.source=[]},w.prototype.wF=function(t){t.reqN=0,t.respFallbackN=0,t.respFallbackErrN=0,t.respP2pN=0,t.reqOtherN=0,t.respFallbackOtherN=0,t.respFallbackOthertErrN=0,t.srcReqN=0,t.srcRespN=0,t.srcRespErrN=0,t.srcReqQt=0,t.srcRespQt=0,t.srcOverQt=0,t.srcOtherReqN=0,t.srcOtherRespN=0,t.srcOtherRespErrN=0,t.srcOtherReqQt=0,t.srcOtherRespQt=0,t.srcOtherOverQt=0,t.p2pSubReqN=0,t.p2pSubRespN=0,t.p2pSubRespPartN=0,t.p2pSubRespErrN=0,t.p2pSubRespExpN=0,t.p2pSubReqQt=0,t.p2pSubRespQt=0,t.p2pDirectQt=0,t.p2pRelayQt=0,t.p2pNatQt=0,t.p2pUdpbQt=0,t.fallAgentRespN=0,t.fallAgentPredHitN=0,t.fallAgentFailedRespN=0,t.fallAgenTrafficSuccessQt=0,t.p2pAgentPredHitN=0,t.p2pAgentPredMissN=0,t.p2pAgentPredPartialHitN=0,t.p2pAgenTrafficSuccessQt=0,t.p2pAgenTrafficFailureQt=0},w.prototype.pF=function(t){t.metrics.videoBufN=0,t.metrics.videoBufQt=0,t.metrics.clientBufferMs=0,t.metrics.lookupNotFound=0,t.metrics.lookupTotal=0,t.metrics.lookupLatency=0,t.metrics.lookupReqAccept=0,t.metrics.lookupReqEstablished=0,t.metrics.lookupFailed=0,t.player.bufferingN=0,t.player.bufferingMs=0,t.player.bF=0},w.prototype.Yf=function(t){var n=this;void 0===t&&(t=!0);var r=new hive.snapshots.MetricSnapshot();r.timestamp=c.Framework.time(),r.guid=this.pd,r.sessionId=this.ticket.sessionId,r.eventId=new EventId(),r.eventId.partnerId=this.ticket.Pd(),r.eventId.customerId=this.ticket.Ld(),r.eventId.contentId=this.ticket.qg();try{var i=new hive.snapshots.ClientInfo();i.clientType=this.yF();var s=this.sl.version.split(".");if(i.majorVersion=parseInt(s[0]),i.minorVersion=parseInt(s[1]),i.patchVersion=parseInt(s[2]),r.client=i,null!=this.testId){var e=new TestInfo();e.testId=this.testId,r.testInfo=e}}catch(t){this.logger.warn(v+" error setting Snapshot ClientInfo",t)}if(this.cj){var h=new hive.snapshots.AgentInfo();h.firstTierBitrates=this.cj.TF(),h.secondTierBitrates=this.cj.mF(),r.agentInfo=h}r.streamInfo=this.SF.OF(),r.traffic=[];var o=new hive.snapshots.TrafficKey();if(r.traffic.push({key:o,value:this.EF.ZU}),this.EF.tF.forEach(function(t,i){var n=new hive.snapshots.TrafficKey();n.bitrate=i,r.traffic.push({key:n,value:t})}),r.metrics=this.EF.metrics,this.oF&&(r.metrics.clientBufferMs=this.oF.min()),this.aF&&(r.metrics.trackerLatency=this.aF.min()),this.cF&&(r.metrics.RF=this.cF.min()),r.player=this.EF.player,0<this.gF.source.length&&(r.gF=this.gF),this._F){var u=this._F.IF();this.EF.metrics.prtOutN=u.AF+u.NF,this.EF.metrics.prtInN=u.kF+u.CF;var a=this._F.DF();a.forEach(function(t,i){n.MF(i,t,r)}),this.EF.rF.filter(function(t,i){return!a.has(i)}).forEach(function(t,i){n.MF(i,t,r)})}return r.connInfo=new hive.snapshots.ConnectivityInfo(),t?this.qd.getConnectivityInfo().then(function(t){return r.connInfo.privateIp=f.Kd.getPrivateIp(t.getNetworkChanged()),n.jF(n.PF(r))}).fail(function(t){return n.jF(n.PF(r))}):(r.connInfo.privateIp=f.Kd.getPrivateIp(this.qd.Yd().getNetworkChanged()),this.jF(r))},w.prototype.PF=function(t){return t.connInfo.internalAs=this.LF,t.connInfo.externalAs=this.HF,t.connInfo.publicIp=this.UF,t},w.prototype.jF=function(t,i){void 0===i&&(i=[]);var n=l.Ec(t,"snapshot");return n.length&&a.ErrorMonitor.Z().logError("NaN found in MetricSnapshot",v,{keysWithNaN:n,snapshot:t}),i.length=0,i.push.apply(i,n),t},w.prototype.yF=function(){var t;switch(this.sl.name){case"JS":t=ClientType.FF;break;case"PROXY":t=ClientType.GF;break;default:t=ClientType.xF}return t},w.prototype.MF=function(t,i,n){var r=this.EF.iF.get(t);i.traffic=r,n.partners||(n.partners=[]);var s=new hive.snapshots.PartnerKey();s.partnerGuid=t,n.partners.push({key:s,value:i})},w.prototype.BF=function(t,i){0<t&&(this.EF.metrics.videoBufN++,this.EF.metrics.videoBufQt+=t,this.EF.player.bufferingN++,this.EF.player.bufferingMs+=t),this.EF.player.playerBufferMs=i},w.prototype.VF=function(t){0<t&&(this.EF.player.bF+=t)},w.prototype.qF=function(){return this.EF.ZU},w.prototype.QF=function(){return this.dF.ZU},w.prototype.YF=function(t){return this.dF.tF.has(t)||this.dF.tF.set(t,new hive.snapshots.Traffic()),this.dF.tF.get(t)},w.prototype.KF=function(t){if(!this.EF.tF.has(t)){var i=new hive.snapshots.Traffic();this.wF(i),this.EF.tF.set(t,i)}return this.EF.tF.get(t)},w.prototype.WF=function(){var t=new hive.snapshots.PartnerTraffic();return t.p2pSuccReq=0,t.p2pFailReq=0,t.p2pPartReq=0,t.p2pSuccReceived=0,t.p2pSuccReceivedLow=0,t.p2pFailReceived=0,t.p2pSuccResp=0,t.p2pFailResp=0,t.p2pPartResp=0,t.p2pSuccSent=0,t.p2pSuccSentLow=0,t.p2pFailSent=0,t},w.prototype.$F=function(t,i){return i.iF.has(t)||i.iF.set(t,this.WF()),i.iF.get(t)},w.prototype.XF=function(t){return this.$F(t,this.EF)},w.prototype.JF=function(t){return this.$F(t,this.dF)},w.prototype.zF=function(t){this.qd=t},w.prototype.ZF=function(t){this._F=t},w.prototype.Xd=function(t){},w.prototype.tG=function(i){var n=!1;this.gF.source.forEach(function(t){t.Ob==i&&(t.count++,n=!0)}),n||this.gF.source.push(new hive.snapshots.iG({Ob:i,count:1}))},w);function w(){this.ticket=null,this.LF=0,this.HF=0,this.testId=null,this.gF=new hive.snapshots.nG(),this.vF()}i.GU=E;var p=(g.prototype.init=function(t,i){this.logger=c.Framework.resolve(c.Framework.p.T).log(i),this.logger.debug(v+" INIT CLIENT STATS"),this.store=t,this.rG()},g.prototype.rG=function(){var t=this;-1<this.sG&&c.Framework.clearInterval(this.sG),this.sG=c.Framework.setInterval(function(){t.snapshot()},s.qc.jc)},g.prototype.ol=function(t){this.state=t},g.prototype.eG=function(){if(this.store)return this.snapshot(!1)},g.prototype.reset=function(t){c.Framework.clearInterval(this.sG),this.store&&(!1===t?this.store.reset():this.store.vF())},g.prototype.snapshot=function(t){var i=this;void 0===t&&(t=!0);var n=this.store.Yf(t);t?(this.logger.debug("[SNAP] TAKING SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.warn("[SNAP] ERROR FORWARDING SNAPSHOT",t)})["finally"](function(){i.store.reset()})):(this.logger.debug("[SNAP] FLUSHING SNAPSHOT"),this.forward(n))},g.prototype.forward=function(t){var i=this;if(this.state!==u.Wc.IDLE&&this.state!==u.Wc.STOP){if(this.client&&this.client.rE()){switch(this.hG){case 0:default:this.logger.debug(v+" SENDING SNAPSHOT");break;case 1:this.logger.debug(v+" SENDING SNAPSHOT "+JSON.stringify(t));break;case 2:this.logger.debug(v+" SENDING SNAPSHOT",t);break;case 3:this.logger.debug(v+" SENDING SNAPSHOT "+JSON.stringify(t),t)}this.protocol.ua("SNAPSHOT",h.aa.ONEWAY,0),t.write(this.protocol),this.protocol.fa();var n=this.la.ca(),r=this.va(n,",",4),s=n.slice(r+1,n.length-1),e=new o.Yc(HiveStreamingServices.eE,1,s);this.client.rE().send(e).fail(function(t){i.logger.warn(v+" PROBLEM: ",t)})}}else this.logger.debug(v+" not send - state "+u.Wc[this.state])},g.prototype.va=function(t,i,n){return t.split(i,n).join(i).length},g);function g(){this.hG=isNaN(e.HiveConfig.DebugLogs.MetricSnapshotLogs)?0:e.HiveConfig.DebugLogs.MetricSnapshotLogs,this.state=u.Wc.$c,this.client=c.Framework.resolve(c.Framework.p.Zc),this.la=new h.ga(),this.protocol=new h.ba(this.la)}i.pl=p},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var h=n(4),o=n(30),u=n(129),e=n(0),a=n(15),f=n(16),c=n(7).W.ef,l=(v.prototype.init=function(t,n){var r=this;if(this.oG)this.oG.then(function(){var t={partnerId:n.Pd(),customerId:n.Ld(),contentId:n.qg(),secret:n.nM()},i=new f.Yc(HiveStreamingServices.uG,1,JSON.stringify(t));r.connection.send(i)});else{var i=h.defer(),s=a.qc.Ac;n.iM&&(c?s=a.qc.kc:(this.logger.warn("[HiveComm] Error trying to resolve test ticket against production services - use production ticket or test plugin"),i.reject(new Error("test ticket in production"))));var e=new o(s)._T({"connection-id":t,partner_id:n.Pd(),customer_id:n.Ld(),content_id:n.qg(),ticket:n.nM()}).toString();this.connection=new u.aG(e,a.qc.Uc,a.qc.Fc,a.qc.Gc),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),i.resolve(r.connection)}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),i.reject(r.connection)}),this.oG=i.promise}return{Rl:this.connection,promise:this.oG}},v.prototype.connect=function(){this.connection&&this.connection.connect(!0)},v.prototype.eb=function(t){},v.prototype.rE=function(){return this.connection},v.prototype.close=function(){this.connection&&(this.oG=null,this.connection.close(!1))},v);function v(){this.logger=e.Framework.resolve(e.Framework.p.T).log(),this.logger.debug("INIT SERVICE CLIENT")}i.fG=l;var d,E=(s(w,d=l),w.prototype.init=function(t,i,n){var r=this;if(this.oG)return this.oG;var s=h.defer(),e=new o(n)._T({"connection-id":t}).toString();return this.logger.debug(this.loggerId+" Connecting to serviceEndpoint "+e),this.connection=new u.aG(e,a.qc.Uc,a.qc.Fc,a.qc.Gc),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),s.resolve(r.connection)}),this.connection.on(HiveStreamingServices.uG,0,function(t){r.logger.debug("FAKED RESOLVING")}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),s.reject(r.connection)}),this.oG=s.promise,this.oG},w);function w(){var t=null!==d&&d.apply(this,arguments)||this;return t.loggerId="[ServicesClientViaToken]",t}i.cG=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(130);var e=n(4),r=n(3),s=n(0),h=n(46),o=function(t){this.oE=new Date().getTime(),this.lG=t},u=(a.prototype.resolve=function(t,i,n){var r=this,s=e.defer();return t&&(t.on(HiveStreamingServices.uG,0,function(t){r.vG(t)}),t.on(HiveStreamingServices.uG,2,function(t){r.vG(t)}),this.dG.set(i,new o(s))),s.promise},a.prototype.vG=function(t){var r=this,s=new Date().getTime(),e=JSON.parse(t.msg),h=!1;this.dG.forEach(function(t,i){if(r.EG(i,e)){h=!0;var n=r.kg(i,e);n?(n.oE=t.oE,n.uE=s,t.lG.resolve(n)):t.lG.reject("Ticket verification failed"),r.dG["delete"](n)}}),h||this.logger.warn("no pending ticket matching: "+t.msg)},a.prototype.yl=function(t){if(new RegExp("^https?://api(?:-test)?.hivestreaming.com/v1/events/(?:wildcard/)?").test(t)){var i=this.wG();return i.Vg(t),i}return null},a.prototype.wG=function(){return new h.Ticket()},a.prototype.EG=function(t,i){return t.Pd()===i[h.Ticket.fM]&&t.Ld()===i[h.Ticket.aM]&&t.qg()===i[h.Ticket.cM]},a.prototype.kg=function(t,i){return t.zD(i),t.ZD()?t:null},a);function a(){this.dG=new r(),this.logger=(s.Framework.resolve(s.Framework.p.T)||console).log(),this.logger.debug("INIT TICKET RESOLVER")}i.pG=u},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(52),o=n(4),h=n(0),u=n(15),a=n(131),f=(c.prototype.gG=function(){var t=this,i=o.defer(),n=indexedDB.open(this.bG);return n.onupgradeneeded=function(){n.result.createObjectStore(t.yG,{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},c.prototype.bl=function(){var s=this;if(this.TG)return this.TG;var e=o.defer();if(this.pd)e.resolve(new a.mG(this.pd));else if(u.qc.hf&&this.indexedDB){var h=setTimeout(function(){s.logger.warn("[HiveComm] timeout retrieving persistent ID - generating random one"),s.pd=s.OG(),s.logger.debug("[HiveComm] Generated UUID: "+s.pd),e.resolve(new a.mG(s.pd))},4e3);try{this.gG().then(function(n){var r=n.transaction(s.yG,"readwrite").objectStore(s.yG).get("MYID");r.onsuccess=function(){if(clearTimeout(h),s.pd)e.resolve(new a.mG(s.pd));else if(null!=r.result&&u.qc.hf){var t=r.result.value;s.logger.debug("[HiveComm] Retrieved persistent UUID: "+t),s.pd=t,n.close(),e.resolve(new a.mG(s.pd))}else{var i=s.OG();s.SG(n,i),e.resolve(new a.mG(s.pd))}},r.onerror=function(t){clearTimeout(h),s.pd||(s.logger.warn("[HiveComm] error retrieving persistent UUID: "+t),s.pd=s.OG(),s.logger.debug("[HiveComm] Generated UUID: "+s.pd)),e.resolve(new a.mG(s.pd))}}).fail(function(t){clearTimeout(h),s.pd||(s.logger.warn("[HiveComm] error opening indexedDB - generating random id. Error: "+t),s.pd=s.OG(),s.logger.debug("[HiveComm] Generated UUID: "+s.pd)),e.resolve(new a.mG(s.pd))})}catch(t){this.pd=this.OG(),this.logger.debug("[HiveComm] Persistence error - Generate UUID: "+this.pd,t),e.resolve(new a.mG(this.pd))}}else this.pd=this.OG(),this.logger.debug("[HiveComm] Persistence disabled - Generate UUID: "+this.pd),e.resolve(new a.mG(this.pd));return this.TG=e.promise,this.TG},c.prototype.SG=function(t,i){var n=this,r=t.transaction(this.yG,"readwrite");r.objectStore(this.yG).put({id:"MYID",value:i}),r.oncomplete=function(){n.logger.debug("[HiveComm] completed UUID persistence"),t.close()},this.logger.debug("[HiveComm] Generated UUID: "+i),this.pd=i},c.prototype.OG=function(){return e.Rb()},c);function c(){this.yG="IdentityStore",this.bG="IdentityDB",this.pd=null,this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,h.Framework&&h.Framework.resolve(h.Framework.p.T)?this.logger=h.Framework.resolve(h.Framework.p.T).log():this.logger=console}i.RG=f;var l,v=(s(d,l=f),d.prototype.bl=function(){var s=this;if(this._G)return this._G;var e=o.defer();return l.prototype.bl.call(this).then(function(t){var i=s.OG(),n=t.Sl(),r=new a.mG(i,n);e.resolve(r)}).fail(function(t){var i=s.OG(),n=new a.mG(i);e.resolve(n)}),this._G=e.promise,this._G},d);function d(){return l.call(this)||this}i.IG=v},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.AG=function(t){this.hostname=t},s.prototype.getHostName=function(){return this.hostname},s.prototype.NG=function(t){this.nc=t},s.prototype.getNetworkChanged=function(){return this.nc},s);function s(){}i.kG=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),e=n(132),h=n(1),o=(u.prototype.CG=function(){var t=new e.DG();this.MG.NG(t)},u.prototype.Yd=function(){return this.MG},u.prototype.getConnectivityInfo=function(){var i=this;if(!this.connInfo)return r.reject("ConnInfo helper undefined");var n=setTimeout(function(){return i.logger.warn(i.loggerId+"Get connectivity info expired"),i.MG?r.resolve(i.MG):r.reject("expired")},2e3);try{return this.connInfo.getConnectivityInfo().then(function(t){return clearTimeout(n),i.MG=t}).fail(function(t){return i.logger.debug(i.loggerId+" get connectivity info failed with error 1: ",t),i.MG?i.MG:r.reject(t)})}catch(t){return this.logger.debug(this.loggerId+" get connectivity info failed with error 2:",t),r.reject(t)}},u.prototype.jG=function(t,i,n){},u.prototype.PG=function(t){},u);function u(){this.loggerId="[PreloadConnectivityInfoProvider] ",this.connInfo=window.myConnInfo,this.logger=s.Framework.resolve(s.Framework.p.T).log(),this.MG=s.Framework.resolve(s.Framework.p.TD),this.connInfo||h.ErrorMonitor.Z().logError("helper undefined",this.loggerId),this.CG()}i.LG=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.HG=function(t){this.publicIp=t},s.prototype.getPublicIp=function(){return this.publicIp},s.prototype.UG=function(t){this.FG=t},s.prototype.getMacAddress=function(){return this.FG},s.prototype.GG=function(t){this.nic=t},s.prototype.getNic=function(){return this.nic},s.prototype.xG=function(t){this.nicName=t},s.prototype.getNicName=function(){return this.nicName},s.prototype.BG=function(t){this.privateIp=t},s.prototype.getPrivateIp=function(){return this.privateIp},s.prototype.VG=function(t){this.netmask=t},s.prototype.getNetmask=function(){return this.netmask},s.prototype.qG=function(t){this.QG=t},s.prototype.getCidr=function(){return null},s);function s(){}i.YG=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(4),r=n(3),e=n(0),h=n(82),o=n(133),u=n(14),c=n(15),a=n(47),f=(l.prototype.CG=function(){var t=new h.YG();this.MG.NG(t)},l.prototype.KG=function(){var t=this;e.Framework.setInterval(function(){t.WG=[],t.$G=[],t.XG=new r(),t.publicIp=null,t.JG=null,t.getConnectivityInfo()},12e4)},l.prototype.getConnectivityInfo=function(){return this.JG||(this.JG=this.zG()),this.JG},l.prototype.Yd=function(){return this.MG},l.prototype.zG=function(){var n=this,r=s.defer();if(this.ZG=e.Framework.setTimeout(function(){r.reject({tx:!0,message:"expired"})},4e3),u.HiveConfig.ConnInfo.detectPrivateIP&&this.ix())try{this.nx=new RTCPeerConnection(null),this.sx=this.nx.createDataChannel("sendChannel",{reliable:!1}),this.ex=new RTCPeerConnection(null),this.ex.ondatachannel=function(t){n.hx=t.channel,n.hx.onopen=function(t){if("open"===n.hx.readyState){if(n.ex.close(),n.nx.close(),n.ex=null,n.nx=null,n.logger.debug("Collected ips ["+n.XG.map(function(t,i){return i+":"+t.ox}).join(", ")+"]"),c.qc.Bc&&!n.ux&&(setTimeout(function(){a.wM.vM(null,null,"local_ice",null,n.ax)},5e3),n.ux=!0),0<n.XG.length&&c.qc.xc){var i=n.XG.entries().sort(function(t,i){return i[1].ox-t[1].ox});i=i.splice(0,1)[0],n.XG.clear(),n.XG.set(i[0],i[1])}n.vx.lx().then(function(t){n.$G=t,0<n.$G.length&&(n.logger.debug("Already known matching ips ["+n.$G.join(",")+"]"),n.$G.forEach(function(t){0<n.XG.keys().indexOf(t)&&(n.WG.push(t),n.XG["delete"](t))})),n.WG=n.WG.concat(n.XG.keys())}).fail(function(t){n.logger.warn("Get Previous working ips failed with error "+t.message),n.WG=n.WG.concat(n.XG.keys())})["finally"](function(){n.logger.debug("Final private ip list ["+n.WG.join(",")+"]"),r.resolve(n.Ex())})}}},this.nx.onicecandidate=function(t){t.candidate&&n.wx(t.candidate.candidate),t.candidate&&n.ex.addIceCandidate(t.candidate)["catch"](function(t){r.reject({tx:!0,message:t.message}),e.Framework.clearTimeout(n.ZG),!1})},this.ex.onicecandidate=function(t){t.candidate&&n.wx(t.candidate.candidate),t.candidate&&n.nx.addIceCandidate(t.candidate)["catch"](function(t){r.reject({tx:!0,message:t.message}),e.Framework.clearTimeout(n.ZG),!1})},this.nx.createOffer().then(function(t){return n.nx.setLocalDescription(t)}).then(function(){return n.ex.setRemoteDescription(n.nx.localDescription)}).then(function(){return n.ex.createAnswer()}).then(function(t){return n.ex.setLocalDescription(t)}).then(function(){return n.nx.setRemoteDescription(n.ex.localDescription)})["catch"](function(t){r.reject({tx:!0,message:t.message}),e.Framework.clearTimeout(n.ZG),!1})}catch(t){r.reject({tx:!0,message:t.message})}else{e.Framework.clearTimeout(this.ZG);var t=u.HiveConfig.ConnInfo.detectPrivateIP?"webrtc datachannel not supported":"private IP detection disabled";r.reject({tx:!1,message:t})}return r.promise},l.prototype.ix=function(){try{return"function"==typeof RTCPeerConnection.prototype.createDataChannel}catch(t){return!1}},l.prototype.wx=function(t){var i="candidate:",n=t.indexOf(i)+i.length,r=t.substr(n).split(" "),s=r[0],e=r[1],h=r[2],o=r[3],u=r[4],a=r[5],f={px:e,type:r[7],gx:s,protocol:h,address:u,port:a,ox:o};c.qc.Bc&&!this.ux&&this.ax.push(f),this.bx(f)},l.prototype.bx=function(t){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(t.address);if(i){var n=i[0],r=this.XG.get(n);(isNaN(r)||t.ox>r)&&this.XG.set(n,t)}},l.prototype.Ex=function(){var t=new h.YG();return 0<this.WG.length&&t.BG(this.WG[0]),this.publicIp&&t.HG(this.publicIp),this.MG.NG(t),this.MG},l.prototype.jG=function(t,i,n){if(this.publicIp=t,this.yx(),0===n&&1<this.WG.length)this.WG.shift();else if(c.qc.wf&&0!==n&&-1==this.$G.indexOf(this.WG[0]))this.$G.unshift(this.WG[0]),this.vx.Tx(this.$G.slice(0,2));else if(c.qc.wf&&0!==n&&0<this.$G.indexOf(this.WG[0])){var r=this.$G.indexOf(this.WG[0]);this.$G=this.$G.splice(r,1),this.$G.unshift(this.WG[0]),this.vx.Tx(this.$G.slice(0,2))}this.Ex()},l.prototype.yx=function(){var t=this.WG.indexOf(this.publicIp);-1<t&&this.WG.splice(t,1)},l.prototype.PG=function(t){},l);function l(){this.nx=null,this.ex=null,this.sx=null,this.hx=null,this.XG=new r(),this.publicIp=null,this.WG=[],this.failed=!1,this.ZG=null,this.ax=[],this.ux=!1,this.logger=e.Framework.resolve(e.Framework.p.T).log(),this.MG=e.Framework.resolve(e.Framework.p.TD),this.vx=new o.mx(),this.$G=[],this.CG(),this.KG()}i.Ox=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(45),s=n(4),e=n(29),h=n(28),o=n(13),u=n(136),a=n(17),f=n(137),c=n(1),l=n(7),v=n(48),d=n(32),E=(w.prototype.getName=function(){return w.yg},w.prototype.id=function(){return"["+w.yg+"] "},w.prototype.getVersion=function(){return this.plugin.getPluginVersion()},w.prototype.Ng=function(){return!0},w.prototype.Sx=function(){return s.resolve(!0)},w.prototype.initSession=function(t,i){var n=this.Rx(t,i.ticket,i.ticket.eM(),i);return h.HiveRequestFactory.register(this),s.resolve(n)},w.prototype.Cg=function(){return this.options().initTimeout},w.prototype.isActive=function(t,i,n){var r=i.manifest.toLowerCase().indexOf("/manifest");if(-1<r&&(!n||t===i.manifest)){var s=i.manifest.substring(0,r);if(-1<t.indexOf(s))return!0}else if(t==i.manifest)return!0;return!1},w.prototype.ny=function(t,i,n){void 0===n&&(n=!0),t.sb&&r["default"].Z().zc(t.id)&&(this.plugin.logger().debug("[StatsJS] stopping session ["+t.id+"] complete close: "+i),t.sb.vl.hE(n),t.sb.ul.eG(),t.sb.ul.reset(i)),i?r["default"].Z().close(t.id):this.ol(t,!0)},w.prototype.ol=function(t,i){var n=i?a.Wc.IDLE:a.Wc.$c;this.plugin.logger().notice("[HiveComm] client state: "+a.Wc[n]),t.sb&&t.sb.ol(n)},w.prototype.pb=function(t,i){var n=this,r=0;return this._x<i.totalBuffering&&(r=i.totalBuffering-this._x,this._x=i.totalBuffering),t.ob().then(function(){t.sb.el.BF(r,i.bufferLength),t.sb.el.VF(i.Ix),t.sb.hl.Id(i.playingPoint,i.bufferLength,i.totalBuffering),n.Ax()}).done(),s.resolve(!0)},w.prototype.Tb=function(t,i,n){return t.ob().then(function(){t.sb.hl.Nd(t.ticket.sessionId,i,n)}).done(),s.resolve(!0)},w.prototype.Cd=function(t,i){return t.ob().then(function(){t.sb.hl.Md([i])}).done(),s.resolve(!0)},w.prototype.onError=function(t){var i=!0;if(null!=this.options().onError)try{i=this.options().onError(t)}catch(t){c.ErrorMonitor.Z().logError("exception in user-defined onError callback",this.id(),t)}return i},w.prototype.onActiveSession=function(r){var s=this;this.Nx(),r.ob().then(function(t){s.kx=t;var i=new f.Cx(s.plugin.isLive(),s.plugin.getStreamProtocol(),r.ticket.eM());s.kx.SF=i,s.kx.el.SF=i,s.plugin.updatePlayerInfo(s.kx),s.kx.ul.init(s.kx.el,r.id),s.plugin.options().testId&&s.kx.el.eF(s.plugin.options().testId),s.kx.hl.Od(r.ticket.sessionId,s.plugin.getPlayerSource(),200);var n=s.plugin.flushTechEvents();if(n&&0<n.length&&s.kx.hl.Md(n),null!=s.options_.onActiveSession)try{s.options_.onActiveSession(r.toHiveSession())}catch(t){c.ErrorMonitor.Z().logError("exception in user-defined onActiveSession callback",s.id(),t)}}).done()},w.prototype.Lg=function(){},w.prototype.Ag=function(){},w.prototype.wg=function(t){this.plugin=t},w.prototype.options=function(){return this.options_},w.prototype.Nx=function(){this._x=0},w.prototype.Rx=function(t,i,n,r){var s=new e.HiveSessionInternal(t,i,n,r,this.plugin.options().jv);return s.Dx=!1,s.id=i.sessionId,s},w.prototype.Ax=function(){try{var t=this.plugin.getExtendedStats();null!=t&&(this.kx.el.EF.metrics.bitrateUpN+=t.getBitrateSwitchUp(),this.kx.el.EF.metrics.bitrateDwnN+=t.getBitrateSwitchDown(),null!=t.getBandwidth()&&(this.kx.el.EF.metrics.srcThroughput=t.getBandwidth()),null!=t.getVideoBitrates()&&this.Mx(!0,t.getVideoBitrates()),null!=t.getAudioBitrates()&&this.Mx(!1,t.getAudioBitrates()))}catch(t){c.ErrorMonitor.Z().logError("Error accounting extended stats",this.id(),t)}},w.prototype.Mx=function(s,t){var e=this,h=0,o=0,u=0,a=0;t.forEach(function(t,i){var n=t.success+t.failed;if(h+=n,a+=t.bytes,o+=t.success,u+=t.failed,s){var r=e.kx.el.KF(Number(i));e.jx(r,n,t.success,t.failed,t.bytes)}});var i=this.kx.el.qF();this.jx(i,h,o,u,a)},w.prototype.jx=function(t,i,n,r,s){t.srcReqN+=i,t.srcRespN+=n,t.srcRespErrN+=r,t.srcRespQt+=s,t.respFallbackN+=n,t.respFallbackErrN+=r},w.prototype.getPluginId=function(){return this.plugin.getPluginId()},w.prototype.Zb=function(t){var e=this,i=new XMLHttpRequest();if(l.W.bf){var h=function(t){var i=t.target,n=i.status,r=i.responseURL,s=i.response;i.removeEventListener("loadend",h),200===n?(e.plugin.logger().debug("Intercepted Manifest Request "+r),e.Px(r,s)):c.ErrorMonitor.Z().logError("Error intercepting manifest request",r)};i.addEventListener("loadend",h)}return i},w.prototype.zb=function(t){return new XMLHttpRequest()},w.prototype.Px=function(t,i){v.HLS.GA(t,null)?this.metadata=v.HLS.KA():d.DASH.GA(t,null)?this.metadata=d.DASH.KA(t):this.plugin.logger().warn("COULD NOT FIND A RIGHT METADATA FOR "+t),this.metadata&&this.metadata.parse(t,i,!1)},w.yg="StatsJS",w);function w(t,i){this.plugin=t,this.options_=new u.Lx(),void 0!==i[w.yg]&&o.updateOptions(i[w.yg],this.options_)}i.StatsJS=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(33),s=n(143),h=n(145),e=n(86),p=n(0),a=n(146),f=n(8),w=n(59),o=n(147),u=n(148),g=n(32),c=n(14),b=n(1),y=n(2),l=n(149),v=n(6),T=n(150),d=(m.prototype.Hx=function(t){var i="";return-1!==t.indexOf("/")&&(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),i=t.substring(0,t.lastIndexOf("/")+1)),i},m.prototype.isLive=function(){return this.live},m.prototype.Ux=function(i){var n=[];return this.Fx.forEach(function(t){void 0!==i&&t.type!==i||-1==n.indexOf(t.bandwidth)&&n.push(t.bandwidth)}),n},m.prototype.reset=function(){this.Fx=[]},m.prototype.parse=function(t,i,n){var h=this;try{this.reset(),this.Gx=t,this.xx(t,i);var o=this.manifest.BaseURL;this.live="static"!==this.manifest.type;var u=this.manifest.Period_asArray[0];return u.AdaptationSet_asArray,u.AdaptationSet.forEach(function(t){var s=-1!=(t.mimeType?t.mimeType:t.Representation_asArray[0].mimeType).indexOf("audio")?f.yf.Tf:f.yf.mf;s===f.yf.mf&&t.ContentProtection&&h.Bx(t.ContentProtection);var e=t.SegmentTemplate;t.Representation_asArray&&t.Representation_asArray.forEach(function(t){var i=new a.Representation(),n=t.SegmentTemplate?t.SegmentTemplate:e;if(i.type=s,i.bandwidth=h.Vx(t),i.timescale=parseInt(n.timescale)||1e3,i.qx=t.id,i.initialization=o+""+n.initialization,i.initialization=i.initialization.replace(m.Qx,""+i.bandwidth),i.initialization=i.initialization.replace(m.Yx,""+i.qx),i.initialization=v.Ka(i.initialization),i.Kx=o+""+n.media,i.Kx=i.Kx.replace(m.Qx,""+i.bandwidth),i.Kx=i.Kx.replace(m.Yx,""+i.qx),i.Kx=v.Ka(i.Kx),i.Wx=h.$x(i.Kx),i.Kx.match(m.Xx)){if(i.Jx=parseInt(n.duration),!i.Jx)throw new Error("Expected duration on SegmentTemplate for Number-based template");i.startNumber=parseInt(n.startNumber)||0,i.zx=parseInt(u.start)||0,h.Zx=!0}else{var r=h.tB(n.SegmentTimeline_asArray[0].S_asArray,i.Kx,i.bandwidth,s);i.iB=r.nB,i.rB=r.sB}h.Fx.push(i)})}),this.eB(i,n)}catch(t){throw b.ErrorMonitor.Z().logError("Error parsing the metadata",this.loggerId,y.Vn.qn,t),new Error(t)}},m.prototype.Vx=function(t){if(this.hB&&this.oB){var i=t.id.match(this.oB),n=i?i[0]:t.id;if(this.hB.has(n))return this.hB.get(n)}return parseInt(t.bandwidth)},m.prototype.uB=function(){if(this.hB){var t=this.hB.keys();t.length&&(this.oB=new RegExp("\\b("+t.join("|")+")\\b"))}else this.oB=null},m.prototype.$x=function(t){var i=t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),n=i.match(/\\\$Number%(\d+)d\\\$/);return n&&(i=i.replace("\\$Number%"+n[1]+"d\\$","(\\d{"+parseInt(n[1])+"})")),i=(i=i.replace("\\$Time\\$","([0-9]*)")).replace("\\$Number\\$","([0-9]*)"),new RegExp(i,"i")},m.prototype.tB=function(t,u,a,f){try{var c,l=new r(),v=new r(),d=0,E=0;return t.forEach(function(t){if(t.d){t.t?d=parseInt(t.t):d+=E;var i=parseInt(t.d),n=u.replace(m.aB,d+""),r=new w.mH(d,a,i,n,n);r.type=f,c&&(c.next=r),l.set(n,r),v.set(d,r),c=r;var s=0;t.r&&(s=parseInt(t.r));for(var e=0;e<s;e++){d+=i;var h=u.replace(m.aB,d+""),o=new w.mH(d,a,i,h,h);o.type=f,c&&(c.next=o),l.set(h,o),v.set(d,o),c=o}E=i}}),{nB:l,sB:v}}catch(t){throw b.ErrorMonitor.Z().logError("Error extracting segment maps",this.loggerId,y.Vn.Qn,t),new Error(t)}},m.prototype.Bx=function(t){try{if(t){if(t.CryptoPeriod){var i=t.CryptoPeriod;this.fB&&!this.fB.cB()&&this.fB instanceof o.lB||(this.fB=new o.lB(i.keyUriTemplate,i.IV,this.authenticationToken))}else this.fB&&this.fB instanceof u.vB||(this.fB=new u.vB());this.fB&&g.DASH.iN&&this.fB.init()}}catch(t){throw b.ErrorMonitor.Z().logError("Error initializing the protection",this.loggerId,y.Vn.Yn,t),new Error(t)}},m.prototype.dB=function(i){return i=v.Ya(i),this.Fx.find(function(t){return t.Wx.test(i)})},m.prototype.EB=function(t){t=v.Ya(t);try{var i=this.dB(t);if(i){var n=void 0;if(i.iB&&(n=i.iB.get(t)))return n;var r=t.match(i.Wx);if(r){var s=parseInt(r[1]);return this.wB(s,i.bandwidth)}}throw new Error("No representation for "+t)}catch(t){return b.ErrorMonitor.Z().logError("Error getting the segment info",this.loggerId,y.Vn.Kn,t),null}},m.prototype.pB=function(t){t=v.Ya(t);try{return this.dB(t).timescale}catch(t){return b.ErrorMonitor.Z().logError("Error getting the representation for timescale",this.loggerId,y.Vn.Wn,t),1e4}},m.prototype.gB=function(i){return i=v.Ya(i),this.Fx.some(function(t){return t.initialization===i})},m.prototype.bB=function(t){t=v.Ya(t);var i=this.EB(t);return null!=i?i.next:null},m.prototype.yB=function(t,i){var n=this.Fx.find(function(t){return t.bandwidth===i});if(n){if(n.rB)return 1;var r=p.Framework.time(),s=this.manifest.availabilityStartTime.getTime()+(this.manifest.Period.start||0)+(t-n.startNumber+1)*n.Jx*n.timescale;return Math.max(1,s-r)}return 1},m.prototype.oP=function(t,i,n,r){try{var s=this.Fx.find(function(t){return t.bandwidth===r});if(s){if(s.rB&&s.rB.has(t)&&s.rB.has(n)){for(var e=s.rB.get(t),h=s.rB.get(n),o=0,u=e;u&&u!=h;)o+=u.duration,u=u.next;return Math.round(o/(s.timescale/1e3))}if(s.Jx)return(n-t)*s.Jx*s.timescale}return 0}catch(t){return b.ErrorMonitor.Z().logError("Error extracting the segment distance",this.loggerId,y.Vn.Wn,t),0}},m.prototype.TB=function(t){try{t instanceof Uint8Array&&(t=t.buffer);var i=h.mB(t),n=i.fetch("tfhd"),r=i.fetch("trun"),s=n?n.default_sample_duration:0;if(r){var e=0;return r.OB.forEach(function(t){e+=t.sample_duration}),isNaN(e)&&0<s&&(e=s*r.OB.length),e}}catch(t){return b.ErrorMonitor.Z().logError("Error extracting duration from the buffer",this.loggerId,y.Vn.$n,t),0}},m.prototype.eB=function(t,i){var n=this.SB();if(!i&&(this.live||n||c.HiveConfig.Dash.DashRemoveBitrateSize))try{var r=new e({}),s=r.RB(t);return this.live&&this._B(s),(n||c.HiveConfig.Dash.DashRemoveBitrateSize)&&this.IB(s,n,c.HiveConfig.Dash.DashRemoveBitrateSize),r.AB(s)}catch(t){this.logger.error(t)}return t},m.prototype._B=function(c){var l=this,v=Math.max(1,g.DASH.DASH_METADATA_MIN_FRAGMENTS),d=Math.max(1,g.DASH.hN),E=[],w=!1;return c.MPD&&c.MPD.Period&&c.MPD.Period.AdaptationSet&&c.MPD.Period.AdaptationSet.forEach(function(t){if(!w)if(t.SegmentTemplate&&t.SegmentTemplate._media&&t.SegmentTemplate._media.match(m.Xx)){w=!0;var i=p.Framework.time();c.MPD.Period._start=c.MPD.Period._start||"PT0S";var n=c.MPD.Period._start,r=T["default"](n),s=parseInt(t.SegmentTemplate._timescale)||1e3,e=parseInt(t.SegmentTemplate._duration)*s,h=Math.max(0,Math.floor((i-(new Date(c.MPD._availabilityStartTime).getTime()+1e3*r))/e)-g.DASH.eN),o=Math.ceil(1e3*g.DASH.sN/e),u=Math.max(0,Math.min(h,o)),a=0<u?u*e/1e3:0;try{c.MPD.Period._start="PT"+(r+a)+"S",l.logger.debug("Trimmed "+a+" from period start "+n+" => "+c.MPD.Period._start)}catch(t){l.logger.warn("Could not modify period: "+t)}}else if(l.NB(t)&&t.Representation_asArray){var f=l.kB(t.SegmentTemplate,d,v);t.Representation_asArray.forEach(function(t){f.bitrate=parseInt(t._bandwidth)||0,E.push(f)})}else t.Representation_asArray&&0<t.Representation_asArray.length&&t.Representation_asArray.forEach(function(t){if(l.CB(t)){var i=l.kB(t.SegmentTemplate,d,v);i.bitrate=parseInt(t._bandwidth)||0,E.push(i)}})}),c},m.prototype.CB=function(t){return t&&("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))},m.prototype.kB=function(t,i,n){for(var r=0,s=0,e=t.SegmentTimeline.S_asArray,h=i*parseInt(t._timescale),o=0,u=0,a=0;a<e.length&&0<n;a++)n<(l=(c=e[o=a])._r?parseInt(c._r):1)?(u=n,n=0):(n-=l,u=l);for(var f=e.length-1;0<=f&&0<h&&o<=f;f--){var c,l=(c=e[f])._r?parseInt(c._r):1,v=0;if(!c._d)throw new Error("missing segment duration");var d=l*(v=parseInt(c._d));if((o<f||f==o&&0==u)&&d<=h)h-=d,e.splice(f,1),r+=l,s+=d;else{var E=Math.ceil(h/v);f==o&&(E=Math.min(E,l-u));var w=v*E;c._r=l-E+"",h-=w,r+=E,s+=w}}return this.logger.debug("DASH trimmed "+r+" segments for total duration: "+s),{count:r,DB:s}},m.prototype.NB=function(t){return!!t&&!!("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))&&!!t.SegmentTemplate.SegmentTimeline},m.prototype.SB=function(){if(c.HiveConfig.Dash.DashFilterBitrates)try{var t=null;t="string"==typeof c.HiveConfig.Dash.DashFilterBitrates?c.HiveConfig.Dash.DashFilterBitrates.split(","):c.HiveConfig.Dash.DashFilterBitrates;var n=[];return t.forEach(function(t){var i=parseInt(t);isNaN(i)||n.push(i)}),n}catch(t){b.ErrorMonitor.Z().logError("Error parsing DashFilterBitrates",this.loggerId,y.Vn.nr,t)}},m.prototype.IB=function(t,r,s){var e=this;if(t.MPD&&t.MPD.Period){var h=[];t.MPD.Period.AdaptationSet.forEach(function(t){if(t.Representation_asArray&&(e.NB(t)||t.Representation_asArray.every(function(t){return e.CB(t)}))){var i=t.Representation_asArray;i.sort(function(t,i){return isNaN(t._bandwidth)&&(t._bandwidth=parseInt(t._bandwidth)),isNaN(i._bandwidth)&&(i._bandwidth=parseInt(i._bandwidth)),t._bandwidth-i._bandwidth});for(var n=i.length-1;0<=n;n--)s&&(delete i[n]._width,delete i[n]._height),r&&-1==r.indexOf(n)?i.splice(n,1):h.push(i[n]._bandwidth);e.logger.debug("DASH filtered-in bitrates: "+h.reverse().join(" ")+" - removed size: "+s)}})}},m.prototype.wB=function(n,i){try{var t=this.Fx.find(function(t){return t.bandwidth===i});if(t&&t.rB&&t.rB.has(n))return t.rB.get(n);if(t&&t.Jx){var r=t.Kx.replace(m.Xx,function(t,i){return l.MB(i||"%d",n)}),s=new w.mH(n,t.bandwidth,t.Jx*t.timescale,r,r),e=t.Kx.replace(m.Xx,function(t,i){return l.MB(i||"%d",n+1)});return s.next=new w.mH(n+1,t.bandwidth,t.Jx*t.timescale,r,e),s.next.type=s.type=t.type,s}return null}catch(t){return b.ErrorMonitor.Z().logError("Error getting the segment",this.loggerId,y.Vn.er,t),null}},m.prototype.jB=function(){return this.Gx},m.Qx="$Bandwidth$",m.aB="$Time$",m.Yx="$RepresentationID$",m.Xx=/\$Number([^$]+)?\$/,m);function m(t,i){this.loggerId="[DASH METADATA] ",this.Zx=!1,this.live=!1,this.hB=i,this.logger=p.Framework&&p.Framework.resolve(p.Framework.p.T)?p.Framework.resolve(p.Framework.p.T).log(t):console,this.PB=new s.LB(),this.uB(),this.reset()}i.HB=d},function(t,i,n){t.exports=function(g,b,y){null==b&&(b="_"),null==y&&(y=!1);var T=!1,m={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function O(t){var i=t.localName;return null==i&&(i=t.UB),null!=i&&""!=i||(i=t.nodeName),i}function n(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):t}function e(t,i,n,r){var s="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+i;if(null!=n)for(var e=0;e<n.length;e++){var h=n[e],o=t[h];s+=" "+h.substr(1)+"='"+o+"'"}return s+=r?"/>":">"}function h(t,i){return"</"+(null!=t.__prefix?t.__prefix+":":"")+i+">"}function o(t,i){return!!(function(t,i){return-1!==t.indexOf(i,t.length-i.length)}(i.toString(),"_asArray")||0==i.toString().indexOf("_")||t[i]instanceof Function)}function u(t){var i=0;if(t instanceof Object)for(var n in t)o(t,n)||i++;return i}function a(t){var i=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf("_")&&i.push(n);return i}function f(t){var i="";return t instanceof Object?i+=function(t){var i="";return null!=t.__cdata&&(i+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(i+=T?n(t.__text):t.__text),i}(t):null!=t&&(i+=T?n(t):t),i}function c(t,i,n){var r="";if(0==t.length)r+=e(t,i,n,!0);else for(var s=0;s<t.length;s++)r+=e(t[s],i,a(t[s]),!1),r+=l(t[s]),r+=h(t[s],i);return r}function l(t){var i="";if(0<u(t))for(var n in t)if(!o(t,n)){var r=t[n],s=a(r);null==r||null==r?i+=e(r,n,s,!0):r instanceof Object?r instanceof Array?i+=c(r,n,s):0<u(r)||null!=r.__text||null!=r.__cdata?(i+=e(r,n,s,!1),i+=l(r),i+=h(r,n)):i+=e(r,n,s,!0):(i+=e(r,n,s,!1),i+=f(r),i+=h(r,n))}return i+=f(t)}this.FB=function(t){var i;window.DOMParser?i=new window.DOMParser().parseFromString(t,"text/xml"):(0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),(i=new ActiveXObject("Microsoft.XMLDOM")).async="false",i.GB(t));return i},this.xB=function(t){return function t(i){if(i.nodeType==m.DOCUMENT_NODE){var n,r,s=i.firstChild;for(n=0,r=i.childNodes.length;n<r;n+=1)if(i.childNodes[n].nodeType!==m.COMMENT_NODE){s=i.childNodes[n];break}return y?e=t(s):(e={})[u=O(s)]=t(s),e}if(i.nodeType!=m.ELEMENT_NODE)return i.nodeType==m.TEXT_NODE||i.nodeType==m.CDATA_SECTION_NODE?i.nodeValue:i.nodeType==m.COMMENT_NODE?null:void 0;var e;(e=new Object()).__cnt=0;for(var h=i.childNodes,o=0;o<h.length;o++){var u=O(s=h.item(o));if(e.__cnt++,null==e[u])e[u]=t(s),e[u+"_asArray"]=new Array(1),e[u+"_asArray"][0]=e[u];else{if(null!=e[u]&&!(e[u]instanceof Array)){var a=e[u];e[u]=new Array(),e[u][0]=a,e[u+"_asArray"]=e[u]}for(var f=0;null!=e[u][f];)f++;e[u][f]=t(s)}}for(var c=0;c<i.attributes.length;c++){var l=i.attributes.item(c);e.__cnt++;for(var v=l.value,d=0,E=g.length;d<E;d++){var w=g[d];try{w.test.call(this,l)&&(v=w.BB.call(this,l.value))}catch(t){w.test.call(this,l),!1}}e[b+l.name]=v}var p=function(t){return t.prefix}(i);return null!=p&&""!=p&&(e.__cnt++,e.__prefix=p),1==e.__cnt&&null!=e["#text"]&&(e=e["#text"]),null!=e["#text"]&&(e.__text=e["#text"],e.__text instanceof Array&&(e.__text=e.__text.join("\n")),T&&(e.__text=function(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}(e.__text)),delete e["#text"],delete e["#text_asArray"],""===e.__text.trim()&&delete e.__text),null!=e["#cdata-section"]&&(e.__cdata=e["#cdata-section"],delete e["#cdata-section"],delete e["#cdata-section_asArray"]),null==e.__text&&null==e.__cdata||(e.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),e}(t)},this.RB=function(t){var i=this.FB(t);return this.xB(i)},this.AB=function(t){return l(t)},this.VB=function(t){var i=this.AB(t);return this.FB(i)},this.getVersion=function(){return"1.0.11"},this.qB=function(t){T=t}}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(34),o=n(58),u=n(1),a=n(6),f=(e=h.HiveRequest,s(c,e),c.QB=function(t,i){c.YB[i]?c.YB[i].push(t):c.YB[i]=[t]},c.registerPlugin=function(t,i){c.KB[i]=t},c.WB=function(i,t){var n=c.YB[t],r=c.KB[t],s=n&&n.length||0;r?s?(c.YB[t]=c.YB[t].filter(function(t){return t.id!=i.id}),s===c.YB[t].length?r.logger().warn(c.loggerId+" Attempt to unregister a not found session (pluginId = "+t+", sessionId = "+i.id+")"):r.logger().debug(c.loggerId+" Unregistered session (pluginId = "+t+", sessionId = "+i.id+")")):r.logger().warn(c.loggerId+" Attempt to unregister a session for plugin with no sessions (pluginId = "+t+", sessionId = "+i.id+")"):!1},c.prototype.send=function(){var i=this;if(!this.pluginId){var t=Object.keys(c.KB);0<t.length&&(this.pluginId=c.KB[t[0]])}var n=c.YB[this.pluginId],r=c.KB[this.pluginId],s=!1;n.forEach(function(t){o.lH(n)||o.lH(r)||t.ticket.Fg!==i.url||(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.$B(i),r.onActivateSession(i.url,!0),s=!0)}),s||(n.forEach(function(t){!o.lH(n)&&!o.lH(r)&&0<=i.url.indexOf(t.ticket.SourceURL)&&(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.$B(i),r.onActivateSession(i.url),s=!0)}),s||(u.ErrorMonitor.Z().logError("HiveJS Tech or Plugin are not defined",this.loggerId),this.resolve()))},c.prototype.resolve=function(){var t=this,i=new XMLHttpRequest();i.open("GET",this.url),i.onreadystatechange=function(){4===i.readyState&&(t.response=i.responseText,t.responseText=i.responseText,t.readyState=4,t.status=i.status,t.dispatchEvent(a.createEvent(Event,"readystatechange",{currentTarget:t})),t.dispatchEvent(a.createEvent(ProgressEvent,"onload",{currentTarget:t})),!1)},i.send()},c.KB={},c.YB={},c.loggerId="[HiveRequestManifest]",c);function c(){return null!==e&&e.apply(this,arguments)||this}i.Sb=f},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(75),o=n(0),u=(e=h["default"],s(a,e),a);function a(){return e.call(this,"JS",o.Framework.p.xl)||this}i["default"]=new u()},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(6),r=n(1),s=(e.prototype.addEventListener=function(t,i,n){this.events[t]=this.events[t]||[],this.events[t].push(i)},e.prototype.removeEventListener=function(t,i,n){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return t!==i}))},e.prototype.dispatchEvent=function(i){var n=this;this.events[i.type]&&this.events[i.type].forEach(function(t){try{"function"==typeof t?t.call(n,i):"function"==typeof t.Tb&&t.Tb(i)}catch(t){r.ErrorMonitor.Z().logError(n.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}});var t=this["on"+i.type];if("function"==typeof t)try{t.call(this,i)}catch(t){r.ErrorMonitor.Z().logError(this.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}return!1},e.prototype.msCachingEnabled=function(){return void 0!==this.msCaching},e.prototype.overrideMimeType=function(t){this.mimeType=t},e.register=function(t,i){e.aN[t]=i},e.prototype.XB=function(t){this.pluginId||(this.pluginId=e.aN[t])},e.prototype.open=function(t,i,n,r,s){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===s&&(s=null),this.url=i.trim(),this.method=t,this.username=r,this.password=s,this.async=n,this.readyState=this.OPENED;var e=h.createEvent(Event,"readystatechange",{currentTarget:this});this.dispatchEvent(e)},e.prototype.setRequestHeader=function(t,i){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");this.JB.push({key:t,value:i})},e.prototype.getResponseHeader=function(t){var i=this.getAllResponseHeaders();if(i){var n={};return i.split(/[\r\n]+/).forEach(function(t){var i=t.match(/^([^:]+): ?(.+)$/);i&&(n[i[1]]=i[2])}),n[t.toLowerCase()]}return null},e.prototype.getAllResponseHeaders=function(){return this.eg},e.prototype.onload=function(t){},e.prototype.onloadend=function(t){},e.prototype.onerror=function(t){},e.prototype.onprogress=function(t){},e.prototype.onreadystatechange=function(t){},e.prototype.onabort=function(t){},e.prototype.onloadstart=function(t){},e.prototype.ontimeout=function(t){},e.aN={},e.Sv=0,e);function e(t){this.loggerId="[HiveXHR] ",this.DONE=4,this.LOADING=3,this.HEADERS_RECEIVED=2,this.OPENED=1,this.UNSENT=0,this.username=null,this.password=null,this.JB=[],this.responseType="",this.readyState=this.UNSENT,this.status=0,this.async=!0,this.timeout=0,this.events={},t&&(this.pluginId=t)}i.uN=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(6),f=n(24),s=n(8),c=n(0),l=n(5),v=n(2),d=n(1),e=n(47),h=n(3),o=(E.prototype.zB=function(t,i){try{var n=void 0,r=t.Vp.duration,s=t.size,e=-1,h=0,o=-1;if(this.ZB.Ta()&&(e=Math.max(10,this.ZB.Ia(s))),h=-1<e?Math.max(0,r-e*l.Ku.Du.eo):.5*r,E.tV){var u=t.mU.yP();0<u&&(o=i/u*l.Ku.Du.oo),n=t.type===f.yp._p?r*l.Ku.Du.ho:-1<o&&o<=h?h:-1<o&&o<=r*l.Ku.Du.uo?r*l.Ku.Du.uo:0}else t.type==f.yp._p&&(h*=2),n=Math.max(this.iV(),h);if(l.Ku.Qu.mu){var a=this.nV.has(t.qp())?this.nV.get(t.qp()):this.rV(t);a.push([c.Framework.time(),i,e,h,o,t.type,n]),this.nV.set(t.qp(),a)}return this.logger.debug("TIMER DETAILS duration: "+r+" left/total: "+i+"/"+s+" cdn: "+e+" remaining: "+h+" p2p: "+o+" timeout: "+n),n}catch(t){return d.ErrorMonitor.Z().logError("Error calculating the p2p timeout",this.loggerId,v.wr.pr,t),0}},E.prototype.sV=function(t,i){return 5e3},E.prototype.eV=function(t){try{return this.ZB.Ta()?Math.min(this.ZB.Ia(t),this.hV()):this.oV()}catch(t){return d.ErrorMonitor.Z().logError("Error calculating the delivery delay",this.loggerId,v.wr.gr,t),this.oV()}},E.prototype.uV=function(t){if(t.Bp()===s.yf.mf)switch(t.xp()){case f.yp.mp:case f.yp.Tp:case f.yp.Op:case f.yp.Sp:this.ZB._a(t.ig());break;case f.yp.Rp:case f.yp._p:this.aV._a(t.ig())}if(l.Ku.Qu.mu){var i=this.nV.has(t.qp())?this.nV.get(t.qp()):this.rV(t);i.push([c.Framework.time(),t.xp()]),e.wM.dM(null,null,"p2p_timer",this.cj.getReportingGuid(),i,10)}},E.prototype.iV=function(){return E.fV},E.prototype.oV=function(){return E.cV},E.prototype.hV=function(){return E.lV},E.prototype.rV=function(t){return[[t.qp(),t.Vp.duration,t.size]]},E.tV=!0,E.fV=500,E.lV=1500,E.cV=500,E);function E(t){this.loggerId="[TIMER HANDLER] ",this.ZB=new r.Ma(),this.aV=new r.Ma(),this.nV=new h(),this.logger=c.Framework.resolve(c.Framework.p.T).log(),this.cj=t}i.vV=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v,r,d=n(2),E=n(2),s=n(0),w=n(13),p=n(1),g=E.ge,b=n(8);(r=v=v||{})[r.dV=0]="INFO",r[r.EV=1]="WARN",r[r.ERROR=2]="ERROR";var e=(y.prototype.wV=function(){var t=this.metadata.Ux(b.yf.mf),i=t.length,n=this.metadata.isLive();if(0===i||void 0!==n)for(var r=0;r<y.pV.length;r++){var s=y.pV[r],e=s[0],h=s[1],o=s[2];if(i<=e){if(-1===this.gV.indexOf(h)){var u=t.map(function(t){return w.Ca(t)+"/s"}).join(", "),a=y.bV+w.pc(d.Ie[h],n?"Live":"VOD",i,u);switch(o){case v.dV:this.logger.info(a);break;case v.EV:this.logger.warn(a);break;default:this.logger.error(a);var f=0==i?g.Se:g.Re;p.ErrorMonitor.Z().logError(d.Ie[f],y.bV,f,{isLive:n,yV:t})}this.gV.push(h)}break}}if(-1===this.gV.indexOf(g.be)){var c=!1;for(r=0;r<t.length;r++){var l=t[r];if(y.TV<l){c=!0,a=y.bV+w.pc(d.Ie[E.ge.be],w.Ca(l),w.Ca(y.TV)),this.logger.warn(a);break}}c&&this.gV.push(g.be)}},y.prototype.reset=function(){this.gV.length=0},y.bV="[StreamHealthChecker] ",y.TV=35e5,y.pV=[[0,g.ye,v.ERROR],[4,g.Te,v.dV],[7,g.me,v.EV],[1/0,g.Oe,v.ERROR]],y);function y(t){this.gV=[],this.metadata=t,this.logger=s.Framework.resolve(s.Framework.p.T).log()}i.mV=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),e=(s.prototype.size=function(){var t=this.end-this.start+1;return Number.isInteger(t)||(r.ErrorMonitor.Z().logError("Segment Size is a Float",{size:t}),t=Math.round(t)),0==this.end&&0==this.start?0:t},s.prototype.OV=function(){return 0==this.start&&(this.end==this.total-1||this.end==this.total&&0==this.total)},s.prototype.SV=function(){return this.end==this.total-1||this.end==this.total&&0==this.total},s.prototype.RV=function(t){return t.start<=this.start&&this.start<=t.end},s.prototype.toString=function(){return"R[S="+this.start+",E="+this.end+",T="+this.total+"]"},s);function s(t,i,n){this.start=t,this.end=i,this.total=n}i._V=e;var h=(o.AV=function(t){return t.split("-")},o.NV=function(t){var i=t.split("=",4),n=i[1].substr(0,i[1].indexOf(",")),r=i[2].substr(0,i[2].indexOf(",")),s=i[3].substr(0,i[3].indexOf("]"));return new e(+n,+r,+s)},o);function o(){}i.kV=h},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.CV||(i.CV={}))[r.DV=0]="ALL",r[r.AS=1]="AS",r[r.nj=2]="SITE"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(0),o=n(18),u=n(5),a=n(9),f=n(4),s=n(3),c=n(61),l=n(186),v=n(1),d=(E.prototype.init=function(t){this.MV=t,this.logger=h.Framework.resolve(h.Framework.p.T).log(t.sessionId),this.cj=t.cj,this.jV=t.jV,this.vj=t.vj},E.prototype.PV=function(t,i){var n=this,r=f.defer();try{if(this.LV){var s=null;t.privateIpString&&(s=t.privateIpString);var e=new l.HV(t.guid,t.rankValue,s,t.isLeader);if(this.UV.has(e.uuid)){var h=this.UV.get(e.uuid);h.udpScore==e.udpScore&&h.FV==e.FV?r.resolve():(this.UV.set(e.uuid,e),this.GV(),this.xV(e).then(function(){r.resolve()}).fail(function(t){n.UV["delete"](e.uuid),n.GV(),r.reject(t)}))}else i?(e.BV=i,this.logger.info(this.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.FV),this.UV.set(e.uuid,e),this.GV(),this.xV(e).then(function(){n.VV(n.UV.get(e.uuid)),r.resolve()}).fail(function(t){n.UV["delete"](e.uuid),n.GV(),r.reject(t)})):this.qV(e).then(function(t){e.BV=t,n.logger.info(n.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.FV),n.UV.set(e.uuid,e),n.GV(),n.xV(e).then(function(){r.resolve()}).fail(function(t){n.UV["delete"](e.uuid),n.GV(),r.reject(t)})}).fail(function(t){r.reject(t)})}else r.reject("LEADER ELECTION NOT STARTED YET")}catch(t){r.reject("TRIGGER LEADER ELECTION ERROR "+t)}return r.promise},E.prototype.VV=function(t){var i=new a.Mf(a.Rf.If,null);i.guid=t.uuid,i.isLeader=t.FV,i.rankValue=t.udpScore;var n=[i];this.jV.QV(n,!1)},E.prototype.qV=function(n){var r=this,s=f.defer();return this.YV.has(n.uuid)||this.KV.has(n.uuid)?s.reject(e.WV):(this.YV.set(n.uuid,Date.now()),this.Wl.connect(n.uuid).then(function(t){var i=t.Jl.Yl(r.MV.swarmId);null==i?(i=t.Jl.Fl(r.MV.swarmId),r.$V(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done()):r.XV.get(n.uuid)?s.resolve(t):(r.YV["delete"](n.uuid),r.$V(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done())}).fail(function(t){r.YV["delete"](n.uuid),s.reject(t)}).done()),s.promise},E.prototype.$V=function(t){var i=this,n=f.defer(),r=new o.Rv.Tv.UDPHandshakeMessage();r.uuid=this.JV.uuid,r.udpScore=this.JV.udpScore,r.isLeader=this.JV.FV,r.streamId=this.JV.streamId,this.logger.debug(this.loggerId+"MSG uuid "+r.uuid+" rankValue "+r.udpScore+" isLeader "+r.isLeader+" stream id "+r.streamId);var s=h.Framework.setTimeout(function(){i.zV(t.otherGuid)},u.Ku.UDPBroadcast.ou);return this.KV.set(t.otherGuid,{ZV:s,defer:n}),t.Zl(o.Dl.Pl,r),n.promise},E.prototype.zV=function(t){if(this.KV.has(t)){this.logger.debug(this.loggerId+" HANDSHAKE REQ EXPIRED TO "+t);var i=this.KV.get(t);this.KV["delete"](t),i.defer.reject("EXPIRED")}},E.prototype.tq=function(t,i){try{this.logger.debug(this.loggerId+"HANDSHAKE RESP RECEIVED FROM "+i.otherGuid);var n=i.otherGuid,r=this.KV.get(n);h.Framework.clearTimeout(r.ZV),this.KV["delete"](n),r.defer.resolve(i)}catch(t){v.ErrorMonitor.Z().logError("HANDSHAKE RESPONSE RECEIVED FAILED",this.loggerId,t)}},E.prototype.iq=function(t,i){var n=this;try{var r=new a.Mf(a.Rf.If,null,t.isLeader);if(r.guid=t.uuid,r.rankValue=t.udpScore,t.streamId===this.cj.getContextId()){var s=i.Jl.Yl(this.MV.swarmId);this.XV.set(t.uuid,t.uuid),this.nq(s,"OK"),this.PV(r,i).then(function(){}).fail(function(t){v.ErrorMonitor.Z().logError("LEADER ELECTION FAILED",n.loggerId,t)})}}catch(t){v.ErrorMonitor.Z().logError("HANDSHAKE REQUEST FAILED",this.loggerId,t)}},E.prototype.nq=function(t,i){var n=new o.Rv.Tv.UDPHandshakeResponse();n.accept=i,t.Zl(o.Dl.UDPHandshakeResponse,n),this.logger.debug(this.loggerId+"SEND HANDSHAKE RESPONSE TO "+t.otherGuid)},E.prototype.xV=function(t){var i=this,n=f.defer();if(this.rq()){var r=!1;this.logger.info(this.loggerId+"I HAVE THE HIGHEST SCORE"),t.FV&&!this.sq.has(t.uuid)&&(r=!0,this.logger.info(this.loggerId+"SEND SWITCH REQUEST TO "+t.uuid),this.eq(t).then(function(){n.resolve()}).fail(function(t){3==t.hq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.hq=2)&&n.reject(t)})),this.JV.FV||null==this.oq||this.oq.uuid==t.uuid||this.sq.has(this.oq.uuid)||(this.logger.info("SEND SWITCH REQUEST TO THE ALREADY KNOWN LEADER"),r=!0,this.eq(this.oq).then(function(){n.resolve()}).fail(function(t){3==t.hq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.hq=2)&&n.reject(t)})),null!=this.oq||t.FV||this.JV.FV||0!=this.sq.length||(this.logger.info(this.loggerId+"BECOME LEADER"),this.uq()),r||n.resolve()}else this.aq(t)&&(this.logger.info(this.loggerId+"PEER "+t.uuid+" HAS THE HIGHEST SCORE"),this.fq(),this.JV.FV&&t.FV&&this.stepDown(),this.cq(t)),n.resolve();return n.promise},E.prototype.cq=function(t){try{this.logger.info(this.loggerId+"UPDATE THE LEADERSHIP"),null!=this.oq&&this.UV.has(this.oq.uuid)&&(this.UV.get(this.oq.uuid).FV=!1),this.UV.has(t.uuid)?(this.UV.get(t.uuid).udpScore=t.udpScore,this.oq=t,this.UV.get(t.uuid).FV=!0):(this.logger.warn(this.loggerId+"SET A LEADER THAT IS NOT A LAN MEMBER LIST. SHOULD NEVER HAPPEN"),this.UV.set(t.uuid,t),this.oq=t),this.cj.lq(t),this.logger.info(this.loggerId+"NEW KNOWN LEADER "+this.cj.OP().uuid)}catch(t){v.ErrorMonitor.Z().logError(t,this.loggerId)}},E.prototype.stepDown=function(){this.logger.info(this.loggerId+"STEP DOWN"),this.JV.FV=!1,this.cj.vq(!1),u.Ku.Pu.mo&&(this.vj.dq(),this.vj.Eq(!1))},E.prototype.fq=function(){for(var t=0,i=this.sq.keys();t<i.length;t++){var n=i[t],r=this.sq.get(n);this.sq["delete"](n),h.Framework.clearTimeout(r.ZV),r.defer.reject({hq:3,message:"CANCELED PENDING RESPONSES"})}},E.prototype.aq=function(t){return t.uuid==this.wq[0].uuid},E.prototype.rq=function(){return l.HV.tS(this.JV,this.wq[0])<0},E.prototype.GV=function(){var t=new c(this.UV.values()),i=t.Bf(l.HV.tS);t.push(this.JV),this.cj.pq(i);var n=new c(this.UV.values());this.wq=n.Bf(l.HV.tS)},E.prototype.gq=function(t){this.bq(t)},E.prototype.bq=function(t){this.logger.info(this.loggerId+"EVALUATE THE SWITCH REQUEST FROM "+t.uuid);var i=void 0;this.UV.has(t.uuid)?i=this.UV.get(t.uuid):this.logger.warn("I RECEIVED A SWITCH REQUEST FROM AN UNKNOWN MEMBER. THIS SHOULD NEVER HAPPEN"),i&&(this.JV.FV?this.rq()?this.yq(i,!1):(this.stepDown(),this.fq(),this.cq(i),this.yq(i,!0)):this.aq(i)?(this.cq(i),this.yq(i,!0)):this.yq(i,!1))},E.prototype.yq=function(t,i){var n=this;this.Tq(t.BV,i).then(function(){}).fail(function(t){v.ErrorMonitor.Z().logError("SEND SWITCH RESPONSE ERROR",n.loggerId,t)}).done()},E.prototype.Tq=function(t,i){var n=f.defer(),r=new o.Rv.Tv.UDPSwitchLeadershipAck();return r.ok=i,t.Jl.Yl(this.MV.swarmId).Zl(o.Dl.Ll,r),n.promise},E.prototype.eq=function(i){var n=this,r=f.defer();return this.mq(i.BV).then(function(t){n.Oq(t,i),r.resolve()}).fail(function(t){r.reject(t)}).done(),r.promise},E.prototype.Oq=function(t,i){try{t?(this.UV.get(i.uuid).FV=!1,this.oq=this.JV,this.uq()):(this.fq(),this.UV.get(i.uuid).FV=!0,this.stepDown(),this.cq(i))}catch(t){v.ErrorMonitor.Z().logError("HANDLE LEADERSHIP SWITCH RESPONSE ERROR",this.loggerId,t)}},E.prototype.Sq=function(t,i){if(this.sq.has(i)){var n=this.sq.get(i);h.Framework.clearTimeout(n.ZV),this.sq["delete"](i),n.defer.resolve(t.ok)}else this.logger.warn(this.loggerId+" SWITCH LEADERSHIP RESPONSE RECEIVED FROM UNKNOWN PEER "+i)},E.prototype.mq=function(t){var i=this,n=f.defer(),r=new o.Rv.Tv.UDPSwitchLeadershipRequest();r.uuid=this.JV.uuid,r.udpScore=this.JV.udpScore,this.logger.debug(this.loggerId+"SWITCH LEADERSHIP REQUEST TO "+t.otherGuid);var s=h.Framework.setTimeout(function(){i.Rq(t.otherGuid)},u.Ku.UDPBroadcast.hu);this.sq.set(t.otherGuid,{ZV:s,defer:n});var e=t.Jl.Yl(this.MV.swarmId);return h.Framework.setTimeout(function(){e.Zl(o.Dl.UDPSwitchLeadershipRequest,r)},1),n.promise},E.prototype.Rq=function(t){if(this.sq.has(t)){this.logger.info(this.loggerId+" SWITCH LEADERSHIP EXPIRED TO "+t);var i=this.sq.get(t);this.sq["delete"](t),i.defer.reject({hq:2,message:"EXPIRED"})}},E.prototype.uq=function(){this.logger.info(this.loggerId+"BECOMING LAN LEADER"),null!=this.oq&&this.UV.has(this.oq.uuid)&&(this.UV.get(this.oq.uuid).FV=!1),this.JV.FV=!0,this.oq=this.JV,this.cj.vq(!0),this.cj.lq(this.JV),u.Ku.Pu.mo&&(this.vj.dq(),this.vj.Eq(!0))},E.prototype.Xd=function(t){this.JV=new l.HV(this.cj.getId(),this.cj._q(),"",!1,this.cj.getContextId()),this.LV=!0,this.logger.info(this.loggerId+" UDP LEADER ELECTION STARTED")},E.prototype.Iq=function(t){this.UV["delete"](t),this.GV(),0==this.UV.length?(this.JV.FV=!1,this.oq=null,this.cj.vq(!1),this.cj.Aq(!1),this.vj.dq(),this.vj.Eq(!1)):this.rq()?this.uq():0<this.wq.length&&this.cq(this.wq[0])},E);function E(){this.LV=!1,this.loggerId="[UDPLeaderElection] ",this.Wl=h.Framework.resolve(h.Framework.p.$l),this.UV=new s(),this.sq=new s(),this.KV=new s(),this.YV=new s(),this.XV=new s(),this.wq=[]}i.Nq=d,(r=e=i.kq||(i.kq={}))[r.Cq=0]="FAILURE",r[r.WV=1]="ALREADY_PENDING"},function(t,i){},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())}),e=this&&this.Dq||function(){return(e=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)};Object.defineProperty(i,"s",{value:!0});var v,h,d,o,u=n(4),a=n(3),E=n(0),w=n(179),p=n(5),f=n(18),c=n(9),l=n(180),g=hive.services.protocol.oU.TrackerPeerInfo,b=n(7),y=n(1),T=n(2),m=b.W.af;(h=v=i.Mq||(i.Mq={}))[h.jq=1]="ACCEPT",h[h.Pq=2]="REJECT",(o=d=i.Lq||(i.Lq={}))[o.DV=0]="ALL",o[o.Hq=1]="IN",o[o.Uq=2]="OUT";var O,S=(O=l.Fq,s(R,O),R.prototype.init=function(t){O.prototype.init.call(this,t),this.MV=t,this.ticket=t.sb.ticket,this.jV=t.jV,this.vj=t.vj,this.Gq=t.Gq,this.xq.init(t),this.Bq.init(t)},R.prototype.start=function(t){try{this.logger.info(this.loggerId+"PARTNERSHIP STARTED "+t.getContextId()),this.context=t,this.contextId=t.getContextId(),this.Vq(p.Ku.Nu.qh),this.qq(p.Ku.Pu._o),this.Qq(p.Ku.ku.Wh),this.active=!0}catch(t){y.ErrorMonitor.Z().logError("Error in partnership initialization",this.loggerId,T.ji.Pi,t)}},R.prototype.stop=function(){return E.Framework.clearInterval(this.Yq),E.Framework.clearInterval(this.Kq),E.Framework.clearInterval(this.Wq),this.context=null,this.contextId=null,this.active=!1,this.$q()},R.prototype.Xd=function(t){this.logger.info("PARTNERSHIP SERVER CONNECTED"),this.pd=t,this.connected=!0,null==this.cj.getId()&&this.cj.setId(this.pd)},R.prototype.Xq=function(){this.connected=!1},R.prototype.Jq=function(i){try{this.zq(i)||this.Zq.has(i.peerInfo.guid)||this.YV.has(i.peerInfo.guid)||i.peerInfo.guid==this.pd?this.tQ(i):this.iQ(i),this.nQ(i)&&this.rQ(i)}catch(t){y.ErrorMonitor.Z().logError("Error in discoering new lan peer",this.loggerId,T.ji.Li,{detailedError:t,otherGuid:i.peerInfo.guid})}},R.prototype.tQ=function(t){if(this.sQ.has(t.peerInfo.guid)){var i=this.sQ.get(t.peerInfo.guid);this.sQ["delete"](t.peerInfo.guid),this.kF.set(t.peerInfo.guid,i),this.cj.Aq(!0)}},R.prototype.rQ=function(t){if(this.AF.has(t.peerInfo.guid)){var i=this.AF.get(t.peerInfo.guid);this.AF["delete"](t.peerInfo.guid),this.NF.set(t.peerInfo.guid,i)}},R.prototype.Vq=function(t){var i=this;-1!=this.Yq&&E.Framework.clearInterval(this.Yq),this.Yq=E.Framework.setInterval(function(){i.eQ(!1)},t)},R.prototype.eQ=function(t){var i=this;t&&this.Yq&&(E.Framework.clearInterval(this.Yq),this.Vq(p.Ku.Nu.qh));try{if(this.connected){this.logger.debug(this.loggerId+"ADDING NEW PEERS IF POSSIBLE, NOW "+this.sQ.length+"/"+p.Ku.Nu.Vh+","+this.kF.length+"/infinity OUT RND "+this.AF.length+" OUT LAN "+this.NF.length);var n=[].concat(this.Zq.keys()).concat(this.YV.keys()),r=this.jV.hQ(!0),s=void 0;s=this.cj.rP()||this.cj.gP()?this.Bq.oQ(p.Ku.Nu.Vh,this.sQ.values(),n,r):this.xq.oQ(p.Ku.Nu.Vh,this.sQ.values(),n,r),this.uQ=s.aQ(),s.fQ().forEach(function(t){i.iQ(t)})}else this.logger.warn(this.loggerId+"NOT RUNNING IN PARTNER CHOICE, SRV DISCONNECTED")}catch(t){y.ErrorMonitor.Z().logError("Error in choosing in partners",this.loggerId,T.ji.Hi,t)}},R.prototype.iQ=function(s){var e=this,h=s.peerInfo.guid,t=s.peerInfo.privateIpString,i=s.peerInfo.publicIpString;this.logger.debug(this.loggerId+"IN PARTNER ADD PROCESS "+h),this.zq(s)||this.Zq.has(h)||this.YV.has(h)||this.Gq.cQ(h,t,i)||(this.YV.set(h,Date.now()),this.Wl.connect(h).then(function(t){var n=t.Jl.Yl(e.MV.swarmId);if(null==n&&(n=t.Jl.Fl(e.MV.swarmId)),n){var r=e.YV.get(h);e.YV["delete"](h),e.active&&e.lQ(n).then(function(t){if(e.vQ(n,s,t.msg,r),e.EQ.dQ(!1,!1),e.Gq.wQ(h,s.peerInfo.privateIpString,s.peerInfo.publicIpString),e.pQ(n),0<e.uQ.length&&!s.gQ()){var i=e.uQ[0];e.bQ(i.guid),i.TQ.yQ(d.Uq),e.uQ.splice(0,1)}}).fail(function(t){t&&"NOT ACCEPTED"!=t&&y.ErrorMonitor.Z().logError("Error in requesting partnership",e.loggerId,T.ji.Gi,{otherGuid:h}),e.EQ.dQ(!1,!0),e.mQ(h)})}}).fail(function(t){y.ErrorMonitor.Z().logError("Error in creating new p2p connection",e.loggerId,T.ji.Fi,{otherGuid:h}),e.EQ.dQ(!0,!0),e.YV["delete"](h),e.jV.Iq(h)}).done())},R.prototype.OQ=function(i,t){var n=this;try{var r=i.guid,s=null,e=null;if(i.privateIpString&&(e=i.privateIpString),i.publicIpString&&(s=i.publicIpString),this.SQ(r))this.logger.info(this.loggerId+"ALREADY OUT PARTNER "+r);else{var h=i.contextId,o=t.Jl.Yl(this.MV.swarmId);if(this.contextId!==h||p.Ku.ku.Kh!==i.p2pProtocolVersion||this.Gq.cQ(r,e,s))this.logger.info(this.loggerId+"PARTNERSHIP CANNOT BE ESTABLISHED WITH "+r+" CONTEXT ID "+h+" protocol version "+i.p2pProtocolVersion),this.RQ(o,v.Pq);else{var u=this._Q(i),a=void 0,f=void 0;if(u){if(this.jV.QV([u],!1),!(a=(f=this.jV.IQ(r)).gQ()||this.AF.length<p.Ku.Nu.Yh)){this.logger.debug(this.loggerId+" got out part req from "+r+" - reached max "+this.AF.length+"/"+p.Ku.Nu.Yh);var c=void 0;(c=this.cj.rP()||this.cj.gP()?this.NQ.AQ(this.cj,u,this.AF.values()):this.kQ.AQ(this.AF.values()))&&(this.logger.debug(this.loggerId+" chocking "+c.guid),this.AF["delete"](c.guid),c.TQ.yQ(d.Hq),a=!0)}}else a=!1;if(a){var l=new w.Partner(r,this.EQ,o,this.logger,!1,f);i.reportingGuid&&l.CQ(i.reportingGuid),this.jV.DQ.has(r)?this.NF.set(r,l):this.AF.set(r,l),this.logger.info(this.loggerId+"ADDED OUT PART "+r),this.RQ(o,v.jq),this.Gq.wQ(r,e,s),E.Framework.setTimeout(function(){n.MQ(r)},500),this.EQ.jQ()}else this.logger.info(this.loggerId+" cannot establish partnership to "+r+" - reached max "+this.AF.length+"/"+p.Ku.Nu.Yh),this.RQ(o,v.Pq)}}}catch(t){y.ErrorMonitor.Z().logError("Error receiving out partnership request",this.loggerId,T.ji.xi,{detailedError:t,otherGuid:i.guid})}},R.prototype._Q=function(i){try{var t=new g();t.guid=i.guid,i.internalAs&&(t.internalAs=i.internalAs),i.externalAs&&(t.externalAs=i.externalAs),i.publicIpString&&(t.publicIpString=i.publicIpString),i.privateIpString&&(t.privateIpString=i.privateIpString);var n=!1,r=this.jV.IQ(i.guid);if(r&&(n=r.peerInfo.isLeader),i.streamCharacteristics){var s=[];i.streamCharacteristics.forEach(function(t){var i=new c.TrackerPeerStreamInfo();i.state=t.streamState,i.bitrate=t.bitrate,i.delta=t.delta,s.push(i)}),t.streams=s.map(function(t){return new hive.services.protocol.oU.TrackerPeerStreamInfo(e({},t))})}return new c.Mf(c.Rf._f,t,n)}catch(t){return y.ErrorMonitor.Z().logError("Error constructing discovered peer info",this.loggerId,T.ji.Bi,{detailedError:t,otherGuid:i.guid}),null}},R.prototype.RQ=function(i,t){var r=this;this.logger.debug(this.loggerId+"SEND PART RESPONSE TO "+i.otherGuid);try{var n=new f.Rv.Tv.OutPartnershipResponse();if(n.accept=t,n.accept===v.jq){this.cj.fP()&&(n.internalAs=this.cj.fP()),this.cj.cP()&&(n.externalAs=this.cj.cP()),this.cj.getPublicIp()&&(n.publicIpString=this.cj.getPublicIp()),this.cj.getPrivateIp()&&(n.privateIpString=this.cj.getPrivateIp()),n.reportingGuid=this.cj.getReportingGuid();var s=this.cj.PQ(),e=[];s.forEach(function(t,i){var n=new f.Rv.Tv.StreamCharacteristics();n.bitrate=i,n.streamState=t.type,n.delta=null!=r.cj.getDelta()?r.cj.getDelta():-1,e.push(n)}),0<e.length&&n.setStreamCharacteristics(e)}i.Zl(f.Dl.jl,n)}catch(t){y.ErrorMonitor.Z().logError("Error constructing partnership response message",this.loggerId,T.ji.Vi,{detailedError:t,otherGuid:i.otherGuid})}},R.prototype.LQ=function(t){this.logger.warn(this.loggerId+t)},R.prototype.vQ=function(t,i,n,r){var s=t.otherGuid;if(n.externalAs&&(i.peerInfo.externalAs=n.externalAs),n.internalAs&&(i.peerInfo.internalAs=n.internalAs),n.publicIpString&&(i.peerInfo.publicIpString=n.publicIpString),n.privateIpString&&(i.peerInfo.privateIpString=n.privateIpString),n.streamCharacteristics){var e=[];n.streamCharacteristics.forEach(function(t){var i=new c.TrackerPeerStreamInfo();i.state=t.streamState,i.bitrate=t.bitrate,i.delta=t.delta,e.push(i)}),i.peerInfo.streams=e}try{var h=new w.Partner(s,this.EQ,t,this.logger,!0,i,r);return n.reportingGuid&&(h.reportingGuid=n.reportingGuid,t.receiver.setReportingGuid(n.reportingGuid),t.sender.setReportingGuid(n.reportingGuid)),i.peerInfo.type==c.Rf.If?(this.kF.set(s,h),this.cj.HQ(!0),this.cj.UQ(!0),this.cj.Aq(!0)):(0!=this.cj.cP()&&this.cj.cP()===i.peerInfo.externalAs&&this.cj.HQ(!0),0!=this.cj.fP()&&this.cj.fP()===i.peerInfo.internalAs&&this.cj.UQ(!0),this.sQ.set(s,h)),this.logger.debug(this.loggerId+s+" IS NOW IN PARTNER"),h}catch(t){y.ErrorMonitor.Z().logError("Error adding a new partner object in the list",this.loggerId,T.ji.qi,{detailedError:t,otherGuid:s})}},R.prototype.Iq=function(i){try{this.logger.info(this.loggerId+"GOT PEER DISC "+i),this.FQ(i)&&(this.logger.info(this.loggerId+"IN PRT DISC "+i),this.bQ(i)),this.SQ(i)&&(this.logger.info(this.loggerId+"OUT PRT DISC "+i),this.AF["delete"](i),this.NF["delete"](i))}catch(t){y.ErrorMonitor.Z().logError("Error removing disconected partner from the list",this.loggerId,T.ji.Qi,{detailedError:t,otherGuid:i})}},R.prototype.bQ=function(i){try{this.logger.debug(this.loggerId+"IN PARTNER REMOVE "+i);var t=this.GQ(i);if(this.uj.xQ(t),this.sQ["delete"](i),this.kF["delete"](i),0<this.kF.length)this.cj.HQ(!0),this.cj.UQ(!0);else{var n=this.cj.fP(),r=this.cj.cP(),s=!1,e=!1;0!=n||0!=r?(this.sQ.forEach(function(t){0<n&&n===t.lP.peerInfo.internalAs&&(s=!0),0<r&&r===t.lP.peerInfo.externalAs&&(e=!0)}),this.cj.UQ(s),this.cj.HQ(e)):(this.cj.UQ(!1),this.cj.HQ(!1))}}catch(t){y.ErrorMonitor.Z().logError("Error removing the in partner",this.loggerId,T.ji.Yi,{detailedError:t,otherGuid:i})}},R.prototype.BQ=function(i,t){try{this.logger.debug(this.loggerId+"CLOSE RECEIVED FROM "+i+" TYPE "+d[t.getType()]),t.getType()!=d.DV&&t.getType()!=d.Uq||(this.AF.has(i)&&this.AF["delete"](i),this.NF.has(i)&&this.NF["delete"](i)),t.getType()!=d.DV&&t.getType()!=d.Hq||this.bQ(i)}catch(t){y.ErrorMonitor.Z().logError("Error when close received",this.loggerId,T.ji.Ki,{detailedError:t,otherGuid:i})}},R.prototype.lQ=function(i){var r=this,n=u.defer();try{var t=new f.Rv.Tv.OutPartnershipRequest();t.guid=this.pd,t.contextId=this.contextId,t.p2pProtocolVersion=p.Ku.ku.Kh,t.reportingGuid=this.cj.getReportingGuid(),this.cj.fP()&&(t.internalAs=this.cj.fP()),this.cj.cP()&&(t.externalAs=this.cj.cP()),this.cj.getPrivateIp()&&(t.privateIpString=this.cj.getPrivateIp()),this.cj.getPublicIp()&&(t.publicIpString=this.cj.getPublicIp());var s=this.cj.PQ(),e=[];s.forEach(function(t,i){var n=new f.Rv.Tv.StreamCharacteristics();n.bitrate=i,n.streamState=t.type,n.delta=null!=r.cj.getDelta()?r.cj.getDelta():-1,e.push(n)}),0<e.length&&t.setStreamCharacteristics(e),this.logger.debug(this.loggerId+"SEND PART REQ TO "+i.otherGuid+" WITH ID "+t.contextId+" internalAS "+t.internalAs+" externalAs "+t.externalAs+" private ip "+t.privateIpString+" public ip "+t.publicIpString+" rGuid "+this.cj.getReportingGuid());var h=E.Framework.setTimeout(function(){r.VQ(n,i.otherGuid)},p.Ku.Nu.Bh);this.Zq.set(i.otherGuid,{ZV:h,defer:n}),i.Zl(f.Dl.Ml,t)}catch(t){y.ErrorMonitor.Z().logError("Error sending partnership request",this.loggerId,T.ji.Wi,{detailedError:t,otherGuid:i.otherGuid}),n.reject(t)}return n.promise},R.prototype.qQ=function(t,i){var n=i.otherGuid,r=this.Zq.get(n);r?(E.Framework.clearTimeout(r.ZV),this.Zq["delete"](n),t.accept===v.jq?r.defer.resolve({la:i,msg:t}):r.defer.reject("NOT ACCEPTED")):y.ErrorMonitor.Z().logError("Error receiving out partnership response from an unknown peer",this.loggerId,T.ji.Ji,{otherGuid:n})},R.prototype.VQ=function(t,i){if(this.Zq.has(i)){y.ErrorMonitor.Z().logError("Error partnership request expired",this.loggerId,T.ji.$i,{otherGuid:i});var n=this.Zq.get(i);this.Zq["delete"](i),n.defer.reject("EXPIRED")}else y.ErrorMonitor.Z().logError("Error partnership request expired for unknown peer",this.loggerId,T.ji.Xi,{otherGuid:i})},R.prototype.$q=function(){var i=this,n=u.defer(),r=this.sQ.values();this.kF.forEach(function(t,i){r.push(t)});var t=r.slice().map(function(t){return t.TQ.close()});return u.all(t).then(function(t){n.resolve("resolved")}).fail(function(t){y.ErrorMonitor.Z().logError("Error closing partnership",i.loggerId,T.ji.zi),n.reject("could not close")}),n.promise},R.prototype.mQ=function(t){this.Wl.disconnect(t)},R.prototype.qq=function(t){var i=this;-1!=this.Kq&&E.Framework.clearInterval(this.Kq),this.Kq=E.Framework.setInterval(function(){i.QQ()},t)},R.prototype.QQ=function(){try{if(this.cj.EP()&&!this.cj.rP()&&m){var t=this.cj.OP(),i=this.context.Tj().bitrate;if(i&&this.FQ(t.uuid)){var n=this.GQ(t.uuid);this.YQ(n.TQ,i)}}}catch(t){y.ErrorMonitor.Z().logError("Error announcing bitrate",this.loggerId,T.ji.Zi,t)}},R.prototype.YQ=function(i,t){try{var n=new f.Rv.Tv.Bitrate();n.guid=this.pd,n.bitrate=t,this.logger.debug(this.loggerId+"ANNOUNCE BITRATE "+n.bitrate+" TO PEER GUID "+i.otherGuid),i.Zl(f.Dl.Bitrate,n)}catch(t){y.ErrorMonitor.Z().logError("Error constructing bitrate announcement",this.loggerId,T.ji.tn,{detailedError:t,otherGuid:i.otherGuid})}},R.prototype.KQ=function(i){try{this.logger.debug(this.loggerId+"RECEIVED BITRATE "+i.bitrate+" FROM PEER GUID "+i.guid),this.jV.DQ.has(i.getGuid())&&(this.jV.DQ.get(i.guid).WQ(i.bitrate),this.vj.$Q())}catch(t){y.ErrorMonitor.Z().logError("Error receiving bitrate info",this.loggerId,T.ji["in"],{detailedError:t,otherGuid:i.guid})}},R.prototype.XQ=function(i){try{var t=i.guid,n=this.GQ(t);n&&this.JQ(n,i),(n=this.zQ(t))&&this.JQ(n,i),this.Gq.wQ(t,i.privateIpString,i.publicIpString)}catch(t){y.ErrorMonitor.Z().logError("Error receiving peer info",this.loggerId,T.ji.nn,{detailedError:t,otherGuid:i.guid})}},R.prototype.JQ=function(t,i){var n=t.lP.peerInfo;if(i.privateIpString&&(n.privateIpString=i.privateIpString),i.publicIpString&&(n.publicIpString=i.publicIpString),i.externalAs&&(n.externalAs=i.externalAs),i.internalAs&&(n.internalAs=i.internalAs),i.streamCharacteristics){var r=[];i.streamCharacteristics.forEach(function(t){var i=new c.TrackerPeerStreamInfo();i.bitrate=t.bitrate,i.delta=t.delta,i.state=t.streamState,r.push(i)}),n.streams=r}},R.prototype.Qq=function(t){var i=this;this.Wq&&E.Framework.clearInterval(this.Wq),this.Wq=E.Framework.setInterval(function(){i.ZQ()},t)},R.prototype.ZQ=function(){var r=this;try{if(this.cj.getPrivateIp()||this.cj.getPublicIp()||this.cj.fP()||this.cj.cP()){var t=this.tY(),n=new f.Rv.Tv.PeerInfoMessage();n.guid=this.cj.getId(),this.cj.getPrivateIp()&&(n.privateIpString=this.cj.getPrivateIp()),this.cj.getPublicIp()&&(n.publicIpString=this.cj.getPublicIp()),this.cj.cP()&&(n.externalAs=this.cj.cP()),this.cj.fP()&&(n.internalAs=this.cj.fP());var i=this.cj.PQ(),s=[];i.forEach(function(t,i){var n=new f.Rv.Tv.StreamCharacteristics();n.bitrate=i,n.streamState=t.type,n.delta=null!=r.cj.getDelta()?r.cj.getDelta():-1,s.push(n)}),0<s.length&&n.setStreamCharacteristics(s),t.forEach(function(t,i){t.TQ.Zl(f.Dl.Hl,n)})}}catch(t){y.ErrorMonitor.Z().logError("Error announcing peer info to all partners",this.loggerId,T.ji.rn,t)}},R.prototype.tY=function(){try{var n=new a();return this.AF.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.NF.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.kF.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.sQ.forEach(function(t,i){n.has(i)||n.set(i,t)}),n}catch(t){return y.ErrorMonitor.Z().logError("Error collecting all partners",this.loggerId,T.ji.sn,t),new a()}},R);function R(){var t=O.call(this)||this;return t.loggerId="[Partnership] ",t.Zq=new a(),t.YV=new a(),t.Yq=-1,t.Kq=-1,t.Wq=-1,t.connected=!1,t.Wl=E.Framework.resolve(E.Framework.p.$l),t.xq=E.Framework.resolve(E.Framework.p.oD),t.kQ=E.Framework.resolve(E.Framework.p.wD),t.Bq=E.Framework.resolve(E.Framework.p.uD),t.NQ=E.Framework.resolve(E.Framework.p.pD),t}i.iY=S},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.nY=!0,s.rY=3e4,s.sY=6e4,s.eY=3e4,s);function s(){}i.hY=r;var e=(h.du="site",h.Eu="externalAs",h.wu="availableSendRate",h.pu="remoteAddress",h.gu="localAddress",h);function h(){}i.oY=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var E=n(99),w=n(5),p=n(0),g=n(1),b=n(2),r=(s.prototype.init=function(t){this.cj=t.cj},s.prototype.oQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-w.Ku.Nu.Qh)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.TQ.la.Xl()}),f=p.Framework.time(),c=a.filter(function(t){return f-t.uY>w.Ku.ku.Zh}),l=Math.min(c.length,o);e=this.aY(l,c);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t.IU._U(!1))})}return 0<u&&(s=this.fY(u,i,n,r)),this.logger.debug("[PART] A/R: "+u+"/"+o+" ["+s.map(function(t){return t.peerInfo.guid.substring(0,8)})+"/"+e.map(function(t){return t.guid.substring(0,8)})+"] P:["+i.map(function(t){return t.guid.substring(0,8)})+"] M:["+r.map(function(t){return t.peerInfo.guid.substring(0,8)})+"]"),new E.cY(s,e)}catch(t){return g.ErrorMonitor.Z().logError("Error updating in partners",this.AH,b.en.hn,t),new E.cY([],[])}},s);function s(){this.AH="[BaseInPartnerSelection] ",this.logger=p.Framework.resolve(p.Framework.p.T).log()}i.lY=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.aQ=function(){return this.vY},s.prototype.fQ=function(){return this.dY},s);function s(t,i){this.dY=t,this.vY=i}i.cY=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.EY=function(t,i,n){return t=isNaN(t)?(n.debug("readyCheckTimeout is "+t+". Setting it to 0"),0):Number(t),i=isNaN(i)?(n.debug("macReadyCheckTimeout is "+i+". Setting it to 0"),0):Number(i),window.navigator.platform.match(/Mac/gi)&&-1<i?i:t},s);function s(){}i.wY=r},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(64),o=n(13),u=n(89),a=n(6),f=(e=u.uN,s(c,e),c.ht=function(t){c.logger=t},c.prototype.send=function(){if(c.logger&&c.logger.debug(this.method+" "+this.url),!this.pluginId){var t=Object.keys(c.aN);0<t.length&&(this.pluginId=c.aN[t[0]])}var i=this,n=new XMLHttpRequest();0===this.url.indexOf("//")&&(this.url=location.protocol+this.url);var r=o.pc(h.UU.jU,h.UU.FD,h.UU.CU,this.pluginId,encodeURIComponent(this.url));n.open("GET",r),this.responseType&&(n.responseType=this.responseType),n.onreadystatechange=function(){},n.onload=function(){if(4===n.readyState)try{i.eg=n.getAllResponseHeaders(),i.response=n.response;var t=n.response.byteLength;"arraybuffer"!==n.responseType&&(i.responseText=n.response),i.readyState=4,i.status=n.status,i.dispatchEvent(a.createEvent(ProgressEvent,"progress",{lengthComputable:!0,loaded:t,total:t,currentTarget:i})),i.dispatchEvent(a.createEvent(Event,"readystatechange",{currentTarget:i,bubbles:!1,cancelable:!1})),i.dispatchEvent(a.createEvent(ProgressEvent,"load",{currentTarget:i,bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:t,total:0})),i.dispatchEvent(a.createEvent(ProgressEvent,"loadend",{currentTarget:i,bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:t,total:0}))}catch(t){c.logger&&c.logger.warn(t)}},n.onerror=function(t){c.logger&&c.logger.warn("onError: "+JSON.stringify(t)),i.dispatchEvent(a.createEvent(ErrorEvent,"error",t,i))},n.onabort=function(t){c.logger&&c.logger.warn("onAbort: "+JSON.stringify(t)),i.dispatchEvent(a.createEvent(ProgressEvent,"abort",t,i))},n.send()},c.prototype.abort=function(){},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.pY=f},function(t,i,o){"use strict";var r,n=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())}),s=this&&this.gY||function(e,h,o,u){return new(o=o||Promise)(function(t,i){function n(t){try{s(u.next(t))}catch(t){i(t)}}function r(t){try{s(u.bY(t))}catch(t){i(t)}}function s(i){i.done?t(i.value):new o(function(t){t(i.value)}).then(n,r)}s((u=u.apply(e,h||[])).next())})},u=this&&this.yY||function(n,r){var s,e,h,t,o={label:0,TY:function(){if(1&h[0])throw h[1];return h[1]},mY:[],OY:[]};return t={next:i(0),bY:i(1),gh:i(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function i(i){return function(t){return function(i){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,e&&(h=2&i[0]?e.gh:i[0]?e.bY||((h=e.gh)&&h.call(e),0):e.next)&&!(h=h.call(e,i[1])).done)return h;switch(e=0,h&&(i=[2&i[0],h.value]),i[0]){case 0:case 1:h=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,e=i[1],i=[0];continue;case 7:i=o.OY.pop(),o.mY.pop();continue;default:if(!(h=0<(h=o.mY).length&&h[h.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!h||i[1]>h[0]&&i[1]<h[3])){o.label=i[1];break}if(6===i[0]&&o.label<h[1]){o.label=h[1],h=i;break}if(h&&o.label<h[2]){o.label=h[2],o.OY.push(i);break}h[2]&&o.OY.pop(),o.mY.pop();continue}i=r.call(n,o)}catch(t){i=[6,t],e=0}finally{s=h=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,t])}}};Object.defineProperty(i,"s",{value:!0});var a=o(25),e=o(221),h=o(222);i.SY="X-Hive-Plugin-Id";var f,c=(f=a.Plugin,n(l,f),l.prototype.RY=function(){return{pluginVersion:a.W.sf,commVersion:a.W["if"]}},l.prototype.initSession=function(t){var n=this;return this.closeHiveSession("Starting a new session"),this.resolveTicketPromise(t).timeout(this.options().pluginTimeout,"The plugin timedout").then(function(i){return s(n,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return this.playerSource=i.manifest,this._Y=new a.HivePlayerExtendedStats(),this.IY=!0,0<=this.getPlayerVersion().indexOf("v1")?[4,this.AY(i)]:[3,2];case 1:return t.TY(),this.NY(),[3,3];case 2:0<=this.getPlayerVersion().indexOf("v2")&&(this.kY(i),this.CY()),t.label=3;case 3:return this.DY(),this.logger().debug("[HiveComm] setup complete for version",this.getPlayerVersion()),[2,i.toHiveSession()]}})})},function(t){throw n.closeHiveSession(),a.logError("Error resolving ticket promise",n.loggerId,a.Cb.ue,t),t})},l.prototype.closeHiveSession=function(t,i){if(void 0===i&&(i=!0),this.$g(!1),this.IY=!1,this.playerSource=null,"shaka"===this.getPluginName()){var n=this.getPotentialSession();0<=this.getPlayerVersion().indexOf("v1")?(this.player.unload=this.MY.unload,n&&n.getTechName()===a.TechName.HiveJS&&(shaka.dash.MpdRequest.prototype.send=this.MY.jY,shaka.media.SourceBufferManager.prototype.fetch=this.MY.PY)):0<=this.getPlayerVersion().indexOf("v2")&&n&&n.getTechName()===a.TechName.HiveJS&&(shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpXHRPlugin,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpXHRPlugin,shaka.net.NetworkingEngine.PluginPriority.PREFERRED))}f.prototype.closeHiveSession.call(this,t,i)},l.prototype.AY=function(h){return s(this,void 0,void 0,function(){var i,n,r,s,e=this;return u(this,function(t){switch(t.label){case 0:return i=this,[4,Promise.resolve().then(function(){return o(223)})];case 1:return i.LY=t.TY().HiveAbrManager,this.LY.HY=function(){return e},n=this,[4,Promise.resolve().then(function(){return o(224)})];case 2:return n.UY=t.TY().FY,this.UY.HY=function(){return e},h.tech.getName()!==a.TechName.HiveJS?[3,4]:[4,Promise.resolve().then(function(){return o(225)})];case 3:r=t.TY().GY,this.MY.jY=shaka.dash.MpdRequest.prototype.send,this.MY.PY=shaka.media.SourceBufferManager.prototype.fetch,shaka.dash.MpdRequest.prototype.send=r(this.getPluginId(),this.MY.jY),shaka.media.SourceBufferManager.prototype.fetch=r(this.getPluginId(),this.MY.PY),t.label=4;case 4:return(s=this).player.unload=function(){return s.isSessionActive()&&(s.logger().debug("[HiveComm] Player unloading, closing hive session..."),s.closeHiveSession()),s.MY.unload.apply(this,arguments)},[2]}})})},l.prototype.kY=function(t){var i=this;this.player.configure({abrFactory:h.xY(this)}),shaka.Player.registerSupportPlugin("hive",this.RY),t.tech.getName()===a.TechName.HiveJS?(this.player.destroy=function(){return i.MY.destroy.call(i.player).then(function(){0===i.destroyHivePlugin()&&0!==l.BY&&(shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpFetchPlugin,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpFetchPlugin,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),l.BY=0),i.$g(!0),i.player.destroy=i.MY.destroy,i.MY=void 0})},this.player.getNetworkingEngine().registerRequestFilter(this.VY),2!==l.BY&&(shaka.net.NetworkingEngine.registerScheme("http",e.qY,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),shaka.net.NetworkingEngine.registerScheme("https",e.qY,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),l.BY=2)):0===l.BY&&(shaka.net.NetworkingEngine.registerScheme("http",shaka.net.HttpXHRPlugin,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),shaka.net.NetworkingEngine.registerScheme("https",shaka.net.HttpXHRPlugin,shaka.net.NetworkingEngine.PluginPriority.PREFERRED),l.BY=1)},l.prototype.registerEvent=function(t,i,n,r){void 0===r&&(r=!1),this.QY.some(function(t){return t.eventName===i&&t.YY===n})||(t.addEventListener(i,n),this.QY.push({target:t,eventName:i,YY:n,KY:r}))},l.prototype.$g=function(e){void 0===e&&(e=!1);var h=[];this.QY.forEach(function(t){var i=t.target,n=t.YY,r=t.eventName,s=t.KY;e||!s?i.removeEventListener(r,n):h.push(t)}),this.QY=h},l.prototype.DY=function(){this.registerEvent(this.player,"error",this.error),this.registerEvent(this.video,"canplay",this.WY),this.registerEvent(this.video,"playing",this.playing),this.registerEvent(this.video,"pause",this.pause),this.registerEvent(this.video,"ended",this.ended),this.registerEvent(this.video,"seeking",this.seeking),this.registerEvent(this.video,"fullscreenchange",this.fullscreenchange)},l.prototype.NY=function(){this.registerEvent(this.video,"loadedmetadata",this.$Y),this.registerEvent(this.player,"bufferingStart",this.XY),this.registerEvent(this.player,"bufferingEnd",this.JY)},l.prototype.CY=function(){this.registerEvent(this.player,"streaming",this.$Y),this.registerEvent(this.player,"unloading",this.zY),this.registerEvent(this.player,"buffering",this.buffering)},l.prototype.VY=function(t,i){return i.pluginId=this.getPluginId(),!0},l.prototype.$Y=function(){this.logger().debug("[HiveComm] Video's metadata has finished loading"),this.onActivateSession(),this.onStartBuffering(!1),this.ub()},l.prototype.zY=function(t){this.logger().debug("unloading",t),this.isSessionActive()&&this.closeHiveSession("Unloading source")},l.prototype.WY=function(t){this.logger().debug("canplay",t),this.onEndBuffering()},l.prototype.playing=function(t){this.logger().debug("playing",t),this.onEventFeedback(a.PlayerEvents.PLAYING,{currentTime:this.getCurrentTime()})},l.prototype.pause=function(t){this.logger().debug("pause",t),this.onEventFeedback(a.PlayerEvents.PAUSED)},l.prototype.ended=function(t){this.logger().debug("ended",t),this.onEventFeedback(a.PlayerEvents.STOPPED)},l.prototype.seeking=function(t){this.logger().debug("seeking",t),this.onEventFeedback(a.PlayerEvents.SKIP)},l.prototype.fullscreenchange=function(){this.logger().debug("fullscreen",document.fullscreen),this.onEventFeedback(a.PlayerEvents.FULLSCREEN,{value:document.fullscreen})},l.prototype.buffering=function(t){this.isSessionActive()&&(t.buffering?(this.logger().debug("[HiveComm] Buffering event start (possible video quality switch)",event),this.onStartBuffering(!0)):(this.logger().debug("[HiveComm] Buffering event end",event),this.onEndBuffering()))},l.prototype.XY=function(t){this.isSessionActive()&&(this.logger().debug("[HiveComm] Buffering event start (possible video quality switch)",t),this.onStartBuffering(!0))},l.prototype.JY=function(t){this.isSessionActive()&&(this.logger().debug("[HiveComm] Buffering event end",t),this.onEndBuffering())},l.prototype.error=function(t){var i=t.detail.type+": "+t.detail.message;-1<this.getPlayerVersion().indexOf("v2")?this.onError(t.detail.code,i,t.detail.severity===shaka.util.Error.Severity.CRITICAL):this.onError(t.detail.code,i)},l.prototype.getPlayerSource=function(){return("function"==typeof this.player.getManifestUri?this.player.getManifestUri():"function"==typeof this.player.getAssetUri?this.player.getAssetUri():null)||this.playerSource},l.prototype.getCurrentTime=function(){return Math.round(1e3*this.video.currentTime)},l.prototype.getBufferLen=function(){return Math.max(Math.round(1e3*a.BasicUtils.Oc(this.video.currentTime,this.video.buffered)),0)},l.prototype.getWindowSize=function(){return{width:this.video?this.video.clientWidth:0,height:this.video?this.video.clientHeight:0}},l.prototype.isFullscreen=function(){return null!=document.fullscreenElement&&document.fullscreenElement==this.video},l.prototype.isLive=function(){return this.player.isLive()},l.prototype.isActive=function(){return!0},l.prototype.getStreamProtocol=function(){var t=this.getPlayerSource();if(null!=t){if(0<=t.indexOf(".m3u8"))return StreamProtocol.HLS;if(0<=t.indexOf(".mpd"))return StreamProtocol.DASH}return null},l.prototype.getExtendedStats=function(){var t=Math.round(this.player.getStats().estimatedBandwidth),i=this._Y;return i.updateBandwidth(t),this._Y=new a.HivePlayerExtendedStats(),i},l.prototype.getPluginName=function(){return"shaka"},l.prototype.getPlayerTech=function(){return"html5"},l.prototype.getPlayerVersion=function(){return"undefined"!=typeof shaka&&shaka.player&&shaka.player.Player&&shaka.player.Player.version?shaka.player.Player.version:"undefined"!=typeof shaka&&shaka.Player&&shaka.Player.version?shaka.Player.version:"v1.6.4"},l.BY=0,l);function l(t,i,n){var r=f.call(this,n=n||i)||this;return r.playerSource="",r.IY=!1,r.QY=[],r.player=t,r.video=3===arguments.length?i:r.player.getMediaElement(),r.MY={destroy:r.player.destroy,unload:r.player.unload},r.$Y=r.$Y.bind(r),r.zY=r.zY.bind(r),r.WY=r.WY.bind(r),r.playing=r.playing.bind(r),r.pause=r.pause.bind(r),r.ended=r.ended.bind(r),r.seeking=r.seeking.bind(r),r.fullscreenchange=r.fullscreenchange.bind(r),r.buffering=r.buffering.bind(r),r.XY=r.XY.bind(r),r.JY=r.JY.bind(r),r.error=r.error.bind(r),r.VY=r.VY.bind(r),r}i.HiveShaka=c,"shaka"==a.W.nf&&(window.HiveShaka=c)},function(t,i,r){"use strict";var s,n=this&&this.Sc||(s=function(t,i){return(s=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())}),e=this&&this.gY||function(e,h,o,u){return new(o=o||Promise)(function(t,i){function n(t){try{s(u.next(t))}catch(t){i(t)}}function r(t){try{s(u.bY(t))}catch(t){i(t)}}function s(i){i.done?t(i.value):new o(function(t){t(i.value)}).then(n,r)}s((u=u.apply(e,h||[])).next())})},h=this&&this.yY||function(n,r){var s,e,h,t,o={label:0,TY:function(){if(1&h[0])throw h[1];return h[1]},mY:[],OY:[]};return t={next:i(0),bY:i(1),gh:i(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function i(i){return function(t){return function(i){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,e&&(h=2&i[0]?e.gh:i[0]?e.bY||((h=e.gh)&&h.call(e),0):e.next)&&!(h=h.call(e,i[1])).done)return h;switch(e=0,h&&(i=[2&i[0],h.value]),i[0]){case 0:case 1:h=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,e=i[1],i=[0];continue;case 7:i=o.OY.pop(),o.mY.pop();continue;default:if(!(h=0<(h=o.mY).length&&h[h.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!h||i[1]>h[0]&&i[1]<h[3])){o.label=i[1];break}if(6===i[0]&&o.label<h[1]){o.label=h[1],h=i;break}if(h&&o.label<h[2]){o.label=h[2],o.OY.push(i);break}h[2]&&o.OY.pop(),o.mY.pop();continue}i=r.call(n,o)}catch(t){i=[6,t],e=0}finally{s=h=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,t])}}};Object.defineProperty(i,"s",{value:!0});var o,u=r(25),a=r(102),f=(o=a.HiveShaka,n(c,o),c.prototype.uB=function(){var t=this.videoRepresentationsMap.keys().concat(this.audioRepresentationsMap.keys());t.length?this.oB=new RegExp("\\b("+t.join("|")+")\\b"):this.oB=null},c.prototype.initSession=function(t){var i=this;return this.closeHiveSession("Starting a new session"),this.resolveTicketPromise(t).timeout(this.options().pluginTimeout,"The plugin timedout").then(function(n){return e(i,void 0,void 0,function(){var i;return h(this,function(t){switch(t.label){case 0:return this.playerSource=n.manifest,this._Y=new u.HivePlayerExtendedStats(),this.IY=!0,n.tech.getName()!==u.TechName.HiveJS?[3,2]:(i=this.player,[4,Promise.resolve().then(function(){return r(226)})]);case 1:i.getRequestPromise=t.TY().getRequestPromise.bind(this),t.label=2;case 2:return this.NY(),this.DY(),this.ZY(),this.logger().debug(this.loggerId+"Setup complete for version "+this.getPlayerVersion()),[2,n.toHiveSession()]}})})},function(t){throw u.logError("Error resolving ticket promise",i.loggerId,u.Cb.ue,t),i.closeHiveSession(),t})},c.prototype.ZY=function(){this.registerEvent(this.player,"bitrateswitch",this.tK),this.registerEvent(this.player,"segmentrequestfinished",this.iK),this.registerEvent(this.player,"unload",this.unload),this.registerEvent(this.player,"destroy",this.destroy,!0)},c.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0);var n=this.getPotentialSession();n&&n.getTechName()===u.TechName.HiveJS&&(this.player.getRequestPromise=void 0),o.prototype.closeHiveSession.call(this,t,i)},c.prototype.tK=function(t){var i,n=t.data,r=n.mimeType,s=n.streamInfoID,e=s.match(this.oB);if(this.logger().debug("bitrateswitch: "+s+" ("+e+")"),i=e?(this.logger().debug("bitrateswitch: "+s+" ("+e+")"),e[0]):s,0<=r.indexOf("video")){var h=this.videoRepresentationsMap.get(i)||t.data.bandwidth;if(-1<this.nK){var o=this.nK;o<h?this._Y.bitrateSwitchUp():h<o&&this._Y.bitrateSwitchDown()}this.nK=h}else 0<=r.indexOf("audio")&&(h=this.audioRepresentationsMap.get(i)||t.data.bandwidth,this.rK=h)},c.prototype.iK=function(t){this.logger().debug("segmentrequestfinished:",t);var i=t.data,n=i.mimeType,r=i.failed,s=i.bytes,e=0<=n.indexOf("video"),h=""+(e?this.nK:this.rK);r?this._Y.accountFailed(e,h):s&&this._Y.accountCompleted(e,h,s)},c.prototype.unload=function(t){this.isSessionActive()&&(this.logger().debug(this.loggerId+"Player unloading, closing hive session..."),this.closeHiveSession())},c.prototype.destroy=function(t){this.logger().debug(this.loggerId+"Player being destroyed"),this.$g(!0),this.destroyHivePlugin()},c.prototype.getPluginName=function(){return"facebook"},c.prototype.getPlayerVersion=function(){return"vFacebook"},c.prototype.getExtendedStats=function(){var t=this._Y;return this._Y=new u.HivePlayerExtendedStats(),t},c);function c(t,i,n){var r=o.call(this,t,i,n)||this;return r.nK=-1,r.rK=-1,r.uB(),r.destroy=r.destroy.bind(r),r.iK=r.iK.bind(r),r.unload=r.unload.bind(r),r.tK=r.tK.bind(r),r}i.HiveFacebook=f,window.HiveFacebook=f},function(t,i,n){var d,E,w=n(65),p=n(66),g=0,b=0;t.exports=function(t,i,n){var r=i&&n||0,s=i||[],e=(t=t||{}).sK||d,h=void 0!==t.eK?t.eK:E;if(null==e||null==h){var o=w();null==e&&(e=d=[1|o[0],o[1],o[2],o[3],o[4],o[5]]),null==h&&(h=E=16383&(o[6]<<8|o[7]))}var u=void 0!==t.hK?t.hK:new Date().getTime(),a=void 0!==t.oK?t.oK:b+1,f=u-g+(a-b)/1e4;if(f<0&&void 0===t.eK&&(h=h+1&16383),(f<0||g<u)&&void 0===t.oK&&(a=0),1e4<=a)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=u,E=h;var c=(1e4*(268435455&(u+=122192928e5))+(b=a))%4294967296;s[r++]=c>>>24&255,s[r++]=c>>>16&255,s[r++]=c>>>8&255,s[r++]=255&c;var l=u/4294967296*1e4&268435455;s[r++]=l>>>8&255,s[r++]=255&l,s[r++]=l>>>24&15|16,s[r++]=l>>>16&255,s[r++]=h>>>8|128,s[r++]=255&h;for(var v=0;v<6;++v)s[r+v]=e[v];return i||p(s)}},function(t,i,n){var h=n(65),o=n(66);t.exports=function(t,i,n){var r=i&&n||0;"string"==typeof t&&(i="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.uK||h)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,i)for(var e=0;e<16;++e)i[r+e]=s[e];return i||o(s)}},function(t,s,e){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,i){this.aK=t,this.fK=i}s.setTimeout=function(){return new r(n.call(setTimeout,i,arguments),clearTimeout)},s.setInterval=function(){return new r(n.call(setInterval,i,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t&&t.close()},r.prototype.cK=r.prototype.lK=function(){},r.prototype.close=function(){this.fK.call(i,this.aK)},s.vK=function(t,i){clearTimeout(t.dK),t.EK=i},s.wK=function(t){clearTimeout(t.dK),t.EK=-1},s.pK=s.active=function(t){clearTimeout(t.dK);var i=t.EK;0<=i&&(t.dK=setTimeout(function(){t.gK&&t.gK()},i))},e(107),s.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,s.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,e(53))},function(t,i,n){(function(t,d){!function(n,r){"use strict";if(!n.setImmediate){var s,e,i,h,o=1,u={},a=!1,f=n.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(n);t=t&&t.setTimeout?t:n,s="[object process]"==={}.toString.call(n.process)?function(t){d.Fe(function(){l(t)})}:function(){if(n.postMessage&&!n.bK){var t=!0,i=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=i,t}}()?(h="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",v,!1):n.attachEvent("onmessage",v),function(t){n.postMessage(h+t,"*")}):n.MessageChannel?((i=new MessageChannel()).port1.onmessage=function(t){l(t.data)},function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(e=f.documentElement,function(t){var i=f.createElement("script");i.onreadystatechange=function(){l(t),i.onreadystatechange=null,e.removeChild(i),i=null},e.appendChild(i)}):function(t){setTimeout(l,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var i=new Array(arguments.length-1),n=0;n<i.length;n++)i[n]=arguments[n+1];var r={YY:t,yK:i};return u[o]=r,s(o),o++},t.clearImmediate=c}function c(t){delete u[t]}function l(t){if(a)setTimeout(l,0,t);else{var i=u[t];if(i){a=!0;try{!function(t){var i=t.YY,n=t.yK;switch(n.length){case 0:i();break;case 1:i(n[0]);break;case 2:i(n[0],n[1]);break;case 3:i(n[0],n[1],n[2]);break;default:i.apply(r,n)}}(i)}finally{c(t),a=!1}}}}function v(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(h)&&l(+t.data.slice(h.length))}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(53),n(36))},function(t,i){if(!RegExp.escape){var n=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(t){return t.replace(n,"\\$&")}}},function(t,i,n){"use strict";var r=n(38),s=n(54);function e(){throw new Error("Can't construct. MapChanges is a mixin.")}t.exports=e;Object.prototype.hasOwnProperty;var h=new r(),o=null;e.prototype.TK=function(){return h.has(this)||(o=o||n(55),h.set(this,o())),h.get(this)},e.prototype.mK=function(t){var i=this.TK();return t=t||"",i.has(t)||i.set(t,{Zf:new s(),tc:new s()}),i.get(t)},e.prototype.OK=function(t,i,n){!this.ec&&this.sc&&this.sc();var r=this.mK(i);(n?r.Zf:r.tc).push(t),Object.defineProperty(this,"WP",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.SK(t,i,n),s=null)}},e.prototype.SK=function(t,i,n){var r=this.mK(i),s=(n?r.Zf:r.tc).findLast(t);if(!s)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(i));s["delete"]()},e.prototype.XP=function(s,e,h){var t=this.TK(),o="Map"+(h?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=h?t.Zf:t.tc;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+o;try{n.forEach(function(t){if(t[r])t[r](e,s,this);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(t,e,s,this)}},this)}finally{t.isActive=!1}}},this)},e.prototype.RK=function(t,i){return this.OK(t,i,!0)},e.prototype._K=function(t,i){return this.SK(t,i,!0)},e.prototype.$P=function(t,i){return this.XP(t,i,!0)}},function(t,i,n){"use strict";n(10);var r=n(55),s=n(54),e=n(11),h=n(40),c=n(71),o=n(12);Object.prototype.hasOwnProperty;function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);i=i||Object.Ae,n=n||Object.hash,r=r||Function.Ne,this.ke=i,this.Ce=n,this.De=r;var s=this;this.IK=new this.AK(null,function(){return new s.NK()}),this.length=0,this.hiveAddEach(t)}(t.exports=u).kK=u,Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),Object.hiveAddEach(u.prototype,o.prototype),u.prototype.AK=r,u.prototype.NK=s,u.prototype.je=function(t){return new this.constructor(t,this.ke,this.Ce,this.De)},u.prototype.has=function(t){var i=this.Ce(t);return this.IK.get(i).has(t)},u.prototype.get=function(t,i){if(i)throw new Error("FastSet#get does not support second argument: equals");var n=this.Ce(t),r=this.IK;return r.has(n)?r.get(n).get(t):this.De(t)},u.prototype["delete"]=function(t,i){if(i)throw new Error("FastSet#delete does not support second argument: equals");var n=this.Ce(t),r=this.IK;if(r.has(n)){var s=r.get(n);if(s["delete"](t))return this.length--,0===s.length&&r["delete"](n),!0}return!1},u.prototype.clear=function(){this.IK.clear(),this.length=0},u.prototype.hiveAdd=function(t){var i=this.Ce(t),n=this.IK;return n.has(i)||n.set(i,new this.NK(null,this.ke)),!n.get(i).has(t)&&(n.get(i).hiveAdd(t),this.length++,!0)},u.prototype.reduce=function(n,t){var r=arguments[2],i=this.IK,s=0;return i.reduce(function(t,i){return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},t,this)},u.prototype.qf=function(){if(0<this.length)return this.IK.qf().qf()},u.prototype.Qf=function(){return this.IK.values().Ff().Qf()},u.prototype.log=function(o,u,a,f){o=o||c.XU,u=u||this.Pe,a||(a=emptyFunction,f=console),a=a.bind(f);var r=this.IK,s=r.keys();s.forEach(function(t,i){var n,e;e=i===s.length-1?(n=o.YU," "):(n=0===i?o.qU:o.KU,o.WU);var h=r.get(t);a.call(f,n+o.BU+o.qU+" "+t),h.forEach(function(t,i){var n,r,s;r=i===h.head.CP?(n=o.YU," "):(n=o.KU,o.WU),u(i,function(t){s?a.call(f,e+" "+r+"  "+t):(a.call(f,e+" "+n+o.BU+o.BU+t),s=!0)},function(t){a.call(f,e+" "+o.WU+"  "+t)})})})},u.prototype.Pe=function(t,i){var n=t.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(t){i(" "+t)}):i(" "+n)}},function(t,i,n){"use strict";t.exports=u;var o=n(37),r=n(11);function u(t){if(!(this instanceof u))return new u(t);if(Array.isArray(t)||"string"==typeof t)return u.Qf(t);if((t=o(t))instanceof u)return t;if(t.next)this.next=function(){return t.next()};else if(t.Qf){var i=t.Qf();this.next=function(){return i.next()}}else{if("[object Function]"!==o.prototype.toString.call(t))throw new TypeError("Can't iterate "+t);this.next=t}}u.prototype.forEach=r.prototype.forEach,u.prototype.map=r.prototype.map,u.prototype.filter=r.prototype.filter,u.prototype.every=r.prototype.every,u.prototype.some=r.prototype.some,u.prototype.Ih=r.prototype.Ih,u.prototype.all=r.prototype.all,u.prototype.min=r.prototype.min,u.prototype.max=r.prototype.max,u.prototype.sa=r.prototype.sa,u.prototype.Uf=r.prototype.Uf,u.prototype.Ff=r.prototype.Ff,u.prototype.Gf=r.prototype.Gf,u.prototype.enumerate=r.prototype.enumerate,u.prototype.Bf=r.prototype.Bf,u.prototype.group=r.prototype.group,u.prototype.reversed=r.prototype.reversed,u.prototype.toArray=r.prototype.toArray,u.prototype.Lf=r.prototype.Lf,u.prototype.iterator=r.prototype.iterator,u.prototype.xP=null,o.defineProperty(u.prototype,"_iterationObject",{get:function(){return this.xP||(this.xP={done:!1,value:void 0})}}),u.prototype.je=function(t){var i=[];return i.hiveAddEach(t),i},u.prototype.CK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){if(!0!==n.BP.done){var t=i.call(r,n.next().value,s++,n);n.BP.value=t}return n.BP})},u.prototype.DK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){for(var t;;){if(!0===(t=n.next()).done)return t;if(i.call(r,t.value,s++,n))return t}})},u.prototype.reduce=function(t){var i,n=u(this),r=arguments[1],s=arguments[2],e=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError();if(!0===(i=n.next()).done){if(1<arguments.length)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(r=1<arguments.length?t.call(s,r,i.value,e,n):i.value,e++;;){if(!0===(i=n.next()).done)return r;r=t.call(s,r,i.value,e,n),e++}},u.prototype.concat=function(){return u.concat(Array.prototype.concat.apply(this,arguments))},u.prototype.MK=function(t){var i,n,r=u(this),s=arguments[1],e=!1,h=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError();for(;!0!==(n=r.next()).done;){if(!t.call(s,n.value,h,r)){e=!0,i=n.value;break}h++}return e?r.constructor([i]).concat(r):r.constructor([])},u.prototype.jK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){if(!0!==n.BP.done){var t=n.next().value;i.call(r,t,s++,n)?n.BP.value=t:(n.BP.done=!0,n.BP.value=void 0)}return n.BP})},u.prototype.PK=function(){return u.xf(Array.prototype.concat.apply(this,arguments))},u.prototype.LK=function(t){return u.count(t).PK(this)},u.Qf=function(t){var i;return i=0,new u(function(){if("object"==typeof t)for(;!(i in t);){if(i>=t.length){this.BP.done=!0,this.BP.value=void 0;break}i+=1}else i>=t.length&&(this.BP.done=!0,this.BP.value=void 0);return this.BP.done||(this.BP.value=t[i],i+=1),this.BP})},u.HK=function(n,r){var s;return arguments.length<2&&(r=1/0),new u(function(){var t,i;return s&&(i=s()),s&&!0!==i.done||(i=0<r?(r--,t=u.Qf(n),(s=t.next.bind(t))()):(this.BP.done=!0,this.BP)),i})},u.concat=function(n){var r;return n=u(n),new u(function(){var t,i;return r&&(i=r()),i&&!0!==i.done?i:!1===(i=n.next()).done?(t=u(i.value),(r=t.next.bind(t))()):i})},u.xf=function(r){return 0===(r=u(r).map(u)).length?new u([]):new u(function(){var i,n,t=r.map(function(t){return!0===(n=t.next()).done&&(i=!0),n.value});return i?(this.BP.done=!0,this.BP.value=void 0):this.BP.value=t,this.BP})},u.Gf=function(){return u.xf(Array.prototype.slice.call(arguments))},u.chain=function(){return u.concat(Array.prototype.slice.call(arguments))},u.range=function(i,n,r){return arguments.length<3&&(r=1),arguments.length<2&&(n=i,i=0),i=i||0,r=r||1,new u(function(){n<=i&&(this.BP.done=!0,this.BP.value=void 0);var t=i;return i+=r,this.BP.value=t,this.BP})},u.count=function(t,i){return u.range(t,1/0,i)},u.repeat=function(t,i){return new u.range(i).CK(function(){return t})}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.destroy=function(){this.abort(),this.loader=null,this.xhr=null},s.prototype.abort=function(){var t=this.loader||this.xhr;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},s.prototype.load=function(t,i,n){this.context=t,this.config=i,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=i.retryDelay,this.UK()},s.prototype.UK=function(){this.xhr=null;var t=this.context,i=this.stats;i.tfirst=0,i.loaded=0,this.xhrSetup?this.xhr=this.xhrSetup(this.xhr,t):!1,this.xhr.onreadystatechange=this.readystatechange.bind(this),this.xhr.onprogress=this.loadprogress.bind(this),this.config.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout)),this.xhr.send()},s.prototype.readystatechange=function(t){var i=t.currentTarget,n=i.readyState,r=this.stats,s=this.context,e=this.config;if(!r.aborted&&2<=n)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===n){var h=i.status,o=i.getAllResponseHeaders()||"";o=o.replace(/[\r\n]{2,}Access-Control-Allow-Origin:\*/,"\naccess-control-allow-origin: *");var u=i.responseURL||i.url||"",a=i.statusText||(200===h?"OK":""),f=o.trim().split(/[\r\n]+/),c={};if(o&&f.forEach(function(t){var i=t.split(": "),n=i.shift(),r=i.join(": ");c[n]=r}),200<=h&&h<300){r.tload=Math.max(r.tfirst,performance.now());var l=void 0,v=void 0;v="arraybuffer"===s.responseType?(l=i.response).byteLength:(l=i.responseText).length,r.loaded=r.total=v;var d={url:u,code:h,text:a,responseHeaders:o,FK:c,data:l};this.callbacks.onSuccess(d,r,s)}else void 0===e.retryDelay||void 0===e.GK||r.retry>=e.xK||400<=h&&h<499?(!1,d={url:u,code:h,text:a,responseHeaders:o,FK:c,data:"arraybuffer"===s.responseType?i.response:i.responseText},this.callbacks.onError(d,s)):(!1,this.destroy(),this.retryTimeout=window.setTimeout(this.UK.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,e.GK),r.retry++)}else e.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),e.timeout))},s.prototype.loadtimeout=function(){!1,this.callbacks.onTimeout(this.stats,this.context)},s.prototype.loadprogress=function(t){var i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null)},s);function s(t){this.loggerId="[HiveXhrLoader]",(this.BK=t)&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}i.cg=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(26),s=(e.prototype.apply=function(t){t.apply(this.context)},e);function e(t){this.id=t,this.context=new r.B()}i.j=s},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.yb||(i.yb={}))[r.HiveJS=0]="HiveJS",r[r.HiveJava=1]="HiveJava",r[r.StatsJS=2]="StatsJS",r[r.HiveJsProxy=3]="HiveJsProxy";var s=(e.StatsJS="StatsJS",e.HiveJsProxy="HiveJsProxy",e.HiveJava="HiveJava",e.HiveJS="HiveJS",e);function e(){}i.TechName=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Z=function(){return void 0===this.tt&&(this.tt=new s()),this.tt},s.prototype.nt=function(t,i){this.VK.push(t),this.callbacks.push(i)},s.prototype.qK=function(n){for(var t=function(t){var i=!0;r.VK[t].forEach(function(t){null!=n[t]&&n[t]||(i=!1)}),i&&r.callbacks[t]()},r=this,i=0;i<this.VK.length;i++)t(i)},s);function s(){var i=this;if(this.VK=[],this.callbacks=[],s.tt)throw new Error("Error: Instantiation failed: Use KeyHandlerHiveComm.getInstance() instead of new.");var n={};document.addEventListener("keydown",function(t){n[t.keyCode]=!0,i.qK(n)},!0),document.addEventListener("keyup",function(t){n={}},!0)}i.rt=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(Object.defineProperty(s.prototype,"fullscreen",{get:function(){return this.QK},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"totalBuffering",{get:function(){return this.YK},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bufferLength",{get:function(){return this.KK},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"playingPoint",{get:function(){return this.WK},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"Ix",{get:function(){return this.$K},enumerable:!0,configurable:!0}),s.prototype.XK=function(){isNaN(this.playingPoint)&&(this.WK=0),isNaN(this.bufferLength)&&(this.KK=0),isNaN(this.totalBuffering)&&(this.YK=0),isNaN(this.Ix)&&(this.$K=0)},s);function s(t,i,n,r,s,e,h){this.WK=t,this.KK=i,this.YK=n,this._width=r,this._height=s,this.QK=e,this.$K=h,this.XK()}i.vb=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.check=function(t){var i=Date.now();return this.isEqual(this.JK,t)||(this.zK=i),this.JK=t,i-this.zK>=this.ZK},s.prototype.isEqual=function(t,i){return!(!t||!i)&&[i.playingPoint-t.playingPoint,i.bufferLength-t.bufferLength,i.totalBuffering-t.totalBuffering].reduce(function(t,i){return t&&Math.abs(i)<10},!0)},s);function s(t){this.ZK=t}i.kb=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Z=function(t){return t&&(this.logger=t),void 0===this.tt&&(this.tt=new s()),this.tt},s.prototype.tW=function(){var i=this,n=!document[this.hidden];this.gm.forEach(function(t){t.call(i,n)})},s.prototype.gb=function(t){this.gm.push(t)},s.prototype.zg=function(){document.removeEventListener(this.iW,this.tW,!1),this.gm.length=0},s);function s(){if(s.tt)throw new Error("Error: Instantiation failed: Use VisibilityChangeListener.getInstance() instead of new.");void 0!==document.hidden?(this.hidden="hidden",this.iW="visibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.iW="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.iW="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==document[this.hidden]?document.addEventListener(this.iW,this.tW.bind(this),!1):s.logger&&s.logger.debug("warn - visibilityChange listener not supported"),this.gm=[]}i.Zg=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),h=n(1),o=function(){this.success=0,this.failed=0,this.bytes=0};i.nW=o;var s=(e.prototype.accountCompleted=function(t,i,n,r){void 0===r&&(r=!0);var s=t?this.rW:this.sW;s.has(i)||s.set(i,new o());var e=s.get(i);isNaN(n)?h.ErrorMonitor.Z().logError("[ExtendedStats] Toal bytes of a downloaded fragment is NaN"):e.bytes+=n,r&&e.success++},e.prototype.accountFailed=function(t,i){var n=t?this.rW:this.sW;n.has(i)||n.set(i,new o()),n.get(i).failed++},e.prototype.updateBandwidth=function(t){t===1/0||isNaN(t)||(this.bandwidth=t)},e.prototype.bitrateSwitchUp=function(){this.eW++},e.prototype.bitrateSwitchDown=function(){this.hW++},e.prototype.getBandwidth=function(){return this.bandwidth},e.prototype.getVideoBitrates=function(){return this.rW},e.prototype.getAudioBitrates=function(){return this.sW},e.prototype.getBitrateSwitchUp=function(){return this.eW},e.prototype.getBitrateSwitchDown=function(){return this.hW},e);function e(){this.eW=0,this.hW=0,this.rW=new r(),this.sW=new r()}i.HivePlayerExtendedStats=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(43),s=n(27),e=n(13),h=n(1),o=(u.prototype.oW=function(){var t=this;this.plugin.options().silent&&(HiveConfig&&(HiveConfig.ConnInfo.detectPrivateIP=!0),void 0===this.uW&&(this.url="//"+r.Av.FD+":"+this.aW+"/feedback",this.plugin.logger().info("starting periodic alive ping to hive tester ["+this.url+"]"),this.uW=setInterval(function(){t.fW()},s.qc.Kb)))},u.prototype.fW=function(){var i=this,t=this.plugin.getActiveSession(),n=void 0;t&&(n="S["+t.id+"]");var r=this.plugin.getCurrentTime();r>this.cW?(this.plugin.logger().info("sending hive tester ping ["+r+" > "+this.cW+"]"),e.bc(this.url).then(function(t){},function(t){h.ErrorMonitor.Z().logError("error sending hive tester ping",n,{error:t}),clearInterval(i.uW)})):this.plugin.logger().warn("not sending hive tester ping ["+r+" <= "+this.cW+"]"),this.cW=r},u);function u(t){this.aW=s.qc._v?9989:9988,this.cW=-1,this.plugin=t,this.oW()}i.Nb=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.vd=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.Hl=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.Ed=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(26),s=n(44),e=n(41),h=n(125),o=(u.prototype.apply=function(t){t.bind(new r.Db(e.p.v,h.lW,r.Mb.Fb)),t.bind(new r.Db(e.p.T,s.XD))},u);function u(){}i._b=o},function(t,e,h){"use strict";(function(t){Object.defineProperty(e,"s",{value:!0});var i=h(70),n=h(3),r=(s.prototype.init=function(){this.vW=void 0},s.prototype.O=function(){return!1},s.prototype.dW=function(t,i,n){},s.prototype.L=function(){return null},s.prototype.time=function(){return+new Date()},s.prototype.setTimeout=function(t,i,n){var r=this;void 0===n&&(n=!1);var s=this.EW.setTimeout(function(){r.wW["delete"](s),t(),0===r.wW.length&&r.vW&&(r.vW(),r.vW=void 0)},i);return this.wW.set(s,n),s},s.prototype.clearTimeout=function(t){return this.wW["delete"](t),this.EW.clearTimeout(t),!0},s.prototype.setInterval=function(t,i){var n=this.EW.setInterval(function(){t()},i);return this.pW.hiveAdd(n),n},s.prototype.clearInterval=function(t){return this.pW["delete"](t),this.EW.clearInterval(t),!0},s.prototype.F=function(n,t){var r=this;void 0===n&&(n=!1),void 0===t&&(t=void 0),this.wW.forEach(function(t,i){!n&&t||r.clearTimeout(i)}),this.pW.forEach(function(t){return r.clearInterval(t)}),0===this.wW.length&&t?t():this.vW=t},s);function s(){this.wW=new n(),this.pW=new i(),this.EW=void 0!==t?t:window}e.lW=r}).call(this,h(53))},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(26),h=n(44),o=n(41),u=n(17),a=n(22),f=n(76),c=n(77),l=n(78),v=n(79),d=n(80),E=n(7),w=E.W.cf,p=E.W.pf;w?r=n(81).LG:s=n(83).Ox;var g=(b.prototype.apply=function(t){p?(t.bind(new e.Db(o.p.RD,u.kl,e.Mb.Fb)),t.bind(new e.Db(o.p.Zc,c.cG,e.Mb.Fb))):(t.bind(new e.Db(o.p.RD,u.Nl,e.Mb.Fb)),t.bind(new e.Db(o.p.Zc,c.fG,e.Mb.Fb))),t.bind(new e.Db(o.p.Al,l.pG,e.Mb.Fb)),t.bind(new e.Db(o.p.il,v.IG,e.Mb.Fb)),t.bind(new e.Db(o.p.T,h.XD,e.Mb.Fb)),w?t.bind(new e.Db(o.p.Jd,r,e.Mb.Fb)):t.bind(new e.Db(o.p.Jd,s,e.Mb.Fb)),t.bind(new e.Db(o.p.TD,d.kG,e.Mb.Fb)),t.bind(new e.Db(o.p.dl,f.GU,e.Mb.Yb)),t.bind(new e.Db(o.p.El,f.pl,e.Mb.Yb)),t.bind(new e.Db(o.p.wl,a.zd,e.Mb.Yb)),t.bind(new e.Db(o.p.jD,a.pl,e.Mb.Yb))},b);function b(){}i.Ib=g},function(t,i,n){var g=n(23),b=window.hive;void 0===b&&(b=window.hive={}),void 0===b.snapshots&&(b.snapshots={}),b.snapshots.Traffic=function(t){this.reqN=null,this.respFallbackN=null,this.respFallbackErrN=null,this.respP2pN=null,this.reqOtherN=null,this.respFallbackOtherN=null,this.respFallbackOthertErrN=null,this.srcReqN=null,this.srcRespN=null,this.srcRespErrN=null,this.srcReqQt=null,this.srcRespQt=null,this.srcOverQt=null,this.srcOtherReqN=null,this.srcOtherRespN=null,this.srcOtherRespErrN=null,this.srcOtherReqQt=null,this.srcOtherRespQt=null,this.srcOtherOverQt=null,this.p2pSubReqN=null,this.p2pSubRespN=null,this.p2pSubRespPartN=null,this.p2pSubRespErrN=null,this.p2pSubRespExpN=null,this.p2pSubReqQt=null,this.p2pSubRespQt=null,this.p2pDirectQt=null,this.p2pRelayQt=null,this.p2pNatQt=null,this.p2pUdpbQt=null,this.fallAgentRespN=null,this.fallAgentPredHitN=null,this.fallAgentFailedRespN=null,this.fallAgentPredMissN=null,this.fallAgentPredPartialHitN=null,this.fallAgenTrafficSuccessQt=null,this.fallAgenTrafficFailureQt=null,this.p2pAgentPredHitN=null,this.p2pAgentPredMissN=null,this.p2pAgentPredPartialHitN=null,this.p2pAgenTrafficSuccessQt=null,this.p2pAgenTrafficFailureQt=null,this.respP2pOtherN=null,this.lCacheRespN=null,this.lCacheRespQt=null,this.p2pOutSiteLowPrio=null,t&&(void 0!==t.reqN&&null!==t.reqN&&(this.reqN=t.reqN),void 0!==t.respFallbackN&&null!==t.respFallbackN&&(this.respFallbackN=t.respFallbackN),void 0!==t.respFallbackErrN&&null!==t.respFallbackErrN&&(this.respFallbackErrN=t.respFallbackErrN),void 0!==t.respP2pN&&null!==t.respP2pN&&(this.respP2pN=t.respP2pN),void 0!==t.reqOtherN&&null!==t.reqOtherN&&(this.reqOtherN=t.reqOtherN),void 0!==t.respFallbackOtherN&&null!==t.respFallbackOtherN&&(this.respFallbackOtherN=t.respFallbackOtherN),void 0!==t.respFallbackOthertErrN&&null!==t.respFallbackOthertErrN&&(this.respFallbackOthertErrN=t.respFallbackOthertErrN),void 0!==t.srcReqN&&null!==t.srcReqN&&(this.srcReqN=t.srcReqN),void 0!==t.srcRespN&&null!==t.srcRespN&&(this.srcRespN=t.srcRespN),void 0!==t.srcRespErrN&&null!==t.srcRespErrN&&(this.srcRespErrN=t.srcRespErrN),void 0!==t.srcReqQt&&null!==t.srcReqQt&&(this.srcReqQt=t.srcReqQt),void 0!==t.srcRespQt&&null!==t.srcRespQt&&(this.srcRespQt=t.srcRespQt),void 0!==t.srcOverQt&&null!==t.srcOverQt&&(this.srcOverQt=t.srcOverQt),void 0!==t.srcOtherReqN&&null!==t.srcOtherReqN&&(this.srcOtherReqN=t.srcOtherReqN),void 0!==t.srcOtherRespN&&null!==t.srcOtherRespN&&(this.srcOtherRespN=t.srcOtherRespN),void 0!==t.srcOtherRespErrN&&null!==t.srcOtherRespErrN&&(this.srcOtherRespErrN=t.srcOtherRespErrN),void 0!==t.srcOtherReqQt&&null!==t.srcOtherReqQt&&(this.srcOtherReqQt=t.srcOtherReqQt),void 0!==t.srcOtherRespQt&&null!==t.srcOtherRespQt&&(this.srcOtherRespQt=t.srcOtherRespQt),void 0!==t.srcOtherOverQt&&null!==t.srcOtherOverQt&&(this.srcOtherOverQt=t.srcOtherOverQt),void 0!==t.p2pSubReqN&&null!==t.p2pSubReqN&&(this.p2pSubReqN=t.p2pSubReqN),void 0!==t.p2pSubRespN&&null!==t.p2pSubRespN&&(this.p2pSubRespN=t.p2pSubRespN),void 0!==t.p2pSubRespPartN&&null!==t.p2pSubRespPartN&&(this.p2pSubRespPartN=t.p2pSubRespPartN),void 0!==t.p2pSubRespErrN&&null!==t.p2pSubRespErrN&&(this.p2pSubRespErrN=t.p2pSubRespErrN),void 0!==t.p2pSubRespExpN&&null!==t.p2pSubRespExpN&&(this.p2pSubRespExpN=t.p2pSubRespExpN),void 0!==t.p2pSubReqQt&&null!==t.p2pSubReqQt&&(this.p2pSubReqQt=t.p2pSubReqQt),void 0!==t.p2pSubRespQt&&null!==t.p2pSubRespQt&&(this.p2pSubRespQt=t.p2pSubRespQt),void 0!==t.p2pDirectQt&&null!==t.p2pDirectQt&&(this.p2pDirectQt=t.p2pDirectQt),void 0!==t.p2pRelayQt&&null!==t.p2pRelayQt&&(this.p2pRelayQt=t.p2pRelayQt),void 0!==t.p2pNatQt&&null!==t.p2pNatQt&&(this.p2pNatQt=t.p2pNatQt),void 0!==t.p2pUdpbQt&&null!==t.p2pUdpbQt&&(this.p2pUdpbQt=t.p2pUdpbQt),void 0!==t.fallAgentRespN&&null!==t.fallAgentRespN&&(this.fallAgentRespN=t.fallAgentRespN),void 0!==t.fallAgentPredHitN&&null!==t.fallAgentPredHitN&&(this.fallAgentPredHitN=t.fallAgentPredHitN),void 0!==t.fallAgentFailedRespN&&null!==t.fallAgentFailedRespN&&(this.fallAgentFailedRespN=t.fallAgentFailedRespN),void 0!==t.fallAgentPredMissN&&null!==t.fallAgentPredMissN&&(this.fallAgentPredMissN=t.fallAgentPredMissN),void 0!==t.fallAgentPredPartialHitN&&null!==t.fallAgentPredPartialHitN&&(this.fallAgentPredPartialHitN=t.fallAgentPredPartialHitN),void 0!==t.fallAgenTrafficSuccessQt&&null!==t.fallAgenTrafficSuccessQt&&(this.fallAgenTrafficSuccessQt=t.fallAgenTrafficSuccessQt),void 0!==t.fallAgenTrafficFailureQt&&null!==t.fallAgenTrafficFailureQt&&(this.fallAgenTrafficFailureQt=t.fallAgenTrafficFailureQt),void 0!==t.p2pAgentPredHitN&&null!==t.p2pAgentPredHitN&&(this.p2pAgentPredHitN=t.p2pAgentPredHitN),void 0!==t.p2pAgentPredMissN&&null!==t.p2pAgentPredMissN&&(this.p2pAgentPredMissN=t.p2pAgentPredMissN),void 0!==t.p2pAgentPredPartialHitN&&null!==t.p2pAgentPredPartialHitN&&(this.p2pAgentPredPartialHitN=t.p2pAgentPredPartialHitN),void 0!==t.p2pAgenTrafficSuccessQt&&null!==t.p2pAgenTrafficSuccessQt&&(this.p2pAgenTrafficSuccessQt=t.p2pAgenTrafficSuccessQt),void 0!==t.p2pAgenTrafficFailureQt&&null!==t.p2pAgenTrafficFailureQt&&(this.p2pAgenTrafficFailureQt=t.p2pAgenTrafficFailureQt),void 0!==t.respP2pOtherN&&null!==t.respP2pOtherN&&(this.respP2pOtherN=t.respP2pOtherN),void 0!==t.lCacheRespN&&null!==t.lCacheRespN&&(this.lCacheRespN=t.lCacheRespN),void 0!==t.lCacheRespQt&&null!==t.lCacheRespQt&&(this.lCacheRespQt=t.lCacheRespQt),void 0!==t.p2pOutSiteLowPrio&&null!==t.p2pOutSiteLowPrio&&(this.p2pOutSiteLowPrio=t.p2pOutSiteLowPrio))},b.snapshots.Traffic.prototype={},b.snapshots.Traffic.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.reqN=t.LE().value:t.PE(n);break;case 2:n==g.Type.DOUBLE?this.respFallbackN=t.fp().value:t.PE(n);break;case 3:n==g.Type.I32?this.respFallbackErrN=t.LE().value:t.PE(n);break;case 4:n==g.Type.DOUBLE?this.respP2pN=t.fp().value:t.PE(n);break;case 5:n==g.Type.I32?this.reqOtherN=t.LE().value:t.PE(n);break;case 6:n==g.Type.I32?this.respFallbackOtherN=t.LE().value:t.PE(n);break;case 7:n==g.Type.I32?this.respFallbackOthertErrN=t.LE().value:t.PE(n);break;case 8:n==g.Type.I32?this.srcReqN=t.LE().value:t.PE(n);break;case 9:n==g.Type.I32?this.srcRespN=t.LE().value:t.PE(n);break;case 10:n==g.Type.I32?this.srcRespErrN=t.LE().value:t.PE(n);break;case 11:n==g.Type.I64?this.srcReqQt=t.ap().value:t.PE(n);break;case 12:n==g.Type.I64?this.srcRespQt=t.ap().value:t.PE(n);break;case 13:n==g.Type.I64?this.srcOverQt=t.ap().value:t.PE(n);break;case 14:n==g.Type.I32?this.srcOtherReqN=t.LE().value:t.PE(n);break;case 15:n==g.Type.I32?this.srcOtherRespN=t.LE().value:t.PE(n);break;case 16:n==g.Type.I32?this.srcOtherRespErrN=t.LE().value:t.PE(n);break;case 17:n==g.Type.I64?this.srcOtherReqQt=t.ap().value:t.PE(n);break;case 18:n==g.Type.I64?this.srcOtherRespQt=t.ap().value:t.PE(n);break;case 19:n==g.Type.I64?this.srcOtherOverQt=t.ap().value:t.PE(n);break;case 20:n==g.Type.I32?this.p2pSubReqN=t.LE().value:t.PE(n);break;case 21:n==g.Type.I32?this.p2pSubRespN=t.LE().value:t.PE(n);break;case 22:n==g.Type.DOUBLE?this.p2pSubRespPartN=t.fp().value:t.PE(n);break;case 23:n==g.Type.DOUBLE?this.p2pSubRespErrN=t.fp().value:t.PE(n);break;case 24:n==g.Type.I32?this.p2pSubRespExpN=t.LE().value:t.PE(n);break;case 25:n==g.Type.I64?this.p2pSubReqQt=t.ap().value:t.PE(n);break;case 26:n==g.Type.I64?this.p2pSubRespQt=t.ap().value:t.PE(n);break;case 27:n==g.Type.I64?this.p2pDirectQt=t.ap().value:t.PE(n);break;case 28:n==g.Type.I64?this.p2pRelayQt=t.ap().value:t.PE(n);break;case 29:n==g.Type.I64?this.p2pNatQt=t.ap().value:t.PE(n);break;case 30:n==g.Type.I64?this.p2pUdpbQt=t.ap().value:t.PE(n);break;case 31:n==g.Type.I32?this.fallAgentRespN=t.LE().value:t.PE(n);break;case 32:n==g.Type.I32?this.fallAgentPredHitN=t.LE().value:t.PE(n);break;case 33:n==g.Type.I32?this.fallAgentFailedRespN=t.LE().value:t.PE(n);break;case 34:n==g.Type.I32?this.fallAgentPredMissN=t.LE().value:t.PE(n);break;case 35:n==g.Type.I32?this.fallAgentPredPartialHitN=t.LE().value:t.PE(n);break;case 36:n==g.Type.I64?this.fallAgenTrafficSuccessQt=t.ap().value:t.PE(n);break;case 37:n==g.Type.I64?this.fallAgenTrafficFailureQt=t.ap().value:t.PE(n);break;case 38:n==g.Type.I32?this.p2pAgentPredHitN=t.LE().value:t.PE(n);break;case 39:n==g.Type.I32?this.p2pAgentPredMissN=t.LE().value:t.PE(n);break;case 40:n==g.Type.I32?this.p2pAgentPredPartialHitN=t.LE().value:t.PE(n);break;case 41:n==g.Type.I64?this.p2pAgenTrafficSuccessQt=t.ap().value:t.PE(n);break;case 42:n==g.Type.I64?this.p2pAgenTrafficFailureQt=t.ap().value:t.PE(n);break;case 43:n==g.Type.I32?this.respP2pOtherN=t.LE().value:t.PE(n);break;case 44:n==g.Type.I32?this.lCacheRespN=t.LE().value:t.PE(n);break;case 45:n==g.Type.I64?this.lCacheRespQt=t.ap().value:t.PE(n);break;case 46:n==g.Type.I64?this.p2pOutSiteLowPrio=t.ap().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.Traffic.prototype.write=function(t){t.FE("Traffic"),null!==this.reqN&&void 0!==this.reqN&&(t.GE("reqN",g.Type.I32,1),t.VE(this.reqN),t.BE()),null!==this.respFallbackN&&void 0!==this.respFallbackN&&(t.GE("respFallbackN",g.Type.DOUBLE,2),t.Bw(this.respFallbackN),t.BE()),null!==this.respFallbackErrN&&void 0!==this.respFallbackErrN&&(t.GE("respFallbackErrN",g.Type.I32,3),t.VE(this.respFallbackErrN),t.BE()),null!==this.respP2pN&&void 0!==this.respP2pN&&(t.GE("respP2pN",g.Type.DOUBLE,4),t.Bw(this.respP2pN),t.BE()),null!==this.reqOtherN&&void 0!==this.reqOtherN&&(t.GE("reqOtherN",g.Type.I32,5),t.VE(this.reqOtherN),t.BE()),null!==this.respFallbackOtherN&&void 0!==this.respFallbackOtherN&&(t.GE("respFallbackOtherN",g.Type.I32,6),t.VE(this.respFallbackOtherN),t.BE()),null!==this.respFallbackOthertErrN&&void 0!==this.respFallbackOthertErrN&&(t.GE("respFallbackOthertErrN",g.Type.I32,7),t.VE(this.respFallbackOthertErrN),t.BE()),null!==this.srcReqN&&void 0!==this.srcReqN&&(t.GE("srcReqN",g.Type.I32,8),t.VE(this.srcReqN),t.BE()),null!==this.srcRespN&&void 0!==this.srcRespN&&(t.GE("srcRespN",g.Type.I32,9),t.VE(this.srcRespN),t.BE()),null!==this.srcRespErrN&&void 0!==this.srcRespErrN&&(t.GE("srcRespErrN",g.Type.I32,10),t.VE(this.srcRespErrN),t.BE()),null!==this.srcReqQt&&void 0!==this.srcReqQt&&(t.GE("srcReqQt",g.Type.I64,11),t.xw(this.srcReqQt),t.BE()),null!==this.srcRespQt&&void 0!==this.srcRespQt&&(t.GE("srcRespQt",g.Type.I64,12),t.xw(this.srcRespQt),t.BE()),null!==this.srcOverQt&&void 0!==this.srcOverQt&&(t.GE("srcOverQt",g.Type.I64,13),t.xw(this.srcOverQt),t.BE()),null!==this.srcOtherReqN&&void 0!==this.srcOtherReqN&&(t.GE("srcOtherReqN",g.Type.I32,14),t.VE(this.srcOtherReqN),t.BE()),null!==this.srcOtherRespN&&void 0!==this.srcOtherRespN&&(t.GE("srcOtherRespN",g.Type.I32,15),t.VE(this.srcOtherRespN),t.BE()),null!==this.srcOtherRespErrN&&void 0!==this.srcOtherRespErrN&&(t.GE("srcOtherRespErrN",g.Type.I32,16),t.VE(this.srcOtherRespErrN),t.BE()),null!==this.srcOtherReqQt&&void 0!==this.srcOtherReqQt&&(t.GE("srcOtherReqQt",g.Type.I64,17),t.xw(this.srcOtherReqQt),t.BE()),null!==this.srcOtherRespQt&&void 0!==this.srcOtherRespQt&&(t.GE("srcOtherRespQt",g.Type.I64,18),t.xw(this.srcOtherRespQt),t.BE()),null!==this.srcOtherOverQt&&void 0!==this.srcOtherOverQt&&(t.GE("srcOtherOverQt",g.Type.I64,19),t.xw(this.srcOtherOverQt),t.BE()),null!==this.p2pSubReqN&&void 0!==this.p2pSubReqN&&(t.GE("p2pSubReqN",g.Type.I32,20),t.VE(this.p2pSubReqN),t.BE()),null!==this.p2pSubRespN&&void 0!==this.p2pSubRespN&&(t.GE("p2pSubRespN",g.Type.I32,21),t.VE(this.p2pSubRespN),t.BE()),null!==this.p2pSubRespPartN&&void 0!==this.p2pSubRespPartN&&(t.GE("p2pSubRespPartN",g.Type.DOUBLE,22),t.Bw(this.p2pSubRespPartN),t.BE()),null!==this.p2pSubRespErrN&&void 0!==this.p2pSubRespErrN&&(t.GE("p2pSubRespErrN",g.Type.DOUBLE,23),t.Bw(this.p2pSubRespErrN),t.BE()),null!==this.p2pSubRespExpN&&void 0!==this.p2pSubRespExpN&&(t.GE("p2pSubRespExpN",g.Type.I32,24),t.VE(this.p2pSubRespExpN),t.BE()),null!==this.p2pSubReqQt&&void 0!==this.p2pSubReqQt&&(t.GE("p2pSubReqQt",g.Type.I64,25),t.xw(this.p2pSubReqQt),t.BE()),null!==this.p2pSubRespQt&&void 0!==this.p2pSubRespQt&&(t.GE("p2pSubRespQt",g.Type.I64,26),t.xw(this.p2pSubRespQt),t.BE()),null!==this.p2pDirectQt&&void 0!==this.p2pDirectQt&&(t.GE("p2pDirectQt",g.Type.I64,27),t.xw(this.p2pDirectQt),t.BE()),null!==this.p2pRelayQt&&void 0!==this.p2pRelayQt&&(t.GE("p2pRelayQt",g.Type.I64,28),t.xw(this.p2pRelayQt),t.BE()),null!==this.p2pNatQt&&void 0!==this.p2pNatQt&&(t.GE("p2pNatQt",g.Type.I64,29),t.xw(this.p2pNatQt),t.BE()),null!==this.p2pUdpbQt&&void 0!==this.p2pUdpbQt&&(t.GE("p2pUdpbQt",g.Type.I64,30),t.xw(this.p2pUdpbQt),t.BE()),null!==this.fallAgentRespN&&void 0!==this.fallAgentRespN&&(t.GE("fallAgentRespN",g.Type.I32,31),t.VE(this.fallAgentRespN),t.BE()),null!==this.fallAgentPredHitN&&void 0!==this.fallAgentPredHitN&&(t.GE("fallAgentPredHitN",g.Type.I32,32),t.VE(this.fallAgentPredHitN),t.BE()),null!==this.fallAgentFailedRespN&&void 0!==this.fallAgentFailedRespN&&(t.GE("fallAgentFailedRespN",g.Type.I32,33),t.VE(this.fallAgentFailedRespN),t.BE()),null!==this.fallAgentPredMissN&&void 0!==this.fallAgentPredMissN&&(t.GE("fallAgentPredMissN",g.Type.I32,34),t.VE(this.fallAgentPredMissN),t.BE()),null!==this.fallAgentPredPartialHitN&&void 0!==this.fallAgentPredPartialHitN&&(t.GE("fallAgentPredPartialHitN",g.Type.I32,35),t.VE(this.fallAgentPredPartialHitN),t.BE()),null!==this.fallAgenTrafficSuccessQt&&void 0!==this.fallAgenTrafficSuccessQt&&(t.GE("fallAgenTrafficSuccessQt",g.Type.I64,36),t.xw(this.fallAgenTrafficSuccessQt),t.BE()),null!==this.fallAgenTrafficFailureQt&&void 0!==this.fallAgenTrafficFailureQt&&(t.GE("fallAgenTrafficFailureQt",g.Type.I64,37),t.xw(this.fallAgenTrafficFailureQt),t.BE()),null!==this.p2pAgentPredHitN&&void 0!==this.p2pAgentPredHitN&&(t.GE("p2pAgentPredHitN",g.Type.I32,38),t.VE(this.p2pAgentPredHitN),t.BE()),null!==this.p2pAgentPredMissN&&void 0!==this.p2pAgentPredMissN&&(t.GE("p2pAgentPredMissN",g.Type.I32,39),t.VE(this.p2pAgentPredMissN),t.BE()),null!==this.p2pAgentPredPartialHitN&&void 0!==this.p2pAgentPredPartialHitN&&(t.GE("p2pAgentPredPartialHitN",g.Type.I32,40),t.VE(this.p2pAgentPredPartialHitN),t.BE()),null!==this.p2pAgenTrafficSuccessQt&&void 0!==this.p2pAgenTrafficSuccessQt&&(t.GE("p2pAgenTrafficSuccessQt",g.Type.I64,41),t.xw(this.p2pAgenTrafficSuccessQt),t.BE()),null!==this.p2pAgenTrafficFailureQt&&void 0!==this.p2pAgenTrafficFailureQt&&(t.GE("p2pAgenTrafficFailureQt",g.Type.I64,42),t.xw(this.p2pAgenTrafficFailureQt),t.BE()),null!==this.respP2pOtherN&&void 0!==this.respP2pOtherN&&(t.GE("respP2pOtherN",g.Type.I32,43),t.VE(this.respP2pOtherN),t.BE()),null!==this.lCacheRespN&&void 0!==this.lCacheRespN&&(t.GE("lCacheRespN",g.Type.I32,44),t.VE(this.lCacheRespN),t.BE()),null!==this.lCacheRespQt&&void 0!==this.lCacheRespQt&&(t.GE("lCacheRespQt",g.Type.I64,45),t.xw(this.lCacheRespQt),t.BE()),null!==this.p2pOutSiteLowPrio&&void 0!==this.p2pOutSiteLowPrio&&(t.GE("p2pOutSiteLowPrio",g.Type.I64,46),t.xw(this.p2pOutSiteLowPrio),t.BE()),t.qE(),t.QE()},b.snapshots.gW=function(t){this.url=null,this.size=null,this.duration=null,this.bW=null,this.contentType=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.size&&null!==t.size&&(this.size=t.size),void 0!==t.duration&&null!==t.duration&&(this.duration=t.duration),void 0!==t.bW&&null!==t.bW&&(this.bW=t.bW),void 0!==t.contentType&&null!==t.contentType&&(this.contentType=t.contentType))},b.snapshots.gW.prototype={},b.snapshots.gW.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.url=t.jE().value:t.PE(n);break;case 2:n==g.Type.I32?this.size=t.LE().value:t.PE(n);break;case 3:n==g.Type.I32?this.duration=t.LE().value:t.PE(n);break;case 4:n==g.Type.STRING?this.bW=t.jE().value:t.PE(n);break;case 5:n==g.Type.I32?this.contentType=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.gW.prototype.write=function(t){t.FE("FragmentMetadata"),null!==this.url&&void 0!==this.url&&(t.GE("url",g.Type.STRING,1),t.xE(this.url),t.BE()),null!==this.size&&void 0!==this.size&&(t.GE("size",g.Type.I32,2),t.VE(this.size),t.BE()),null!==this.duration&&void 0!==this.duration&&(t.GE("duration",g.Type.I32,3),t.VE(this.duration),t.BE()),null!==this.bW&&void 0!==this.bW&&(t.GE("qualityLevelId",g.Type.STRING,4),t.xE(this.bW),t.BE()),null!==this.contentType&&void 0!==this.contentType&&(t.GE("contentType",g.Type.I32,5),t.VE(this.contentType),t.BE()),t.qE(),t.QE()},b.snapshots.yW=function(t){this.id=null,this.yV=null,this.width=null,this.height=null,this.label=null,t&&(void 0!==t.id&&null!==t.id&&(this.id=t.id),void 0!==t.yV&&null!==t.yV&&(this.yV=t.yV),void 0!==t.width&&null!==t.width&&(this.width=t.width),void 0!==t.height&&null!==t.height&&(this.height=t.height),void 0!==t.label&&null!==t.label&&(this.label=t.label))},b.snapshots.yW.prototype={},b.snapshots.yW.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.id=t.jE().value:t.PE(n);break;case 2:if(n==g.Type.LIST){var s,e;this.yV=[];(e=t.tp()).np,s=e.size;for(var h=0;h<s;++h){var o;o=t.LE().value,this.yV.push(o)}t.rp()}else t.PE(n);break;case 3:n==g.Type.I32?this.width=t.LE().value:t.PE(n);break;case 4:n==g.Type.I32?this.height=t.LE().value:t.PE(n);break;case 5:n==g.Type.STRING?this.label=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.yW.prototype.write=function(t){if(t.FE("QualityLevel"),null!==this.id&&void 0!==this.id&&(t.GE("id",g.Type.STRING,1),t.xE(this.id),t.BE()),null!==this.yV&&void 0!==this.yV){for(var i in t.GE("bitrates",g.Type.LIST,2),t.jw(g.Type.I32,this.yV.length),this.yV)this.yV.hasOwnProperty(i)&&(i=this.yV[i],t.VE(i));t.Pw(),t.BE()}null!==this.width&&void 0!==this.width&&(t.GE("width",g.Type.I32,3),t.VE(this.width),t.BE()),null!==this.height&&void 0!==this.height&&(t.GE("height",g.Type.I32,4),t.VE(this.height),t.BE()),null!==this.label&&void 0!==this.label&&(t.GE("label",g.Type.STRING,5),t.xE(this.label),t.BE()),t.qE(),t.QE()},b.snapshots.Metrics=function(t){this.upBW=null,this.downBW=null,this.memN=null,this.prtInN=null,this.prtOutN=null,this.initVideoBufQt=null,this.videoAvgBufQt=null,this.videoBufQt=null,this.videoBufN=null,this.initAudioBufQt=null,this.audioAvgBufQt=null,this.audioBufQt=null,this.audioBufN=null,this.bitrateUpN=null,this.bitrateDwnN=null,this.delay=null,this.delayEnforcement=null,this.lookupReqEstablished=null,this.lookupReqAccept=null,this.fallbackAvgTp=null,this.srcThroughput=null,this.diskReadTimeout=null,this.diskReadRate=null,this.diskStoreRate=null,this.diskRemoveRate=null,this.diskCacheSize=null,this.clientBufferMs=null,this.lookupTotal=null,this.lookupNotFound=null,this.lookupFailed=null,this.lookupLatency=null,this.trackerFailed=null,this.trackerLatency=null,this.snapshotFailed=null,this.snapshotLatency=null,this.RF=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.memN&&null!==t.memN&&(this.memN=t.memN),void 0!==t.prtInN&&null!==t.prtInN&&(this.prtInN=t.prtInN),void 0!==t.prtOutN&&null!==t.prtOutN&&(this.prtOutN=t.prtOutN),void 0!==t.initVideoBufQt&&null!==t.initVideoBufQt&&(this.initVideoBufQt=t.initVideoBufQt),void 0!==t.videoAvgBufQt&&null!==t.videoAvgBufQt&&(this.videoAvgBufQt=t.videoAvgBufQt),void 0!==t.videoBufQt&&null!==t.videoBufQt&&(this.videoBufQt=t.videoBufQt),void 0!==t.videoBufN&&null!==t.videoBufN&&(this.videoBufN=t.videoBufN),void 0!==t.initAudioBufQt&&null!==t.initAudioBufQt&&(this.initAudioBufQt=t.initAudioBufQt),void 0!==t.audioAvgBufQt&&null!==t.audioAvgBufQt&&(this.audioAvgBufQt=t.audioAvgBufQt),void 0!==t.audioBufQt&&null!==t.audioBufQt&&(this.audioBufQt=t.audioBufQt),void 0!==t.audioBufN&&null!==t.audioBufN&&(this.audioBufN=t.audioBufN),void 0!==t.bitrateUpN&&null!==t.bitrateUpN&&(this.bitrateUpN=t.bitrateUpN),void 0!==t.bitrateDwnN&&null!==t.bitrateDwnN&&(this.bitrateDwnN=t.bitrateDwnN),void 0!==t.delay&&null!==t.delay&&(this.delay=t.delay),void 0!==t.delayEnforcement&&null!==t.delayEnforcement&&(this.delayEnforcement=t.delayEnforcement),void 0!==t.lookupReqEstablished&&null!==t.lookupReqEstablished&&(this.lookupReqEstablished=t.lookupReqEstablished),void 0!==t.lookupReqAccept&&null!==t.lookupReqAccept&&(this.lookupReqAccept=t.lookupReqAccept),void 0!==t.fallbackAvgTp&&null!==t.fallbackAvgTp&&(this.fallbackAvgTp=t.fallbackAvgTp),void 0!==t.srcThroughput&&null!==t.srcThroughput&&(this.srcThroughput=t.srcThroughput),void 0!==t.diskReadTimeout&&null!==t.diskReadTimeout&&(this.diskReadTimeout=t.diskReadTimeout),void 0!==t.diskReadRate&&null!==t.diskReadRate&&(this.diskReadRate=t.diskReadRate),void 0!==t.diskStoreRate&&null!==t.diskStoreRate&&(this.diskStoreRate=t.diskStoreRate),void 0!==t.diskRemoveRate&&null!==t.diskRemoveRate&&(this.diskRemoveRate=t.diskRemoveRate),void 0!==t.diskCacheSize&&null!==t.diskCacheSize&&(this.diskCacheSize=t.diskCacheSize),void 0!==t.clientBufferMs&&null!==t.clientBufferMs&&(this.clientBufferMs=t.clientBufferMs),void 0!==t.lookupTotal&&null!==t.lookupTotal&&(this.lookupTotal=t.lookupTotal),void 0!==t.lookupNotFound&&null!==t.lookupNotFound&&(this.lookupNotFound=t.lookupNotFound),void 0!==t.lookupFailed&&null!==t.lookupFailed&&(this.lookupFailed=t.lookupFailed),void 0!==t.lookupLatency&&null!==t.lookupLatency&&(this.lookupLatency=t.lookupLatency),void 0!==t.trackerFailed&&null!==t.trackerFailed&&(this.trackerFailed=t.trackerFailed),void 0!==t.trackerLatency&&null!==t.trackerLatency&&(this.trackerLatency=t.trackerLatency),void 0!==t.snapshotFailed&&null!==t.snapshotFailed&&(this.snapshotFailed=t.snapshotFailed),void 0!==t.snapshotLatency&&null!==t.snapshotLatency&&(this.snapshotLatency=t.snapshotLatency),void 0!==t.RF&&null!==t.RF&&(this.RF=t.RF))},b.snapshots.Metrics.prototype={},b.snapshots.Metrics.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.upBW=t.LE().value:t.PE(n);break;case 2:n==g.Type.I32?this.downBW=t.LE().value:t.PE(n);break;case 3:n==g.Type.I32?this.memN=t.LE().value:t.PE(n);break;case 4:n==g.Type.I32?this.prtInN=t.LE().value:t.PE(n);break;case 5:n==g.Type.I32?this.prtOutN=t.LE().value:t.PE(n);break;case 6:n==g.Type.I64?this.initVideoBufQt=t.ap().value:t.PE(n);break;case 7:n==g.Type.DOUBLE?this.videoAvgBufQt=t.fp().value:t.PE(n);break;case 8:n==g.Type.I64?this.videoBufQt=t.ap().value:t.PE(n);break;case 9:n==g.Type.I32?this.videoBufN=t.LE().value:t.PE(n);break;case 10:n==g.Type.I32?this.initAudioBufQt=t.LE().value:t.PE(n);break;case 11:n==g.Type.DOUBLE?this.audioAvgBufQt=t.fp().value:t.PE(n);break;case 12:n==g.Type.I64?this.audioBufQt=t.ap().value:t.PE(n);break;case 13:n==g.Type.I32?this.audioBufN=t.LE().value:t.PE(n);break;case 14:n==g.Type.I32?this.bitrateUpN=t.LE().value:t.PE(n);break;case 15:n==g.Type.I32?this.bitrateDwnN=t.LE().value:t.PE(n);break;case 16:n==g.Type.I32?this.delay=t.LE().value:t.PE(n);break;case 17:n==g.Type.I32?this.delayEnforcement=t.LE().value:t.PE(n);break;case 18:n==g.Type.I32?this.lookupReqEstablished=t.LE().value:t.PE(n);break;case 19:n==g.Type.I32?this.lookupReqAccept=t.LE().value:t.PE(n);break;case 20:n==g.Type.DOUBLE?this.fallbackAvgTp=t.fp().value:t.PE(n);break;case 21:n==g.Type.DOUBLE?this.srcThroughput=t.fp().value:t.PE(n);break;case 22:n==g.Type.I32?this.diskReadTimeout=t.LE().value:t.PE(n);break;case 23:n==g.Type.DOUBLE?this.diskReadRate=t.fp().value:t.PE(n);break;case 24:n==g.Type.DOUBLE?this.diskStoreRate=t.fp().value:t.PE(n);break;case 25:n==g.Type.DOUBLE?this.diskRemoveRate=t.fp().value:t.PE(n);break;case 26:n==g.Type.I64?this.diskCacheSize=t.ap().value:t.PE(n);break;case 27:n==g.Type.I32?this.clientBufferMs=t.LE().value:t.PE(n);break;case 28:n==g.Type.I32?this.lookupTotal=t.LE().value:t.PE(n);break;case 29:n==g.Type.I32?this.lookupNotFound=t.LE().value:t.PE(n);break;case 30:n==g.Type.I32?this.lookupFailed=t.LE().value:t.PE(n);break;case 31:n==g.Type.I32?this.lookupLatency=t.LE().value:t.PE(n);break;case 32:n==g.Type.I32?this.trackerFailed=t.LE().value:t.PE(n);break;case 33:n==g.Type.I32?this.trackerLatency=t.LE().value:t.PE(n);break;case 34:n==g.Type.I32?this.snapshotFailed=t.LE().value:t.PE(n);break;case 35:n==g.Type.I32?this.snapshotLatency=t.LE().value:t.PE(n);break;case 36:n==g.Type.I32?this.RF=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.Metrics.prototype.write=function(t){t.FE("Metrics"),null!==this.upBW&&void 0!==this.upBW&&(t.GE("upBW",g.Type.I32,1),t.VE(this.upBW),t.BE()),null!==this.downBW&&void 0!==this.downBW&&(t.GE("downBW",g.Type.I32,2),t.VE(this.downBW),t.BE()),null!==this.memN&&void 0!==this.memN&&(t.GE("memN",g.Type.I32,3),t.VE(this.memN),t.BE()),null!==this.prtInN&&void 0!==this.prtInN&&(t.GE("prtInN",g.Type.I32,4),t.VE(this.prtInN),t.BE()),null!==this.prtOutN&&void 0!==this.prtOutN&&(t.GE("prtOutN",g.Type.I32,5),t.VE(this.prtOutN),t.BE()),null!==this.initVideoBufQt&&void 0!==this.initVideoBufQt&&(t.GE("initVideoBufQt",g.Type.I64,6),t.xw(this.initVideoBufQt),t.BE()),null!==this.videoAvgBufQt&&void 0!==this.videoAvgBufQt&&(t.GE("videoAvgBufQt",g.Type.DOUBLE,7),t.Bw(this.videoAvgBufQt),t.BE()),null!==this.videoBufQt&&void 0!==this.videoBufQt&&(t.GE("videoBufQt",g.Type.I64,8),t.xw(this.videoBufQt),t.BE()),null!==this.videoBufN&&void 0!==this.videoBufN&&(t.GE("videoBufN",g.Type.I32,9),t.VE(this.videoBufN),t.BE()),null!==this.initAudioBufQt&&void 0!==this.initAudioBufQt&&(t.GE("initAudioBufQt",g.Type.I32,10),t.VE(this.initAudioBufQt),t.BE()),null!==this.audioAvgBufQt&&void 0!==this.audioAvgBufQt&&(t.GE("audioAvgBufQt",g.Type.DOUBLE,11),t.Bw(this.audioAvgBufQt),t.BE()),null!==this.audioBufQt&&void 0!==this.audioBufQt&&(t.GE("audioBufQt",g.Type.I64,12),t.xw(this.audioBufQt),t.BE()),null!==this.audioBufN&&void 0!==this.audioBufN&&(t.GE("audioBufN",g.Type.I32,13),t.VE(this.audioBufN),t.BE()),null!==this.bitrateUpN&&void 0!==this.bitrateUpN&&(t.GE("bitrateUpN",g.Type.I32,14),t.VE(this.bitrateUpN),t.BE()),null!==this.bitrateDwnN&&void 0!==this.bitrateDwnN&&(t.GE("bitrateDwnN",g.Type.I32,15),t.VE(this.bitrateDwnN),t.BE()),null!==this.delay&&void 0!==this.delay&&(t.GE("delay",g.Type.I32,16),t.VE(this.delay),t.BE()),null!==this.delayEnforcement&&void 0!==this.delayEnforcement&&(t.GE("delayEnforcement",g.Type.I32,17),t.VE(this.delayEnforcement),t.BE()),null!==this.lookupReqEstablished&&void 0!==this.lookupReqEstablished&&(t.GE("lookupReqEstablished",g.Type.I32,18),t.VE(this.lookupReqEstablished),t.BE()),null!==this.lookupReqAccept&&void 0!==this.lookupReqAccept&&(t.GE("lookupReqAccept",g.Type.I32,19),t.VE(this.lookupReqAccept),t.BE()),null!==this.fallbackAvgTp&&void 0!==this.fallbackAvgTp&&(t.GE("fallbackAvgTp",g.Type.DOUBLE,20),t.Bw(this.fallbackAvgTp),t.BE()),null!==this.srcThroughput&&void 0!==this.srcThroughput&&(t.GE("srcThroughput",g.Type.DOUBLE,21),t.Bw(this.srcThroughput),t.BE()),null!==this.diskReadTimeout&&void 0!==this.diskReadTimeout&&(t.GE("diskReadTimeout",g.Type.I32,22),t.VE(this.diskReadTimeout),t.BE()),null!==this.diskReadRate&&void 0!==this.diskReadRate&&(t.GE("diskReadRate",g.Type.DOUBLE,23),t.Bw(this.diskReadRate),t.BE()),null!==this.diskStoreRate&&void 0!==this.diskStoreRate&&(t.GE("diskStoreRate",g.Type.DOUBLE,24),t.Bw(this.diskStoreRate),t.BE()),null!==this.diskRemoveRate&&void 0!==this.diskRemoveRate&&(t.GE("diskRemoveRate",g.Type.DOUBLE,25),t.Bw(this.diskRemoveRate),t.BE()),null!==this.diskCacheSize&&void 0!==this.diskCacheSize&&(t.GE("diskCacheSize",g.Type.I64,26),t.xw(this.diskCacheSize),t.BE()),null!==this.clientBufferMs&&void 0!==this.clientBufferMs&&(t.GE("clientBufferMs",g.Type.I32,27),t.VE(this.clientBufferMs),t.BE()),null!==this.lookupTotal&&void 0!==this.lookupTotal&&(t.GE("lookupTotal",g.Type.I32,28),t.VE(this.lookupTotal),t.BE()),null!==this.lookupNotFound&&void 0!==this.lookupNotFound&&(t.GE("lookupNotFound",g.Type.I32,29),t.VE(this.lookupNotFound),t.BE()),null!==this.lookupFailed&&void 0!==this.lookupFailed&&(t.GE("lookupFailed",g.Type.I32,30),t.VE(this.lookupFailed),t.BE()),null!==this.lookupLatency&&void 0!==this.lookupLatency&&(t.GE("lookupLatency",g.Type.I32,31),t.VE(this.lookupLatency),t.BE()),null!==this.trackerFailed&&void 0!==this.trackerFailed&&(t.GE("trackerFailed",g.Type.I32,32),t.VE(this.trackerFailed),t.BE()),null!==this.trackerLatency&&void 0!==this.trackerLatency&&(t.GE("trackerLatency",g.Type.I32,33),t.VE(this.trackerLatency),t.BE()),null!==this.snapshotFailed&&void 0!==this.snapshotFailed&&(t.GE("snapshotFailed",g.Type.I32,34),t.VE(this.snapshotFailed),t.BE()),null!==this.snapshotLatency&&void 0!==this.snapshotLatency&&(t.GE("snapshotLatency",g.Type.I32,35),t.VE(this.snapshotLatency),t.BE()),null!==this.RF&&void 0!==this.RF&&(t.GE("sourceLatency",g.Type.I32,36),t.VE(this.RF),t.BE()),t.qE(),t.QE()},b.snapshots.PartnerTraffic=function(t){this.p2pSuccReq=null,this.p2pFailReq=null,this.p2pPartReq=null,this.p2pSuccReceived=null,this.p2pSuccReceivedLow=null,this.p2pFailReceived=null,this.p2pSuccResp=null,this.p2pFailResp=null,this.p2pPartResp=null,this.p2pSuccSent=null,this.p2pSuccSentLow=null,this.p2pFailSent=null,t&&(void 0!==t.p2pSuccReq&&null!==t.p2pSuccReq&&(this.p2pSuccReq=t.p2pSuccReq),void 0!==t.p2pFailReq&&null!==t.p2pFailReq&&(this.p2pFailReq=t.p2pFailReq),void 0!==t.p2pPartReq&&null!==t.p2pPartReq&&(this.p2pPartReq=t.p2pPartReq),void 0!==t.p2pSuccReceived&&null!==t.p2pSuccReceived&&(this.p2pSuccReceived=t.p2pSuccReceived),void 0!==t.p2pSuccReceivedLow&&null!==t.p2pSuccReceivedLow&&(this.p2pSuccReceivedLow=t.p2pSuccReceivedLow),void 0!==t.p2pFailReceived&&null!==t.p2pFailReceived&&(this.p2pFailReceived=t.p2pFailReceived),void 0!==t.p2pSuccResp&&null!==t.p2pSuccResp&&(this.p2pSuccResp=t.p2pSuccResp),void 0!==t.p2pFailResp&&null!==t.p2pFailResp&&(this.p2pFailResp=t.p2pFailResp),void 0!==t.p2pPartResp&&null!==t.p2pPartResp&&(this.p2pPartResp=t.p2pPartResp),void 0!==t.p2pSuccSent&&null!==t.p2pSuccSent&&(this.p2pSuccSent=t.p2pSuccSent),void 0!==t.p2pSuccSentLow&&null!==t.p2pSuccSentLow&&(this.p2pSuccSentLow=t.p2pSuccSentLow),void 0!==t.p2pFailSent&&null!==t.p2pFailSent&&(this.p2pFailSent=t.p2pFailSent))},b.snapshots.PartnerTraffic.prototype={},b.snapshots.PartnerTraffic.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.p2pSuccReq=t.ap().value:t.PE(n);break;case 2:n==g.Type.I64?this.p2pFailReq=t.ap().value:t.PE(n);break;case 3:n==g.Type.I64?this.p2pPartReq=t.ap().value:t.PE(n);break;case 4:n==g.Type.I64?this.p2pSuccReceived=t.ap().value:t.PE(n);break;case 5:n==g.Type.I64?this.p2pSuccReceivedLow=t.ap().value:t.PE(n);break;case 10:n==g.Type.I64?this.p2pFailReceived=t.ap().value:t.PE(n);break;case 6:n==g.Type.I64?this.p2pSuccResp=t.ap().value:t.PE(n);break;case 11:n==g.Type.I64?this.p2pFailResp=t.ap().value:t.PE(n);break;case 7:n==g.Type.I64?this.p2pPartResp=t.ap().value:t.PE(n);break;case 8:n==g.Type.I64?this.p2pSuccSent=t.ap().value:t.PE(n);break;case 9:n==g.Type.I64?this.p2pSuccSentLow=t.ap().value:t.PE(n);break;case 12:n==g.Type.I64?this.p2pFailSent=t.ap().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.PartnerTraffic.prototype.write=function(t){t.FE("PartnerTraffic"),null!==this.p2pSuccReq&&void 0!==this.p2pSuccReq&&(t.GE("p2pSuccReq",g.Type.I64,1),t.xw(this.p2pSuccReq),t.BE()),null!==this.p2pFailReq&&void 0!==this.p2pFailReq&&(t.GE("p2pFailReq",g.Type.I64,2),t.xw(this.p2pFailReq),t.BE()),null!==this.p2pPartReq&&void 0!==this.p2pPartReq&&(t.GE("p2pPartReq",g.Type.I64,3),t.xw(this.p2pPartReq),t.BE()),null!==this.p2pSuccReceived&&void 0!==this.p2pSuccReceived&&(t.GE("p2pSuccReceived",g.Type.I64,4),t.xw(this.p2pSuccReceived),t.BE()),null!==this.p2pSuccReceivedLow&&void 0!==this.p2pSuccReceivedLow&&(t.GE("p2pSuccReceivedLow",g.Type.I64,5),t.xw(this.p2pSuccReceivedLow),t.BE()),null!==this.p2pFailReceived&&void 0!==this.p2pFailReceived&&(t.GE("p2pFailReceived",g.Type.I64,10),t.xw(this.p2pFailReceived),t.BE()),null!==this.p2pSuccResp&&void 0!==this.p2pSuccResp&&(t.GE("p2pSuccResp",g.Type.I64,6),t.xw(this.p2pSuccResp),t.BE()),null!==this.p2pFailResp&&void 0!==this.p2pFailResp&&(t.GE("p2pFailResp",g.Type.I64,11),t.xw(this.p2pFailResp),t.BE()),null!==this.p2pPartResp&&void 0!==this.p2pPartResp&&(t.GE("p2pPartResp",g.Type.I64,7),t.xw(this.p2pPartResp),t.BE()),null!==this.p2pSuccSent&&void 0!==this.p2pSuccSent&&(t.GE("p2pSuccSent",g.Type.I64,8),t.xw(this.p2pSuccSent),t.BE()),null!==this.p2pSuccSentLow&&void 0!==this.p2pSuccSentLow&&(t.GE("p2pSuccSentLow",g.Type.I64,9),t.xw(this.p2pSuccSentLow),t.BE()),null!==this.p2pFailSent&&void 0!==this.p2pFailSent&&(t.GE("p2pFailSent",g.Type.I64,12),t.xw(this.p2pFailSent),t.BE()),t.qE(),t.QE()},b.snapshots.PartnerMetrics=function(t){this.rateReceived=null,this.rateSent=null,this.handshakeDelay=null,t&&(void 0!==t.rateReceived&&null!==t.rateReceived&&(this.rateReceived=t.rateReceived),void 0!==t.rateSent&&null!==t.rateSent&&(this.rateSent=t.rateSent),void 0!==t.handshakeDelay&&null!==t.handshakeDelay&&(this.handshakeDelay=t.handshakeDelay))},b.snapshots.PartnerMetrics.prototype={},b.snapshots.PartnerMetrics.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.DOUBLE?this.rateReceived=t.fp().value:t.PE(n);break;case 2:n==g.Type.DOUBLE?this.rateSent=t.fp().value:t.PE(n);break;case 3:n==g.Type.I64?this.handshakeDelay=t.ap().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.PartnerMetrics.prototype.write=function(t){t.FE("PartnerMetrics"),null!==this.rateReceived&&void 0!==this.rateReceived&&(t.GE("rateReceived",g.Type.DOUBLE,1),t.Bw(this.rateReceived),t.BE()),null!==this.rateSent&&void 0!==this.rateSent&&(t.GE("rateSent",g.Type.DOUBLE,2),t.Bw(this.rateSent),t.BE()),null!==this.handshakeDelay&&void 0!==this.handshakeDelay&&(t.GE("handshakeDelay",g.Type.I64,3),t.xw(this.handshakeDelay),t.BE()),t.qE(),t.QE()},b.snapshots.ConnectivityInfo=function(t){this.upBW=null,this.downBW=null,this.externalAs=null,this.internalAs=null,this.publicIp=null,this.privateIp=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp))},b.snapshots.ConnectivityInfo.prototype={},b.snapshots.ConnectivityInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.upBW=t.LE().value:t.PE(n);break;case 2:n==g.Type.I32?this.downBW=t.LE().value:t.PE(n);break;case 3:n==g.Type.I32?this.externalAs=t.LE().value:t.PE(n);break;case 4:n==g.Type.I32?this.internalAs=t.LE().value:t.PE(n);break;case 5:n==g.Type.STRING?this.publicIp=t.jE().value:t.PE(n);break;case 6:n==g.Type.STRING?this.privateIp=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.ConnectivityInfo.prototype.write=function(t){t.FE("ConnectivityInfo"),null!==this.upBW&&void 0!==this.upBW&&(t.GE("upBW",g.Type.I32,1),t.VE(this.upBW),t.BE()),null!==this.downBW&&void 0!==this.downBW&&(t.GE("downBW",g.Type.I32,2),t.VE(this.downBW),t.BE()),null!==this.externalAs&&void 0!==this.externalAs&&(t.GE("externalAs",g.Type.I32,3),t.VE(this.externalAs),t.BE()),null!==this.internalAs&&void 0!==this.internalAs&&(t.GE("internalAs",g.Type.I32,4),t.VE(this.internalAs),t.BE()),null!==this.publicIp&&void 0!==this.publicIp&&(t.GE("publicIp",g.Type.STRING,5),t.xE(this.publicIp),t.BE()),null!==this.privateIp&&void 0!==this.privateIp&&(t.GE("privateIp",g.Type.STRING,6),t.xE(this.privateIp),t.BE()),t.qE(),t.QE()},b.snapshots.Partner=function(t){this.connInfo=null,this.traffic=null,this.metrics=null,this.inPart=null,this.outPart=null,this.udp=null,t&&(void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.inPart&&null!==t.inPart&&(this.inPart=t.inPart),void 0!==t.outPart&&null!==t.outPart&&(this.outPart=t.outPart),void 0!==t.udp&&null!==t.udp&&(this.udp=t.udp))},b.snapshots.Partner.prototype={},b.snapshots.Partner.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.PE(n);break;case 2:n==g.Type.STRUCT?(this.traffic=new b.snapshots.PartnerTraffic(),this.traffic.read(t)):t.PE(n);break;case 3:n==g.Type.STRUCT?(this.metrics=new b.snapshots.PartnerMetrics(),this.metrics.read(t)):t.PE(n);break;case 4:n==g.Type.BOOL?this.inPart=t.hp().value:t.PE(n);break;case 5:n==g.Type.BOOL?this.outPart=t.hp().value:t.PE(n);break;case 6:n==g.Type.BOOL?this.udp=t.hp().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.Partner.prototype.write=function(t){t.FE("Partner"),null!==this.connInfo&&void 0!==this.connInfo&&(t.GE("connInfo",g.Type.STRUCT,1),this.connInfo.write(t),t.BE()),null!==this.traffic&&void 0!==this.traffic&&(t.GE("traffic",g.Type.STRUCT,2),this.traffic.write(t),t.BE()),null!==this.metrics&&void 0!==this.metrics&&(t.GE("metrics",g.Type.STRUCT,3),this.metrics.write(t),t.BE()),null!==this.inPart&&void 0!==this.inPart&&(t.GE("inPart",g.Type.BOOL,4),t.Uw(this.inPart),t.BE()),null!==this.outPart&&void 0!==this.outPart&&(t.GE("outPart",g.Type.BOOL,5),t.Uw(this.outPart),t.BE()),null!==this.udp&&void 0!==this.udp&&(t.GE("udp",g.Type.BOOL,6),t.Uw(this.udp),t.BE()),t.qE(),t.QE()},b.snapshots.StreamInfo=function(t){this.url=null,this.streamType=null,this.streamProtocol=null,this.duration=null,this.TW=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.streamProtocol&&null!==t.streamProtocol&&(this.streamProtocol=t.streamProtocol),void 0!==t.duration&&null!==t.duration&&(this.duration=t.duration),void 0!==t.TW&&null!==t.TW&&(this.TW=t.TW))},b.snapshots.StreamInfo.prototype={},b.snapshots.StreamInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.url=t.jE().value:t.PE(n);break;case 2:n==g.Type.I32?this.streamType=t.LE().value:t.PE(n);break;case 3:n==g.Type.I32?this.streamProtocol=t.LE().value:t.PE(n);break;case 4:n==g.Type.I32?this.duration=t.LE().value:t.PE(n);break;case 5:if(n==g.Type.LIST){var s,e;this.TW=[];(e=t.tp()).np,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new b.snapshots.yW()).read(t),this.TW.push(o)}t.rp()}else t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.StreamInfo.prototype.write=function(t){if(t.FE("StreamInfo"),null!==this.url&&void 0!==this.url&&(t.GE("url",g.Type.STRING,1),t.xE(this.url),t.BE()),null!==this.streamType&&void 0!==this.streamType&&(t.GE("streamType",g.Type.I32,2),t.VE(this.streamType),t.BE()),null!==this.streamProtocol&&void 0!==this.streamProtocol&&(t.GE("streamProtocol",g.Type.I32,3),t.VE(this.streamProtocol),t.BE()),null!==this.duration&&void 0!==this.duration&&(t.GE("duration",g.Type.I32,4),t.VE(this.duration),t.BE()),null!==this.TW&&void 0!==this.TW){for(var i in t.GE("qualityLevels",g.Type.LIST,5),t.jw(g.Type.STRUCT,this.TW.length),this.TW)this.TW.hasOwnProperty(i)&&(i=this.TW[i]).write(t);t.Pw(),t.BE()}t.qE(),t.QE()},b.snapshots.ClientInfo=function(t){this.clientType=null,this.majorVersion=null,this.minorVersion=null,this.patchVersion=null,t&&(void 0!==t.clientType&&null!==t.clientType&&(this.clientType=t.clientType),void 0!==t.majorVersion&&null!==t.majorVersion&&(this.majorVersion=t.majorVersion),void 0!==t.minorVersion&&null!==t.minorVersion&&(this.minorVersion=t.minorVersion),void 0!==t.patchVersion&&null!==t.patchVersion&&(this.patchVersion=t.patchVersion))},b.snapshots.ClientInfo.prototype={},b.snapshots.ClientInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.clientType=t.LE().value:t.PE(n);break;case 2:n==g.Type.BYTE?this.majorVersion=t.op().value:t.PE(n);break;case 3:n==g.Type.BYTE?this.minorVersion=t.op().value:t.PE(n);break;case 4:n==g.Type.I16?this.patchVersion=t.up().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.ClientInfo.prototype.write=function(t){t.FE("ClientInfo"),null!==this.clientType&&void 0!==this.clientType&&(t.GE("clientType",g.Type.I32,1),t.VE(this.clientType),t.BE()),null!==this.majorVersion&&void 0!==this.majorVersion&&(t.GE("majorVersion",g.Type.BYTE,2),t.Fw(this.majorVersion),t.BE()),null!==this.minorVersion&&void 0!==this.minorVersion&&(t.GE("minorVersion",g.Type.BYTE,3),t.Fw(this.minorVersion),t.BE()),null!==this.patchVersion&&void 0!==this.patchVersion&&(t.GE("patchVersion",g.Type.I16,4),t.Gw(this.patchVersion),t.BE()),t.qE(),t.QE()},b.snapshots.AgentInfo=function(t){this.firstTierBitrates=null,this.secondTierBitrates=null,t&&(void 0!==t.firstTierBitrates&&null!==t.firstTierBitrates&&(this.firstTierBitrates=t.firstTierBitrates),void 0!==t.secondTierBitrates&&null!==t.secondTierBitrates&&(this.secondTierBitrates=t.secondTierBitrates))},b.snapshots.AgentInfo.prototype={},b.snapshots.AgentInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:if(n==g.Type.SET){var s,e;this.firstTierBitrates=[];(e=t.sp()).np,s=e.size;for(var h=0;h<s;++h){var o;o=t.LE().value,this.firstTierBitrates.push(o)}t.ep()}else t.PE(n);break;case 2:if(n==g.Type.SET){var u,a;this.secondTierBitrates=[];(a=t.sp()).np,u=a.size;for(var f=0;f<u;++f){var c;c=t.LE().value,this.secondTierBitrates.push(c)}t.ep()}else t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.AgentInfo.prototype.write=function(t){if(t.FE("AgentInfo"),null!==this.firstTierBitrates&&void 0!==this.firstTierBitrates){for(var i in t.GE("firstTierBitrates",g.Type.SET,1),t.Lw(g.Type.I32,this.firstTierBitrates.length),this.firstTierBitrates)this.firstTierBitrates.hasOwnProperty(i)&&(i=this.firstTierBitrates[i],t.VE(i));t.Hw(),t.BE()}if(null!==this.secondTierBitrates&&void 0!==this.secondTierBitrates){for(var n in t.GE("secondTierBitrates",g.Type.SET,2),t.Lw(g.Type.I32,this.secondTierBitrates.length),this.secondTierBitrates)this.secondTierBitrates.hasOwnProperty(n)&&(n=this.secondTierBitrates[n],t.VE(n));t.Hw(),t.BE()}t.qE(),t.QE()},b.snapshots.TrafficKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,this.bW=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid),void 0!==t.bW&&null!==t.bW&&(this.bW=t.bW))},b.snapshots.TrafficKey.prototype={},b.snapshots.TrafficKey.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.bitrate=t.LE().value:t.PE(n);break;case 2:n==g.Type.I32?this.AS=t.LE().value:t.PE(n);break;case 3:n==g.Type.STRING?this.partnerGuid=t.jE().value:t.PE(n);break;case 4:n==g.Type.STRING?this.bW=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.TrafficKey.prototype.write=function(t){t.FE("TrafficKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.GE("bitrate",g.Type.I32,1),t.VE(this.bitrate),t.BE()),null!==this.AS&&void 0!==this.AS&&(t.GE("AS",g.Type.I32,2),t.VE(this.AS),t.BE()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.GE("partnerGuid",g.Type.STRING,3),t.xE(this.partnerGuid),t.BE()),null!==this.bW&&void 0!==this.bW&&(t.GE("qualityLevelId",g.Type.STRING,4),t.xE(this.bW),t.BE()),t.qE(),t.QE()},b.snapshots.PartnerKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,this.bW=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid),void 0!==t.bW&&null!==t.bW&&(this.bW=t.bW))},b.snapshots.PartnerKey.prototype={},b.snapshots.PartnerKey.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.bitrate=t.LE().value:t.PE(n);break;case 2:n==g.Type.I32?this.AS=t.LE().value:t.PE(n);break;case 3:n==g.Type.STRING?this.partnerGuid=t.jE().value:t.PE(n);break;case 4:n==g.Type.STRING?this.bW=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.PartnerKey.prototype.write=function(t){t.FE("PartnerKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.GE("bitrate",g.Type.I32,1),t.VE(this.bitrate),t.BE()),null!==this.AS&&void 0!==this.AS&&(t.GE("AS",g.Type.I32,2),t.VE(this.AS),t.BE()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.GE("partnerGuid",g.Type.STRING,3),t.xE(this.partnerGuid),t.BE()),null!==this.bW&&void 0!==this.bW&&(t.GE("qualityLevelId",g.Type.STRING,4),t.xE(this.bW),t.BE()),t.qE(),t.QE()},b.snapshots.Player=function(t){this.bufferingN=null,this.bufferingMs=null,this.initBufferingN=null,this.initBufferingMs=null,this.seekBufferingN=null,this.seekBufferingMs=null,this.playerBufferMs=null,this.bF=null,t&&(void 0!==t.bufferingN&&null!==t.bufferingN&&(this.bufferingN=t.bufferingN),void 0!==t.bufferingMs&&null!==t.bufferingMs&&(this.bufferingMs=t.bufferingMs),void 0!==t.initBufferingN&&null!==t.initBufferingN&&(this.initBufferingN=t.initBufferingN),void 0!==t.initBufferingMs&&null!==t.initBufferingMs&&(this.initBufferingMs=t.initBufferingMs),void 0!==t.seekBufferingN&&null!==t.seekBufferingN&&(this.seekBufferingN=t.seekBufferingN),void 0!==t.seekBufferingMs&&null!==t.seekBufferingMs&&(this.seekBufferingMs=t.seekBufferingMs),void 0!==t.playerBufferMs&&null!==t.playerBufferMs&&(this.playerBufferMs=t.playerBufferMs),void 0!==t.bF&&null!==t.bF&&(this.bF=t.bF))},b.snapshots.Player.prototype={},b.snapshots.Player.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I16?this.bufferingN=t.up().value:t.PE(n);break;case 2:n==g.Type.I32?this.bufferingMs=t.LE().value:t.PE(n);break;case 3:n==g.Type.I16?this.initBufferingN=t.up().value:t.PE(n);break;case 4:n==g.Type.I32?this.initBufferingMs=t.LE().value:t.PE(n);break;case 5:n==g.Type.I16?this.seekBufferingN=t.up().value:t.PE(n);break;case 6:n==g.Type.I32?this.seekBufferingMs=t.LE().value:t.PE(n);break;case 36:n==g.Type.I32?this.playerBufferMs=t.LE().value:t.PE(n);break;case 37:n==g.Type.I32?this.bF=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.Player.prototype.write=function(t){t.FE("Player"),null!==this.bufferingN&&void 0!==this.bufferingN&&(t.GE("bufferingN",g.Type.I16,1),t.Gw(this.bufferingN),t.BE()),null!==this.bufferingMs&&void 0!==this.bufferingMs&&(t.GE("bufferingMs",g.Type.I32,2),t.VE(this.bufferingMs),t.BE()),null!==this.initBufferingN&&void 0!==this.initBufferingN&&(t.GE("initBufferingN",g.Type.I16,3),t.Gw(this.initBufferingN),t.BE()),null!==this.initBufferingMs&&void 0!==this.initBufferingMs&&(t.GE("initBufferingMs",g.Type.I32,4),t.VE(this.initBufferingMs),t.BE()),null!==this.seekBufferingN&&void 0!==this.seekBufferingN&&(t.GE("seekBufferingN",g.Type.I16,5),t.Gw(this.seekBufferingN),t.BE()),null!==this.seekBufferingMs&&void 0!==this.seekBufferingMs&&(t.GE("seekBufferingMs",g.Type.I32,6),t.VE(this.seekBufferingMs),t.BE()),null!==this.playerBufferMs&&void 0!==this.playerBufferMs&&(t.GE("playerBufferMs",g.Type.I32,36),t.VE(this.playerBufferMs),t.BE()),null!==this.bF&&void 0!==this.bF&&(t.GE("playingTimeMs",g.Type.I32,37),t.VE(this.bF),t.BE()),t.qE(),t.QE()},b.snapshots.iG=function(t){this.Ob=null,this.count=null,t&&(void 0!==t.Ob&&null!==t.Ob&&(this.Ob=t.Ob),void 0!==t.count&&null!==t.count&&(this.count=t.count))},b.snapshots.iG.prototype={},b.snapshots.iG.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I16?this.Ob=t.up().value:t.PE(n);break;case 2:n==g.Type.I32?this.count=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.iG.prototype.write=function(t){t.FE("ResponseInfo"),null!==this.Ob&&void 0!==this.Ob&&(t.GE("statusCode",g.Type.I16,1),t.Gw(this.Ob),t.BE()),null!==this.count&&void 0!==this.count&&(t.GE("count",g.Type.I32,2),t.VE(this.count),t.BE()),t.qE(),t.QE()},b.snapshots.nG=function(t){this.source=null,t&&void 0!==t.source&&null!==t.source&&(this.source=g.bp(t.source,[b.snapshots.iG]))},b.snapshots.nG.prototype={},b.snapshots.nG.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:if(n==g.Type.LIST){var s,e;this.source=[];(e=t.tp()).np,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new b.snapshots.iG()).read(t),this.source.push(o)}t.rp()}else t.PE(n);break;case 0:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.nG.prototype.write=function(t){if(t.FE("ServiceResponseInfo"),null!==this.source&&void 0!==this.source){for(var i in t.GE("source",g.Type.LIST,1),t.jw(g.Type.STRUCT,this.source.length),this.source)this.source.hasOwnProperty(i)&&(i=this.source[i]).write(t);t.Pw(),t.BE()}t.qE(),t.QE()},b.snapshots.MetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.gF=null,this.testInfo=null,this.mW=null,this.OW=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.gF&&null!==t.gF&&(this.gF=t.gF),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.mW&&null!==t.mW&&(this.mW=t.mW),void 0!==t.OW&&null!==t.OW&&(this.OW=t.OW))},b.snapshots.MetricSnapshot.prototype={},b.snapshots.MetricSnapshot.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.timestamp=t.ap().value:t.PE(n);break;case 2:n==g.Type.STRING?this.guid=t.jE().value:t.PE(n);break;case 3:n==g.Type.STRUCT?(this.eventId=new EventId(),this.eventId.read(t)):t.PE(n);break;case 4:n==g.Type.STRUCT?(this.streamInfo=new b.snapshots.StreamInfo(),this.streamInfo.read(t)):t.PE(n);break;case 5:n==g.Type.STRUCT?(this.metrics=new b.snapshots.Metrics(),this.metrics.read(t)):t.PE(n);break;case 6:if(n==g.Type.MAP){var s,e;this.traffic={};(e=t.Xw()).Jw,e.zw,s=e.size;for(var h=0;h<s;++h){0<h&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var o=null,u=null;(o=new b.snapshots.TrafficKey()).read(t),(u=new b.snapshots.Traffic()).read(t),this.traffic[o]=u}t.Zw()}else t.PE(n);break;case 7:n==g.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo(),this.snapshotInfo.read(t)):t.PE(n);break;case 8:n==g.Type.STRUCT?(this.agentInfo=new b.snapshots.AgentInfo(),this.agentInfo.read(t)):t.PE(n);break;case 9:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.PE(n);break;case 10:if(n==g.Type.MAP){var a,f;this.partners={};(f=t.Xw()).Jw,f.zw,a=f.size;for(var c=0;c<a;++c){0<c&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var l=null,v=null;(l=new b.snapshots.PartnerKey()).read(t),(v=new b.snapshots.Partner()).read(t),this.partners[l]=v}t.Zw()}else t.PE(n);break;case 11:n==g.Type.STRUCT?(this.player=new b.snapshots.Player(),this.player.read(t)):t.PE(n);break;case 12:n==g.Type.STRUCT?(this.client=new b.snapshots.ClientInfo(),this.client.read(t)):t.PE(n);break;case 13:n==g.Type.STRING?this.sessionId=t.jE().value:t.PE(n);break;case 14:n==g.Type.STRUCT?(this.gF=new b.snapshots.nG(),this.gF.read(t)):t.PE(n);break;case 15:n==g.Type.STRUCT?(this.testInfo=new TestInfo(),this.testInfo.read(t)):t.PE(n);break;case 16:n==g.Type.I64?this.mW=t.ap().value:t.PE(n);break;case 17:if(n==g.Type.LIST){var d,E;this.OW=[];(E=t.tp()).np,d=E.size;for(var w=0;w<d;++w){var p=null;(p=new b.snapshots.gW()).read(t),this.OW.push(p)}t.rp()}else t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.MetricSnapshot.prototype.write=function(t){if(t.FE("MetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.GE("timestamp",g.Type.I64,1),t.xw(this.timestamp),t.BE()),null!==this.guid&&void 0!==this.guid&&(t.GE("guid",g.Type.STRING,2),t.xE(this.guid),t.BE()),null!==this.eventId&&void 0!==this.eventId&&(t.GE("eventId",g.Type.STRUCT,3),this.eventId.write(t),t.BE()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.GE("streamInfo",g.Type.STRUCT,4),this.streamInfo.write(t),t.BE()),null!==this.metrics&&void 0!==this.metrics&&(t.GE("metrics",g.Type.STRUCT,5),this.metrics.write(t),t.BE()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.GE("traffic",g.Type.MAP,6),t.Dw(g.Type.STRUCT,g.Type.STRUCT,g.wE(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];n.key.write(t),n.value.write(t)}t.Mw(),t.BE()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.GE("snapshotInfo",g.Type.STRUCT,7),this.snapshotInfo.write(t),t.BE()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.GE("agentInfo",g.Type.STRUCT,8),this.agentInfo.write(t),t.BE()),null!==this.connInfo&&void 0!==this.connInfo&&(t.GE("connInfo",g.Type.STRUCT,9),this.connInfo.write(t),t.BE()),null!==this.partners&&void 0!==this.partners){for(var r in t.GE("partners",g.Type.MAP,10),t.Dw(g.Type.STRUCT,g.Type.STRUCT,g.wE(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];s.key.write(t),s.value.write(t)}t.Mw(),t.BE()}if(null!==this.player&&void 0!==this.player&&(t.GE("player",g.Type.STRUCT,11),this.player.write(t),t.BE()),null!==this.client&&void 0!==this.client&&(t.GE("client",g.Type.STRUCT,12),this.client.write(t),t.BE()),null!==this.sessionId&&void 0!==this.sessionId&&(t.GE("sessionId",g.Type.STRING,13),t.xE(this.sessionId),t.BE()),null!==this.gF&&void 0!==this.gF&&(t.GE("responseInfo",g.Type.STRUCT,14),this.gF.write(t),t.BE()),null!==this.testInfo&&void 0!==this.testInfo&&(t.GE("testInfo",g.Type.STRUCT,15),this.testInfo.write(t),t.BE()),null!==this.mW&&void 0!==this.mW&&(t.GE("clientId",g.Type.I64,16),t.xw(this.mW),t.BE()),null!==this.OW&&void 0!==this.OW){for(var e in t.GE("fragments",g.Type.LIST,17),t.jw(g.Type.STRUCT,this.OW.length),this.OW)this.OW.hasOwnProperty(e)&&(e=this.OW[e]).write(t);t.Pw(),t.BE()}t.qE(),t.QE()},b.snapshots.JsonMetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.gF=null,this.testInfo=null,this.mW=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.gF&&null!==t.gF&&(this.gF=t.gF),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.mW&&null!==t.mW&&(this.mW=t.mW))},b.snapshots.JsonMetricSnapshot.prototype={},b.snapshots.JsonMetricSnapshot.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.timestamp=t.ap().value:t.PE(n);break;case 2:n==g.Type.STRING?this.guid=t.jE().value:t.PE(n);break;case 3:n==g.Type.STRUCT?(this.eventId=new EventId(),this.eventId.read(t)):t.PE(n);break;case 4:n==g.Type.STRUCT?(this.streamInfo=new b.snapshots.StreamInfo(),this.streamInfo.read(t)):t.PE(n);break;case 5:n==g.Type.STRUCT?(this.metrics=new b.snapshots.Metrics(),this.metrics.read(t)):t.PE(n);break;case 6:if(n==g.Type.MAP){var s,e;this.traffic={};(e=t.Xw()).Jw,e.zw,s=e.size;for(var h=0;h<s;++h){0<h&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var o,u=null;o=t.jE().value,(u=new b.snapshots.Traffic()).read(t),this.traffic[o]=u}t.Zw()}else t.PE(n);break;case 7:n==g.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo(),this.snapshotInfo.read(t)):t.PE(n);break;case 8:n==g.Type.STRUCT?(this.agentInfo=new b.snapshots.AgentInfo(),this.agentInfo.read(t)):t.PE(n);break;case 9:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.PE(n);break;case 10:if(n==g.Type.MAP){var a,f;this.partners={};(f=t.Xw()).Jw,f.zw,a=f.size;for(var c=0;c<a;++c){0<c&&t.qw.length>t.WE[t.WE.length-1]+1&&t.qw.pop();var l,v=null;l=t.jE().value,(v=new b.snapshots.Partner()).read(t),this.partners[l]=v}t.Zw()}else t.PE(n);break;case 11:n==g.Type.STRUCT?(this.player=new b.snapshots.Player(),this.player.read(t)):t.PE(n);break;case 12:n==g.Type.STRUCT?(this.client=new b.snapshots.ClientInfo(),this.client.read(t)):t.PE(n);break;case 13:n==g.Type.STRING?this.sessionId=t.jE().value:t.PE(n);break;case 14:n==g.Type.STRUCT?(this.gF=new b.snapshots.nG(),this.gF.read(t)):t.PE(n);break;case 15:n==g.Type.STRUCT?(this.testInfo=new TestInfo(),this.testInfo.read(t)):t.PE(n);break;case 16:n==g.Type.STRING?this.mW=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},b.snapshots.JsonMetricSnapshot.prototype.write=function(t){if(t.FE("JsonMetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.GE("timestamp",g.Type.I64,1),t.xw(this.timestamp),t.BE()),null!==this.guid&&void 0!==this.guid&&(t.GE("guid",g.Type.STRING,2),t.xE(this.guid),t.BE()),null!==this.eventId&&void 0!==this.eventId&&(t.GE("eventId",g.Type.STRUCT,3),this.eventId.write(t),t.BE()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.GE("streamInfo",g.Type.STRUCT,4),this.streamInfo.write(t),t.BE()),null!==this.metrics&&void 0!==this.metrics&&(t.GE("metrics",g.Type.STRUCT,5),this.metrics.write(t),t.BE()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.GE("traffic",g.Type.MAP,6),t.Dw(g.Type.STRING,g.Type.STRUCT,g.wE(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];t.xE(i),n.write(t)}t.Mw(),t.BE()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.GE("snapshotInfo",g.Type.STRUCT,7),this.snapshotInfo.write(t),t.BE()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.GE("agentInfo",g.Type.STRUCT,8),this.agentInfo.write(t),t.BE()),null!==this.connInfo&&void 0!==this.connInfo&&(t.GE("connInfo",g.Type.STRUCT,9),this.connInfo.write(t),t.BE()),null!==this.partners&&void 0!==this.partners){for(var r in t.GE("partners",g.Type.MAP,10),t.Dw(g.Type.STRING,g.Type.STRUCT,g.wE(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];t.xE(r),s.write(t)}t.Mw(),t.BE()}null!==this.player&&void 0!==this.player&&(t.GE("player",g.Type.STRUCT,11),this.player.write(t),t.BE()),null!==this.client&&void 0!==this.client&&(t.GE("client",g.Type.STRUCT,12),this.client.write(t),t.BE()),null!==this.sessionId&&void 0!==this.sessionId&&(t.GE("sessionId",g.Type.STRING,13),t.xE(this.sessionId),t.BE()),null!==this.gF&&void 0!==this.gF&&(t.GE("responseInfo",g.Type.STRUCT,14),this.gF.write(t),t.BE()),null!==this.testInfo&&void 0!==this.testInfo&&(t.GE("testInfo",g.Type.STRUCT,15),this.testInfo.write(t),t.BE()),null!==this.mW&&void 0!==this.mW&&(t.GE("clientId",g.Type.STRING,16),t.xE(this.mW),t.BE()),t.qE(),t.QE()}},function(t,i,n){var u=n(23),r=(window.StreamType={1:"LIVE",LIVE:1,2:"VOD",VOD:2},window.StreamProtocol={1:"DASH",DASH:1,2:"HDS",HDS:2,3:"HLS",HLS:3,4:"SS",SS:4},window.ClientType={1:"JAVA",SW:1,2:"STATS_ONLY",xF:2,3:"JS_DIRECT",FF:3,4:"JS_PROXY",GF:4},window.RW={1:"AUDIO",Tf:1,2:"VIDEO",mf:2},window.EventId=function(t){this.partnerId=null,this.customerId=null,this.contentId=null,this.tags=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.tags&&null!==t.tags&&(this.tags=t.tags))});r.prototype={},r.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.partnerId=t.jE().value:t.PE(n);break;case 2:n==u.Type.STRING?this.customerId=t.jE().value:t.PE(n);break;case 3:n==u.Type.STRING?this.contentId=t.jE().value:t.PE(n);break;case 4:if(n==u.Type.LIST){var s,e;this.tags=[];(e=t.tp()).np,s=e.size;for(var h=0;h<s;++h){var o;o=t.jE().value,this.tags.push(o)}t.rp()}else t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},r.prototype.write=function(t){if(t.FE("EventId"),null!==this.partnerId&&void 0!==this.partnerId&&(t.GE("partnerId",u.Type.STRING,1),t.xE(this.partnerId),t.BE()),null!==this.customerId&&void 0!==this.customerId&&(t.GE("customerId",u.Type.STRING,2),t.xE(this.customerId),t.BE()),null!==this.contentId&&void 0!==this.contentId&&(t.GE("contentId",u.Type.STRING,3),t.xE(this.contentId),t.BE()),null!==this.tags&&void 0!==this.tags){for(var i in t.GE("tags",u.Type.LIST,4),t.jw(u.Type.STRING,this.tags.length),this.tags)this.tags.hasOwnProperty(i)&&(i=this.tags[i],t.xE(i));t.Pw(),t.BE()}t.qE(),t.QE()};var s=window.SnapshotInfo=function(t){this.timestamp=null,this.apiServer=null,this.clientIp=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.apiServer&&null!==t.apiServer&&(this.apiServer=t.apiServer),void 0!==t.clientIp&&null!==t.clientIp&&(this.clientIp=t.clientIp))};s.prototype={},s.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.I64?this.timestamp=t.ap().value:t.PE(n);break;case 2:n==u.Type.STRING?this.apiServer=t.jE().value:t.PE(n);break;case 3:n==u.Type.STRING?this.clientIp=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},s.prototype.write=function(t){t.FE("SnapshotInfo"),null!==this.timestamp&&void 0!==this.timestamp&&(t.GE("timestamp",u.Type.I64,1),t.xw(this.timestamp),t.BE()),null!==this.apiServer&&void 0!==this.apiServer&&(t.GE("apiServer",u.Type.STRING,2),t.xE(this.apiServer),t.BE()),null!==this.clientIp&&void 0!==this.clientIp&&(t.GE("clientIp",u.Type.STRING,3),t.xE(this.clientIp),t.BE()),t.qE(),t.QE()};var e=window.TestInfo=function(t){this.testId=null,t&&void 0!==t.testId&&null!==t.testId&&(this.testId=t.testId)};e.prototype={},e.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.testId=t.jE().value:t.PE(n);break;case 0:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},e.prototype.write=function(t){t.FE("TestInfo"),null!==this.testId&&void 0!==this.testId&&(t.GE("testId",u.Type.STRING,1),t.xE(this.testId),t.BE()),t.qE(),t.QE()};var h=window.InetAddress=function(t){this.address=null,this.port=null,t&&(void 0!==t.address&&null!==t.address&&(this.address=t.address),void 0!==t.port&&null!==t.port&&(this.port=t.port))};h.prototype={},h.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.address=t.cp().value:t.PE(n);break;case 2:n==u.Type.I32?this.port=t.LE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},h.prototype.write=function(t){t.FE("InetAddress"),null!==this.address&&void 0!==this.address&&(t.GE("address",u.Type.STRING,1),t.Vw(this.address),t.BE()),null!==this.port&&void 0!==this.port&&(t.GE("port",u.Type.I32,2),t.VE(this.port),t.BE()),t.qE(),t.QE()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(16),e=n(15),h=(o.prototype._W=function(){return Date.now()>=this.IW},o);function o(t,i){this.msg=t,this.IW=Date.now()+i,this.AW=r.defer()}var u=(a.prototype.fh=function(t){var i=t.service+"_"+t.msgId,n=this.TQ[i];null!=n?n(t):s.logger().error(s.loggerId+"Could not find a dispatcher for ",t,i,this.TQ)},a.prototype.on=function(t,i,n){this.TQ[t+"_"+i]=n},a.prototype.onerror=function(t){this.NW.push(t)},a.prototype.onconnect=function(t){this.kW.push(t)},a.prototype.DW=function(){var n=this;if(window.WebSocket){var t=new WebSocket(this.MW);return t.binaryType="arraybuffer",t.onopen=function(t){n.jW(),s.logger().debug(s.loggerId+"HiveServicesConnection established to "+n.MW),n.PW=new n.LW().getTime(),n.HW(),n.kW.forEach(function(t){return t(n)}),n.UW(),n.FW()},t.onclose=function(t){n.close(n.GW),n.connect()},t.onmessage=function(t){n.fh(s.Yc.Qc(t.data))},t.onerror=function(i){n.close(!0),n.NW.forEach(function(t){return t(i.toString())})},t}this.NW.forEach(function(t){return t("WebSocket not defined")})},a.prototype.isOpen=function(){return null!=this.Ny&&this.Ny.readyState==this.Ny.OPEN},a.prototype.connect=function(t){var i=this;t&&(this.GW=!0),this.GW&&1!=this.isOpen()&&(0<this.xW||(-1<this.PW&&new this.LW().getTime()-this.PW>this.BW?(this.VW=e.qc.Vc,this.PW=-1):this.VW=Math.min(2*this.VW,this.BW),this.xW=window.setTimeout(function(){i.xW=-1,s.logger().debug(s.loggerId+"Connection attempt to "+i.MW+" [t:"+i.VW+" hb:"+i.qW+"]"),i.Ny=i.DW(),i.VW=Math.max(i.VW,e.qc.Vc)},this.VW)))},a.prototype.jW=function(){-1<this.xW&&(clearTimeout(this.xW),this.xW=-1)},a.prototype.close=function(t){this.GW=null!=t&&t,s.logger().debug(s.loggerId+"Closing connection [reconnect:"+this.GW+"]"),this.jW(),null!=this.Ny&&(this.Ny.close(),this.Ny=null)},a.prototype.HW=function(){for(;0<this.QW.length;){var i=this.QW.pop();try{i._W()?i.AW.reject(new Error("Message expired")):(this.UW(),this.Ny.send(i.msg.oa()))}catch(t){if(t.code===DOMException.INVALID_STATE_ERR){this.QW.push(i);break}s.logger().error(s.loggerId+"Failed to send the message, dropped: ",t.code,t.name),i.AW.reject(t)}}this.FW()},a.prototype.UW=function(){this.YW&&(clearTimeout(this.YW),this.YW=null)},a.prototype.FW=function(){var t=this;this.qW&&!this.YW&&(this.YW=window.setInterval(function(){t.send(new s.Yc(HiveStreamingServices.KW,0,""))},this.WW))},a.prototype.send=function(t,i){if(void 0===i&&(i=this.$W),this.QW.length>=this.XW)throw new Error("HiveServices connection cannot queue more messages");var n=new h(t,i);return this.QW.push(n),this.Ny&&this.HW(),n.AW.promise},a.prototype.JW=function(t){this.qW=t,this.qW&&this.FW()},a.prototype.isConnected=function(){return null!=this.Ny},a);function a(t,i,n,r,s,e,h){void 0===i&&(i=3e4),void 0===n&&(n=100),void 0===r&&(r=3e4),void 0===s&&(s=15e3),void 0===e&&(e=Date),void 0===h&&(h=!1),this.VW=1,this.xW=-1,this.PW=-1,this.TQ={},this.NW=[],this.kW=[],this.qW=!1,this.GW=!0,this.MW=t,this.QW=Array(),this.BW=i,this.XW=n,this.$W=r,this.WW=s,this.LW=e,this.qW=h||/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge./i.test(navigator.userAgent)}i.aG=u},function(t,i){window.HiveStreamingServices={1:"REMOTE_EXECUTOR",zW:1,2:"PEER_FORWARDER",ZW:2,3:"PEER_INDEX",t$:3,4:"PEER_BROADCAST",i$:4,5:"PEER_FILTER",n$:5,6:"PEER_LOGGING",r$:6,7:"HIVEJS_TRACKER",s$:7,8:"PEER_SYSTEM",e$:8,9:"HIVEJS_SNAPSHOTS",eE:9,10:"HIVEJS_TICKETS",uG:10,11:"HIVEJS_KEEPALIVE",KW:11,12:"HIVEJS_FORWARDING",h$:12,13:"INTERNAL_TICKET",o$:13,14:"LOCALITY_SERVICE",u$:14}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.Ol=function(){return this.p2pId},s.prototype.Sl=function(){return this.reportingId?this.reportingId:this.p2pId},s);function s(t,i){this.p2pId=t,this.reportingId=i}i.mG=r},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(82),o=(e=h.YG,s(u,e),u.prototype.getCidr=function(){return this.QG?this.QG:null},u);function u(){return null!==e&&e.apply(this,arguments)||this}i.DG=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(58),o=n(4),r=n(0),u=n(15),s=(e.prototype.gG=function(){var i=o.defer(),n=this.indexedDB.open("PrivateIPDB");return n.onupgradeneeded=function(){n.result.createObjectStore("PrivateIPStore",{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},e.prototype.lx=function(){var r=this;if(this.a$)return this.a$;var s=setTimeout(function(){r.logger.warn("Private list retrieval timeout"),e.reject({message:"Private list timeout"})},4e3),e=o.defer();return u.qc.wf&&this.indexedDB?this.gG().then(function(i){var n=i.transaction("PrivateIPStore","readwrite").objectStore("PrivateIPStore").get("iplist");n.onsuccess=function(){clearTimeout(s);var t=[];h.lH(n.result)||h.lH(n.result.value)||(t=n.result.value.split("|")),e.resolve(t),i.close()},n.onerror=function(t){clearTimeout(s),r.logger.warn("I got an error on indexed db "+t.message),e.reject({message:"Error on indexedDB "+t.message})}}).fail(function(t){clearTimeout(s),r.logger.warn("DB is not open with error"+t.message),e.reject({message:"DB is not open with error "+t.message})}):(clearTimeout(s),e.reject({message:"DB is not ready or enabled"})),this.a$=e.promise,this.a$},e.prototype.Tx=function(n){var r=this;if(u.qc.wf&&this.indexedDB){var s=n.join("|");this.gG().then(function(t){var i=t.transaction("PrivateIPStore","readwrite");i.objectStore("PrivateIPStore").put({id:"iplist",value:s}),i.oncomplete=function(){r.logger.debug("Storing site matched ips ["+n.join(",")+"]"),t.close()}}).fail(function(t){r.logger.warn("DB is not open with error "+t.message)})}},e);function e(){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.logger=r.Framework.resolve(r.Framework.p.T).log()}i.mx=s},function(t,i){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.Zk&&"function"==typeof t.fill&&"function"==typeof t.LN}},function(t,i){"function"==typeof Object.create?t.exports=function(t,i){t.f$=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,i){t.f$=i;function n(){}n.prototype=i.prototype,t.prototype=new n(),t.prototype.constructor=t}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(19),o=(e=h.HiveTechOptions,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.Lx=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.OF=function(){var t=new hive.snapshots.StreamInfo();return t.streamType=this.isLive?StreamType.LIVE:StreamType.VOD,t.streamProtocol=this.protocol,t.url=this.Gx,t},s);function s(t,i,n){this.isLive=t,this.protocol=i,this.Gx=n}i.Cx=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var l=n(1),e=n(139),r=n(3),h=n(140),v=n(59),s=n(0),d=n(6),a=n(48),E=n(2),o=(u.prototype.parse=function(i,n){try{var t=new e.c$();if(t.push(n),t.manifest.playlists)this.l$(i,t.manifest);else{var r=this.v$(i,t.manifest);if(r&&r.d$&&(this.live=!r.d$.E$),this.live){var s=this.w$(t.manifest,n);return this.logger.debug("HLS manifest trimmed "+s.p$+" segments ("+s.p$+"s) - new segments:["+r.g$.map(function(t){return t.id+":"+t.duration})+"]"),s.b$}}return n}catch(t){return l.ErrorMonitor.Z().logError("Error parsing metadata",this.loggerId,E.cr.qn,{detailedError:t,url:i}),n}},u.prototype.wB=function(t,i){return this.y$.has(i)?this.y$.get(i).rB.get(t):null},u.prototype.Ux=function(){return this.T$.values().map(function(t){return t.bitrate})},u.prototype.isLive=function(){return this.live},u.prototype.EB=function(t){return null==this.iB?null:this.iB.get(t)},u.prototype.bB=function(i){try{var t=this.iB.get(i);if(t){var n=t.bitrate;return this.y$.get(n).rB.get(t.id+1)}return null}catch(t){return l.ErrorMonitor.Z().logError("Error getting the next segment info",this.loggerId,E.cr.Kn,{detailedError:t,url:i}),null}},u.prototype.m$=function(t){return this.T$.has(t)},u.prototype.jB=function(){return this.O$},u.prototype.l$=function(s,t){var e=this;this.O$=s,this.S$=t,this.T$=new r(),this.iB=new r(),this.y$=new r(),this.S$.playlists.forEach(function(t){var i=d.qa(s,t.uri),n=t.attributes.BANDWIDTH,r=new h.R$(n,t.uri,i);e.T$.set(i,r),e.y$.set(n,r)})},u.prototype.v$=function(e,t){var h=this;try{var o=this.T$.get(e);if(!o)return void l.ErrorMonitor.Z().logError("Playlist url does not match any playlist in the master file",this.loggerId,E.cr.lr,{url:e});var u=null!=t.mediaSequence?t.mediaSequence:0,a=[],i=u-1,f=o.rB.get(i),c=[];return t._$.forEach(function(t){var i=d.qa(e,t.uri),n=Math.round(1e3*t.duration),r=o.bitrate;Number.isInteger(r)||(l.ErrorMonitor.Z().logError("Segment Bitrate is a Float",{bitrate:r}),r=Math.round(r));var s=new v.mH(u,r,n,t.uri,i);h.iB.has(i)||c.push(s),h.iB.set(i,s),o.rB.set(u,s),a.push(s),f&&(f.next=s),f=s,u++}),o.update(t.mediaSequence,t.discontinuitySequence,t.E$,t.I$,a),{d$:o,g$:c}}catch(t){return l.ErrorMonitor.Z().logError("Error updating the playlist",this.loggerId,E.cr.dr,t),null}},u.prototype.w$=function(t,i){try{for(var n=i.split("\n"),r=Math.max(1,a.HLS.AM),s=null,e=0,h=0,o=t._$.length-1;r-1<o&&(s=t._$[o],!(e>=a.HLS.IM));o--)h++,e+=s.duration;var u="";if(s){for(o=0;o<n.length&&(u=u+n[o]+"\n",n[o].trim()!==s.uri);o++);this.logger.debug("HLS trimmed "+h+" segments for total duration: "+e)}else u=n.join("\n")+"\n",this.logger.debug("HLS trimming disabled (minFragments = "+r+", segments.length = "+t._$.length+")");return{b$:u,p$:h,A$:e}}catch(t){throw l.ErrorMonitor.Z().logError("Error trimming the playlist",this.loggerId,E.cr.Er,t),new Error(t)}},u);function u(){this.loggerId="[HLS METADATA] ",this.T$=new r(),this.logger=(s.Framework.resolve(s.Framework.p.T)||console).log()}i.bM=o},function(t,i,n){var r=function(){var e={sR:{}};e.sR.create=Object.create||function(t){function i(){}return i.prototype=t,new i()},e.sR.N$=function(t,i,n){for(var r in t)hasOwnProp.call(t,r)&&i.call(n||this,r,t[r])},e.sR.iO=function(t,i){if(!i)return t;for(var n in i)hasOwnProp.call(i,n)&&(t[n]=i[n]);return t},e.sR.k$=function(t,i){var n,r,s;for(n in t=e.sR.Zk(t),i)hasOwnProp.call(i,n)&&(r=t[n],s=i[n],e.sR.C$(r)&&e.sR.C$(s)?t[n]=e.sR.k$(r,s):t[n]=i[n]);return t},e.sR.Zk=function(t){return e.sR.iO({},t)},e.sR.C$=function(t){return!!t&&"object"==typeof t&&"[object Object]"===t.toString()&&t.constructor===Object},e.sR.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.mergeOptions=function(t,i){var n,r,s;for(n in t=e.sR.Zk(t),i)i.hasOwnProperty(n)&&(r=t[n],s=i[n],e.sR.C$(r)&&e.sR.C$(s)?t[n]=e.util.mergeOptions(r,s):t[n]=i[n]);return t},(t=function(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},this.off=function(t,i){var n;return!!e[t]&&(n=e[t].indexOf(i),e[t].splice(n,1),-1<n)},this.trigger=function(t){var i,n,r,s;if(i=e[t])for(s=Array.prototype.slice.call(arguments,1),r=i.length,n=0;n<r;++n)i[n].apply(this,s)},this.M$=function(){e={}}}}).prototype.D$=function(i){this.on("data",function(t){i.push(t)})},e.j$=t;function h(t){for(var i,n=t.split(a),r=n.length,s={};r--;)""!==n[r]&&((i=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),s[i[0]]=i[1]);return s}var i,o,u,a=new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'),t=e.j$;return(i=function(){var n="";i.prototype.init.call(this),this.push=function(t){var i;for(i=(n+=t).indexOf("\n");-1<i;i=n.indexOf("\n"))this.trigger("data",n.substring(0,i)),n=n.substring(i+1)}}).prototype=new t(),(o=function(){o.prototype.init.call(this)}).prototype=new t(),o.prototype.push=function(t){var i,n;if(0!==(t=t.replace(/^\s+|\s+$/g,"")).length)if("#"===t[0])if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),i=/^#EXTM3U/.exec(t))this.trigger("data",{type:"tag",P$:"m3u"});else{if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return n={type:"tag",P$:"inf"},i[1]&&(n.duration=parseFloat(i[1])),i[2]&&(n.title=i[2]),void this.trigger("data",n);if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",P$:"targetduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",P$:"totalduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return n={type:"tag",P$:"version"},i[1]&&(n.version=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",P$:"media-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",P$:"discontinuity-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return n={type:"tag",P$:"playlist-type"},i[1]&&(n.L$=i[1]),void this.trigger("data",n);if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return n={type:"tag",P$:"byterange"},i[1]&&(n.length=parseInt(i[1],10)),i[2]&&(n.offset=parseInt(i[2],10)),void this.trigger("data",n);if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return n={type:"tag",P$:"allow-cache"},i[1]&&(n.qj=!/NO/.test(i[1])),void this.trigger("data",n);if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t))return n={type:"tag",P$:"stream-inf"},i[1]&&(n.attributes=h(i[1]),n.attributes.H$&&(r=n.attributes.H$.split("x"),s={},r[0]&&(s.width=parseInt(r[0],10)),r[1]&&(s.height=parseInt(r[1],10)),n.attributes.H$=s),n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes.U$&&(n.attributes.U$=parseInt(n.attributes.U$,10))),void this.trigger("data",n);var r,s;if(i=/^#EXT-X-ENDLIST/.exec(t))this.trigger("data",{type:"tag",P$:"endlist"});else if(i=/^#EXT-X-DISCONTINUITY/.exec(t))this.trigger("data",{type:"tag",P$:"discontinuity"});else{if(i=/^#EXT-X-KEY:?(.*)$/.exec(t))return n={type:"tag",P$:"key"},i[1]&&(n.attributes=h(i[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2)&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void this.trigger("data",n);this.trigger("data",{type:"tag",data:t.slice(4,t.length)})}}else this.trigger("data",{type:"comment",text:t.slice(1)});else this.trigger("data",{type:"uri",uri:t})},(u=function(){var t,n=this,r=[],s={};u.prototype.init.call(this),this.F$=new i(),this.G$=new o(),this.F$.D$(this.G$),this.manifest={x$:!0},this.G$.on("data",function(i){({tag:function(){({"allow-cache":function(){this.manifest.x$=i.qj,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.x$=!0)},byterange:function(){var t={};"length"in i&&((s.byterange=t).length=i.length,"offset"in i||(this.trigger("info",{message:"defaulting offset to zero"}),i.offset=0)),"offset"in i&&((s.byterange=t).offset=i.offset)},endlist:function(){this.manifest.E$=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<=i.duration&&(s.duration=i.duration),this.manifest._$=r},key:function(){i.attributes?"NONE"!==i.attributes.B$?i.attributes.oy?(i.attributes.B$||this.trigger("warn",{message:"defaulting key method to AES-128"}),t={method:i.attributes.B$||"AES-128",uri:i.attributes.oy},void 0!==i.attributes.IV&&(t.iv=i.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):t=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(i.number)?this.manifest.mediaSequence=i.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number})},"discontinuity-sequence":function(){isFinite(i.number)?this.manifest.discontinuitySequence=i.number:this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number})},"playlist-type":function(){/VOD|EVENT/.test(i.L$)?this.manifest.L$=i.L$:this.trigger("warn",{message:"ignoring unknown playlist type: "+i.d$})},"stream-inf":function(){this.manifest.playlists=r,i.attributes?(s.attributes||(s.attributes={}),s.attributes=e.mergeOptions(s.attributes,i.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){s.discontinuity=!0},targetduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration}):this.manifest.I$=i.duration},totalduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+i.duration}):this.manifest.V$=i.duration}}[i.P$]||function(){}).call(n)},uri:function(){s.uri=i.uri,r.push(s),!this.manifest.I$||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.I$),t&&(s.key=t),s={}},q$:function(){}})[i.type].call(n)})}).prototype=new t(),u.prototype.push=function(t){this.F$.push(t)},u.prototype.end=function(){this.F$.push("\n")},e.Q$=i,e.Y$=o,e.c$=u,e}();t.exports=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=(e.prototype.update=function(t,i,n,r,s){this.mediaSequence=t,this.discontinuitySequence=i,this.E$=n,this.I$=r,this._$=s,this.updated=!0},e);function e(t,i,n){this.rB=new r(),this.bitrate=t,this.uri=i,this.TH=n}i.R$=s},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,u=n(85),a=n(59),h=n(32),f=n(4),o=(e=u.HB,s(c,e),c.prototype.xx=function(t,i){this.manifest=this.PB.parse(i,this.Hx(t))},c.prototype.iU=function(i){var n=this,r=f.defer(),o=this.EB(i.Kp());if(!o||o.next)return r.resolve(!1),r.promise;var s=f.defer();if(this.fB)h.DASH.iN?this.fB.K$().then(function(t){t?n.fB.decrypt(i.hg).then(function(t){s.resolve(n.TB(t))}).fail(function(t){return s.reject(!0)}):s.reject(!1)}):s.reject(!1);else try{var t=this.TB(i.hg);s.resolve(t)}catch(t){this.logger.warn("error extracting duration",t),s.reject(!0)}return s.promise.then(function(e){if(!isNaN(e)){var h=o.id+e;n.logger.debug("found next fragment: "+o.id+" -> "+h+" duration: "+e),n.Fx.forEach(function(t){if(t.type===o.type){var i=t.Kx.replace(u.HB.aB,o.id+""),n=t.Kx.replace(u.HB.aB,h+""),r=t.iB.get(i);if(!t.iB.has(n)&&r){r.duration=e;var s=new a.mH(h,t.bandwidth,e,n,n);s.type=r.type,r.next=s,t.iB.set(n,s),t.rB.set(h,s)}}})}r.resolve(!1)}).fail(function(t){n.logger.debug("could not extract duration from "+i.Kp()+" [reevaluate: "+t+"]"),r.resolve(t)}),r.promise},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.$A=o},function(t,i,n){"use strict";t.exports=u;n(10);var r=n(11),s=n(40),e=n(12),h=n(39),o=n(71);function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);this.ke=i||Object.Ae,this.Hf=n||Object.compare,this.De=r||Function.Ne,this.root=null,this.length=0,this.hiveAddEach(t)}function a(t){this.value=t,this.left=null,this.right=null,this.length=1}function f(t,i,n){if(this.set=t,this.CP=null,this.end=n,i){var r=this.set.W$(i);r&&(this.set.$$(r.value),this.CP=r.X$())}}u.J$=u,Object.hiveAddEach(u.prototype,r.prototype),Object.hiveAddEach(u.prototype,s.prototype),Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),u.prototype.hU=!0,u.prototype.je=function(t){return new this.constructor(t,this.ke,this.Hf,this.De)},u.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.$$(t),this.ke(t,this.root.value))},u.prototype.get=function(t,i){if(i)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.$$(t),this.ke(t,this.root.value))?this.root.value:this.De(t)},u.prototype.hiveAdd=function(t){var i=new this.Node(t);if(!this.root)return this.BC&&this.KC([t],[],0),this.root=i,this.length++,this.BC&&this.qC([t],[],0),!0;if(this.$$(t),this.ke(t,this.root.value))return!1;var n=this.Hf(t,this.root.value);if(0===n)throw new Error("SortedSet cannot contain incomparable but inequal values: "+t+" and "+this.root.value);return this.BC&&this.KC([t],[],this.root.index),n<0?(i.right=this.root,i.left=this.root.left,this.root.left=null):(i.left=this.root,i.right=this.root.right,this.root.right=null),this.root.z$(),i.z$(),this.root=i,this.length++,this.BC&&this.qC([t],[],this.root.index),!0},u.prototype["delete"]=function(t,i){if(i)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.$$(t),this.ke(t,this.root.value))){var n=this.root.index;if(this.BC&&this.KC([],[t],n),this.root.left){var r=this.root.right;this.root=this.root.left,this.$$(t),this.root.right=r}else this.root=this.root.right;return this.length--,this.root&&this.root.z$(),this.BC&&this.qC([],[t],n),!0}return!1},u.prototype.indexOf=function(t,i){if(i)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.$$(t),this.ke(t,this.root.value))?this.root.index:-1},u.prototype.find=function(t,i,n){if(i)throw new Error("SortedSet#find does not support second argument: equals");if(n)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.$$(t),this.ke(t,this.root.value)))return this.root},u.prototype.Z$=function(t){if(this.root){for(t=t||this.root;t.right;)t=t.right;return t}},u.prototype.tX=function(t){if(this.root){for(t=t||this.root;t.left;)t=t.left;return t}},u.prototype.iX=function(t){if(this.root)return this.$$(t),0<this.Hf(this.root.value,t)?this.root.X$():this.root},u.prototype.nX=function(t){if(this.root)return this.$$(t),0<=this.Hf(this.root.value,t)?this.root.X$():this.root},u.prototype.W$=function(t){if(this.root)return this.$$(t),0<=this.Hf(this.root.value,t)?this.root:this.root.rX()},u.prototype.sX=function(t){if(this.root)return this.$$(t),this.Hf(this.root.value,t)<=0?this.root.rX():this.root},u.prototype.pop=function(){if(this.root){var t=this.Z$();return this["delete"](t.value),t.value}},u.prototype.shift=function(){if(this.root){var t=this.tX();return this["delete"](t.value),t.value}},u.prototype.push=function(){this.hiveAddEach(arguments)},u.prototype.unshift=function(){this.hiveAddEach(arguments)},u.prototype.slice=function(t,i){t=t||0,i=i||this.length,t<0&&(t+=this.length),i<0&&(i+=this.length);var n=[];if(this.root)for(this.eX(t);this.root.index<i&&(n.push(this.root.value),this.root.right);)this.$$(this.root.rX().value);return n},u.prototype.splice=function(t,i){return this.GP(t,i,Array.prototype.slice.call(arguments,2))},u.prototype.GP=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=[];if(this.root){this.eX(t);for(var s=0;s<i;s++){r.push(this.root.value);var e=this.root.rX();if(this["delete"](this.root.value),!e)break;this.$$(e.value)}}return this.hiveAddEach(n),r},u.prototype.$$=function(t){var i,n,r,s,e,h;if(this.root){for(i=n=r=new this.Node(),h=new this.Node(),e=this.root;;){var o=this.Hf(t,e.value);if(o<0){if(!e.left)break;if(this.Hf(t,e.left.value)<0&&(s=e.left,e.left=s.right,e.z$(),s.right=e,s.z$(),!(e=s).left))break;(s=new a()).right=e,s.left=h.left,h.left=s,r.left=e,r.z$(),e=(r=e).left}else{if(!(0<o))break;if(!e.right)break;if(0<this.Hf(t,e.right.value)&&(s=e.right,e.right=s.left,e.z$(),s.left=e,s.z$(),!(e=s).right))break;(s=new a()).left=e,s.right=h.right,h.right=s,n.right=e,n.z$(),e=(n=e).right}}for(n.right=e.left,n.z$(),r.left=e.right,r.z$(),e.left=i.right,e.right=i.left;h.left;)h.left.right.z$(),h.left=h.left.left;for(;h.right;)h.right.left.z$(),h.right=h.right.right;e.z$(),this.root=e}},u.prototype.eX=function(t){if(this.root){for(var i=this.root,n=this.root.index;n!==t;)if(t<n&&i.left)n-=1+((i=i.left).right?i.right.length:0);else{if(!(n<t&&i.right))break;n+=1+((i=i.right).left?i.left.length:0)}return this.$$(i.value),this.root.index===t}return!1},u.prototype.reduce=function(t,i,n){return this.root&&(i=this.root.reduce(t,i,0,n,this)),i},u.prototype.reduceRight=function(t,i,n){return this.root&&(i=this.root.reduceRight(t,i,this.length-1,n,this)),i},u.prototype.min=function(t){var i=this.tX(t);if(i)return i.value},u.prototype.max=function(t){var i=this.Z$(t);if(i)return i.value},u.prototype.qf=function(){return this.min()},u.prototype.clear=function(){var t;this.BC&&(t=this.toArray(),this.KC([],t,0)),this.root=null,this.length=0,this.BC&&this.qC([],t,0)},u.prototype.Qf=function(t,i){return new this.Iterator(this,t,i)},u.prototype.Iterator=f,u.prototype.summary=function(){return this.root?this.root.summary():"()"},u.prototype.log=function(t,i,n,r){t=t||o.$U,i=i||this.Pe,n||(n=emptyFunction,r=console),n=n.bind(r),this.root&&this.root.log(t,i,n,n)},u.prototype.Pe=function(t,i,n){i(" "+t.value)},u.hX=o,(u.prototype.Node=a).prototype.reduce=function(t,i,n,r,s,e){if(e=e||0,this.left){var h=this.left.length;i=this.left.reduce(t,i,n,r,s,e+1),n+=h}return i=t.call(r,i,this.value,n,s,this,e),n+=1,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1)),i},a.prototype.reduceRight=function(t,i,n,r,s,e){return e=e||0,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1),n-=this.right.length),i=t.call(r,i,this.value,this.value,s,this,e),n-=1,this.left&&(i=this.left.reduce(t,i,n,r,s,e+1)),i},a.prototype.z$=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},a.prototype.oX=function(){var t=1;if(t+=this.left?this.left.oX():0,t+=this.right?this.right.oX():0,this.length!==t)throw new Error("Integrity check failed: "+this.summary());return t},a.prototype.rX=function(){var t=this;if(t.right){for(t=t.right;t.left;)t=t.left;return t}},a.prototype.X$=function(){var t=this;if(t.left){for(t=t.left;t.right;)t=t.right;return t}},a.prototype.summary=function(){var t=this.value||"-";return t+=" <"+this.length,this.left||this.right?"("+t+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+t+")"},a.prototype.log=function(i,t,n,r){var s,e,h,o,u=this;s=this.left&&this.right?i.XC:this.left?i.VU:this.right?i.qU:i.BU,this.left&&this.left.log(i,t,function(t){e?r(i.WU+" "+t):(e=!0,r(i.QU+i.BU+t))},function(t){r("  "+t)}),t(this,function(t){h?n((u.right?i.WU:" ")+t):(h=!0,n(s+t))},function(t){r((u.left?i.WU:" ")+t)}),this.right&&this.right.log(i,t,function(t){o?n("  "+t):(o=!0,n(i.YU+i.BU+t))},function(t){n(i.WU+" "+t)})},f.prototype.xP=null,Object.defineProperty(f.prototype,"BP",{get:function(){return this.xP||(this.xP={done:!1,value:null})}}),f.prototype.next=function(){var t;return(t=this.CP?this.set.sX(this.CP.value):this.set.tX())?void 0!==this.end&&0<=this.set.Hf(t.value,this.end)?(this.BP.done=!0,this.BP.value=void 0):(this.CP=t,this.BP.value=t.value):(this.BP.done=!0,this.BP.value=void 0),this.BP}},function(t,i,n){var o=n(144),u=n(86);t.exports.LB=function(){var s=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,e=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,i=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,h=[{type:"duration",test:function(t){for(var i=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],n=i.length,r=0;r<n;r++)if(t.nodeName===i[r])return s.test(t.value);return!1},BB:function(t){var i=s.exec(t),n=31536e3*parseFloat(i[2]||0)+2592e3*parseFloat(i[4]||0)+86400*parseFloat(i[6]||0)+3600*parseFloat(i[8]||0)+60*parseFloat(i[10]||0)+parseFloat(i[12]||0);return void 0!==i[1]&&(n=-n),n}},{type:"datetime",test:function(t){return e.test(t.value)},BB:function(t){var i,n=e.exec(t);if(i=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var r=60*parseInt(n[9],10)+parseInt(n[10],10);i+=("+"===n[8]?-1:1)*r*60*1e3}return new Date(i)}},{type:"numeric",test:function(t){return i.test(t.value)},BB:function(t){return parseFloat(t)}}];return{parse:function(i,t){var n,r=new u(h,"",!0),s=new o(function(){var t=[];return t.push(function(){var t,i,n,r;return r=[{name:"profiles",iO:!1},{name:"width",iO:!1},{name:"height",iO:!1},{name:"sar",iO:!1},{name:"frameRate",iO:!1},{name:"audioSamplingRate",iO:!1},{name:"mimeType",iO:!1},{name:"segmentProfiles",iO:!1},{name:"codecs",iO:!1},{name:"maximumSAPPeriod",iO:!1},{name:"startsWithSap",iO:!1},{name:"maxPlayoutRate",iO:!1},{name:"codingDependency",iO:!1},{name:"scanType",iO:!1},{name:"FramePacking",iO:!0},{name:"AudioChannelConfiguration",iO:!0},{name:"ContentProtection",iO:!0}],(t={}).name="AdaptationSet",t.uX=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=r,(i={}).name="Representation",i.uX=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),(n={name:"SubRepresentation",uX:!1,isArray:!0}).parent=i,n.children=[],n.properties=r,i.children.push(n),t}()),t.push(function(){var t,i,n,r;return r=[{name:"SegmentBase",iO:!0},{name:"SegmentTemplate",iO:!0},{name:"SegmentList",iO:!0}],(t={}).name="Period",t.uX=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=r,(i={}).name="AdaptationSet",i.uX=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),(n={name:"Representation",uX:!1,isArray:!0}).parent=i,n.children=[],n.properties=r,i.children.push(n),t}()),t.push(function(){var t,i,n,r,s;return s=[{name:"BaseURL",iO:!0,aX:function(t,i){return 0===i.indexOf("http://")?i:t+i}}],(t={}).name="mpd",t.uX=!0,t.isArray=!0,t.parent=null,t.children=[],t.properties=s,(i={}).name="Period",i.uX=!1,i.isArray=!0,i.parent=null,i.children=[],i.properties=s,t.children.push(i),(n={}).name="AdaptationSet",n.uX=!1,n.isArray=!0,n.parent=i,n.children=[],n.properties=s,i.children.push(n),(r={name:"Representation",uX:!1,isArray:!0}).parent=n,r.children=[],r.properties=s,n.children.push(r),t}()),t}());new Date();try{n=r.RB(i),new Date(),n.hasOwnProperty("BaseURL")?(n.BaseURL=n.BaseURL_asArray[0],0!==n.BaseURL.toString().indexOf("http")&&(n.BaseURL=t+n.BaseURL)):n.BaseURL=t,n.hasOwnProperty("Location")&&(n.Location=n.Location_asArray[0]),s.gC(n),new Date()}catch(t){return!1,null}return n}}}},function(t,n,r){t.exports=function(u){var a;for(a=[],i=0,len=u.length;i<len;i+=1)u[i].uX?a.push("root"):a.push(u[i].name);function f(t,i){var n;if(null!==t&&null!==i)for(n in t)t.hasOwnProperty(n)&&(i.hasOwnProperty(n)||(i[n]=t[n]))}function c(t,i,n){var r,s,e,h,o;if(null!==t&&0!==t.length)for(r=0,s=t.length;r<s;r+=1)e=t[r],i.hasOwnProperty(e.name)&&(n.hasOwnProperty(e.name)?e.iO&&(h=i[e.name],o=n[e.name],"object"==typeof h&&"object"==typeof o?f(h,o):null!=e.aX?n[e.name]=e.aX(h,o):n[e.name]=h+o):n[e.name]=i[e.name])}var l=function(t,i){var n,r,s,e,h,o,u,a=t;if(null!==a.children&&0!==a.children.length)for(n=0,r=a.children.length;n<r;n+=1)if(o=a.children[n],i.hasOwnProperty(o.name))if(o.isArray)for(s=0,e=(h=i[o.name+"_asArray"]).length;s<e;s+=1)u=h[s],c(a.properties,i,u),l(o,u);else u=i[o.name],c(a.properties,i,u),l(o,u)},v=function(t){var i,n,r,s,e,h,o;if(null===t)return t;if("object"!=typeof t)return t;for(i=0,n=a.length;i<n;i+=1)"root"===a[i]&&(e=u[i],l(e,h=t));for(s in t)if(t.hasOwnProperty(s)){if(-1!==(r=a.indexOf(s)))if((e=u[r]).isArray)for(i=0,n=(o=t[s+"_asArray"]).length;i<n;i+=1)h=o[i],l(e,h);else h=t[s],l(e,h);v(t[s])}return t};return{gC:v}}},function(t,i,n){if(void 0===r)var r={};r.mB=function(t){return new s(t).parse()},r.fX={},r.fX.cX=function(t,i){var n=i||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(t);var r=[],s=0;if("utf-8"===n)for(;s<t.byteLength;){var e=t.getUint8(s++);e<128||(e<224?e=(31&e)<<6:(e<240?e=(15&e)<<12:(e=(7&e)<<18,e|=(63&t.getUint8(s++))<<12),e|=(63&t.getUint8(s++))<<6),e|=63&t.getUint8(s++)),r.push(String.fromCharCode(e))}else for(;s<t.byteLength;)r.push(String.fromCharCode(t.getUint8(s++)));return r.join("")},i.mB=r.mB,i.fX=r.fX,r.lX=function(t){this.offset=void 0===t?0:t};var s=function(t){this.vX=new DataView(t),this.dX=new r.lX(),this.EX=[]};s.prototype.fetch=function(t){var i=this.wX(t,!0);return i.length?i[0]:null},s.prototype.wX=function(t,i){var n=[];return s.pX.call(this,t,n,i),n},s.prototype.parse=function(){for(this.dX.offset=0,this.EX=[];this.dX.offset<this.vX.byteLength;){var t=e.parse(this);if(void 0===t.type)break;this.EX.push(t)}return this},s.pX=function(t,i,n){for(var r in this.type&&this.type==t&&i.push(this),this.EX){if(i.length&&n)return;s.pX.call(this.EX[r],t,i,n)}};var e=function(){this.dX=new r.lX()};e.parse=function(t){var i=new e();return i.gX=t.dX.offset,i.bX=t.bX?t.bX:t,i.vX=t.vX,i.yX=t,i.TX(),t.dX.offset=i.vX.byteOffset+i.vX.byteLength,i},e.prototype.mX=function(t){var i=null;switch(t){case 8:i=this.vX.getInt8(this.dX.offset-this.vX.byteOffset);break;case 16:i=this.vX.getInt16(this.dX.offset-this.vX.byteOffset);break;case 32:i=this.vX.getInt32(this.dX.offset-this.vX.byteOffset);break;case 64:var n=this.vX.getInt32(this.dX.offset-this.vX.byteOffset),r=this.vX.getInt32(this.dX.offset-this.vX.byteOffset+4);i=n*Math.pow(2,32)+r}return this.dX.offset+=t>>3,i},e.prototype.OX=function(t){var i=null;switch(t){case 8:i=this.vX.getUint8(this.dX.offset-this.vX.byteOffset);break;case 16:i=this.vX.getUint16(this.dX.offset-this.vX.byteOffset);break;case 24:i=((n=this.vX.getUint16(this.dX.offset-this.vX.byteOffset))<<8)+(r=this.vX.getUint8(this.dX.offset-this.vX.byteOffset+2));break;case 32:i=this.vX.getUint32(this.dX.offset-this.vX.byteOffset);break;case 64:var n=this.vX.getUint32(this.dX.offset-this.vX.byteOffset),r=this.vX.getUint32(this.dX.offset-this.vX.byteOffset+4);i=n*Math.pow(2,32)+r}return this.dX.offset+=t>>3,i},e.prototype.SX=function(t){for(var i="",n=0;n<t;n++){var r=this.OX(8);i+=String.fromCharCode(r)}return i},e.prototype.RX=function(){for(var t="";;){var i=this.OX(8);if(0==i)break;t+=String.fromCharCode(i)}return t},e.prototype._X=function(t){return this.OX(t/2)+this.OX(t/2)/Math.pow(2,t/2)},e.prototype.TX=function(){if(this.dX.offset=this.gX,this.gX+8>this.vX.buffer.byteLength)this.bX.IX=!0;else{switch(this.size=this.OX(32),this.type=this.SX(4),1==this.size&&(this.AX=this.OX(64)),"uuid"==this.type&&(this.NX=this.SX(16)),this.size){case 0:this.vX=new DataView(this.vX.buffer,this.gX,this.vX.byteLength-this.dX.offset);break;case 1:this.gX+this.size>this.vX.buffer.byteLength?(this.IX=!0,this.bX.IX=!0):this.vX=new DataView(this.vX.buffer,this.gX,this.AX);break;default:this.gX+this.size>this.vX.buffer.byteLength?(this.IX=!0,this.bX.IX=!0):this.vX=new DataView(this.vX.buffer,this.gX,this.size)}!this.IX&&this.kX[this.type]&&this.kX[this.type].call(this)}},e.prototype.CX=function(){this.version=this.OX(8),this.flags=this.OX(24)},e.prototype.kX={},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(t){e.prototype.kX[t]=function(){for(this.EX=[];this.dX.offset-this.vX.byteOffset<this.vX.byteLength;)this.EX.push(e.parse(this))}}),e.prototype.kX.DX=function(){this.CX(),this.MX=this.OX(32),this.entries=[];for(var t=1;t<=this.MX;t++){var i={};1==this.version?(i.jX=this.OX(64),i.PX=this.mX(64)):(i.jX=this.OX(32),i.PX=this.mX(32)),i.LX=this.mX(16),i.HX=this.mX(16),this.entries.push(i)}},e.prototype.kX.UX=function(){this.CX(),this.FX=this.RX(),this.value=this.RX(),this.timescale=this.OX(32),this.GX=this.OX(32),this.xX=this.OX(32),this.id=this.OX(32),this.BX=new DataView(this.vX.buffer,this.dX.offset,this.vX.byteLength-(this.dX.offset-this.gX))},e.prototype.kX.VX=e.prototype.kX.PE=function(){this.data=new DataView(this.vX.buffer,this.dX.offset,this.vX.byteLength-(this.dX.offset-this.gX))},e.prototype.kX.qX=e.prototype.kX.QX=function(){for(this.YX=this.SX(4),this.KX=this.OX(32),this.WX=[];this.dX.offset-this.vX.byteOffset<this.vX.byteLength;)this.WX.push(this.SX(4))},e.prototype.kX.$X=function(){this.CX(),this.XX=this.OX(32),this.JX=this.SX(4),this.$y=[this.OX(32),this.OX(32),this.OX(32)],this.name=this.RX()},e.prototype.kX.zX=function(){this.data=new DataView(this.vX.buffer,this.dX.offset,this.vX.byteLength-(this.dX.offset-this.gX))},e.prototype.kX.ZX=function(){this.CX(),1==this.version?(this.tJ=this.OX(64),this.iJ=this.OX(64),this.timescale=this.OX(32),this.duration=this.OX(64)):(this.tJ=this.OX(32),this.iJ=this.OX(32),this.timescale=this.OX(32),this.duration=this.OX(32));var t=this.OX(16);this.pad=t>>15,this.language=String.fromCharCode(96+(t>>10&31),96+(t>>5&31),96+(31&t)),this.XX=this.OX(16)},e.prototype.kX.nJ=function(){this.CX(),this.rJ=this.OX(32)},e.prototype.kX.sJ=function(){this.CX(),1==this.version?(this.tJ=this.OX(64),this.iJ=this.OX(64),this.timescale=this.OX(32),this.duration=this.OX(64)):(this.tJ=this.OX(32),this.iJ=this.OX(32),this.timescale=this.OX(32),this.duration=this.OX(32)),this.rate=this._X(32),this.volume=this._X(16),this.eJ=this.OX(16),this.hJ=[this.OX(32),this.OX(32)],this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this._X(32));this.XX=[];for(t=0;t<6;t++)this.XX.push(this.OX(32));this.oJ=this.OX(32)},e.prototype.kX.uJ=function(){var t=new DataView(this.vX.buffer,this.dX.offset,this.vX.byteLength-(this.dX.offset-this.gX));this.aJ=r.fX.cX(t)},e.prototype.kX.fJ=function(){this.CX(),this.cJ=this.OX(32),this.timescale=this.OX(32),0==this.version?(this.lJ=this.OX(32),this.vJ=this.OX(32)):(this.lJ=this.OX(64),this.vJ=this.OX(64)),this.$y=this.OX(16),this.dJ=this.OX(16),this.EJ=[];for(var t=0;t<this.dJ;t++){var i={},n=this.OX(32);i.wJ=n>>31&1,i.pJ=2147483647&n,i.gJ=this.OX(32);var r=this.OX(32);i.bJ=r>>31&1,i.yJ=r>>28&7,i.TJ=268435455&r,this.EJ.push(i)}},e.prototype.kX.mJ=function(){this.CX(),this.OJ=this.OX(32),this.SJ=[];for(var t=0;t<this.OJ;t++){var i={};i.RJ=this.OX(32),i._J=[];for(var n=0;n<i.RJ;n++){var r={};r.level=this.OX(8),r.IJ=this.OX(24),i._J.push(r)}this.SJ.push(i)}},e.prototype.kX.AJ=function(){this.CX(),1==this.version?this.NJ=this.OX(64):this.NJ=this.OX(32)},e.prototype.kX.tfhd=function(){this.CX(),this.kJ=this.OX(32),1&this.flags&&(this.CJ=this.OX(64)),2&this.flags&&(this.DJ=this.OX(32)),8&this.flags&&(this.default_sample_duration=this.OX(32)),16&this.flags&&(this.MJ=this.OX(32)),32&this.flags&&(this.jJ=this.OX(32))},e.prototype.kX.PJ=function(){this.CX(),1==this.version?(this.tJ=this.OX(64),this.iJ=this.OX(64),this.kJ=this.OX(32),this.eJ=this.OX(32),this.duration=this.OX(64)):(this.tJ=this.OX(32),this.iJ=this.OX(32),this.kJ=this.OX(32),this.eJ=this.OX(32),this.duration=this.OX(32)),this.hJ=[this.OX(32),this.OX(32)],this.LJ=this.OX(16),this.HJ=this.OX(16),this.volume=this._X(16),this.UJ=this.OX(16),this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this._X(32));this.width=this.OX(32),this.height=this.OX(32)},e.prototype.kX.trun=function(){this.CX(),this.FJ=this.OX(32),1&this.flags&&(this.GJ=this.mX(32)),4&this.flags&&(this.xJ=this.OX(32)),this.OB=[];for(var t=0;t<this.FJ;t++){var i={};256&this.flags&&(i.sample_duration=this.OX(32)),512&this.flags&&(i.BJ=this.OX(32)),1024&this.flags&&(i.VJ=this.OX(32)),2048&this.flags&&(0==this.version?i.qJ=this.OX(32):i.qJ=this.mX(32)),this.OB.push(i)}},e.prototype.kX.QJ=function(){var t=new DataView(this.vX.buffer,this.dX.offset,this.vX.byteLength-(this.dX.offset-this.gX));this.YJ=r.fX.cX(t)},e.prototype.kX.KJ=function(){var t=new DataView(this.vX.buffer,this.dX.offset,this.vX.byteLength-(this.dX.offset-this.gX));this.config=r.fX.cX(t)},e.prototype.kX.WJ=function(){}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.Representation=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(0),h=n(1),o=n(2),u=function(t,i){this.name=t,this.iv=i},s=(a.prototype.init=function(){var i=this;try{this.$J();var n=e.defer();this.XJ().then(function(){return n.resolve(!0)}).fail(function(t){h.ErrorMonitor.Z().logError("Error initializing key",i.loggerId,o._n.An,t),n.resolve(!1)}),this.JJ=n.promise}catch(t){h.ErrorMonitor.Z().logError("Error initializing AES Manager",this.loggerId,o._n.In,t)}},a.prototype.K$=function(){return this.JJ?this.JJ:e.resolve(!1)},a.prototype.XJ=function(){var i=this;if(this.zJ)return this.zJ;var n=e.defer();return this.ZJ().then(function(t){window.crypto.subtle.importKey("raw",t,i.tz,!1,["decrypt"]).then(function(t){n.resolve(t)},function(t){n.reject("error importing key: "+t.toString())})}).fail(function(t){return n.reject(t)}),this.zJ=n.promise,this.zJ},a.prototype.$J=function(){for(var t=2,i=this.iz.length,n=[];t<i;t+=2)n.push(parseInt(this.iz.substr(t,2),16));this.iv=new Uint8Array(n)},a.prototype.decrypt=function(i){var n=this,r=e.defer(),s=new u(this.tz,this.iv);return this.zJ.then(function(t){window.crypto.subtle.decrypt(s,t,i).then(function(t){r.resolve(t)})})["catch"](function(t){h.ErrorMonitor.Z().logError("Error decrypting arraybuffer",n.loggerId,o._n.kn,t),n.failed=!0,n.JJ=e.resolve(!1),r.reject(t)}),r.promise},a.prototype.ZJ=function(){var i=this,n=e.defer(),r=new XMLHttpRequest();return r.responseType="arraybuffer",r.open("GET",this.nz),this.rz&&r.setRequestHeader("Authorization",this.rz),r.onload=function(){if(200===r.status){var t=new Uint8Array(r.response);n.resolve(t)}else h.ErrorMonitor.Z().logError("Error downloading key",i.loggerId,o._n.Cn,r.status),n.reject("error downloading key - status: "+r.status)},r.onerror=function(){h.ErrorMonitor.Z().logError("Error downloading key",i.logger,o._n.Dn),n.reject("error downloading key")},r.send(),n.promise},a.prototype.cB=function(){return this.failed},a);function a(t,i,n){this.loggerId="[DASH AES Manager] ",this.tz="AES-CBC",this.failed=!1,this.logger=r.Framework&&r.Framework.resolve(r.Framework.p.T)?r.Framework.resolve(r.Framework.p.T).log():console,this.nz=t,this.iz=i,this.logger.debug(this.loggerId+"Starting Dash AES Manager"),n&&(this.rz=n)}i.lB=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=(e.prototype.init=function(){},e.prototype.K$=function(){return r.resolve(!1)},e.prototype.decrypt=function(t){return r.reject("unsupported")},e.prototype.cB=function(){return!1},e);function e(){}i.vB=s},function(i,n,r){var s;!function(){"use strict";var d={sz:/[^s]/,ez:/[^t]/,hz:/[^T]/,oz:/[^v]/,number:/[diefg]/,uz:/[bcdiefguxX]/,json:/[j]/,az:/[^j]/,text:/^[^\x25]+/,fz:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,cz:/^\.([a-z_][a-z_\d]*)/i,lz:/^\[(\d+)\]/,sign:/^[+-]/};function E(t){return function(t,i){var n,r,s,e,h,o,u,a,f,c=1,l=t.length,v="";for(r=0;r<l;r++)if("string"==typeof t[r])v+=t[r];else if("object"==typeof t[r]){if((e=t[r]).keys)for(n=i[c],s=0;s<e.keys.length;s++){if(null==n)throw new Error(E('[sprintf] Cannot access property "%s" of undefined value "%s"',e.keys[s],e.keys[s-1]));n=n[e.keys[s]]}else n=e.vz?i[e.vz]:i[c++];if(d.hz.test(e.type)&&d.oz.test(e.type)&&n instanceof Function&&(n=n()),d.uz.test(e.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(E("[sprintf] expecting number but found %T",n));switch(d.number.test(e.type)&&(a=0<=n),e.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,e.width?parseInt(e.width):0);break;case"e":n=e.precision?parseFloat(n).toExponential(e.precision):parseFloat(n).toExponential();break;case"f":n=e.precision?parseFloat(n).toFixed(e.precision):parseFloat(n);break;case"g":n=e.precision?String(Number(n.toPrecision(e.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=e.precision?n.substring(0,e.precision):n;break;case"t":n=String(!!n),n=e.precision?n.substring(0,e.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=e.precision?n.substring(0,e.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=e.precision?n.substring(0,e.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}d.json.test(e.type)?v+=n:(!d.number.test(e.type)||a&&!e.sign?f="":(f=a?"+":"-",n=n.toString().replace(d.sign,"")),o=e.dz?"0"===e.dz?"0":e.dz.charAt(1):" ",u=e.width-(f+n).length,h=e.width&&0<u?o.repeat(u):"",v+=e.align?f+n+h:"0"===o?f+h+n:h+f+n)}return v}(function(t){if(u[t])return u[t];var i,n=t,r=[],s=0;for(;n;){if(null!==(i=d.text.exec(n)))r.push(i[0]);else if(null!==(i=d.fz.exec(n)))r.push("%");else{if(null===(i=d.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){s|=1;var e=[],h=i[2],o=[];if(null===(o=d.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(e.push(o[1]);""!==(h=h.substring(o[0].length));)if(null!==(o=d.cz.exec(h)))e.push(o[1]);else{if(null===(o=d.lz.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");e.push(o[1])}i[2]=e}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:i[0],vz:i[1],keys:i[2],sign:i[3],dz:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}n=n.substring(i[0].length)}return u[t]=r}(t),arguments)}function t(t,i){return E.apply(null,[t].concat(i||[]))}var u=Object.create(null);n.MB=E,n.Ez=t,"undefined"!=typeof window&&(window.MB=E,window.Ez=t,void 0===(s=function(){return{MB:E,Ez:t}}.call(n,r,n,i))||(i.exports=s))}()},function(t,i,n){var r,s,e;s=[i],void 0===(e="function"==typeof (r=function(t){"use strict";var i,n;Object.defineProperty(t,"s",{value:!0});var r={YEAR:31536e3,MONTH:2628e3,DAY:86400,HOUR:3600,MINUTE:60,SECOND:1},u="years",a="months",f="days",c="hours",l="minutes",v="seconds",d=((i={}).wz=0,i.pz=0,i.gz=0,i),E=((n={}).bz=0,n.yz=0,n.Tz=0,n),s=function(t){return/^-?P((([0-9]+Y([0-9]+M)?([0-9]+D)?|([0-9]+M)([0-9]+D)?|([0-9]+D))(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S)))?)|(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S))))$/.test(t)},w=function(t){return"string"==typeof t&&0<t.length},p=function(t){return"-"===t[0]},g=function(t){return t.slice(1)},o=function(t,i){var n=b(i);return function(t,i){return r[t.toUpperCase()]*i}(t,n)},b=function(t){var i=parseFloat(t);return isNaN(i)?0:i},e=function(t){var i=p(t),n=i?g(t):t,r=n.split("T"),s=g(r[0]),e=r[1],h=0;return w(s)&&(h+=function(t){var i=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("year",n)+o("month",r)+o("day",s)}(s)),w(e)&&(h+=function(t){var i=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("hour",n)+o("minute",r)+o("second",s)}(e)),i?-h:h},h=t.mz=function(t){var i,n=p(t),r=n?g(t):t,s=r.split("T"),e=g(s[0]),h=s[1],o=((i={}).Oz=n,i);return o=w(e)?Object.assign(o,function(t){var i,n=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[u]=b(r),i[a]=b(s),i[f]=b(e),i}(e)):Object.assign(o,d),o=w(h)?Object.assign(o,function(t){var i,n=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[c]=b(r),i[l]=b(s),i[v]=b(e),i}(h)):Object.assign(o,E)};t["default"]=function(t,i){return function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if("string"==typeof t)return s(t)?i?h(t):e(t):null;throw new TypeError("expected input to be a string")}(t,i)}})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(85),o=n(4),u=(e=h.HB,s(a,e),a.prototype.xx=function(t,i){if(DOMParser){var n=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("Location"),r="";if(n&&0<n.length&&0<n[0].childNodes.length){var s=n[0].childNodes[0];r=this.Hx(s.data)}else r=this.Hx(t);this.manifest=this.PB.parse(i,r)}},a.prototype.iU=function(t){return o.resolve(!1)},a);function a(){return null!==e&&e.apply(this,arguments)||this}i.WA=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(3),r=(d.prototype.Sz=function(t,i,n){if(!this.QY.has(t)){if(!t[i])throw new Error(d.loggerId+"- method "+i+" is undefined in event target.");if(!t[n])throw new Error(d.loggerId+"- method "+n+" is undefined in event target.");this.QY.set(t,{Rz:d._z++,Iz:i,Az:n,events:{}})}return this},d.prototype.Nz=function(t,i){if(!i){var n=this.QY.keys(),r=n.length;if(1!==r)throw new Error(d.loggerId+"Incorrect use of non-targeted registerEvents; "+r+" registered");i=t,t=n[0]}var s=this.QY.get(t);if(!s)throw new Error(d.loggerId+"- target not registered");for(var e=s.Iz,h=s.Rz,o=[],u=0,a=Object.keys(i);u<a.length;u++){var f=a[u],c=i[f],l=void 0;if(l="function"==typeof c?c=c.bind(this.plugin):c.kz=c.kz.bind(this.plugin),!s.events[f])try{t[e](f,l),s.events[f]=c,o.push(f)}catch(t){this.plugin.logger().warn(d.loggerId+" error binding event '"+f+"' on target #"+h+": "+t.toString())}}return this.plugin&&this.plugin.logger().debug(d.loggerId+"Registering events ["+o.join(", ")+"] on target #"+h),0<o.length},d.prototype.$g=function(l){var v=this;void 0===l&&(l=!1),this.QY.forEach(function(t,i){for(var n=t.Az,r=t.events,s=t.Rz,e=[],h=0,o=Object.keys(r);h<o.length;h++){var u=o[h],a=r[u],f=void 0,c=void 0;if("function"==typeof a?f=a:(f=a.kz,c=a.KY),l||!c){try{i[n](u,f)}catch(t){v.plugin.logger().warn(d.loggerId+" error unbinding event '"+u+"' on target #"+s+": "+t.toString())}e.push(u),delete r[u]}}l&&v.QY["delete"](i),v.plugin&&v.plugin.logger().debug(d.loggerId+"Unregistering events ["+e.join(", ")+"] on target #"+s+" [destroy: "+l+"]")})},d.prototype.reset=function(){var r=this;this.QY.forEach(function(t,i){var n=t.Rz;r.QY["delete"](i),r.plugin&&r.plugin.logger().debug(d.loggerId+"Reset on target #"+n)})},d.loggerId="[HiveEventsBinder] ",d._z=0,d);function d(t,i,n,r){this.QY=new s(),this.plugin=t,i&&this.Sz(i,n,r)}i["default"]=r},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),o=n(57),u=n(0),a=n(154),f=n(88),c=n(17),l=n(84),v=n(214),d=n(21),E=n(29),w=n(28),p=n(13),g=n(87),b=n(1),y=n(44),T=n(34),m=(e=l.StatsJS,s(O,e),O.prototype.getName=function(){return O.yg},O.prototype.getVersion=function(){return this.plugin.getPluginVersion()},O.prototype.Ng=function(){return!0},O.prototype.Sx=function(){return f["default"].Z?navigator&&navigator.userAgent&&this.Cz(navigator.userAgent)?h.resolve(!0):h.reject(new d.HiveTechError(d.Qv.Yv,"WebRTC DataChannels not supported by browser")):h.reject(new d.HiveTechError(d.Qv.Yv,"Not included in the page"))},O.prototype.initSession=function(s,e){var h=this;return this.Sx().then(function(){var t=e.ticket;h.Nx();var i=t.eM();0===i.indexOf("//")&&(i=location.protocol+i);var n=h.Rx(s,t,i,e),r=h.plugin.getPluginId();return g.Sb.QB(n,r),g.Sb.registerPlugin(h.plugin,r),w.HiveRequestFactory.register(h),window&&window.activateXHRInterceptor&&window.activateXHRInterceptor(h.plugin.loggerLevel()>y.QD.info,r),n})},O.prototype.isActive=function(t,i,n){void 0===n&&(n=!1);var r=i.manifest.toLowerCase(),s=t.toLowerCase(),e=r.indexOf(".ism/manifest");if(-1<e&&(!n||t===i.manifest)){var h=r.substring(0,e);if(-1<s.indexOf(h))return-1<s.indexOf(".ism/manifest(format=mpd-time-csf)")?this.Dz?(i.ticket.SourceURL=t,!0):this.Mz(i,"The player does not use HiveRequest, downgrading to StatsJS"):this.Mz(i,"Protocol not supported by HiveJS tech, downgrading to StatsJS")}else if(s===r)return!!this.Dz||this.Mz(i,"The player does not use HiveRequest, downgrading to StatsJS");return!1},O.prototype.ny=function(t,i){window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),e.prototype.ny.call(this,t,i);var n=f["default"].Z();i?(w.HiveRequestFactory.clearPlugin(this.plugin.getPluginId()),g.Sb.WB(t,this.plugin.getPluginId()),n&&(n.ol(this.plugin.getPluginId(),c.Wc.STOP),n.jz())):n&&n.ol(this.plugin.getPluginId(),c.Wc.IDLE)},O.prototype.Mz=function(t,i){return t.tech=this.pg,w.HiveRequestFactory.register(this.pg),this.Dz&&this.Dz.resolve(),this.Dz=void 0,this.plugin.logger().warn("[HiveJS] "+i),this.onError(new d.HiveTechError(d.Qv.Wv,i)),window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),!0},O.prototype.$B=function(t){this.Dz=t},O.prototype.Ag=function(){},O.prototype.onActiveSession=function(r){var s=this;u.Framework.h().apply(new a.Pz(!0));var e=f["default"].Z();if(e.ol(this.plugin.getPluginId(),c.Wc.STOP),this.Lz()&&e.Hz(!0),e.start(r.sb,!1,this.options_,this.plugin.Rg()).then(function(t){if(s.Nx(),s.kx=r.sb,s.kx.fl(s.options_.renderStatsCallback),s.kx.rl(f["default"]._l()),s.kx.ul.init(s.kx.el,r.ticket.sessionId),s.plugin.options().testId&&s.kx.el.eF(s.plugin.options().testId),r.authenticationToken){var i=e.Uz(s.plugin.getPluginId());i&&i.Gz.P.Fz(r.authenticationToken)}s.Dz&&e.request(s.Dz,s.plugin.getPluginId()),s.kx.hl.Od(r.ticket.sessionId,s.plugin.getPlayerSource(),200);var n=s.plugin.flushTechEvents();n&&0<n.length&&s.kx.hl.Md(n),s.plugin.updatePlayerInfo(s.kx)}),null!=this.options().onActiveSession)try{this.options().onActiveSession(r.toHiveSession())}catch(t){b.ErrorMonitor.Z().logError("exception in user-defined onActiveSession callback","[HiveJS]",t)}},O.prototype.ol=function(t,i){},O.prototype.Rx=function(t,i,n,r){var s=new E.HiveSessionInternal(t,i,n,r,this.plugin.options().jv);return s.Dx=!0,s.id=s.ticket.sessionId,s},O.prototype.Ax=function(){},O.prototype.Lz=function(){var t=new o.Hd();return t.Ud(navigator.userAgent),"Android"==t.Fd().name},O.prototype.Cz=function(t){try{var i=new o.Hd(t).pL();return"Mobile Safari"!==i.name&&("Safari"===i.name?12<=parseInt(i.ZP,10):"function"==typeof RTCPeerConnection.prototype.createDataChannel)}catch(t){return!1}},O.prototype.getPluginId=function(){return this.plugin.getPluginId()},O.prototype.Zb=function(t){return new g.Sb(t)},O.prototype.zb=function(t){return new T.HiveRequest(t)},O.yg="HiveJS",O);function O(t,i,n){var r=e.call(this,t,i)||this;return r.options_=new v.xz(),null!=i[O.yg]&&p.updateOptions(i[O.yg],r.options_),r.pg=n,r}i.HiveJS=m},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(26),s=n(41),e=n(44),h=n(17),o=n(77),u=n(78),a=n(79),f=n(76),c=n(22),l=n(155),v=n(157),d=n(158),E=n(165),w=n(168),p=n(169),g=n(170),b=n(171),y=n(172),T=n(96),m=n(187),O=n(188),S=n(189),R=n(51),_=n(18),I=n(190),A=n(194),N=n(195),k=n(196),C=n(197),D=n(199),M=n(200),j=n(201),P=n(202),L=n(80),H=n(203),U=n(204),F=n(205),G=n(7),x=n(206),B=n(207),V=n(208),q=n(209),Q=n(211),Y=n(212),K=n(94),W=n(81),$=n(83),X=G.W.uf,J=G.W.af,z=G.W.cf,Z=G.W.pf,tt=(it.prototype.apply=function(t){this.Bz?z&&t.bind(new r.Db(s.p.Jd,W.LG,r.Mb.Fb)):(Z?(t.bind(new r.Db(s.p.RD,h.kl,r.Mb.Fb)),t.bind(new r.Db(s.p.Zc,o.cG,r.Mb.Fb))):(t.bind(new r.Db(s.p.RD,h.Nl,r.Mb.Fb)),t.bind(new r.Db(s.p.Zc,o.fG,r.Mb.Fb))),t.bind(new r.Db(s.p.Al,u.pG,r.Mb.Fb)),t.bind(new r.Db(s.p.il,a.IG,r.Mb.Fb)),t.bind(new r.Db(s.p.T,e.XD,r.Mb.Fb)),t.bind(new r.Db(s.p.El,f.pl,r.Mb.Yb)),t.bind(new r.Db(s.p.wl,c.zd,r.Mb.Yb)),t.bind(new r.Db(s.p.jD,c.pl,r.Mb.Yb)),z?t.bind(new r.Db(s.p.Jd,W.LG,r.Mb.Fb)):t.bind(new r.Db(s.p.Jd,$.Ox,r.Mb.Fb))),t.bind(new r.Db(s.p.cD,q.Vz,r.Mb.Yb)),t.bind(new r.Db(s.p.kD,x.qz,r.Mb.Yb)),t.bind(new r.Db(s.p.TD,L.kG,r.Mb.Fb)),t.bind(new r.Db(s.p.SD,j.Qz,r.Mb.Fb)),t.bind(new r.Db(s.p.xl,l.Vu,r.Mb.Fb)),t.bind(new r.Db(s.p.rD,v.Yz,r.Mb.Yb)),t.bind(new r.Db(s.p.nD,d.Kz,r.Mb.Yb)),t.bind(new r.Db(s.p.tD,w.Cache,r.Mb.Yb)),t.bind(new r.Db(s.p.fD,E.Wz,r.Mb.Yb)),t.bind(new r.Db(s.p.sD,p.$z,r.Mb.Yb)),"undefined"!=typeof HiveOriginalXMLHttpRequest?t.bind(new r.Db(s.p.hD,HiveOriginalXMLHttpRequest)):t.bind(new r.Db(s.p.hD,XMLHttpRequest)),t.bind(new r.Db(s.p.MD,M.Xz,r.Mb.Fb)),t.bind(new r.Db(s.p.DD,g.Jz,r.Mb.Yb)),t.bind(new r.Db(s.p.$l,I.zz,r.Mb.Fb)),t.bind(new r.Db(s.p.ND,A.Zz,r.Mb.Fb)),t.bind(new r.Db(s.p.iD,P.tZ,r.Mb.Yb)),t.bind(new r.Db(s.p.ED,b.iZ,r.Mb.Yb)),t.bind(new r.Db(s.p.vD,y.Gu,r.Mb.Yb)),t.bind(new r.Db(s.p.yD,T.iY,r.Mb.Yb)),t.bind(new r.Db(s.p.oD,B.nZ,r.Mb.Yb)),t.bind(new r.Db(s.p.wD,U.rZ,r.Mb.Yb)),t.bind(new r.Db(s.p.uD,F.sZ,r.Mb.Yb)),t.bind(new r.Db(s.p.pD,F.eZ,r.Mb.Yb)),t.bind(new r.Db(s.p.aD,H.Cu,r.Mb.Yb)),t.bind(new r.Db(s.p.gD,m.hZ,r.Mb.Yb)),t.bind(new r.Db(s.p.ID,O.oZ,r.Mb.Yb)),t.bind(new r.Db(s.p.AD,S.uZ,r.Mb.Yb)),t.bind(new r.Db(s.p.mD,C.aZ,r.Mb.Yb)),t.bind(new r.Db(s.p.bD,R.NP,r.Mb.Yb)),t.bind(new r.Db(s.p.OD,D.fZ,r.Mb.Yb)),t.bind(new r.Db(s.p.PD,_.Rv,r.Mb.Yb)),t.bind(new r.Db(s.p._D,N.Lu,r.Mb.Yb)),t.bind(new r.Db(s.p.lD,V.cZ,r.Mb.Yb)),X&&(t.bind(new r.Db(s.p.HD,Y.lZ,r.Mb.Yb)),t.bind(new r.Db(s.p.LD,Q.vZ,r.Mb.Yb))),J&&t.bind(new r.Db(s.p.af,K.Nq,r.Mb.Yb)),t.bind(new r.Db(s.p.dD,k.dZ,r.Mb.Yb))},it);function it(t){this.Bz=!1,t&&(this.Bz=t)}i.Pz=tt},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var o=n(4),r=n(31),u=n(0),s=n(6),a=n(5),e=n(17),h=n(3),f=n(156),c=n(49),l=n(47),v=n(7),d=n(1),E=n(2),w=v.W.uf,p=v.W.af,g=v.W.ff,b=(y.prototype.init=function(t,i,n,r,s){try{g?this.EZ(!1):n?this.EZ(!1):this.EZ(!0),this.cj.setReportingGuid(this.sb.identity.Sl()),this.cj.wZ(n),this.rw.init(a.Ku.Cache.Fo,a.Ku.Cache.Go);var e=this.Gz.Ej(t,i,s,r&&r.pZ);this.cj.setContextId(this.Gz.P.getContextId());var h=new f.gZ(e);this.sb.SF=h,this.sb.el.SF=h,this.bZ.start(this.Gz,this.jV),(w||u.Framework.O()&&c.VM.GM)&&this.TZ.yZ(this.jV);var o=[this.mZ,this.jV,this.lj,this.bZ,this.sb.el,this.sb.hl,this.Gq];(w||u.Framework.O()&&c.VM.GM)&&o.push(this.TZ),(p||u.Framework.O()&&c.VM.xM)&&o.push(this.OZ),this.Wl.start(this.swarmId,o),this.sb.el.ZF(this.lj),this.sb.el.lF(this.cj),this.cj.SZ(t)}catch(t){throw d.ErrorMonitor.Z().logError("Error initializing swarm object",this.loggerId,E.Zs.ie,t),new Error(t)}},y.prototype.EZ=function(t){t&&"undefined"!=typeof navigator&&navigator.hardwareConcurrency?(this.cj.RZ(navigator.hardwareConcurrency),this.cj._Z(navigator.hardwareConcurrency)):(this.cj.RZ(1),this.cj._Z(1)),this.logger.debug(this.loggerId+"My score "+this.cj._q())},y.prototype.IZ=function(t){return r.sv.MO(t).toString(r.sv.cO.lO)},y.prototype.request=function(t){this.AZ(),this.aj.request(t)},y.prototype.NZ=function(){this.state!==e.Wc.STOP?(this.jV.stop(),this.lj.stop(),this.vj.kZ(),this.vj.CZ(),this.bZ.DZ(),this.TZ&&this.TZ.MZ(),this.sb.ol(e.Wc.IDLE),this.rw.jZ(),this.dj.PZ(),this.aj.LZ(),this.nU.HZ(),u.Framework.clearTimeout(this.requestTimeout)):this.logger.debug("Ignoring changing state from Stop to Idle")},y.prototype.ol=function(t,i){try{if(this.state!=t){switch(this.logger.info("Switching state "+e.Wc[this.state]+" -> "+e.Wc[t]),t){case e.Wc.STOP:this.NZ(),this.Wl.stop(i);break;case e.Wc.IDLE:this.NZ();break;case e.Wc.$c:this.jV.start(),this.lj.start(this.Gz.P),this.vj.UZ(),this.bZ.FZ(),this.TZ&&this.TZ.GZ(),this.sb.ol(e.Wc.$c),this.nU.xZ()}this.state=t}}catch(t){d.ErrorMonitor.Z().logError("Error changing peer status",this.loggerId,E.Zs.ne,t)}},y.prototype.AZ=function(){var t=this;try{u.Framework.clearTimeout(this.requestTimeout),this.ol(e.Wc.$c),this.requestTimeout=u.Framework.setTimeout(function(){t.ol(e.Wc.IDLE)},a.Ku.Vu.yu)}catch(t){d.ErrorMonitor.Z().logError("Error requesting timeout",this.loggerId,E.Zs.Ys,t)}},y);function y(t){this.state=e.Wc.$c,this.requestTimeout=-1;try{this.logger=u.Framework.resolve(u.Framework.p.T).log(t.ticket.sessionId),this.loggerId="[SWARM] ",this.Wl=u.Framework.resolve(u.Framework.p.$l),this.sessionId=t.ticket.sessionId,this.sb=t,this.aj=u.Framework.resolve(u.Framework.p.rD),this.rw=u.Framework.resolve(u.Framework.p.tD),this.jV=u.Framework.resolve(u.Framework.p.vD),this.BZ=u.Framework.resolve(u.Framework.p.sD),this.uj=u.Framework.resolve(u.Framework.p.ED),this.lj=u.Framework.resolve(u.Framework.p.yD),this.uploadScore=u.Framework.resolve(u.Framework.p.AD),this.VZ=u.Framework.resolve(u.Framework.p.ID),this.bZ=u.Framework.resolve(u.Framework.p.DD),this.fj=u.Framework.resolve(u.Framework.p.gD),this.Gz=u.Framework.resolve(u.Framework.p.nD),this.LH=u.Framework.resolve(u.Framework.p._D),this.cj=u.Framework.resolve(u.Framework.p.dD),this.rU=u.Framework.resolve(u.Framework.p.bD),this.vj=u.Framework.resolve(u.Framework.p.OD),this.dj=u.Framework.resolve(u.Framework.p.iD),this.Gq=u.Framework.resolve(u.Framework.p.aD),this.nU=u.Framework.resolve(u.Framework.p.kD),this.qZ=u.Framework.resolve(u.Framework.p.lD),this.mZ=u.Framework.resolve(u.Framework.p.cD),(w||u.Framework.O()&&c.VM.GM)&&(this.QZ=u.Framework.resolve(u.Framework.p.LD),this.TZ=u.Framework.resolve(u.Framework.p.HD)),(p||u.Framework.O()&&c.VM.xM)&&(this.OZ=u.Framework.resolve(u.Framework.p.af)),this.swarmId=this.IZ(t.ticket.Vd()),this.nU.init(this),this.BZ.init(this),this.dj.init(this),this.Gq.init(this),this.lj.init(this),this.VZ.init(this),this.bZ.init(this),this.fj.init(this),this.Gz.init(this),this.aj.init(this),this.jV.init(this),this.rU.init(this),this.vj.init(this),this.LH.init(this),this.qZ.init(this),this.mZ.init(this),(p||u.Framework.O()&&c.VM.xM)&&this.OZ.init(this),(w||u.Framework.O()&&c.VM.GM)&&this.TZ.init(this)}catch(t){throw d.ErrorMonitor.Z().logError("Error constructing swarm object",this.loggerId,E.Zs.te,t),new Error(t)}}i.YZ=b;var T=(m.prototype.start=function(t,i,n,r){this.logger=u.Framework.resolve(u.Framework.p.T).log(t.ticket.sessionId);var s=t.ticket;this.renderStats.init(this,t);var e=s.pluginId;if(this.KZ.has(e))this.logger.warn("SESSION ALREADY ACTIVE "+e);else{l.wM.wd(t.vl.client,s.hM(),t.identity.Sl());var h=new b(t);h.init(s,i,this.WZ,n,r),this.qd.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();i&&h.cj.BG(i)}).done(),t.el.zF(this.qd),this.logger.info("PEER CONTEXT STARTED"),this.KZ.set(e,h),this.$Z.set(h.swarmId,e)}return 1!=this.KZ.length&&!this.XZ||u.Framework.O()||(this.JZ.init(),this.XZ=!1),o.resolve(s.SourceURL)},m.prototype.jz=function(){this.XZ=!0},m.prototype.Gl=function(t){if(this.$Z.has(t)){var i=this.$Z.get(t);return this.KZ.get(i)}return null},m.prototype.Uz=function(t){return this.KZ.get(t)},m.prototype.zZ=function(t){return this.KZ.has(t)?this.KZ.get(t).aj:null},m.prototype.request=function(t,i){this.Uz(i).request(t)},m.prototype.ol=function(t,i){var n=this.Uz(t);n&&(n.ol(i,n.swarmId),i===e.Wc.STOP&&this.KZ["delete"](t))},m.prototype.abort=function(t,i){var n=this.zZ(i);n&&n.abort(t)},m.prototype.Hz=function(t){this.WZ=t},m.prototype.ZZ=function(t,i){this.qd.PG(t)},m);function m(){this.Sv=new s.Counter(),this.KZ=new h(),this.$Z=new h(),this.t0=!1,this.XZ=!1,this.JZ=u.Framework.resolve(u.Framework.p.MD),this.renderStats=u.Framework.resolve(u.Framework.p.SD),this.qd=u.Framework.resolve(u.Framework.p.Jd),this.WZ=!1}i.Vu=T},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.OF=function(){var t=new hive.snapshots.StreamInfo();return t.streamType=this.wj.isLive()?StreamType.LIVE:StreamType.VOD,t.streamProtocol=this.wj.getStreamProtocol(),t.url=this.wj.jB(),t},s);function s(t){this.wj=t}i.gZ=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(4),a=n(24),f=n(6),e=n(5),h=n(0),c=n(8),o=n(6),u=n(1),l=n(2),v=(d.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.p.T).log(t.sessionId),this.uj=t.uj,this.rw=t.rw,this.lj=t.lj,this.el=t.sb.el,this.sessionId=t.sb.ticket.sessionId,this.BZ=t.BZ,this.fj=t.fj,this.i0=t.Gz,this.cj=t.cj,this.dj=t.dj,this.nU=t.nU,this.n0=t.vj,this.el.hF(this.r0)},d.prototype.request=function(t){try{var i=t.url;this.logger.info("HIVE REQ "+i),t.Fp=h.Framework.time();var n=this.i0.s0(t),r=n.e0(t.url);this.nU.h0(r),this.Wj(t,r,n,a.yp.Tp)}catch(t){u.ErrorMonitor.Z().logError("Error on player request",this.loggerId,l.Ks.Ws,t)}},d.prototype.Wj=function(n,t,i,r){var s=this;if(t.Xp()){if(t.Bp()!=c.yf.mf)return this.o0(n,t,i,r);var e=i.NH(t,r);if(e.VH)return this.logger.debug("DO NOT CONTINUE WITH THE REQUEST "+t.qp()+". ALREADY REQUESTED  "+e.HH+" PENDING REQUEST "+e.BH),null;if(e.BH&&r==a.yp.Tp){var h=this.u0(n,t,i,r);return 0<h.length?(h.forEach(function(t){var i=s.a0.get(t);s.a0.set(n.id,i),s.a0["delete"](t)}),null):(this.logger.info("PREFETCH UPGRADE FAILED. THIS SHOULD NOT HAPPEN. CHECK FOR MULTIPLE PLAYER REQUESTS FOR THE SAME FRAGMENT"),this.o0(n,t,i,r))}return this.o0(n,t,i,r)}var o=f.ja.next(),u=new a.fg(n,o,r,t,i);return this.a0.set(n.id,u),u.type=a.yp.mp,this.f0(u),u},d.prototype.o0=function(t,i,n,r){var s=this,e=f.ja.next(),h=new a.fg(t,e,r,i,n);if(this.a0.set(t.id,h),i.Bp()==c.yf.mf&&(n.QH(h),r!==a.yp.Op&&r!==a.yp._p)){var o=i.bitrate,u=this.cj.c0();0!=o&&(this.cj.l0(o),this.n0.Eq(this.cj.gP()||this.cj.rP()),o!=u&&(this.v0=!0,this.d0=0),this.v0&&this.d0++,this.d0==this.E0&&(this.lj.QQ(),this.v0=!1,this.d0=0))}return this.w0(i.qp()).then(function(t){s.nU.p0(h,t),s.g0(h,t),n.YH(h.qp(),h.Qp()),n.XH(i.bitrate)})["catch"](function(){s.b0(i,h),h.Bp()==c.yf.mf&&(n.WH(h),h.type==a.yp.Tp&&s.r0.add(0))}),h},d.prototype.u0=function(t,i,n,r){return n.qH(t,i,r)},d.prototype.w0=function(t){return this.rw.get(t)},d.prototype.b0=function(t,i){this.uj.contains(t.qp())?(this.logger.debug("OBJ IDX CONTAINS "+i.qp()),i.xp()==a.yp.Op&&(i.type=a.yp._p),this.Ip(i)):i.xp()!=a.yp._p?this.f0(i):(u.ErrorMonitor.Z().logError("P2P PREFETCH FAILED BECAUSE OBJECT INDEX DOES NOT CONTAIN REQUEST ENTITY",this.loggerId,{zM:i.qp()}),i.ag.YH(i.qp(),i.Qp()))},d.prototype.LZ=function(){var i=this;this.a0.forEach(function(t){return i.abort(t.ug)})},d.prototype.abort=function(t){if(this.a0.has(t.id)){var i=this.a0.get(t.id);try{var n=i.Qp();this.logger.debug("REQUEST "+n+" ABORTED "),this.fj.eh(n)?this.fj.y0(n):this.BZ.eh(n)&&this.BZ.y0(n),this.a0["delete"](t.id)}catch(t){u.ErrorMonitor.Z().logError("Error occurred while aborting the request",this.loggerId,l.Ks.$s,t)}}},d.prototype.Ip=function(t){t.type==a.yp.Tp&&(t.type=a.yp.Rp),t.type==a.yp._p&&(t.sg=!0),this.fj.request(t)},d.prototype.T0=function(t){if(0!=t.og&&(t.Zp.kp=t.og,this.logger.info("ALREADY DOWNLOADED "+t.Zp.kp+" BYTES"),t.Zp.Cp=t.og),!e.Ku.Uu.$o&&t.og&&(t.Zp.kp=0),this.nU.m0(t),t.type!=a.yp._p)t.type=a.yp.Sp,this.f0(t);else if(t.Bp()==c.yf.mf){t.ag.KH(t.qp()),t.ag.YH(t.qp(),t.Qp());var i=t.Vp;i.bitrate&&t.ag.XH(i.bitrate)}},d.prototype.O0=function(t){var i=this;this.logger.info("SUCCESS FROM P2P FOR "+t.Kp()+" [REQ "+t.Yp+"] ["+a.yp[t.type]+"] AFTER "+t.tg()+" [bw:"+t.ig().Ca()+"]"),this.S0(t),this.R0(t,this.kH(t.type)),this.dj._0(t);var n=this.BZ.I0().Aa();this.nU.A0(t,n),this.N0(t).then(function(){t.ag.iU(t),i.k0()})["finally"](function(){i.kH(t.type)&&i.C0(t),i.a0["delete"](t.ug.id)})},d.prototype.D0=function(t){if(t.type!=a.yp._p)t.type=a.yp.Tp,this.f0(t);else if(t.Bp()==c.yf.mf){t.ag.KH(t.qp()),t.ag.YH(t.qp(),t.Qp());var i=t.Vp;i.bitrate&&t.ag.XH(i.bitrate)}},d.prototype.f0=function(t){this.nU.M0(t),this.BZ.request(t)},d.prototype.j0=function(t){this.k0();var i=this.BZ.I0().Aa();this.nU.P0(t,i),t.Bp()==c.yf.mf&&(t.ag.KH(t.qp()),t.ag.YH(t.qp(),t.Qp())),this.L0(t)},d.prototype.H0=function(t){var i=this;this.S0(t),this.R0(t,this.kH(t.type)),t.type==a.yp.Sp&&this.logger.debug("CDN COMPENSATION TIME "+(t.Zp.Up-t.ug.Fp)+" / "+(t.Zp.Up-t.Zp.Pp)+" P2P TIME "+(t.Zp.Hp-t.Zp.Lp)),-1==[c.yf.Of,c.yf.Sf].indexOf(t.Bp())&&this.dj._0(t);var n=this.BZ.I0().Aa();this.nU.U0(t,n),this.N0(t).then(function(){t.Bp()==c.yf.Of&&t.ag.F0(t),-1==[c.yf.Of,c.yf.Sf].indexOf(t.Bp())&&t.ag.iU(t),i.k0()})["catch"](function(t){i.logger.error(t)})["finally"](function(){i.kH(t.type)&&i.C0(t),i.a0["delete"](t.ug.id)})},d.prototype.S0=function(t){t.type==a.yp._p&&(t.Zp.p2pAgenTrafficSuccessQt=t.Zp.kp),t.type==a.yp.Op&&(t.Zp.jp=t.Zp.Mp,t.rg&&(t.Zp.srcOtherRespQt=t.Zp.Mp)),t.Zp.Np=t.Zp.Mp+t.Zp.kp,t.ug.total=t.Zp.Np},d.prototype.R0=function(t,i){if(this.G0(t),t.ug.total=t.size,i){var n=f.createEvent(ProgressEvent,"progress",{lengthComputable:!0,total:t.Zp.Np,loaded:t.Zp.Np,currentTarget:t.ug});t.ug.dispatchEvent(n),t.Vp.XM()||(t.ug.response=t.x0,t.ug.responseText=t.x0)}},d.prototype.C0=function(t){var i=t.ug,n=h.Framework.O()?i.total:t.hg?t.hg.byteLength:0;this.logger.info("RESPOND TO THE PLAYER "+t.qp()+" SIZE "+n),i.status=200,i.statusText="OK",i.readyState=4,"string"==typeof i.response&&"arraybuffer"===i.responseType&&(i.response=f.Wa(i.response)),"text"!=i.responseType&&""!=i.responseType&&delete i.responseText,t.Vp.XM()&&(i.response=h.Framework.O()?null:f.La(t.hg));var r=f.createEvent(Event,"readystatechange",{currentTarget:i}),s=f.createEvent(ProgressEvent,"load",{bubbles:!1,cancelable:!1,lengthComputable:!1,total:n,currentTarget:i,loaded:n}),e=f.createEvent(ProgressEvent,"loadend",{bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:n,total:0,currentTarget:i});i.dispatchEvent(r),i.dispatchEvent(s),i.dispatchEvent(e)},d.prototype.L0=function(t){this.a0["delete"](t.ug.id);var i=t.ug,n={bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:i.total,total:0,currentTarget:i};t.xhr.status&&0<t.xhr.status?(i.status=t.xhr.status,i.eg=t.eg):i.status=404,i.readyState=4,i.dispatchEvent(f.createEvent(Event,"readystatechange",n)),i.dispatchEvent(f.createEvent(ProgressEvent,"load",n)),i.dispatchEvent(f.createEvent(ProgressEvent,"loadend",n))},d.prototype.N0=function(t){var i=this;return t.Vp.Xp()?this.rw.put(t).then(function(){return i.lj.B0(t.Vp,t.Zp.Np,t.mU)})["catch"](function(t){s.resolve(!0)}):s.resolve(!0)},d.prototype.g0=function(t,i){var n=this;t.hg=i.data,t.eg=i.headers,t.V0=i.V0,t.Zp=i.Zp,t.size=i.length;var r=t.ag.q0().eV(i.length);this.logger.info("SCHEDULE DELIVERY OF "+t.qp()+" IN "+r+" SIZE "+(h.Framework.O()?i.length:t.hg.byteLength)+" BYTES"),h.Framework.setTimeout(function(){n.Q0(t)},r)},d.prototype.Q0=function(t){this.logger.debug("DELIVERY OF "+t.qp()),this.R0(t,!0),this.a0["delete"](t.ug.id);var i=t.ug.Fp-t.Zp.Up;this.logger.info("FRAGMENT PREFETCHED "+i+" MSECS BEFORE PLAYER REQUEST"),0<i&&t.Bp()==c.yf.mf&&this.r0.add(i);var n=0;n=0<t.Zp.Lp?t.ug.Fp-t.Zp.Lp:t.ug.Fp-t.Zp.Hp,this.logger.info("FRAGMENT REQUESTED "+n+" MSECS BEFORE PLAYER REQUEST"),this.C0(t)},d.prototype.kH=function(t){return t!=a.yp._p&&t!=a.yp.Op},d.prototype.G0=function(t){if(t.type!==a.yp.Sp)t.eg=t.ug.eg=t.eg;else{var i="\nContent-Range: bytes=0-"+(t.size-1)+"/"+t.size+"\n";i+="Content-Length: "+t.size+"\n",t.eg=t.ug.eg=i}null==t.eg?t.eg="access-control-allow-origin: *":-1==t.eg.toLowerCase().indexOf("access-control-allow-origin")&&(t.eg=t.eg.trim()+"\naccess-control-allow-origin: *\n")},d.prototype.k0=function(){h.Framework.O()||this.renderStats.render()},d);function d(){this.a0=new r(),this.v0=!1,this.d0=0,this.loggerId="[HiveCache] ",this.E0=5,this.renderStats=h.Framework.resolve(h.Framework.p.SD),this.r0=new o.ha()}i.Yz=v},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(32),o=n(48),u=n(159),a=n(163),r=n(0),s=(e.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.p.T).log(t.sessionId),this.MV=t,this.lj=t.lj},e.prototype.Ej=function(t,i,n,r){var s=null,e=t.rM();return o.HLS.GA(e,this.logger,r?r.hls:void 0)?this.P=s=new a.j(t,i,this.MV,r?r.hls:void 0):h.DASH.GA(e,this.logger,r?r.dash:void 0)?this.P=s=new u.j(t,this.MV,n):this.logger.warn("COULD NOT FIND A CONTEXT FOR "+e),null!=s&&this.Y0(this.P),s},e.prototype.Y0=function(i){var n=this;null!=this.lj?this.lj.stop().then(function(t){n.lj.start(i)}):this.lj.start(i)},e.prototype.s0=function(t){if(null==this.P)this.logger.warn("FIRST REQUEST, COULD NOT FIND RIGHT CONTEXT "+t.url);else if(!this.P.K0(t))return this.logger.warn("REQUEST DOES NOT BELONG TO THE CURRENT CONTEXT "+t.url),null;return this.P},e);function e(){this.lj=null,this.Wl=r.Framework.resolve(r.Framework.p.$l)}i.Kz=s},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(60),o=n(32),u=n(162),c=n(8),l=n(50),a=n(34),f=n(0),v=n(1),d=n(2),E=n(6),w=n(91),p=(e=h.eU,s(g,e),g.prototype.mP=function(){return this.ticket},g.prototype.getStreamProtocol=function(){return StreamProtocol.DASH},g.prototype.jB=function(){return this.W0},g.prototype.Ux=function(){return this.$0.Ux()},g.prototype.isLive=function(){return this.$0.isLive()},g.prototype.q0=function(){return this.X0},g.prototype.Xp=function(t){var i=this.Bp(t);if(i==c.yf.mf||i==c.yf.Tf)return!0},g.prototype.Bp=function(i){try{if(o.DASH.xA(i,void 0,this.sU))return c.yf.Of;if(this.gB(i))return c.yf.Sf;var t=this.$0.EB(i);return null!=t?t.type:-1!=i.indexOf("audio")?c.yf.Tf:c.yf.Sf}catch(t){return v.ErrorMonitor.Z().logError("Error getting the entity type based on a url",this.loggerId,d.Mn.jn,{detailedError:t,url:i}),c.yf.Sf}},g.prototype.e0=function(i){var t=c.yf.Sf,n=0,r=0,s=0,e=!0,h=!1,o=0;try{if(t=this.Bp(i),this.gB(i))e=!0;else if(t!=c.yf.Of){var u=this.$0.EB(i);if(null!=u){n=u.duration,r=u.bitrate,s=u.id,h=this.Xp(i);var a=this.$0.pB(i)/1e3;o=Math.round(n/a)}else{this.Xj(),this.logger.warn("could not extract segment info for "+i);var f=this.$0.dB(i);f?(this.logger.warn("representation is",f),this.logger.warn("representation holds",f.iB.map(function(t,i){return i+" => "+t.id}))):this.logger.warn("no representation found for "+i)}}else e=!1;return new l.ZM(i,t,e,s,o,r,h,this.getContextId())}catch(t){return v.ErrorMonitor.Z().logError("Error getting the entity characteristics based on a url",this.loggerId,d.Mn.Pn,{detailedError:t,url:i}),new l.ZM(i,c.yf.Sf,!1,0,0,0,!1,this.getContextId())}},g.prototype.Zj=function(i){try{var t=i.url,n=this.$0.bB(t);return null!=n?this.e0(n.TH):null}catch(t){return v.ErrorMonitor.Z().logError("Error getting the next entity",this.loggerId,d.Mn.Ln,{detailedError:t,url:i.url}),null}},g.prototype.iP=function(){return e.prototype.RH.call(this,o.DASH.XA,o.DASH.JA)},g.prototype.K0=function(i){try{var t=i.url,n=E.Ya(t);return E.Ya(this.$0.jB()),n===E.Ya(this.W0)||!(null==this.$0||!this.$0.gB(t))||!(o.DASH.xA(t,this.logger,this.sU)&&this.$0.jB()!==t&&!o.DASH.QA(this.$0.jB(),t))}catch(t){return v.ErrorMonitor.Z().logError("Error identifying if is current context",this.loggerId,d.Mn.Hn,{detailedError:t,url:i.url}),!1}},g.prototype.F0=function(i){try{this.J0=f.Framework.time();var t=i.x0,n=i.ug.url,r=this.$0.parse(n,t,i.ug.internal);this.z0.wV(),i.ug.responseText=r,i.ug.response=r,this.Z0()}catch(t){v.ErrorMonitor.Z().logError("Error parsing received metadata",this.loggerId,d.Mn.Un,{detailedError:t,url:i.ug.url}),i.x0&&(i.ug.responseText=i.x0,i.ug.response=i.x0)}try{this.SH.Uj()}catch(t){v.ErrorMonitor.Z().logError("Error starting prefetcher after fetching metadata",this.loggerId,d.Mn.Fn,{detailedError:t,url:i.ug.url})}this.t1()},g.prototype.iU=function(i){var n=this;try{e.prototype.iU.call(this,i),i.Bp()!==c.yf.mf&&i.Bp()!==c.yf.Tf||(i.Bp()===c.yf.mf&&this.X0.uV(i),this.$0.iU(i).then(function(t){t&&n.t1(),i.Bp()==c.yf.mf&&n.SH.kj(i.Vp)}).done())}catch(t){v.ErrorMonitor.Z().logError("Error when received a fragment",this.loggerId,d.Mn.Gn,t)}},g.prototype.getContextId=function(){return this.ticket.oM()},g.prototype.NH=function(t,i){var n=t;return n.IH=f.Framework.time(),e.prototype.NH.call(this,n,i)},g.prototype.oP=function(t,i,n,r){return this.$0.oP(t,i,n,r)},g.prototype.gB=function(t){return this.$0.gB(t)},g.prototype.t1=function(){var n=this;try{this.$0.fB?this.$0.fB.K$().then(function(t){if(t)n.i1=!0,n.logger.debug("Protection evaluation: can decrypt");else{var i="Protection evaluation: cannot decrypt ["+(o.DASH.iN?"error":"disabled")+"]";o.DASH.nN?(n.i1=!0,n.logger.debug(i+", metadata prefetch enabled")):n.logger.warn(i+", metadata prefetch DISABLED")}}).done():this.logger.debug("Protection evaluation: not encrypted")}catch(t){if(v.ErrorMonitor.Z().logError("Error evaluating the protection",this.loggerId,d.Mn.xn,t),o.DASH.nN){var i="Protection evaluation: cannot decrypt ["+(o.DASH.iN?"error":"disabled")+"]";this.i1=!0,this.logger.debug(i+", metadata prefetch enabled")}}},g.prototype.Xj=function(){this.i1&&(null==this.n1&&this.$0.isLive()?this.s1():this.logger.debug("DASH PRE-FETCHING METADATA ALREADY SCHEDULED OR NOT LIVE"))},g.prototype.Z0=function(){this.i1&&null!=this.n1&&(f.Framework.clearTimeout(this.n1),this.n1=null)},g.prototype.s1=function(){var t=this,i=(null!=this.J0?this.J0:0)+o.DASH.zA,n=Math.max(1,i-f.Framework.time()+o.DASH.rN);this.logger.debug("DASH PREFETCHING METADATA "+this.$0.jB()+" IN "+n),this.n1=f.Framework.setTimeout(function(){t.e1(t.$0.jB(),f.Framework.time())},n)},g.prototype.e1=function(t,i){var n=this.J0;if(null==n&&(n=0),i<n&&this.s1(),this.$0&&this.$0.Zx)this.n1=null,this.J0=f.Framework.time();else{var r=new a.HiveRequest(this.ticket.pluginId);r.open("GET",t),r.internal=!0,r.send(),this.n1=null,this.J0=f.Framework.time()}},g.prototype.Fz=function(t){this.$0.authenticationToken=t},g.prototype.eP=function(t,i){try{var n=this.Tj(),r=this.zH(),s=n.KM(),e=this.$0.oP(s,n.bitrate,t,i),h=f.Framework.time()-r;return Math.max(0,e-h)}catch(t){return v.ErrorMonitor.Z().logError("Error calculating the distance duration",this.loggerId,d.Mn.Bn,t),0}},g.prototype.yB=function(t,i){return this.$0.yB(t,i)},g.prototype.h1=function(){return o.DASH.tN},g.prototype.Lj=function(t,i,n){var r=this.$0.wB(t,i);return null!=r?new l.ZM(r.TH,n,!0,t,r.duration,i,!0,this.getContextId()):null},g.prototype.hP=function(){return o.DASH.ZA},g);function g(t,i,n,r){var s=e.call(this,i,r)||this;return s.Sv=0,s.i1=!0,s.loggerId="[Dash Context] ",s.ticket=t,s.W0=t.eM(),s.X0=new u.o1(i.cj),s.$0=o.DASH.KA(s.W0,i.sessionId,n),s.z0=new w.mV(s.$0),s}i.j=p},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.HH=!1,this.BH=!1,this.VH=!1}i.jH=r},function(t,i,n){"use strict";t.exports=h;n(10);var r=n(11),s=n(12),e=n(39);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);Array.isArray(t)?t=(this.tR=t).splice(0,t.length):this.tR=[],this.ke=i||Object.Ae,this.Hf=n||Object.compare,this.De=r||Function.Ne,this.length=0,this.hiveAddEach(t)}function o(t,i,n){for(var r=0,s=t.length-1;r<=s;){var e=r+s>>1,h=n(i,t[e]);if(0<h)r=1+e;else{if(!(h<0))return e;s=e-1}}return-(r+1)}function u(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;0<s&&r(i,t[s-1]);)s--;return r(i,t[s])?s:-1}function a(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;s<t.length-1&&r(i,t[s+1]);)s++;return r(i,t[s])?s:-1}h.u1=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.hU=!0,h.prototype.je=function(t){return new this.constructor(t,this.ke,this.Hf,this.De)},h.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");var n=o(this.tR,t,this.Hf);return 0<=n&&this.ke(this.tR[n],t)},h.prototype.get=function(t,i){if(i)throw new Error("SortedArray#get does not support second argument: equals");var n=u(this.tR,t,this.Hf,this.ke);return-1!==n?this.tR[n]:this.De(t)},h.prototype.hiveAdd=function(t){var i=function(t,i,n){var r=o(t,i,n);if(r<0)return-r-1;for(var s=t.length-1;r<s&&0===n(i,t[r+1]);)r++;return r}(this.tR,t,this.Hf);return this.BC&&this.KC([t],[],i),this.tR.splice(i,0,t),this.length++,this.BC&&this.qC([t],[],i),!0},h.prototype["delete"]=function(t,i){if(i)throw new Error("SortedArray#delete does not support second argument: equals");var n=u(this.tR,t,this.Hf,this.ke);return-1!==n&&(this.BC&&this.KC([],[t],n),this.tR.splice(n,1),this.length--,this.BC&&this.qC([],[t],n),!0)},h.prototype.ZC=function(t,i){if(i){var n=this.tR.ZC(t,i);return this.length-=n,n}var r=u(this.tR,t,this.Hf,this.ke);if(-1===r)return 0;for(var s=r;this.ke(t,this.tR[s]);)s++;var e=this.slice(r,s);return this.BC&&this.KC([],e,r),this.tR.splice(r,e.length),this.length-=e.length,this.BC&&this.qC([],e,r),e.length},h.prototype.indexOf=function(t){return u(this.tR,t,this.Hf,this.ke)},h.prototype.lastIndexOf=function(t){return a(this.tR,t,this.Hf,this.ke)},h.prototype.find=function(t,i,n){if(i)throw new Error("SortedArray#find does not support second argument: equals");if(n)throw new Error("SortedArray#find does not support third argument: index");return u(this.tR,t,this.Hf,this.ke)},h.prototype.findLast=function(t,i,n){if(i)throw new Error("SortedArray#findLast does not support second argument: equals");if(n)throw new Error("SortedArray#findLast does not support third argument: index");return a(this.tR,t,this.Hf,this.ke)},h.prototype.push=function(){this.hiveAddEach(arguments)},h.prototype.unshift=function(){this.hiveAddEach(arguments)},h.prototype.pop=function(){var t=this.tR.pop();return this.length=this.tR.length,t},h.prototype.shift=function(){var t=this.tR.shift();return this.length=this.tR.length,t},h.prototype.slice=function(){return this.tR.slice.apply(this.tR,arguments)},h.prototype.splice=function(t,i){return this.GP(t,i,Array.prototype.slice.call(arguments,2))},h.prototype.GP=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=this.slice(t,t+i);return this.BC&&this.KC(n,r,t),this.tR.splice(t,i),this.length-=r.length,this.BC&&this.qC([],r,t),this.hiveAddEach(n),r},h.prototype.reduce=function(r,t){var s=arguments[2];return this.tR.reduce(function(t,i,n){return r.call(s,t,i,n,this)},t,this)},h.prototype.reduceRight=function(){var r=arguments[2];return this.tR.reduceRight(function(t,i,n){return callback.call(r,t,i,n,this)},basis,this)},h.prototype.min=function(){if(this.length)return this.tR[0]},h.prototype.max=function(){if(this.length)return this.tR[this.length-1]},h.prototype.qf=function(){return this.tR.qf()},h.prototype.clear=function(){var t;this.BC&&(t=this.tR.slice(),this.KC([],t,0)),this.length=0,this.tR.clear(),this.BC&&this.qC([],t,0)},h.prototype.Ae=function(t,i){return this.tR.Ae(t,i)},h.prototype.compare=function(t,i){return this.tR.compare(t,i)},h.prototype.Qf=function(t,i){return new this.Iterator(this.tR,t,i)},h.prototype.toJSON=function(){return this.toArray()},h.prototype.Iterator=Array.prototype.Iterator},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(90),o=(e=h.vV,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.o1=o},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(60),u=n(48),a=n(164),f=n(0),c=n(34),l=n(8),v=n(50),d=n(30),E=n(1),w=n(2),p=n(91),g=(e=o.eU,s(b,e),b.prototype.getStreamProtocol=function(){return StreamProtocol.HLS},b.prototype.a1=function(t){var i=t.lastIndexOf("/");return t.substr(0,i)},b.prototype.mP=function(){return this.ticket},b.prototype.Ux=function(){return this.f1.Ux()},b.prototype.isLive=function(){return this.f1.isLive()},b.prototype.q0=function(){return this.X0},b.prototype.getContextId=function(){return this.ticket.oM()},b.prototype.jB=function(){return this.W0},b.prototype.K0=function(i){try{var t=i.url=this.c1(i.url);return t===this.W0?(this.l1&&this.logger.debug("SAME MANIFEST "+t+","+this.W0),!0):null!=this.f1&&this.f1.m$(t)?(this.l1&&this.logger.debug("CORRECT PLAYLIST "+t+","+this.W0),!0):null!=this.f1&&null!=this.f1.EB(t)?(this.l1&&this.logger.debug("CORRECT SEGMENT "+t+","+this.W0),!0):(u.HLS.xA(t,this.logger,this.sU)&&this.f1.jB()!==t&&this.l1&&this.logger.debug("FIRST REQUEST FOR MANIFEST "+t+","+this.W0),!1)}catch(t){return E.ErrorMonitor.Z().logError("Error getting the current context of the HiveRequest",this.loggerId,w.hr.Hn,{detailedError:t,url:i.url}),!1}},b.prototype.c1=function(t){return d(t).om().toString()},b.prototype.Bp=function(i){try{return u.HLS.xA(i,void 0,this.sU)?l.yf.Of:null!=this.f1.EB(i)?l.yf.mf:l.yf.Sf}catch(t){return E.ErrorMonitor.Z().logError("Error getting the entityType",this.loggerId,w.hr.jn,{detailedError:t,url:i}),l.yf.Sf}},b.prototype.Xp=function(t){var i=this.Bp(t);if(i==l.yf.mf||i==l.yf.Tf)return!0},b.prototype.e0=function(i){var t=0,n=0,r=0,s=!0,e=!1;try{var h=this.Bp(i);if(h!=l.yf.Of){var o=this.f1.EB(i);null!=o&&(t=o.duration,n=o.bitrate,r=o.id,e=this.Xp(i))}else s=!1,null!=this.f1&&this.f1.T$.has(i)&&(n=this.f1.T$.get(i).bitrate,this.J0.set(n,f.Framework.time()));return new v.ZM(i,h,s,r,t,n,e,this.getContextId())}catch(t){return E.ErrorMonitor.Z().logError("Error getting the entityCharacteristics from the url",this.loggerId,w.hr.Pn,{detailedError:t,url:i}),new v.ZM(i,l.yf.Sf,!1,0,0,0,!1,this.getContextId())}},b.prototype.Lj=function(t,i,n){var r=this.f1.wB(t,i);return null!=r?new v.ZM(r.TH,n,!0,t,r.duration,i,!0,this.getContextId()):null},b.prototype.F0=function(i){try{var t=i.x0,n=i.Kp(),r=this.f1.parse(n,t);if(this.z0.wV(),this.f1.T$.has(n)){var s=this.f1.T$.get(n);this.SH.Uj(s.bitrate)}i.ug.response=r,i.ug.responseText=r}catch(t){E.ErrorMonitor.Z().logError("Error receiving the metadata",this.loggerId,w.hr.ur,{detailedError:t,url:i.Kp()}),i.x0&&(i.ug.responseText=i.x0,i.ug.response=i.x0)}},b.prototype.iU=function(t){e.prototype.iU.call(this,t),t.Bp()!=l.yf.Of&&t.Bp()!=l.yf.Sf&&(this.X0.uV(t),t.Bp()==l.yf.mf&&this.SH.kj(t.Vp))},b.prototype.NH=function(t,i){var n=t;return n.IH=f.Framework.time(),e.prototype.NH.call(this,n,i)},b.prototype.Xj=function(t){u.HLS.RM&&(null==this.n1.get(t)&&this.f1.isLive()?this.s1(t):this.logger.debug("HLS PRE-FETCHING METADATA ALREADY SCHEDULED OR MISSING HLS INFO"))},b.prototype.s1=function(t){var i=this;try{var n=this.f1.y$.get(t);if(null!=n){var r=this.J0.has(t),s=this.J0.get(t),e=(r?s:0)+(null!=n._$?n._$[n._$.length-1].duration:u.HLS.OM),h=Math.max(1,e-f.Framework.time()+u.HLS.SM);this.logger.info("HLS PREFETCHING METADATA "+n.TH+" BITRATE "+t+" IN "+h);var o=f.Framework.setTimeout(function(){i.e1(t,n.TH,f.Framework.time())},h);this.n1.set(t,o)}else this.logger.warn("NO STREAM WITH BT "+t)}catch(t){E.ErrorMonitor.Z().logError("Error scheduling metadata prefetch",this.loggerId,w.hr.ar,t)}},b.prototype.e1=function(t,i,n){var r=this.J0.get(t);if(null==r&&(r=0),n<r)this.s1(t);else{var s=new c.HiveRequest(this.ticket.pluginId);s.open("GET",i),s.internal=!0,s.send(),this.n1["delete"](t),this.J0.set(t,f.Framework.time())}},b.prototype.Z0=function(){var n=this;this.n1.keys().forEach(function(t){var i=n.n1.get(t);f.Framework.clearTimeout(i),n.n1["delete"](t)})},b.prototype.iP=function(){return e.prototype.RH.call(this,u.HLS.yM,u.HLS.TM)},b.prototype.Zj=function(t){try{var i=t.url,n=this.f1.bB(i);return null!=n?this.e0(n.TH):null}catch(t){return E.ErrorMonitor.Z().logError("Error getting the next entity",this.loggerId,w.hr.Ln,t),null}},b.prototype.oP=function(t,i,n,r){return n-t},b.prototype.hP=function(){return u.HLS.mM},b.prototype.h1=function(){return u.HLS._M},b.prototype.Fz=function(t){},b.prototype.eP=function(t,i){try{var n=this.Tj(),r=this.zH(),s=n.KM(),e=0;if(s<t)for(var h=this.f1.wB(s,i);h&&h.id<t;)e+=h.duration,h=h.next;var o=f.Framework.time()-r;return Math.max(0,e-o)}catch(t){return E.ErrorMonitor.Z().logError("Error getting the distance duration",this.loggerId,w.hr.Bn,t),0}},b.prototype.yB=function(t,i){return 1},b);function b(t,i,n,r){var s=e.call(this,n,r)||this;return s.l1=!1,s.loggerId="[HLS Context] ",s.Sv=0,s.J0=new h(),s.n1=new h(),s.ticket=t,(s.v1=i)&&(s.d1=s.a1(t.rM())),s.W0=t.eM(),s.X0=new a.E1(n.cj),s.f1=u.HLS.KA(),s.z0=new p.mV(s.f1),s}i.j=g},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(90),o=(e=h.vV,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.E1=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),c=n(4),s=n(0),l=n(166),v=n(92),d=n(167),E=n(1),w=n(2),e=(h.prototype.init=function(t,i){this.w1=t,this.g1=i},h.prototype.put=function(t){var i=c.defer();try{var n=t.qp(),r=t.eg,s=t.hg,e=t.Zp.Np-1,h=t.Zp.Np;-1==this.b1&&this.T1();var o=null,u=!1;if(this.m1.has(n)){o=this.m1.get(n);var a=new v._V(0,e,h);u=!0,o.content.forEach(function(t,i){v.kV.NV(i).RV(a)&&(u=!1)})}else{var f=new v._V(0,e,h).toString();o=new d.O1(t.Vp),t.mU&&(o.V0=t.mU.lP.peerInfo),o.content.set(f,new l.S1(h,s,t.Zp,t.xp())),this.m1.set(n,o),u=!0,this.R1.unshift(n)}null==o.headers&&null!=r&&(o.headers=r),u?i.resolve(!0):i.reject(!1)}catch(t){E.ErrorMonitor.Z().logError("Error adding fragment in LiveCache",this.loggerId,w.hi.ii,t),i.reject("CACHE PUT ERROR "+t)}return i.promise},h.prototype.get=function(t){var i=c.defer();try{var n=this.m1.get(t);if(null!=n){var r=null;n.content.forEach(function(t,i){if(v.kV.NV(i).OV())return(r=t).headers=n.headers,void (r.V0=n.V0)}),i.resolve(r)}else i.reject(!1)}catch(t){E.ErrorMonitor.Z().logError("Error getting fragment from LiveCache",this.loggerId,w.hi.ni,t),i.reject("CACHE GET ERROR "+t)}return i.promise},h.prototype.zj=function(){try{return this.m1.keys()}catch(t){return E.ErrorMonitor.Z().logError("Error getting keys from LiveCache",this.loggerId,w.hi.si,t),[]}},h.prototype._1=function(){var i=c.defer();try{i.resolve(this.m1.values())}catch(t){E.ErrorMonitor.Z().logError("Error getting elements from LiveCache",this.loggerId,w.hi.ei,t),i.reject("CACHE GET ELEMENTS ERROR "+t)}return i.promise},h.prototype.contains=function(t){var i=c.defer();try{this.m1.has(t)?i.resolve(!0):i.resolve(!1)}catch(t){E.ErrorMonitor.Z().logError("Error checking if LiveCache contains the fragment",this.loggerId,w.hi.ri,t),i.reject("CACHE CONTAINS ERROR "+t)}return i.promise},h.prototype.T1=function(){var t=this;this.I1(),this.logger.debug(this.loggerId+"Starting cache periodic purge"),this.b1=s.Framework.setInterval(function(){t.H()},this.g1)},h.prototype.I1=function(){-1!=this.b1&&(this.logger.debug(this.loggerId+" Stopping cache periodic purge"),s.Framework.clearInterval(this.b1),this.b1=-1)},h.prototype.H=function(){var r=this;try{var s=0,e=0,t=0;this.logger.debug(this.loggerId+" RUNNING GC"),this.R1.every(function(t,i){var n=r.m1.get(t).size();return s+n>r.w1?(e=i,!1):(s+=n,!0)})||(t=this.R1.length-e,this.R1.splice(e,this.R1.length-1).forEach(function(t){r.m1["delete"](t)})),this.logger.debug(this.loggerId+" GC DONE - REMOVED: "+t+" - CURRENT ITEMS: "+this.m1.length+" SIZE: "+s+" "),0===this.m1.length&&(this.logger.debug(this.loggerId+" Cache contains no items, stopping purge timer"),this.I1())}catch(t){E.ErrorMonitor.Z().logError("Error purging LiveCache",this.loggerId,w.hi.oi,t)}},h.prototype.jZ=function(){this.m1=new r(),this.R1=[]},h.prototype.A1=function(){var n=this;this.m1.forEach(function(t,i){n.logger.debug("EID="+i),t.content.forEach(function(t,i){n.logger.debug("\tRANGE ",i)})})},h);function h(){this.loggerId="[LIVE CACHE] ",this.m1=new r(),this.b1=-1,this.R1=[],this.logger=s.Framework.resolve(s.Framework.p.T).log()}i.Wz=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.length=t,this.data=i,this.Zp=n,this.N1=r}i.S1=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(92),s=n(3),e=(h.prototype.size=function(){var n=0;return this.content.forEach(function(t,i){n+=r.kV.NV(i).size()}),n},h);function h(t){this.headers=null,this.V0=null,this.totalSize=0,this.C1=!1,this.Vp=t,this.content=new s()}i.O1=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(4),e=n(2),h=n(1),o=(u.prototype.init=function(t,i){try{this.D1.init(t,i)}catch(t){h.ErrorMonitor.Z().logError("Error initializing cache",this.loggerId,e.Zt.ti,t)}},u.prototype.put=function(t){var i=this,n=s.defer();try{this.D1.put(t).then(function(){n.resolve(!0)})["catch"](function(t){t&&h.ErrorMonitor.Z().logError("Error adding new fragment in cache",i.loggerId,e.Zt.ii,t),n.reject(!1)})}catch(t){h.ErrorMonitor.Z().logError("Error adding new fragment in cache",this.loggerId,e.Zt.ii,t),n.reject(!1)}return n.promise},u.prototype.get=function(i){var n=this,r=s.defer();try{this.contains(i).then(function(t){t?n.D1.get(i).then(function(t){r.resolve(t)})["catch"](function(t){t&&h.ErrorMonitor.Z().logError("Error getting the fragment from cache",n.loggerId,e.Zt.ni,t),r.reject(!1)}):r.reject(!1)})["catch"](function(t){t&&h.ErrorMonitor.Z().logError("Error getting the fragment from cache",n.loggerId,e.Zt.ni,t),r.reject(!1)})}catch(t){h.ErrorMonitor.Z().logError("Error getting the fragment from cache",this.loggerId,e.Zt.ni,t),r.reject(!1)}return r.promise},u.prototype.contains=function(t){var i=this,n=s.defer(),r=!1;try{this.D1.contains(t).then(function(t){r=t}).fail(function(t){i.logger.error(t)})["finally"](function(){n.resolve(r)})}catch(t){h.ErrorMonitor.Z().logError("Error checking if cache contains the fragment",this.loggerId,e.Zt.ri,t),n.resolve(!1)}return n.promise},u.prototype.zj=function(){try{return this.D1.zj()}catch(t){return h.ErrorMonitor.Z().logError("Error getting the keys from cache",this.loggerId,e.Zt.si,t),[]}},u.prototype._1=function(){var i=this,n=s.defer(),r=[];try{this.D1._1().then(function(t){r=t}).fail(function(t){i.logger.error(t)})["finally"](function(){n.resolve(r)})}catch(t){h.ErrorMonitor.Z().logError("Error getting the elements from cache ",this.loggerId,e.Zt.ei,t),n.resolve(r)}return n.promise},u.prototype.jZ=function(){this.D1.jZ()},u);function u(){this.loggerId="[CACHE] ",this.logger=r.Framework.resolve(r.Framework.p.T).log(),this.D1=r.Framework.resolve(r.Framework.p.fD)}i.Cache=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(24),e=n(6),u=n(6),a=n(5),f=n(0),c=n(8),l=n(1),v=n(2),h=n(6),o=(d.prototype.init=function(t){this.logger=f.Framework.resolve(f.Framework.p.T).log(t.sessionId),this.M1=t.aj,this.cj=t.cj,this.cj&&(this.ma=this.cj.j1()),this.el=t.sb.el,this.el.fF(this.cF)},d.prototype.request=function(n){var r=this,s=f.Framework.resolve(f.Framework.p.hD),e=!1,h=n.Qp(),o=n.ug,t=n.Kp();n.xhr=s,n.Zp.Hp=f.Framework.time(),this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+n.Vp.toString()+"-"+n.Zp.kp+" ["+c.yf[n.Bp()]+"] TO FALLBACK "),n.Vp.XM()&&(s.responseType="arraybuffer"),this.P1(n.type)&&o.range&&n.Bp()!=c.yf.Of&&s.setRequestHeader("Range","bytes="+o.range),a.Ku.Uu.$o&&this.L1(n.type)&&0!=n.Zp.kp&&(this.logger.info("SET RANGE bytes="+n.Zp.kp+"-"),s.setRequestHeader("Range","bytes="+n.Zp.kp+"-")),o.JB.forEach(function(t){"range"!==t.key.toLowerCase()&&s.setRequestHeader(t.key,t.value)}),o.async&&0<o.timeout&&(s.timeout=o.timeout),o.mimeType&&s.overrideMimeType(o.mimeType),o.withCredentials&&(s.withCredentials=o.withCredentials),s.onloadstart=function(t){var i=u.createEvent(Event,"loadstart",t,o);o.dispatchEvent(i)},s.onabort=function(t){if(!e){var i=u.createEvent(Event,"abort",t,o);o.dispatchEvent(i)}},s.ontimeout=function(t){if(!e){r.error(n,h,10);var i=u.createEvent(ProgressEvent,"timeout",t,o);o.dispatchEvent(i),l.ErrorMonitor.Z().logError("Error on fallback request because of timeout",r.loggerId,v.Qs.Ys)}},s.onreadystatechange=function(t){if(o&&(s.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(o.eg=s.getAllResponseHeaders(),o.status=s.status,o.statusText=s.statusText),s.readyState<XMLHttpRequest.DONE||s.readyState===XMLHttpRequest.DONE&&0===s.status)){o.readyState=s.readyState;var i=u.createEvent(Event,"readystatechange",t,o);o.dispatchEvent(i)}},s.onprogress=function(t){if(!r.L1(n.type)){var i=u.createEvent(ProgressEvent,"progress",t,o);o.dispatchEvent(i),s.total=t.total}n.Zp.Mp=t.total,n.size=t.total},s.onload=function(t){if(e=!0,o.status=s.status,t&&0!=t.total&&(n.Zp.Mp=t.total),n.eg=s.getAllResponseHeaders(),s.status<200||299<s.status)return r.logger.debug("FRL SERVER RETURNED ERROR CODE "+s.status),void r.error(n,h);n.Vp.XM()?r.P1(n.type)?n.hg=s.response:r.L1(n.type)&&(a.Ku.Uu.$o?n.hg=f.Framework.O()?null:u.appendBuffer(n.hg,s.response):n.hg=s.response):n.x0=s.responseText,n.loaded(),r.H1["delete"](h),n.Zp.Up=f.Framework.time(),r.U1(n),r.F1(n),r.M1.H0(n),s=null},s.onerror=function(){e||r.error(n,h)},this.H1.set(h,n),s.open("GET",t,o.async,o.username,o.password),s.send()},d.prototype.error=function(t,i,n){this.el&&-1==a.Ku.ju.vo.indexOf(t.xhr.status)&&(n&&0<n?this.el.tG(n):t.xhr.status&&0<t.xhr.status?this.el.tG(t.xhr.status):this.el.tG(404));var r="COULD NOT DOWNLOAD "+t.Kp()+" status: "+t.xhr.status;t.type==s.yp.Op?this.logger.debug(r):this.logger.warn(r),this.G1(t),this.H1["delete"](i),this.M1.j0(t)},d.prototype.eh=function(t){return this.H1.has(t)},d.prototype.P1=function(t){return t==s.yp.Op||t==s.yp.mp||t==s.yp.Tp},d.prototype.L1=function(t){return t==s.yp.Sp},d.prototype.y0=function(t){var i=this.H1.get(t);this.H1["delete"](t),i&&i.xhr&&i.xhr.abort()},d.prototype.F1=function(t){t.Vp.Bp()==c.yf.mf&&this.cF.add(t.zp()),this.logger.info("SUCCESS FROM FALLBACK FOR "+t.Kp()+" ["+s.yp[t.type]+"]["+t.Zp.Mp+"] AFTER "+t.zp()+" [curr:"+t.ig().Ca()+" avg:"+this.ma.Ca()+"]")},d.prototype.G1=function(t){},d.prototype.I0=function(){return this.ma},d.prototype.U1=function(t){t.Bp()===c.yf.mf&&this.ma._a(t.ig())},d);function d(){this.loggerId="[FallbackRequester] ",this.H1=new r(),this.ma=new e.Ma(),this.cF=new h.ha()}i.$z=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(4);n(62);var u=n(0),e=n(5),a=n(51),f=n(60),o=n(9),r=n(93),c=hive.services.protocol.oU.CustomerKey,l=n(14),s=n(7),v=n(1),d=n(2),E=n(6),w=s.W.af,p=(g.prototype.init=function(t){this.logger=u.Framework.resolve(u.Framework.p.T).log(t.sessionId),this.sessionId=t.sessionId,this.BZ=t.BZ,this.cj=t.cj,this.rU=t.rU,this.n0=t.vj,this.JZ.B1(t.sessionId,this),this.V1=r.CV.DV,this.el=t.sb.el,this.el.uF(this.q1)},g.prototype.start=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.context=t,this.streamId=t.P.getContextId(),this.ticket=t.P.mP(),this.gm=i},g.prototype.Q1=function(t){this.Y1=t},g.prototype.FZ=function(){var t=this;this.DZ(),this.K1=u.Framework.setInterval(function(){t.W1()},e.Ku.Mu.co),this.W1()},g.prototype.DZ=function(){this.K1&&u.Framework.clearInterval(this.K1)},g.prototype.X1=function(){var i=this,n=h.defer(),r=new hive.services.protocol.oU.TrackerRequest(),s=this.context.P,t=s.isLive()?StreamType.LIVE:StreamType.VOD;r.sessionId=this.sessionId;var e=new c();return this.Y1?(e.partnerId=this.Y1.partnerId,e.customerId=this.Y1.customerId):l.HiveConfig.ClientInfo.Rc&&l.HiveConfig.ClientInfo._c?(e.partnerId=l.HiveConfig.ClientInfo.Rc,e.customerId=l.HiveConfig.ClientInfo._c):(e.partnerId=this.ticket.Pd(),e.customerId=this.ticket.Ld()),r.customerKey=e,r.streamType=t,r.contentId=this.cj.getContextId(),this.qd.getConnectivityInfo().then(function(t){i.J1=t.getNetworkChanged().getPrivateIp(),i.cj.BG(i.J1)}).fail(function(t){v.ErrorMonitor.Z().logError("Error getting connectivity info",i.loggerId,d.Or.Rr)})["finally"](function(){try{var t=new hive.snapshots.ConnectivityInfo();t.publicIp=i.UF,t.privateIp=i.J1,r.info=i.z1(t,s),r.query=i.Z1(s,r.info),n.resolve(r)}catch(t){v.ErrorMonitor.Z().logError("Error collecting the data for the tracker request",i.loggerId,d.Or.Ir,t),n.reject("ERROR")}}).done(),n.promise},g.prototype.t2=function(){var t=new Array();return this.V1==r.CV.DV?t.push(hive.services.protocol.oU.uU.Global):this.V1==r.CV.AS?t.push(hive.services.protocol.oU.uU.fU):this.V1==r.CV.nj?t.push(hive.services.protocol.oU.uU.aU):this.logger.warn("Wrong locality mode"),t},g.prototype.Z1=function(t,i){var r=this,s=new hive.services.protocol.oU.TrackerQuery();try{return s.random=e.Ku.xu.fu,i.externalAs&&!this.HF&&(this.HF=i.externalAs),i.internalAs&&!this.i2&&(this.i2=i.internalAs),s.rankings=this.t2(),s.asns=[],0<this.HF&&this.n2(s.asns,hive.services.protocol.oU.cU.External,this.HF,e.Ku.xu.cu),0<this.i2&&(this.n2(s.asns,hive.services.protocol.oU.cU.lU,this.i2,e.Ku.xu.lu),s.watchers=[],t.Ux().forEach(function(t){var i=r.s2(hive.services.protocol.oU.cU.lU,r.i2,t,-1);s.watchers.push({key:i,value:1})}),s.streamers=[],this.cj.PQ().forEach(function(t,i){var n=r.s2(hive.services.protocol.oU.cU.lU,r.i2,i,t.type==a.tj.nj?hive.services.protocol.oU.Af.Cf:-1);s.streamers.push({key:n,value:e.Ku.xu.vu})})),s}catch(t){throw v.ErrorMonitor.Z().logError("Error preparing tracker query",this.loggerId,d.Or.Ar,t),new Error(t)}},g.prototype.s2=function(t,i,n,r){var s=new hive.services.protocol.oU.TrackerBitrateQuery(),e=new hive.services.protocol.oU.TrackerAsQuery();return e.asType=t,e.asn=i,s.bitrate=n,s.asn=e,-1!=r&&s.streamState,s},g.prototype.n2=function(t,i,n,r){var s=new hive.services.protocol.oU.TrackerAsQuery();s.asType=i,s.asn=n,t.push({key:s,value:r})},g.prototype.z1=function(t,i){var r=new hive.services.protocol.oU.TrackerPeerInfo();try{if(u.Framework.O()?r.guid=this.pd:r.guid=btoa(this.pd),r.timestamp=u.Framework.time(),r.nat=void 0,this.cj.cP()&&(r.externalAs=this.cj.cP()),this.cj.fP()&&(r.internalAs=this.cj.fP()),null!=t){r.publicIpString=t.publicIp;var n=new InetAddress();n.address=t.publicIp,r.publicIp=n,r.privateIpString=t.privateIp;var s=new InetAddress();s.address=t.privateIp,r.privateIp=s}var e=Math.round(this.cj.j1().Aa()/8);if(r.bandwidth=isNaN(e)?null:e,!this.cj.rP()&&this.cj.EP()&&w?r.rankValue=1:r.rankValue=this.cj.e2(),this.context.P instanceof f.eU){r.streams=new Array();var h=i.Tj();null!=h&&(r.watchingBitrate=h.bitrate);var o=i.OH();this.cj.PQ().forEach(function(t,i){if(t.YM){var n=new hive.services.protocol.oU.TrackerPeerStreamInfo();switch(n.bitrate=i,t.type){case a.tj.Nf:n.state=hive.services.protocol.oU.Af.kf;break;case a.tj.ij:n.state=hive.services.protocol.oU.Af.Df;break;case a.tj.nj:n.state=hive.services.protocol.oU.Af.Cf}n.delta=o.Fj(t.YM.KM(),i),r.streams.push(n)}})}return r}catch(t){throw v.ErrorMonitor.Z().logError("Error preparing tracker info",this.loggerId,d.Or.kr,t),new Error(t)}},g.prototype.W1=function(){var n=this;this.h2=u.Framework.time(),this.logger.debug(this.loggerId+" PREPARE REQUEST"),this.X1().then(function(t){var i=n.loggerId+"SENDING TRACKER REQUEST [ privateIp:"+t.info.privateIpString+" rank:"+t.info.rankValue+"]";switch(n.o2){case 0:default:n.logger.debug(i);break;case 1:n.logger.debug(i+" "+JSON.stringify(t));break;case 2:n.logger.debug(i,t);break;case 3:n.logger.debug(i+" "+JSON.stringify(t),t)}n.JZ.u2(t)},function(t){v.ErrorMonitor.Z().logError("Error preparing the tracker request",n.loggerId,d.Or.Sr)})["catch"](function(t){v.ErrorMonitor.Z().logError("Error sending tracker request",n.loggerId,d.Or.Cr,t)})},g.prototype.a2=function(t){this.V1=t},g.prototype.f2=function(){var t=Math.max(0,u.Framework.time()-this.h2);0<t&&t<e.Ku.xu.TIMEOUT&&this.q1.add(t)},g.prototype.R0=function(t){var i=this;try{switch(this.f2(),this.o2){case 1:this.logger.debug(this.loggerId+this.context.P.mP()+" Tracker Response: "+JSON.stringify(t));break;case 2:this.logger.debug(this.loggerId+this.context.P.mP()+" Tracker Response: ",t);break;case 3:this.logger.debug(this.loggerId+this.context.P.mP()+" Tracker Response: "+JSON.stringify(t),t)}this.HF=t.peerInfo.externalAs,this.i2=t.peerInfo.internalAs,this.UF=t.peerInfo.publicIpString,this.J1=t.peerInfo.privateIpString,this.cj.HG(this.UF),this.cj.c2(this.i2),this.cj.l2(this.HF),this.qd.jG(this.UF,this.J1,this.i2),this.logger.debug(this.loggerId+"Reporting from tracker public IP:"+this.UF+" private IP: "+this.J1+" ExtAs:"+this.HF+" inAs:"+this.i2),!this.cj.rP()&&this.cj.EP()&&w?this.n0.Eq(!1):this.n0.v2(t.rankings,t.infos);var n=this.d2(t);this.gm.forEach(function(t){return t.QV(n,i.E2)}),this.E2=!1}catch(t){v.ErrorMonitor.Z().logError("Error handling the response",this.loggerId,d.Or.Dr,t)}},g.prototype.d2=function(t){for(var i=[],n=0,r=t.infos;n<r.length;n++){var s=r[n],e=new o.Mf(o.Rf._f,s);i.push(e)}return i},g.prototype.Iq=function(t){},g.prototype.Xd=function(t){this.pd=t,this.logger.info(this.loggerId+"CONNECTED "+this.pd),this.n0.w2(),this.FZ()},g.prototype.Xq=function(){},g);function g(){this.o2=isNaN(l.HiveConfig.DebugLogs.TrackerLogs)?0:l.HiveConfig.DebugLogs.TrackerLogs,this.loggerId="[TRACKER] ",this.HF=0,this.i2=0,this.g2=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{0,4}){5})/,this.E2=!0,this.Wl=u.Framework.resolve(u.Framework.p.$l),this.qd=u.Framework.resolve(u.Framework.p.Jd),this.JZ=u.Framework.resolve(u.Framework.p.MD),this.q1=new E.ha()}i.Jz=p},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(6),h=n(1),o=n(2),u=function(t,i){this.id=t,this.size=i};i.Element=u;var a=(f.prototype.put=function(t,i){try{var n=t.fragmentId,r=t.size;t.bitrate,this.b2.has(n)||(this.b2.set(n,new u(n,r)),this.T2.set(n,new Array())),this.T2.get(n).push(i)}catch(t){throw h.ErrorMonitor.Z().logError("Error adding new have in object index",this.loggerId,o.Xs.Js,t),new Error(t)}},f.prototype.contains=function(t){return this.T2.has(t)},f.prototype.aP=function(t){return this.T2.get(t)},f.prototype.uP=function(t){return this.b2.get(t)},f.prototype.xQ=function(n){var r=this;try{this.T2.forEach(function(t,i){e.Ha(t,n,!1),0===t.length&&(r.T2["delete"](i),r.b2["delete"](i))})}catch(t){h.ErrorMonitor.Z().logError("Error removing haves send from a specific peer",this.loggerId,o.Xs.zs,t)}},f.prototype.A1=function(){var n=this;this.T2.forEach(function(t,i){n.logger.debug("OBJIDX FR "+i+" PS "+t.map(function(t){return t.TQ.la.otherGuid}).reduce(function(t,i){return t+","+i}))})},f);function f(){this.loggerId="[ObjectIndex] ",this.b2=new r(),this.T2=new r(),this.logger=s.Framework.resolve(s.Framework.p.T).log()}i.iZ=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(0),h=n(6),o=n(9),u=n(173),a=n(49),f=n(94),c=n(7),l=n(1),v=n(2),d=c.W.af,E=(w.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.p.T).log(t.sessionId),this.lj=t.lj,this.cj=t.cj,this.qZ=t.qZ,this.m2=t.nU,(d||e.Framework.O()&&a.VM.xM)&&(this.OZ=t.OZ),this.start()},w.prototype.start=function(){this.O2=!0},w.prototype.stop=function(){this.O2=!1},w.prototype.QV=function(t,i){var n=this;try{if(this.O2){var r=[];t.forEach(function(i){var t=null;i.guid!=n.pd&&(i.type==o.Rf._f?t=n.S2(i):d||e.Framework.O()&&a.VM.xM?(t=n.R2(i),n.OZ.PV(i).then(function(){n.lj.Jq(n.DQ.get(i.guid))}).fail(function(t){t&&t!=f.kq.WV&&(n.DQ["delete"](i.guid),l.ErrorMonitor.Z().logError("Error electing lan leader",n.loggerId,v.ai.ci))})):t=n.R2(i)),t&&r.push(t.peerInfo.guid)}),this._2(),this.pb(),i&&this.lj.eQ(i),0<r.length&&this.logger.debug("DISCOVERED NEW "+r.length+"/"+t.length+": ["+r.join(", ")+"]")}}catch(t){l.ErrorMonitor.Z().logError("Error discovering peers",this.loggerId,v.ai.fi,t)}},w.prototype.pb=function(){var t=this.I2.length+this.DQ.length;this.m2.A2(t)},w.prototype._2=function(){try{this.I2.length>s.Ku.Gu.uu&&this.N2(this.I2,s.Ku.Gu.uu),this.DQ.length>=s.Ku.Gu.au&&this.C2(this.DQ)}catch(t){l.ErrorMonitor.Z().logError("Error clearing membership views",this.loggerId,v.ai.li,t)}},w.prototype.N2=function(t,i){for(var n=t.values().sort(function(t,i){return t.peerInfo.timestamp-i.peerInfo.timestamp});t.length>i;){var r=n.splice(0,1)[0];this.lj.zq(r)||t["delete"](r.peerInfo.guid)}},w.prototype.C2=function(t){var i=t.keys()[e.Framework.random()*t.length];t["delete"](i)},w.prototype.R2=function(t){var i=null;try{if(this.I2.has(t.guid)?(i=this.I2.get(t.guid),this.I2["delete"](t.guid),this.DQ.set(t.guid,i)):this.DQ.has(t.guid)&&(i=this.DQ.get(t.guid)),!i)return i=new u.D2(t),this.DQ.set(t.guid,i),i;i.Q1(t)}catch(t){return l.ErrorMonitor.Z().logError("Error adding peer to lan view",this.loggerId,v.ai.vi,t),null}},w.prototype.S2=function(t){var i=null;try{if(this.DQ.has(t.guid))this.R2(t);else{if(!this.I2.has(t.guid))return i=new u.D2(t),this.I2.set(t.guid,i),this.qZ.M2(i),i;(i=this.I2.get(t.guid)).Q1(t),this.qZ.M2(i)}}catch(t){return l.ErrorMonitor.Z().logError("Error adding peer to random view",this.loggerId,v.ai.di,t),null}},w.prototype.hQ=function(t,i){var n=[];try{return this.O2&&(n=d||e.Framework.O()&&a.VM.xM?h.Ga(this.I2.values()):(n=this.I2.values(),this.DQ.forEach(function(t,i){n.push(t)}),h.Ga(n))),t?n:i?n.slice(0,i):n.slice(0,2*s.Ku.Nu.Vh)}catch(t){return l.ErrorMonitor.Z().logError("Error sampling membership",this.loggerId,v.ai.Ei,t),[]}},w.prototype.IQ=function(t){return this.I2.has(t)?this.I2.get(t):this.DQ.has(t)?this.DQ.get(t):null},w.prototype.Xd=function(t){this.logger.info("MEMBERSHIP SERVER CONNECTED"),this.pd=t,this.cj.setId(this.pd)},w.prototype.Xq=function(){},w.prototype.Iq=function(t){this.logger.debug("Peer "+t+" disconnected"),this.I2["delete"](t),this.DQ["delete"](t),this.pb()},w);function w(){this.loggerId="[Membership] ",this.pd=null,this.I2=new r(),this.DQ=new r()}i.Gu=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(9),s=n(174),e=(h.prototype.gQ=function(){return this.peerInfo.type===r.Rf.If},h.prototype.j2=function(t){this.P2=new s.L2([t])},h.prototype.H2=function(){return this.P2},h.prototype.U2=function(){return this.qZ},h.prototype.F2=function(t){isNaN(t)||(this.qZ=t)},h.prototype.Q1=function(t){this.peerInfo.type==r.Rf._f&&t.type==r.Rf.If?this.peerInfo.type=r.Rf.If:this.peerInfo.type==r.Rf._f&&t.type==r.Rf._f||this.peerInfo.type==r.Rf.If&&t.type==r.Rf.If?this.G2(this.peerInfo,t):this.peerInfo.type==r.Rf.If&&t.type==r.Rf._f&&(this.G2(this.peerInfo,t),this.peerInfo.type=r.Rf.If)},h.prototype.WQ=function(t){this.peerInfo.watchingBitrate=t},h.prototype.G2=function(t,i){t.internalAs=this.B2(t.internalAs,i.internalAs),t.externalAs=this.B2(t.externalAs,i.externalAs),t.nat=this.B2(t.nat,i.nat),t.bandwidth=this.B2(t.bandwidth,i.bandwidth),t.watchingBitrate=this.B2(t.watchingBitrate,i.watchingBitrate),t.privateIpString=this.B2(t.privateIpString,i.privateIpString),t.publicIpString=this.B2(t.publicIpString,i.publicIpString),t.rankValue=this.B2(t.rankValue,i.rankValue),t.timestamp=this.B2(t.timestamp,i.timestamp),i.isLeader&&(t.isLeader=this.B2(t.isLeader,i.isLeader)),i.streams&&(t.streams=i.streams)},h.prototype.B2=function(t,i){return t?i&&t!=i&&(t=i):i&&(t=i),t},h);function h(t){this.qZ=0,this.peerInfo=t}i.D2=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(c.prototype.V2=function(){return this.q2||this.Q2(),this.q2},c.prototype.Q2=function(){for(var t=[],i=0;i<this.columns;i++){for(var n=[],r=0;r<this.rows;r++)n.push(this.matrix[r][i]);t.push(n)}this.q2=new c(t)},c.prototype.Y2=function(t){for(var i=t.K2(),n=[],r=0;r<this.rows;r++){for(var s=[],e=0;e<this.columns;e++){var h=this.matrix[r][e]/i[r][e];s.push(h||0)}n.push(s)}return new c(n)},c.prototype.multiply=function(t){for(var i=t.K2(),n=t.W2(),r=t.X2(),s=[],e=0;e<this.rows;e++){for(var h=this.matrix[e],o=[],u=0;u<r;u++){for(var a=0,f=0;f<n;f++)a+=h[f]*i[f][u];o.push(a)}s.push(o)}return new c(s)},c.prototype.J2=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]*t);i.push(r)}return new c(i)},c.prototype.z2=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]+t);i.push(r)}return new c(i)},c.prototype.Z2=function(){for(var t=[],i=0;i<this.rows;i++){for(var n=[],r=0;r<this.columns;r++)n.push(Math.exp(this.matrix[i][r]));t.push(n)}return new c(t)},c.prototype.t3=function(t){for(var i=[],n=0;n<this.rows;n++){var r=this.matrix[n];i.push([t]);for(var s=0;s<r.length;s++)i[n].push(r[s])}return new c(i)},c.prototype.K2=function(){return this.matrix},c.prototype.W2=function(){return this.rows},c.prototype.X2=function(){return this.columns},c);function c(t){this.matrix=[],this.rows=0,this.columns=0,this.matrix=t,this.rows=this.matrix.length,this.columns=this.matrix[0].length}i.L2=r},function(s,e,l){(function(i){var t,n,r;n=[l(35)],void 0===(r="function"==typeof (t=function(T,t){"use strict";var s={};return s.i3=T,s.bN=T.bN||null,s.VERSION="4.1.3",s.n3={},s.n3.r3=0,s.n3.s3=1,s.n3.e3=2,s.n3.h3=3,s.n3.o3=4,s.n3.u3=5,s.a3=[s.n3.r3,s.n3.s3,s.n3.u3],s.f3={int32:{name:"int32",c3:s.n3.r3,defaultValue:0},uint32:{name:"uint32",c3:s.n3.r3,defaultValue:0},sint32:{name:"sint32",c3:s.n3.r3,defaultValue:0},int64:{name:"int64",c3:s.n3.r3,defaultValue:s.bN?s.bN.ZERO:void 0},uint64:{name:"uint64",c3:s.n3.r3,defaultValue:s.bN?s.bN.l3:void 0},sint64:{name:"sint64",c3:s.n3.r3,defaultValue:s.bN?s.bN.ZERO:void 0},bool:{name:"bool",c3:s.n3.r3,defaultValue:!1},"double":{name:"double",c3:s.n3.s3,defaultValue:0},string:{name:"string",c3:s.n3.e3,defaultValue:""},bytes:{name:"bytes",c3:s.n3.e3,defaultValue:null},fixed32:{name:"fixed32",c3:s.n3.u3,defaultValue:0},sfixed32:{name:"sfixed32",c3:s.n3.u3,defaultValue:0},fixed64:{name:"fixed64",c3:s.n3.s3,defaultValue:s.bN?s.bN.l3:void 0},sfixed64:{name:"sfixed64",c3:s.n3.s3,defaultValue:s.bN?s.bN.ZERO:void 0},"float":{name:"float",c3:s.n3.u3,defaultValue:0},"enum":{name:"enum",c3:s.n3.r3,defaultValue:0},message:{name:"message",c3:s.n3.e3,defaultValue:null},group:{name:"group",c3:s.n3.h3,defaultValue:null}},s.v3=[s.f3.int32,s.f3.sint32,s.f3.sfixed32,s.f3.uint32,s.f3.fixed32,s.f3.int64,s.f3.sint64,s.f3.sfixed64,s.f3.uint64,s.f3.fixed64,s.f3.bool,s.f3.string,s.f3.bytes],s.d3=1,s.E3=536870911,s.w3=!1,s.g3=!0,s.b3=!0,s.s_=function(){var s={};return s.y3=!("object"!=typeof i||i+""!="[object process]"||i.yC),s.T3=function(){for(var t=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=null,n=0;n<t.length;n++){try{i=t[n]()}catch(t){continue}break}if(!i)throw Error("XMLHttpRequest is not supported");return i},s.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),s.y3){var i=l(20);if(n)i.m3(t,function(t,i){n(t?null:""+i)});else try{return i.O3(t)}catch(t){return null}}else{var r=s.T3();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},s.S3=function(t){return t.replace(/_([a-zA-Z])/g,function(t,i){return i.toUpperCase()})},s}(),s.Lang={R3:/[\s\{\}=;:\[\],'"\(\)<>]/g,_3:/^(?:required|optional|repeated|map)$/,kL:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,SL:/^[a-zA-Z_][a-zA-Z_0-9]*$/,I3:/^[a-zA-Z][a-zA-Z_0-9]*$/,A3:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,N3:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,C3:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,D3:/^(?:[1-9][0-9]*|0)$/,M3:/^0[xX][0-9a-fA-F]+$/,j3:/^0[0-7]+$/,P3:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,L3:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,H3:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,U3:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,F3:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,G3:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},s.x3=function(r,h){function i(t){this.source=t+"",this.index=0,this.line=1,this.stack=[],this.B3=null}var t={},n=i.prototype;function s(t){this.V3=new i(t),this.q3=!1}n.SX=function(){var t='"'===this.B3?h.F3:h.G3;t.lastIndex=this.index-1;var i=t.exec(this.source);if(!i)throw Error("unterminated string");return this.index=t.lastIndex,this.stack.push(this.B3),this.B3=null,i[1]},n.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this.B3)return this.SX();var t,i,n;do{for(t=!1;h.U3.test(n=this.source.charAt(this.index));)if("\n"===n&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,t=!0}else{if("*"!==(n=this.source.charAt(this.index)))return"/";do{if("\n"===n&&++this.line,++this.index===this.source.length)return null;i=n,n=this.source.charAt(this.index)}while("*"!==i||"/"!==n);++this.index,t=!0}}while(t);if(this.index===this.source.length)return null;var r=this.index;if(h.R3.lastIndex=0,!h.R3.test(this.source.charAt(r++)))for(;r<this.source.length&&!h.R3.test(this.source.charAt(r));)++r;var s=this.source.substring(this.index,this.index=r);return'"'!==s&&"'"!==s||(this.B3=s),s},n.UP=function(){if(0===this.stack.length){var t=this.next();if(null===t)return null;this.stack.push(t)}return this.stack[0]},n.PE=function(t){var i=this.next();if(i!==t)throw Error("illegal '"+i+"', '"+t+"' expected")},n.Q3=function(t){return this.UP()===t&&(this.next(),!0)},n.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},t.Y3=i;var e=s.prototype;function o(t,i){var n=-1,r=1;if("-"==t.charAt(0)&&(r=-1,t=t.substring(1)),h.D3.test(t))n=parseInt(t);else if(h.M3.test(t))n=parseInt(t.substring(2),16);else{if(!h.j3.test(t))throw Error("illegal id value: "+(r<0?"-":"")+t);n=parseInt(t.substring(1),8)}if(n=r*n|0,!i&&n<0)throw Error("illegal id value: "+(r<0?"-":"")+t);return n}function u(t){var i=1;if("-"==t.charAt(0)&&(i=-1,t=t.substring(1)),h.D3.test(t))return i*parseInt(t,10);if(h.M3.test(t))return i*parseInt(t.substring(2),16);if(h.j3.test(t))return i*parseInt(t.substring(1),8);if("inf"===t)return i*(1/0);if("nan"===t)return NaN;if(h.P3.test(t))return i*parseFloat(t);throw Error("illegal number value: "+(i<0?"-":"")+t)}function a(t,i,n){void 0===t[i]?t[i]=n:(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(n))}return e.parse=function(){var t,i={name:"[ROOT]","package":null,messages:[],K3:[],imports:[],options:{},services:[]},n=!0;try{for(;t=this.V3.next();)switch(t){case"package":if(!n||null!==i["package"])throw Error("unexpected 'package'");if(t=this.V3.next(),!h.A3.test(t))throw Error("illegal package name: "+t);this.V3.PE(";"),i["package"]=t;break;case"import":if(!n)throw Error("unexpected 'import'");"public"===(t=this.V3.UP())&&this.V3.next(),t=this.SX(),this.V3.PE(";"),i.imports.push(t);break;case"syntax":if(!n)throw Error("unexpected 'syntax'");this.V3.PE("="),"proto3"===(i.W3=this.SX())&&(this.q3=!0),this.V3.PE(";");break;case"message":this.X3(i,null),n=!1;break;case"enum":this.J3(i),n=!1;break;case"option":this.z3(i);break;case"service":this.Z3(i);break;case"extend":this.t4(i);break;default:throw Error("unexpected '"+t+"'")}}catch(t){throw t.message="Parse error at line "+this.V3.line+": "+t.message,t}return delete i.name,i},s.parse=function(t){return new s(t).parse()},e.SX=function(){var t,i,n="";do{if("'"!==(i=this.V3.next())&&'"'!==i)throw Error("illegal string delimiter: "+i);n+=this.V3.next(),this.V3.PE(i),t=this.V3.UP()}while('"'===t||'"'===t);return n},e.i4=function(t){var i=this.V3.UP();if('"'===i||"'"===i)return this.SX();if(this.V3.next(),h.C3.test(i))return u(i);if(h.BOOL.test(i))return"true"===i.toLowerCase();if(t&&h.A3.test(i))return i;throw Error("illegal value: "+i)},e.z3=function(t,i){var n=this.V3.next(),r=!1;if("("===n&&(r=!0,n=this.V3.next()),!h.A3.test(n))throw Error("illegal option name: "+n);var s=n;r&&(this.V3.PE(")"),s="("+s+")",n=this.V3.UP(),h.N3.test(n)&&(s+=n,this.V3.next())),this.V3.PE("="),this.n4(t,s),i||this.V3.PE(";")},e.n4=function(t,i){var n=this.V3.UP();if("{"!==n)a(t.options,i,this.i4(!0));else for(this.V3.PE("{");"}"!==(n=this.V3.next());){if(!h.SL.test(n))throw Error("illegal option name: "+i+"."+n);this.V3.Q3(":")?a(t.options,i+"."+n,this.i4(!0)):this.n4(t,i+"."+n)}},e.Z3=function(t){var i=this.V3.next();if(!h.SL.test(i))throw Error("illegal service name at line "+this.V3.line+": "+i);var n={name:i,r4:{},options:{}};for(this.V3.PE("{");"}"!==(i=this.V3.next());)if("option"===i)this.z3(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this.s4(n)}this.V3.Q3(";"),t.services.push(n)},e.s4=function(t){var i=this.V3.next();if(!h.SL.test(i))throw Error("illegal rpc service method name: "+i);var n=i,r={request:null,response:null,e4:!1,h4:!1,options:{}};if(this.V3.PE("("),"stream"===(i=this.V3.next()).toLowerCase()&&(r.e4=!0,i=this.V3.next()),!h.A3.test(i))throw Error("illegal rpc service request type: "+i);if(r.request=i,this.V3.PE(")"),"returns"!==(i=this.V3.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.V3.PE("("),"stream"===(i=this.V3.next()).toLowerCase()&&(r.h4=!0,i=this.V3.next()),r.response=i,this.V3.PE(")"),"{"===(i=this.V3.UP())){for(this.V3.next();"}"!==(i=this.V3.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this.z3(r)}this.V3.Q3(";")}else this.V3.PE(";");void 0===t.r4&&(t.r4={}),t.r4[n]=r},e.X3=function(t,i){var n=!!i,r=this.V3.next(),s={name:"",fields:[],K3:[],messages:[],options:{},o4:{}};if(!h.SL.test(r))throw Error("illegal "+(n?"group":"message")+" name: "+r);for(s.name=r,n&&(this.V3.PE("="),i.id=o(this.V3.next()),s.u4=!0),"["===(r=this.V3.UP())&&i&&this.a4(i),this.V3.PE("{");"}"!==(r=this.V3.next());)if(h._3.test(r))this.f4(s,r);else if("oneof"===r)this.c4(s);else if("enum"===r)this.J3(s);else if("message"===r)this.X3(s);else if("option"===r)this.z3(s);else if("extensions"===r)this.l4(s);else if("extend"===r)this.t4(s);else{if(!h.A3.test(r))throw Error("illegal message token: "+r);if(!this.q3)throw Error("illegal field rule: "+r);this.f4(s,"optional",r)}return this.V3.Q3(";"),t.messages.push(s),s},e.f4=function(t,i,n){if(!h._3.test(i))throw Error("illegal message field rule: "+i);var r,s={rule:i,type:"",name:"",options:{},id:0};if("map"===i){if(n)throw Error("illegal type: "+n);if(this.V3.PE("<"),r=this.V3.next(),!h.kL.test(r)&&!h.A3.test(r))throw Error("illegal message field type: "+r);if(s.keytype=r,this.V3.PE(","),r=this.V3.next(),!h.kL.test(r)&&!h.A3.test(r))throw Error("illegal message field: "+r);if(s.type=r,this.V3.PE(">"),r=this.V3.next(),!h.SL.test(r))throw Error("illegal message field name: "+r);s.name=r,this.V3.PE("="),s.id=o(this.V3.next()),"["===(r=this.V3.UP())&&this.a4(s),this.V3.PE(";")}else if("group"===(n=void 0!==n?n:this.V3.next())){var e=this.X3(t,s);if(!/^[A-Z]/.test(e.name))throw Error("illegal group name: "+e.name);s.type=e.name,s.name=e.name.toLowerCase(),this.V3.Q3(";")}else{if(!h.kL.test(n)&&!h.A3.test(n))throw Error("illegal message field type: "+n);if(s.type=n,r=this.V3.next(),!h.SL.test(r))throw Error("illegal message field name: "+r);s.name=r,this.V3.PE("="),s.id=o(this.V3.next()),"["===(r=this.V3.UP())&&this.a4(s),this.V3.PE(";")}return t.fields.push(s),s},e.c4=function(t){var i=this.V3.next();if(!h.SL.test(i))throw Error("illegal oneof name: "+i);var n,r=i,s=[];for(this.V3.PE("{");"}"!==(i=this.V3.next());)(n=this.f4(t,"optional",i)).v4=r,s.push(n.id);this.V3.Q3(";"),t.o4[r]=s},e.a4=function(t){this.V3.PE("[");for(var i=!0;"]"!==this.V3.UP();)i||this.V3.PE(","),this.z3(t,!0),i=!1;this.V3.next()},e.J3=function(t){var i={name:"",values:[],options:{}},n=this.V3.next();if(!h.SL.test(n))throw Error("illegal name: "+n);for(i.name=n,this.V3.PE("{");"}"!==(n=this.V3.next());)if("option"===n)this.z3(i);else{if(!h.SL.test(n))throw Error("illegal name: "+n);this.V3.PE("=");var r={name:n,id:o(this.V3.next(),!0)};"["===(n=this.V3.UP())&&this.a4({options:{}}),this.V3.PE(";"),i.values.push(r)}this.V3.Q3(";"),t.K3.push(i)},e.l4=function(t){var i=this.V3.next(),n=[];"min"===i?n.push(r.d3):"max"===i?n.push(r.E3):n.push(u(i)),this.V3.PE("to"),"min"===(i=this.V3.next())?n.push(r.d3):"max"===i?n.push(r.E3):n.push(u(i)),this.V3.PE(";"),t.extensions=n},e.t4=function(t){var i=this.V3.next();if(!h.A3.test(i))throw Error("illegal extend reference: "+i);var n={lK:i,fields:[]};for(this.V3.PE("{");"}"!==(i=this.V3.next());)if(h._3.test(i))this.f4(n,i);else{if(!h.A3.test(i))throw Error("illegal extend token: "+i);if(!this.q3)throw Error("illegal field rule: "+i);this.f4(n,"optional",i)}return this.V3.Q3(";"),t.messages.push(n),n},e.toString=function(){return"Parser at line "+this.V3.line},t.c$=s,t}(s,s.Lang),s.Reflect=function(E){function f(t,i,n){this.d4=t,this.parent=i,this.name=n,this.className}var h={},t=f.prototype;function o(t,i,n,r,s){f.call(this,t,i,n),this.className="Namespace",this.children=[],this.options=r||{},this.W3=s||"proto2"}t.E4=function(){for(var t=this.name,i=this;null!=(i=i.parent);)t=i.name+"."+t;return t},t.toString=function(t){return(t?this.className+" ":"")+this.E4()},t.mv=function(){throw Error(this.toString(!0)+" cannot be built directly")},h.w4=f;var i=o.prototype=Object.create(f.prototype);function c(t,i,n,r){if(this.type=t,this.g4=i,this.b4=n,this.W3=r,n&&E.v3.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)}i.y4=function(t){if(null==(t=t||null))return this.children.slice();for(var i=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof t&&i.push(this.children[n]);return i},i.T4=function(t){var i;if(i=this.m4(t.name))if(i instanceof l.O4&&i.name!==i.S4&&null===this.m4(i.S4))i.name=i.S4;else{if(!(t instanceof l.O4&&t.name!==t.S4&&null===this.m4(t.S4)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+t.name);t.name=t.S4}this.children.push(t)},i.m4=function(t){for(var i="number"==typeof t?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][i]===t)return this.children[n];return null},i.resolve=function(t,i){var n,r="string"==typeof t?t.split("."):t,s=this,e=0;if(""===r[e]){for(;null!==s.parent;)s=s.parent;e++}do{do{if(!(s instanceof h.R4)){s=null;break}if(!(n=s.m4(r[e]))||!(n instanceof h.w4)||i&&!(n instanceof h.R4)){s=null;break}s=n,e++}while(e<r.length);if(null!=s)break;if(null!==this.parent)return this.parent.resolve(t,i)}while(null!=s);return s},i._4=function(t){for(var i=[],n=t;i.unshift(n.name),null!==(n=n.parent););for(var r=1;r<=i.length;r++){var s=i.slice(i.length-r);if(t===this.resolve(s,t instanceof h.R4))return s.join(".")}return t.E4()},i.mv=function(){for(var t,i={},n=this.children,r=0,s=n.length;r<s;++r)(t=n[r])instanceof o&&(i[t.name]=t.mv());return Object.defineProperty&&Object.defineProperty(i,"I4",{value:this.A4()}),i},i.A4=function(){for(var t={},i=Object.keys(this.options),n=0,r=i.length;n<r;++n){var s=i[n],e=this.options[i[n]];t[s]=e}return t},i.N4=function(t){return void 0===t?this.options:void 0!==this.options[t]?this.options[t]:null},h.R4=o;var n=c.prototype;function e(t,i){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t._k&&t.low==t.low&&t.high==t.high)return new E.bN(t.low,t.high,void 0===i?t._k:i);if("string"==typeof t)return E.bN.LO(t,i||!1,10);if("number"==typeof t)return E.bN.PO(t,i||!1);throw Error("not convertible to Long")}c.C4=function(t){if("string"==typeof t&&(t=E.f3[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==E.f3.bytes?new T(0):t.defaultValue},n.D4=function(i){var n=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);switch(this.type){case E.f3.int32:case E.f3.sint32:case E.f3.sfixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),4294967295<i?0|i:i;case E.f3.uint32:case E.f3.fixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),i<0?i>>>0:i;case E.f3.int64:case E.f3.sint64:case E.f3.sfixed64:if(E.bN)try{return e(i,!1)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.f3.uint64:case E.f3.fixed64:if(E.bN)try{return e(i,!0)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.f3.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case E.f3["float"]:case E.f3["double"]:return"number"!=typeof i&&n(typeof i,"not a number"),i;case E.f3.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case E.f3.bytes:return T.ON(i)?i:T.wrap(i,"base64");case E.f3["enum"]:var t=this.g4.y4(E.Reflect.j4.M4);for(s=0;s<t.length;s++){if(t[s].name==i)return t[s].id;if(t[s].id==i)return t[s].id}if("proto3"===this.W3)return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),(4294967295<i||i<0)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case E.f3.group:case E.f3.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.g4.P4)return i;if(i instanceof E.L4.Yc){var r={};for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);i=r}return new this.g4.P4(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},n.H4=function(t,i){if(null===i)return 0;var n;switch(this.type){case E.f3.int32:return i<0?T.mk(i):T.vk(i);case E.f3.uint32:return T.vk(i);case E.f3.sint32:return T.vk(T.dk(i));case E.f3.fixed32:case E.f3.sfixed32:case E.f3["float"]:return 4;case E.f3.int64:case E.f3.uint64:return T.mk(i);case E.f3.sint64:return T.mk(T.Rk(i));case E.f3.fixed64:case E.f3.sfixed64:return 8;case E.f3.bool:return 1;case E.f3["enum"]:return T.vk(i);case E.f3["double"]:return 8;case E.f3.string:return n=T.qk(i),T.vk(n)+n;case E.f3.bytes:if(i.hC()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.hC()+" bytes remaining");return T.vk(i.hC())+i.hC();case E.f3.message:return n=this.g4.U4(i),T.vk(n)+n;case E.f3.group:return(n=this.g4.U4(i))+T.vk(t<<3|E.n3.o3)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")},n.F4=function(t,i,n){if(null===i)return n;switch(this.type){case E.f3.int32:i<0?n.Ck(i):n.wk(i);break;case E.f3.uint32:n.wk(i);break;case E.f3.sint32:n.pk(i);break;case E.f3.fixed32:n.KN(i);break;case E.f3.sfixed32:n.QN(i);break;case E.f3.int64:case E.f3.uint64:n.Ck(i);break;case E.f3.sint64:n.Dk(i);break;case E.f3.fixed64:n.ik(i);break;case E.f3.sfixed64:n.JN(i);break;case E.f3.bool:"string"==typeof i?n.wk("false"===i.toLowerCase()?0:!!i):n.wk(i?1:0);break;case E.f3["enum"]:n.wk(i);break;case E.f3["float"]:n.ek(i);break;case E.f3["double"]:n.fk(i);break;case E.f3.string:n.$k(i);break;case E.f3.bytes:if(i.hC()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.hC()+" bytes remaining");var r=i.offset;n.wk(i.hC()),n.append(i),i.offset=r;break;case E.f3.message:var s=new T().iC();this.g4.encode(i,s),n.wk(s.offset),n.append(s.uv());break;case E.f3.group:this.g4.encode(i,n),n.wk(t<<3|E.n3.o3);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")}return n},n.decode=function(t,i,n){if(i!=this.type.c3)throw Error("Unexpected wire type for element");var r,s;switch(this.type){case E.f3.int32:return 0|t.gk();case E.f3.uint32:return t.gk()>>>0;case E.f3.sint32:return 0|t.yk();case E.f3.fixed32:return t.$N()>>>0;case E.f3.sfixed32:return 0|t.YN();case E.f3.int64:return t.Mk();case E.f3.uint64:return t.Mk().Ak();case E.f3.sint64:return t.jk();case E.f3.fixed64:return t.rk();case E.f3.sfixed64:return t.ZN();case E.f3.bool:return!!t.gk();case E.f3["enum"]:return t.gk();case E.f3["float"]:return t.ak();case E.f3["double"]:return t.fp();case E.f3.string:return t.Xk();case E.f3.bytes:if(s=t.gk(),t.hC()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+t.hC());return(r=t.clone()).dN=r.offset+s,t.offset+=s,r;case E.f3.message:return s=t.gk(),this.g4.decode(t,s);case E.f3.group:return this.g4.decode(t,-1,n)}throw Error("[INTERNAL] Illegal decode type")},n.G4=function(t){if(!this.b4)throw Error("valueFromString() called on non-map-key element");switch(this.type){case E.f3.int32:case E.f3.sint32:case E.f3.sfixed32:case E.f3.uint32:case E.f3.fixed32:return this.D4(parseInt(t));case E.f3.int64:case E.f3.sint64:case E.f3.sfixed64:case E.f3.uint64:case E.f3.fixed64:return this.D4(t);case E.f3.bool:return"true"===t;case E.f3.string:return this.D4(t);case E.f3.bytes:return T._N(t)}},n.x4=function(t){if(!this.b4)throw Error("valueToString() called on non-map-key element");return this.type===E.f3.bytes?t.toString("binary"):t.toString()},h.Element=c;var l=function(t,i,n,r,s,e){o.call(this,t,i,n,r,e),this.className="Message",this.extensions=[E.d3,E.E3],this.P4=null,this.u4=!!s,this.B4=null,this.V4=null,this.q4=null},r=l.prototype=Object.create(o.prototype);function w(t,i){var n=i.gk(),r=7&n,s=n>>>3;switch(r){case E.n3.r3:for(;128==(128&(n=i.PN())););break;case E.n3.s3:i.offset+=8;break;case E.n3.e3:n=i.gk(),i.offset+=n;break;case E.n3.h3:w(s,i);break;case E.n3.o3:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case E.n3.u3:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+r)}return!0}function u(t,i,n,r,s,e,h,o,u,a){f.call(this,t,i,e),this.className="Message.Field",this.required="required"===n,this.repeated="repeated"===n,this.map="map"===n,this.Q4=r||null,this.type=s,this.g4=null,this.id=h,this.options=o||{},this.defaultValue=null,this.v4=u||null,this.W3=a||"proto2",this.S4=this.name,this.Y4=null,this.K4=null,!this.d4.options.w3||this instanceof l.W4||(this.name=E.s_.S3(this.name))}r.mv=function(t){if(this.P4&&!t)return this.P4;var i=function(c,h){var o=h.y4(c.Reflect.Yc.O4),u=h.y4(c.Reflect.Yc.X4),a=function(t,i){c.L4.Yc.call(this);for(var n=0,r=u.length;n<r;++n)this[u[n].name]=null;for(n=0,r=o.length;n<r;++n){var s=o[n];this[s.name]=s.repeated?[]:s.map?new c.Map(s):null,!s.required&&"proto3"!==h.W3||null===s.defaultValue||(this[s.name]=s.defaultValue)}var e;if(0<arguments.length)if(1!==arguments.length||null===t||"object"!=typeof t||!("function"!=typeof t.encode||t instanceof a)||Array.isArray(t)||t instanceof c.Map||T.ON(t)||t instanceof ArrayBuffer||c.bN&&t instanceof c.bN)for(n=0,r=arguments.length;n<r;++n)void 0!==(e=arguments[n])&&this.J4(o[n].name,e);else this.J4(t)},e=a.prototype=Object.create(c.L4.Yc.prototype);e.add=function(t,i,n){var r=h.q4[t];if(!n){if(!r)throw Error(this+"#"+t+" is undefined");if(!(r instanceof c.Reflect.Yc.O4))throw Error(this+"#"+t+" is not a field: "+r.toString(!0));if(!r.repeated)throw Error(this+"#"+t+" is not a repeated field");i=r.D4(i,!0)}return null===this[t]&&(this[t]=[]),this[t].push(i),this},e.z4=e.add,e.set=function(t,i,n){if(t&&"object"==typeof t){for(var r in n=i,t)t.hasOwnProperty(r)&&void 0!==(i=t[r])&&this.J4(r,i,n);return this}var s=h.q4[t];if(n)this[t]=i;else{if(!s)throw Error(this+"#"+t+" is not a field: undefined");if(!(s instanceof c.Reflect.Yc.O4))throw Error(this+"#"+t+" is not a field: "+s.toString(!0));this[s.name]=i=s.D4(i)}if(s&&s.v4){var e=this[s.v4.name];null!==i?(null!==e&&e!==s.name&&(this[e]=null),this[s.v4.name]=s.name):e===t&&(this[s.v4.name]=null)}return this},e.J4=e.set,e.get=function(t,i){if(i)return this[t];var n=h.q4[t];if(!(n&&n instanceof c.Reflect.Yc.O4))throw Error(this+"#"+t+" is not a field: undefined");if(!(n instanceof c.Reflect.Yc.O4))throw Error(this+"#"+t+" is not a field: "+n.toString(!0));return this[n.name]},e.Z4=e.get;for(var t=0;t<o.length;t++){var i=o[t];i instanceof c.Reflect.Yc.W4||h.d4.options.g3&&(function(n){var t=n.S4.replace(/(_[a-zA-Z])/g,function(t){return t.toUpperCase().replace("_","")});function i(t,i){return this[n.name]=i?t:n.D4(t),this}function r(){return this[n.name]}t=t.substring(0,1).toUpperCase()+t.substring(1);var s=n.S4.replace(/([A-Z])/g,function(t){return"_"+t});null===h.m4("set"+t)&&(e["set"+t]=i),null===h.m4("set_"+s)&&(e["set_"+s]=i),null===h.m4("get"+t)&&(e["get"+t]=r),null===h.m4("get_"+s)&&(e["get_"+s]=r)})(i)}function l(t,n,r,s){if(null===t||"object"!=typeof t){if(s&&s instanceof c.Reflect.j4){var i=c.Reflect.j4.getName(s.object,t);if(null!==i)return i}return t}if(T.ON(t))return n?t.aC():t.oC();if(c.bN.t5(t))return r?t.toString():c.bN.i5(t);var e;if(Array.isArray(t))return e=[],t.forEach(function(t,i){e[i]=l(t,n,r,s)}),e;if(e={},t instanceof c.Map){for(var h=t.entries(),o=h.next();!o.done;o=h.next())e[t.n5.x4(o.value[0])]=l(o.value[1],n,r,t.r5.g4);return e}var u=t.s5,a=void 0;for(var f in t)t.hasOwnProperty(f)&&(u&&(a=u.m4(f))?e[f]=l(t[f],n,r,a.g4):e[f]=l(t[f],n,r));return e}return e.encode=function(i,t){"boolean"==typeof i&&(t=i,i=void 0);var n=!1;i||(i=new T(),n=!0);var r=i.EN;try{return h.encode(this,i.iC(),t),(n?i.uv():i).iC(r)}catch(t){throw i.iC(r),t}},a.encode=function(t,i,n){return new a(t).encode(i,n)},e.U4=function(){return h.U4(this)},e.e5=function(t){var i=!1;t||(t=new T(),i=!0);var n=new T().iC();return h.encode(this,n).uv(),t.wk(n.hC()),t.append(n),i?t.uv():t},e.h5=function(){try{return this.encode().Wa()}catch(t){throw t.o5&&(t.o5=t.o5.Wa()),t}},e.Wa=e.h5,e.u5=function(){try{return this.encode().oC()}catch(t){throw t.o5&&(t.o5=t.o5.oC()),t}},e.oC=e.u5,e.a5=function(){try{return this.encode().aC()}catch(t){throw t.o5&&(t.o5=t.o5.aC()),t}},e.aC=e.a5,e.f5=function(){try{return this.encode().fC()}catch(t){throw t.o5&&(t.o5=t.o5.fC()),t}},e.fC=e.f5,e.c5=function(t,i){return l(this,!!t,!!i,this.s5)},e.l5=function(){return JSON.stringify(l(this,!0,!0,this.s5))},a.decode=function(i,t){"string"==typeof i&&(i=T.wrap(i,t||"base64"));var n=(i=T.ON(i)?i:T.wrap(i)).EN;try{var r=h.decode(i.iC());return i.iC(n),r}catch(t){throw i.iC(n),t}},a.v5=function(i,t){if("string"==typeof i&&(i=T.wrap(i,t||"base64")),(i=T.ON(i)?i:T.wrap(i)).hC()<1)return null;var n=i.offset,r=i.gk();if(i.hC()<r)return i.offset=n,null;try{var s=h.decode(i.slice(i.offset,i.offset+r).iC());return i.offset+=r,s}catch(t){throw i.offset+=r,t}},a.d5=function(t){return a.decode(t,"base64")},a.E5=function(t){return a.decode(t,"hex")},a.w5=function(t){return new a(JSON.parse(t))},e.toString=function(){return h.toString()},Object.defineProperty&&(Object.defineProperty(a,"I4",{value:h.A4()}),Object.defineProperty(e,"I4",{value:a.I4}),Object.defineProperty(a,"s5",{value:h}),Object.defineProperty(e,"s5",{value:h})),a}(E,this);this.B4=[],this.V4={},this.q4={};for(var n,r=0,s=this.children.length;r<s;r++)if((n=this.children[r])instanceof v||n instanceof l||n instanceof g){if(i.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");i[n.name]=n.mv()}else if(n instanceof l.O4)n.mv(),this.B4.push(n),this.V4[n.id]=n,this.q4[n.name]=n;else if(!(n instanceof l.X4||n instanceof p))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[r].toString(!0));return this.P4=i},r.encode=function(t,i,n){for(var r,s,e=null,h=0,o=this.B4.length;h<o;++h)s=t[(r=this.B4[h]).name],r.required&&null===s?null===e&&(e=r):r.encode(n?s:r.D4(s),i,t);if(null===e)return i;var u=Error("Missing at least one required field for "+this.toString(!0)+": "+e);throw u.o5=i,u},r.U4=function(t){for(var i,n,r=0,s=0,e=this.B4.length;s<e;++s){if(n=t[(i=this.B4[s]).name],i.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+i);r+=i.U4(n,t)}return r},r.decode=function(t,i,n){i="number"==typeof i?i:-1;for(var r,s,e,h,o=t.offset,u=new this.P4();t.offset<o+i||-1===i&&0<t.hC();){if(e=(r=t.gk())>>>3,(s=7&r)===E.n3.o3){if(e!==n)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+e+" ("+(n?n+" expected":"not a group")+")");break}if(h=this.V4[e]){if(h.repeated&&!h.options.p5)u[h.name].push(h.decode(s,t));else if(h.map){var a=h.decode(s,t);u[h.name].set(a[0],a[1])}else if(u[h.name]=h.decode(s,t),h.v4){var f=u[h.v4.name];null!==f&&f!==h.name&&(u[f]=null),u[h.v4.name]=h.name}}else switch(s){case E.n3.r3:t.gk();break;case E.n3.u3:t.offset+=4;break;case E.n3.s3:t.offset+=8;break;case E.n3.e3:var c=t.gk();t.offset+=c;break;case E.n3.h3:for(;w(e,t););break;default:throw Error("Illegal wire type for unknown field "+e+" in "+this.toString(!0)+"#decode: "+s)}}for(var l=0,v=this.B4.length;l<v;++l)if(null===u[(h=this.B4[l]).name])if("proto3"===this.W3)u[h.name]=h.defaultValue;else{if(h.required){var d=Error("Missing at least one required field for "+this.toString(!0)+": "+h.name);throw d.g5=u,d}E.b3&&null!==h.defaultValue&&(u[h.name]=h.defaultValue)}return u},h.Yc=l;var s=u.prototype=Object.create(f.prototype);function a(t,i,n,r,s,e,h){u.call(this,t,i,n,null,r,s,e,h),this.b5}s.mv=function(){this.Y4=new c(this.type,this.g4,!1,this.W3),this.map&&(this.K4=new c(this.Q4,void 0,!0,this.W3)),"proto3"!==this.W3||this.repeated||this.map?void 0!==this.options["default"]&&(this.defaultValue=this.D4(this.options["default"])):this.defaultValue=c.C4(this.type)},s.D4=function(t,i){i=i||!1;var n,r=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);if(null===t)return this.required&&r(typeof t,"required"),"proto3"===this.W3&&this.type!==E.f3.message&&r(typeof t,"proto3 field without field presence cannot be null"),null;if(!this.repeated||i)return this.map&&!i?t instanceof E.Map?t:(t instanceof Object||r(typeof t,"expected ProtoBuf.Map or raw object for map field"),new E.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(typeof t,"no array expected"),this.Y4.D4(t));Array.isArray(t)||(t=[t]);var s=[];for(n=0;n<t.length;n++)s.push(this.Y4.D4(t[n]));return s},s.y5=function(t,i){if("proto3"!==this.W3)return null!==t;if(this.v4&&i[this.v4.name]===this.name)return!0;switch(this.type){case E.f3.int32:case E.f3.sint32:case E.f3.sfixed32:case E.f3.uint32:case E.f3.fixed32:return 0!==t;case E.f3.int64:case E.f3.sint64:case E.f3.sfixed64:case E.f3.uint64:case E.f3.fixed64:return 0!==t.low||0!==t.high;case E.f3.bool:return t;case E.f3["float"]:case E.f3["double"]:return 0!==t;case E.f3.string:return 0<t.length;case E.f3.bytes:return 0<t.hC();case E.f3["enum"]:return 0!==t;case E.f3.message:return null!==t;default:return!0}},s.encode=function(i,s,t){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return s;try{var n;if(this.repeated)if(this.options.p5&&0<=E.a3.indexOf(this.type.c3)){s.wk(this.id<<3|E.n3.e3),s.tC(s.offset+=1);var r=s.offset;for(n=0;n<i.length;n++)this.Y4.F4(this.id,i[n],s);var e=s.offset-r,h=T.vk(e);if(1<h){var o=s.slice(r,s.offset);r+=h-1,s.offset=r,s.append(o)}s.wk(e,r-h)}else for(n=0;n<i.length;n++)s.wk(this.id<<3|this.type.c3),this.Y4.F4(this.id,i[n],s);else this.map?i.forEach(function(t,i,n){var r=T.vk(8|this.Q4.c3)+this.K4.H4(1,i)+T.vk(16|this.type.c3)+this.Y4.H4(2,t);s.wk(this.id<<3|E.n3.e3),s.wk(r),s.wk(8|this.Q4.c3),this.K4.F4(1,i,s),s.wk(16|this.type.c3),this.Y4.F4(2,t,s)},this):this.y5(i,t)&&(s.wk(this.id<<3|this.type.c3),this.Y4.F4(this.id,i,s))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.U4=function(i,t){if(i=this.D4(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var s=0;try{var n,r;if(this.repeated)if(this.options.p5&&0<=E.a3.indexOf(this.type.c3)){for(s+=T.vk(this.id<<3|E.n3.e3),n=r=0;n<i.length;n++)r+=this.Y4.H4(this.id,i[n]);s+=T.vk(r),s+=r}else for(n=0;n<i.length;n++)s+=T.vk(this.id<<3|this.type.c3),s+=this.Y4.H4(this.id,i[n]);else this.map?i.forEach(function(t,i,n){var r=T.vk(8|this.Q4.c3)+this.K4.H4(1,i)+T.vk(16|this.type.c3)+this.Y4.H4(2,t);s+=T.vk(this.id<<3|E.n3.e3),s+=T.vk(r),s+=r},this):this.y5(i,t)&&(s+=T.vk(this.id<<3|this.type.c3),s+=this.Y4.H4(this.id,i))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.decode=function(t,i,n){var r,s;if(!(!this.map&&t==this.type.c3||!n&&this.repeated&&this.options.p5&&t==E.n3.e3||this.map&&t==E.n3.e3))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.c3+" expected)");if(t==E.n3.e3&&this.repeated&&this.options.p5&&0<=E.a3.indexOf(this.type.c3)&&!n){s=i.gk(),s=i.offset+s;for(var e=[];i.offset<s;)e.push(this.decode(this.type.c3,i,!0));return e}if(this.map){var h=c.C4(this.Q4);if(r=c.C4(this.type),s=i.gk(),i.hC()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+i.hC());var o=i.clone();for(o.dN=o.offset+s,i.offset+=s;0<o.hC();){var u=o.gk();t=7&u;var a=u>>>3;if(1==a)h=this.K4.decode(o,t,a);else{if(2!=a)throw Error("Unexpected tag in map field key/value submessage");r=this.Y4.decode(o,t,a)}}return[h,r]}return this.Y4.decode(i,t,this.id)},h.Yc.O4=u,a.prototype=Object.create(u.prototype),h.Yc.W4=a,h.Yc.X4=function(t,i,n){f.call(this,t,i,n),this.fields=[]};var v=function(t,i,n,r,s){o.call(this,t,i,n,r,s),this.className="Enum",this.object=null};function d(t,i,n,r){f.call(this,t,i,n),this.className="Enum.Value",this.id=r}v.getName=function(t,i){for(var n,r=Object.keys(t),s=0;s<r.length;++s)if(t[n=r[s]]===i)return n;return null},(v.prototype=Object.create(o.prototype)).mv=function(t){if(this.object&&!t)return this.object;for(var i=new E.L4.j4(),n=this.y4(v.M4),r=0,s=n.length;r<s;++r)i[n[r].name]=n[r].id;return Object.defineProperty&&Object.defineProperty(i,"I4",{value:this.A4(),enumerable:!1}),this.object=i},h.j4=v,d.prototype=Object.create(f.prototype),h.j4.M4=d;var p=function(t,i,n,r){f.call(this,t,i,n),this.T5=r};p.prototype=Object.create(f.prototype),h.m5=p;var g=function(t,i,n,r){o.call(this,t,i,n,r),this.className="Service",this.P4=null};function b(t,i,n,r){f.call(this,t,i,n),this.className="Service.Method",this.options=r||{}}function y(t,i,n,r,s,e,h,o){b.call(this,t,i,n,o),this.className="Service.RPCMethod",this.O5=r,this.S5=s,this.R5=e,this._5=h,this.I5=null,this.A5=null}return(g.prototype=Object.create(o.prototype)).mv=function(t){return this.P4&&!t?this.P4:this.P4=function(i,s){for(var e=function(t){i.L4.N5.call(this),this.k5=t||function(t,i,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},t=e.prototype=Object.create(i.L4.N5.prototype),n=s.y4(i.Reflect.N5.C5),r=0;r<n.length;r++)!function(r){t[r.name]=function(t,n){try{try{t=r.I5.P4.decode(T.wrap(t))}catch(t){if(!(t instanceof TypeError))throw t}if(null===t||"object"!=typeof t)throw Error("Illegal arguments");t instanceof r.I5.P4||(t=new r.I5.P4(t)),this.k5(r.E4(),t,function(t,i){if(t)n(t);else{try{i=r.A5.P4.decode(i)}catch(t){}i&&i instanceof r.A5.P4?n(null,i):n(Error("Illegal response type received in service method "+s.name+"#"+r.name))}})}catch(t){setTimeout(n.bind(this,t),0)}},e[r.name]=function(t,i,n){new e(t)[r.name](i,n)},Object.defineProperty&&(Object.defineProperty(e[r.name],"I4",{value:r.A4()}),Object.defineProperty(t[r.name],"I4",{value:e[r.name].I4}))}(n[r]);return Object.defineProperty&&(Object.defineProperty(e,"I4",{value:s.A4()}),Object.defineProperty(t,"I4",{value:e.I4}),Object.defineProperty(e,"s5",{value:s}),Object.defineProperty(t,"s5",{value:s})),e}(E,this)},h.N5=g,(b.prototype=Object.create(f.prototype)).A4=i.A4,h.N5.D5=b,y.prototype=Object.create(b.prototype),h.N5.C5=y,h}(s),s.L4=function(c,i,h){function o(t){this.M5=new h.R4(this,null,""),this.j5=this.M5,this.P5=!1,this.result=null,this.files={},this.L5=null,this.options=t||{}}var t=o.prototype;return o.H5=function(t){return"string"==typeof t.name&&void 0===t.values&&void 0===t.r4},o.U5=function(t){return"string"==typeof t.rule&&"string"==typeof t.name&&"string"==typeof t.type&&void 0!==t.id},o.F5=function(t){return"string"==typeof t.name&&!(void 0===t.values||!Array.isArray(t.values)||0===t.values.length)},o.G5=function(t){return!("string"!=typeof t.name||"object"!=typeof t.r4||!t.r4)},o.x5=function(t){return"string"==typeof t.lK},t.reset=function(){return this.j5=this.M5,this},t.define=function(t){if("string"!=typeof t||!i.A3.test(t))throw Error("illegal namespace: "+t);return t.split(".").forEach(function(t){var i=this.j5.m4(t);null===i&&this.j5.T4(i=new h.R4(this,this.j5,t)),this.j5=i},this),this},t.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var i=[t];0<i.length;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;0<t.length;){var n=t.shift();if(o.H5(n)){var s=new h.Yc(this,this.j5,n.name,n.options,n.u4,n.W3),r={};n.o4&&Object.keys(n.o4).forEach(function(t){s.T4(r[t]=new h.Yc.X4(this,s,t))},this),n.fields&&n.fields.forEach(function(t){if(null!==s.m4(0|t.id))throw Error("duplicate or invalid field id in "+s.name+": "+t.id);if(t.options&&"object"!=typeof t.options)throw Error("illegal field options in "+s.name+"#"+t.name);var i=null;if("string"==typeof t.v4&&!(i=r[t.v4]))throw Error("illegal oneof in "+s.name+"#"+t.name+": "+t.v4);t=new h.Yc.O4(this,s,t.rule,t.keytype,t.type,t.name,t.id,t.options,i,n.W3),i&&i.fields.push(t),s.T4(t)},this);var e=[];if(n.K3&&n.K3.forEach(function(t){e.push(t)}),n.messages&&n.messages.forEach(function(t){e.push(t)}),n.services&&n.services.forEach(function(t){e.push(t)}),n.extensions&&(s.extensions=n.extensions,s.extensions[0]<c.d3&&(s.extensions[0]=c.d3),s.extensions[1]>c.E3&&(s.extensions[1]=c.E3)),this.j5.T4(s),0<e.length){i.push(t),t=e,e=null,this.j5=s,s=null;continue}e=null}else if(o.F5(n))s=new h.j4(this,this.j5,n.name,n.options,n.W3),n.values.forEach(function(t){s.T4(new h.j4.M4(this,s,t.name,t.id))},this),this.j5.T4(s);else if(o.G5(n))s=new h.N5(this,this.j5,n.name,n.options),Object.keys(n.r4).forEach(function(t){var i=n.r4[t];s.T4(new h.N5.C5(this,s,t,i.request,i.response,!!i.e4,!!i.h4,i.options))},this),this.j5.T4(s);else{if(!o.x5(n))throw Error("not a valid definition: "+JSON.stringify(n));if(s=this.j5.resolve(n.lK,!0))n.fields.forEach(function(t){if(null!==s.m4(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(t.id<s.extensions[0]||t.id>s.extensions[1])throw Error("illegal extended field id in "+s.name+": "+t.id+" ("+s.extensions.join(" to ")+" expected)");var i=t.name;this.options.w3&&(i=c.s_.S3(i));var n=new h.Yc.W4(this,s,t.rule,t.type,this.j5.E4()+"."+i,t.id,t.options),r=new h.m5(this,this.j5,t.name,n);n.b5=r,this.j5.T4(r),s.T4(n)},this);else if(!/\.?google\.protobuf\./.test(n.lK))throw Error("extended message "+n.lK+" is not defined")}s=n=null}t=null,this.j5=this.j5.parent}return this.P5=!1,this.result=null,this},t["import"]=function(i,t){var n="/";if("string"==typeof t){if(c.s_.y3&&(t=l(95).resolve(t)),!0===this.files[t])return this.reset();this.files[t]=!0}else if("object"==typeof t){var r=t.root;c.s_.y3&&(r=l(95).resolve(r)),(0<=r.indexOf("\\")||0<=t.B5.indexOf("\\"))&&(n="\\");var s=r+n+t.B5;if(!0===this.files[s])return this.reset();this.files[s]=!0}if(i.imports&&0<i.imports.length){var e,h=!1;"object"==typeof t?(this.L5=t.root,h=!0,e=this.L5,t=t.B5,(0<=e.indexOf("\\")||0<=t.indexOf("\\"))&&(n="\\")):"string"==typeof t?this.L5?e=this.L5:0<=t.indexOf("/")?""===(e=t.replace(/\/[^\/]*$/,""))&&(e="/"):0<=t.indexOf("\\")?(e=t.replace(/\\[^\\]*$/,""),n="\\"):e=".":e=null;for(var o=0;o<i.imports.length;o++)if("string"==typeof i.imports[o]){if(!e)throw Error("cannot determine import root");var u=i.imports[o];if("google/protobuf/descriptor.proto"===u)continue;if(u=e+n+u,!0===this.files[u])continue;/\.proto$/i.test(u)&&!c.x3&&(u=u.replace(/\.proto$/,".json"));var a=c.s_.fetch(u);if(null===a)throw Error("failed to import '"+u+"' in '"+t+"': file not found");/\.json$/i.test(u)?this["import"](JSON.parse(a+""),u):this["import"](c.x3.c$.parse(a),u)}else t?/\.(\w+)$/.test(t)?this["import"](i.imports[o],t.replace(/^(.+)\.(\w+)$/,function(t,i,n){return i+"_import"+o+"."+n})):this["import"](i.imports[o],t+"_import"+o):this["import"](i.imports[o]);h&&(this.L5=null)}i["package"]&&this.define(i["package"]),i.W3&&(function i(n){n.messages&&n.messages.forEach(function(t){t.W3=n.W3,i(t)}),n.K3&&n.K3.forEach(function(t){t.W3=n.W3})})(i);var f=this.j5;return i.options&&Object.keys(i.options).forEach(function(t){f.options[t]=i.options[t]}),i.messages&&(this.create(i.messages),this.j5=f),i.K3&&(this.create(i.K3),this.j5=f),i.services&&(this.create(i.services),this.j5=f),i.V5&&this.create(i.V5),this.reset()},t.q5=function(){var t;if(null==this.j5||"object"==typeof this.j5.type)return this;if(this.j5 instanceof h.R4)this.j5.children.forEach(function(t){this.j5=t,this.q5()},this);else if(this.j5 instanceof h.Yc.O4){if(i.kL.test(this.j5.type))this.j5.type=c.f3[this.j5.type];else{if(!i.A3.test(this.j5.type))throw Error("illegal type reference in "+this.j5.toString(!0)+": "+this.j5.type);if(!(t=(this.j5 instanceof h.Yc.W4?this.j5.b5.parent:this.j5.parent).resolve(this.j5.type,!0)))throw Error("unresolvable type reference in "+this.j5.toString(!0)+": "+this.j5.type);if((this.j5.g4=t)instanceof h.j4){if(this.j5.type=c.f3["enum"],"proto3"===this.j5.W3&&"proto3"!==t.W3)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(t instanceof h.Yc))throw Error("illegal type reference in "+this.j5.toString(!0)+": "+this.j5.type);this.j5.type=t.u4?c.f3.group:c.f3.message}}if(this.j5.map){if(!i.kL.test(this.j5.Q4))throw Error("illegal key type for map field in "+this.j5.toString(!0)+": "+this.j5.Q4);this.j5.Q4=c.f3[this.j5.Q4]}}else if(this.j5 instanceof c.Reflect.N5.D5){if(!(this.j5 instanceof c.Reflect.N5.C5))throw Error("illegal service type in "+this.j5.toString(!0));if(!((t=this.j5.parent.resolve(this.j5.O5,!0))&&t instanceof c.Reflect.Yc))throw Error("Illegal type reference in "+this.j5.toString(!0)+": "+this.j5.O5);if(this.j5.I5=t,!((t=this.j5.parent.resolve(this.j5.S5,!0))&&t instanceof c.Reflect.Yc))throw Error("Illegal type reference in "+this.j5.toString(!0)+": "+this.j5.S5);this.j5.A5=t}else if(!(this.j5 instanceof c.Reflect.Yc.X4||this.j5 instanceof c.Reflect.m5||this.j5 instanceof c.Reflect.j4.M4))throw Error("illegal object in namespace: "+typeof this.j5+": "+this.j5);return this.reset()},t.mv=function(t){if(this.reset(),this.P5||(this.q5(),this.P5=!0,this.result=null),null===this.result&&(this.result=this.M5.mv()),!t)return this.result;for(var i="string"==typeof t?t.split("."):t,n=this.result,r=0;r<i.length;r++){if(!n[i[r]]){n=null;break}n=n[i[r]]}return n},t.Q5=function(t,i){return t?this.M5.resolve(t,i):this.M5},t.toString=function(){return"Builder"},o.Yc=function(){},o.j4=function(){},o.N5=function(){},o}(s,s.Lang,s.Reflect),s.Map=function(t,h){function i(t,i){if(!t.map)throw Error("field is not a map");if(this.T5=t,this.n5=new h.Element(t.Q4,null,!0,t.W3),this.r5=new h.Element(t.type,t.g4,!1,t.W3),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var n=Object.keys(i),r=0;r<n.length;r++){var s=this.n5.G4(n[r]),e=this.r5.D4(i[n[r]]);this.map[this.n5.x4(s)]={key:s,value:e}}}var n=i.prototype;function s(t){var i=0;return{next:function(){return i<t.length?{done:!1,value:t[i++]}:{done:!0}}}}return n.clear=function(){this.map={}},n["delete"]=function(t){var i=this.n5.x4(this.n5.D4(t)),n=i in this.map;return delete this.map[i],n},n.entries=function(){for(var t,i=[],n=Object.keys(this.map),r=0;r<n.length;r++)i.push([(t=this.map[n[r]]).key,t.value]);return s(i)},n.keys=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].key);return s(t)},n.values=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].value);return s(t)},n.forEach=function(t,i){for(var n,r=Object.keys(this.map),s=0;s<r.length;s++)t.call(i,(n=this.map[r[s]]).value,n.key,this)},n.set=function(t,i){var n=this.n5.D4(t),r=this.r5.D4(i);return this.map[this.n5.x4(n)]={key:n,value:r},this},n.get=function(t){var i=this.n5.x4(this.n5.D4(t));if(i in this.map)return this.map[i].value},n.has=function(t){return this.n5.x4(this.n5.D4(t))in this.map},i}(0,s.Reflect),s.Y5=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.B5&&"string"==typeof i.root)&&(n=i,i=void 0),s.Ov(s.x3.c$.parse(t),i,n)},s.K5=s.Y5,s.W5=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.s_.fetch("string"==typeof i?i:i.root+"/"+i.B5,function(t){if(null!==t)try{n(null,s.Y5(t,r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.s_.fetch("object"==typeof i?i.root+"/"+i.B5:i);return null===t?null:s.Y5(t,r,i)},s.X5=s.W5,s.J5=function(t){return void 0===(t=t||{}).w3&&(t.w3=s.w3),void 0===t.g3&&(t.g3=s.g3),new s.L4(t)},s.Ov=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.B5&&"string"==typeof i.root)&&(n=i,i=null),i&&"object"==typeof i||(i=s.J5()),"string"==typeof t&&(t=JSON.parse(t)),i["import"](t,n),i.q5(),i},s.z5=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.s_.fetch("string"==typeof i?i:i.root+"/"+i.B5,function(t){if(null!==t)try{n(null,s.Ov(JSON.parse(t),r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.s_.fetch("object"==typeof i?i.root+"/"+i.B5:i);return null===t?null:s.Ov(JSON.parse(t),r,i)},s})?t.apply(e,n):t)||(s.exports=r)}).call(this,l(36))},function(t,i,n){var r,s,e;s=[],void 0===(e="function"==typeof (r=function(){"use strict";function v(t,i,n){this.low=0|t,this.high=0|i,this._k=!!n}Object.defineProperty(v.prototype,"Z5",{value:!0,enumerable:!1,configurable:!1}),v.t5=function(t){return!0===(t&&t.Z5)};var s={},e={};v.qO=function(t,i){var n,r;return i?0<=(t>>>=0)&&t<256&&(r=e[t])?r:(n=new v(t,(0|t)<0?-1:0,!0),0<=t&&t<256&&(e[t]=n),n):-128<=(t|=0)&&t<128&&(r=s[t])?r:(n=new v(t,t<0?-1:0,!1),-128<=t&&t<128&&(s[t]=n),n)},v.PO=function(t,i){return i=!!i,isNaN(t)||!isFinite(t)?v.ZERO:!i&&t<=-h?v.MIN_VALUE:!i&&h<=t+1?v.MAX_VALUE:i&&r<=t?v.t6:t<0?v.PO(-t,i).wS():new v(t%n|0,t/n|0,i)},v.EI=function(t,i,n){return new v(t,i,n)},v.LO=function(t,i,n){if(0===t.length)throw Error("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v.ZERO;if("number"==typeof i&&(n=i,i=!1),(n=n||10)<2||36<n)throw Error("radix out of range: "+n);var r;if(0<(r=t.indexOf("-")))throw Error('number format error: interior "-" character: '+t);if(0===r)return v.LO(t.substring(1),i,n).wS();for(var s=v.PO(Math.pow(n,8)),e=v.ZERO,h=0;h<t.length;h+=8){var o=Math.min(8,t.length-h),u=parseInt(t.substring(h,h+o),n);if(o<8){var a=v.PO(Math.pow(n,o));e=e.multiply(a).add(v.PO(u))}else e=(e=e.multiply(s)).add(v.PO(u))}return e._k=i,e},v.i5=function(t){return t instanceof v?t:"number"==typeof t?v.PO(t):"string"==typeof t?v.LO(t):new v(t.low,t.high,t._k)};var n=4294967296,r=n*n,h=r/2,d=v.qO(1<<24);return v.ZERO=v.qO(0),v.l3=v.qO(0,!0),v.ONE=v.qO(1),v.i6=v.qO(1,!0),v.n6=v.qO(-1),v.MAX_VALUE=v.EI(-1,2147483647,!1),v.t6=v.EI(-1,-1,!0),v.MIN_VALUE=v.EI(0,-2147483648,!1),v.prototype.Ok=function(){return this._k?this.low>>>0:this.low},v.prototype.r6=function(){return this._k?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},v.prototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix out of range: "+t);if(this.s6())return"0";var i;if(this.Oz()){if(this.Ae(v.MIN_VALUE)){var n=v.PO(t),r=this.e6(n);return i=r.multiply(n).h6(this),r.toString(t)+i.Ok().toString(t)}return"-"+this.wS().toString(t)}var s=v.PO(Math.pow(t,6),this._k);i=this;for(var e="";;){var h=i.e6(s),o=(i.h6(h.multiply(s)).Ok()>>>0).toString(t);if((i=h).s6())return o+e;for(;o.length<6;)o="0"+o;e=""+o+e}},v.prototype.o6=function(){return this.high},v.prototype.u6=function(){return this.high>>>0},v.prototype.a6=function(){return this.low},v.prototype.f6=function(){return this.low>>>0},v.prototype.c6=function(){if(this.Oz())return this.Ae(v.MIN_VALUE)?64:this.wS().c6();for(var t=0!=this.high?this.high:this.low,i=31;0<i&&0==(t&1<<i);i--);return 0!=this.high?i+33:i+1},v.prototype.s6=function(){return 0===this.high&&0===this.low},v.prototype.Oz=function(){return!this._k&&this.high<0},v.prototype.l6=function(){return this._k||0<=this.high},v.prototype.v6=function(){return 1==(1&this.low)},v.prototype.ES=function(){return 0==(1&this.low)},v.d6=v.prototype.Ae=function(t){return v.t5(t)||(t=v.i5(t)),(this._k===t._k||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},v.E6=v.prototype.w6=function(t){return!this.Ae(t)},v.prototype.p6=v.prototype.g6=function(t){return this.compare(t)<0},v.prototype.b6=v.prototype.y6=function(t){return this.compare(t)<=0},v.prototype.T6=v.prototype.m6=function(t){return 0<this.compare(t)},v.prototype.O6=v.prototype.S6=function(t){return 0<=this.compare(t)},v.prototype.compare=function(t){if(v.t5(t)||(t=v.i5(t)),this.Ae(t))return 0;var i=this.Oz(),n=t.Oz();return i&&!n?-1:!i&&n?1:this._k?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.h6(t).Oz()?-1:1},v.prototype.R6=v.prototype.wS=function(){return!this._k&&this.Ae(v.MIN_VALUE)?v.MIN_VALUE:this.not().add(v.ONE)},v.prototype.add=function(t){v.t5(t)||(t=v.i5(t));var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=0,a=0,f=0,c=0;return f+=(c+=s+(65535&t.low))>>>16,a+=(f+=r+o)>>>16,u+=(a+=n+h)>>>16,u+=i+e,v.EI((f&=65535)<<16|(c&=65535),(u&=65535)<<16|(a&=65535),this._k)},v.prototype.sub=v.prototype.h6=function(t){return v.t5(t)||(t=v.i5(t)),this.add(t.wS())},v.prototype._6=v.prototype.multiply=function(t){if(this.s6())return v.ZERO;if(v.t5(t)||(t=v.i5(t)),t.s6())return v.ZERO;if(this.Ae(v.MIN_VALUE))return t.v6()?v.MIN_VALUE:v.ZERO;if(t.Ae(v.MIN_VALUE))return this.v6()?v.MIN_VALUE:v.ZERO;if(this.Oz())return t.Oz()?this.wS().multiply(t.wS()):this.wS().multiply(t).wS();if(t.Oz())return this.multiply(t.wS()).wS();if(this.g6(d)&&t.g6(d))return v.PO(this.r6()*t.r6(),this._k);var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=65535&t.low,a=0,f=0,c=0,l=0;return c+=(l+=s*u)>>>16,f+=(c+=r*u)>>>16,c&=65535,f+=(c+=s*o)>>>16,a+=(f+=n*u)>>>16,f&=65535,a+=(f+=r*o)>>>16,f&=65535,a+=(f+=s*h)>>>16,a+=i*u+n*o+r*h+s*e,v.EI((c&=65535)<<16|(l&=65535),(a&=65535)<<16|(f&=65535),this._k)},v.prototype.I6=v.prototype.e6=function(t){if(v.t5(t)||(t=v.i5(t)),t.s6())throw new Error("division by zero");if(this.s6())return this._k?v.l3:v.ZERO;var i,n,r;if(this.Ae(v.MIN_VALUE))return t.Ae(v.ONE)||t.Ae(v.n6)?v.MIN_VALUE:t.Ae(v.MIN_VALUE)?v.ONE:(i=this.Nk(1).e6(t).shiftLeft(1)).Ae(v.ZERO)?t.Oz()?v.ONE:v.n6:(n=this.h6(t.multiply(i)),r=i.add(n.e6(t)));if(t.Ae(v.MIN_VALUE))return this._k?v.l3:v.ZERO;if(this.Oz())return t.Oz()?this.wS().e6(t.wS()):this.wS().e6(t).wS();if(t.Oz())return this.e6(t.wS()).wS();for(r=v.ZERO,n=this;n.S6(t);){i=Math.max(1,Math.floor(n.r6()/t.r6()));for(var s=Math.ceil(Math.log(i)/Math.LN2),e=s<=48?1:Math.pow(2,s-48),h=v.PO(i),o=h.multiply(t);o.Oz()||o.m6(n);)o=(h=v.PO(i-=e,this._k)).multiply(t);h.s6()&&(h=v.ONE),r=r.add(h),n=n.h6(o)}return r},v.prototype.iS=v.prototype.fz=function(t){return v.t5(t)||(t=v.i5(t)),this.h6(this.e6(t).multiply(t))},v.prototype.not=function(){return v.EI(~this.low,~this.high,this._k)},v.prototype.and=function(t){return v.t5(t)||(t=v.i5(t)),v.EI(this.low&t.low,this.high&t.high,this._k)},v.prototype.or=function(t){return v.t5(t)||(t=v.i5(t)),v.EI(this.low|t.low,this.high|t.high,this._k)},v.prototype.xor=function(t){return v.t5(t)||(t=v.i5(t)),v.EI(this.low^t.low,this.high^t.high,this._k)},v.prototype.A6=v.prototype.shiftLeft=function(t){return v.t5(t)&&(t=t.Ok()),0==(t&=63)?this:t<32?v.EI(this.low<<t,this.high<<t|this.low>>>32-t,this._k):v.EI(0,this.low<<t-32,this._k)},v.prototype.N6=v.prototype.Nk=function(t){return v.t5(t)&&(t=t.Ok()),0==(t&=63)?this:t<32?v.EI(this.low>>>t|this.high<<32-t,this.high>>t,this._k):v.EI(this.high>>t-32,0<=this.high?0:-1,this._k)},v.prototype.k6=v.prototype.Sk=function(t){if(v.t5(t)&&(t=t.Ok()),0==(t&=63))return this;var i=this.high;if(t<32){var n=this.low;return v.EI(n>>>t|i<<32-t,i>>>t,this._k)}return v.EI(32===t?i:i>>>t-32,0,this._k)},v.prototype.Ik=function(){return this._k?new v(this.low,this.high,!1):this},v.prototype.Ak=function(){return this._k?this:new v(this.low,this.high,!0)},v})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),y=n(18),e=n(49),h=n(178),o=n(182),u=n(7),T=n(1),m=n(2),O=u.W.vf,a=u.W.af,f=(c.prototype.Xl=function(){return this.sender.Xl()||this.receiver.Xl()},c.prototype.close=function(){var i=this,n=r.defer();return this.sender.C6().then(function(t){return i.receiver.close(t).then(function(t){return i.yQ(t).then(function(t){return i.la.close(t).then(function(t){n.resolve(t)})})})})["catch"](function(t){T.ErrorMonitor.Z().logError("Error closing connection to peer",i.loggerId,m.qt.Ut,{detailedError:t,otherGuid:i.otherGuid}),n.reject("Close partnership failed")}),n.promise},c.prototype.yQ=function(t){this.logger.debug("SEND CLOSE TO "+this.otherGuid);var i=new y.Rv.Tv.Close();return i.setType(t),this.Zl(y.Dl.Close,i),r(this.swarmId)},c.prototype.fh=function(t){try{switch(O&&this.logger.debug("DISPATCH "+t.wv),t.wv){case y.Dl.Chunk:var i=y.Rv.Tv.Chunk.decode(t.bv);this.receiver.D6(i);break;case y.Dl.Ack:var n=y.Rv.Tv.Ack.decode(t.bv);this.sender.M6(n.transferId);break;case y.Dl.Cancel:var r=y.Rv.Tv.Cancel.decode(t.bv);this.sender.j6(r.transferId);break;case y.Dl.Ml:O&&this.logger.debug("RECEIVED OUT PART,DECODING ");var s=y.Rv.Tv.OutPartnershipRequest.decode(t.bv);O&&this.logger.debug("RECEIVED OUT PART FROM "+s.guid),this.lj.OQ(s,this.la);break;case y.Dl.jl:O&&this.logger.debug("RECEIVED OUT PART RESP ");var e=y.Rv.Tv.OutPartnershipResponse.decode(t.bv);O&&this.logger.debug("RECEIVED OUT PART RESP FROM "+e.accept),this.lj.qQ(e,this.la);break;case y.Dl.Have:var h=y.Rv.Tv.Have.decode(t.bv);O&&this.logger.debug("RECEIVED HAVE FOR "+h.fragmentId+" FROM "+this.otherGuid),this.lj.P6(this.otherGuid,h);break;case y.Dl.Close:var o=y.Rv.Tv.Close.decode(t.bv);O&&this.logger.debug("RECEIVED CLOSE FROM "+this.otherGuid),this.lj.BQ(this.otherGuid,o);break;case y.Dl.Request:var u=y.Rv.Tv.Request.decode(t.bv);O&&this.logger.debug("RECEIVED REQUEST FOR "+u.fragmentId+" FROM "+this.otherGuid),this.VZ.NH(this.otherGuid,u,this);break;case y.Dl.DoNotHave:var a=y.Rv.Tv.DoNotHave.decode(t.bv);O&&this.logger.debug("DoNotHave "+a.transferId),this.H6.L6(a);break;case y.Dl.Pl:var f=y.Rv.Tv.UDPHandshakeMessage.decode(t.bv);O&&this.logger.debug("UDP HANDSHAKE MESSAGE RECEIVED FROM "+f.uuid),this.OZ.iq(f,this.la);break;case y.Dl.UDPHandshakeResponse:var c=y.Rv.Tv.UDPHandshakeResponse.decode(t.bv);O&&this.logger.debug("UDP HANDSHAKE MESSAGE RESPONSE RECEIVED FROM "+this.otherGuid),this.OZ.tq(c,this.la);break;case y.Dl.UDPSwitchLeadershipRequest:var l=y.Rv.Tv.UDPSwitchLeadershipRequest.decode(t.bv);O&&this.logger.debug("SWITCH LEADERSHIP REQUEST RECEIVED FROM "+this.otherGuid),this.OZ.gq(l);break;case y.Dl.Ll:var v=y.Rv.Tv.UDPSwitchLeadershipAck.decode(t.bv);O&&this.logger.debug("UDP SWITCH ACKNOWLEDGMENT RESPONSE FROM "+this.otherGuid),this.OZ.Sq(v,this.otherGuid);break;case y.Dl.Bitrate:var d=y.Rv.Tv.Bitrate.decode(t.bv);O&&this.logger.debug("BITRATE INFO "+d.bitrate+" FROM "+d.guid),this.lj.KQ(d);break;case y.Dl.Haves:var E=y.Rv.Tv.Haves.decode(t.bv);O&&this.logger.debug("RECEIVED BATCH HAVES FOR FROM "+this.otherGuid),this.lj.U6(this.otherGuid,E);break;case y.Dl.Hl:var w=y.Rv.Tv.PeerInfoMessage.decode(t.bv);O&&this.logger.debug("RECEIVED PEER INFO FROM "+this.otherGuid),this.lj.XQ(w);break;case y.Dl.Ping:var p=y.Rv.Tv.Ping.decode(t.bv);O&&this.logger.debug("RECEIVED PING FROM "+this.otherGuid),this.lj.F6(p);break;case y.Dl.Pong:var g=y.Rv.Tv.Pong.decode(t.bv);O&&this.logger.debug("RECEIVED PONG FROM "+this.otherGuid),this.lj.G6(g);break;case y.Dl.Ul:var b=y.Rv.Tv.NoPartners.decode(t.bv);O&&this.logger.debug("RECEIVED NON PARTNER MESSAGE FROM "+this.otherGuid),this.H6.x6(this.otherGuid,b);break;default:this.logger.warn("UNKNOWN MESSAGE TYPE "+t.wv)}}catch(t){T.ErrorMonitor.Z().logError("Error dispatching message",this.loggerId,t,m.qt.Qt,t)}},c.prototype.Zl=function(t,i){return this.la.Zl(t,this.swarmId,i)},c.prototype.cv=function(){this.sender.cv()},c);function c(t,i,n,r){this.loggerId="[P2PDispatcher] ",this.logger=s.Framework.resolve(s.Framework.p.T).log(t.sessionId),this.Vl=i,this.otherGuid=n,this.swarmId=t.swarmId,this.la=r,this.receiver=new h.B6(i,n,t),this.sender=new o.V6(i,n,t,this),this.H6=t.fj,this.lj=t.lj,this.VZ=t.VZ,(a||s.Framework.O()&&e.VM.xM)&&(this.OZ=t.OZ)}i.Bl=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(33),e=n(18),u=n(0),a=n(6),f=n(5),h=n(96),c=n(1),l=n(2),o=(v.prototype.setReportingGuid=function(t){this.q6=t},v.prototype.Xl=function(){return!(0===this.Q6.keys().length&&null===this.Y6)},v.prototype.K6=function(t){var i=new e.Rv.Tv.Request();try{i.fragmentId=t.qp(),i.transferId=t.AP,this.Cl&&this.logger.debug("INITIATING TR-"+t.AP+" TIMEOUT: "+t.W6+" FRAGMENT: "+t.qp()+" FROM: "+this.otherGuid),this.Q6.set(t.AP,t),this.X6.set(t.AP,u.Framework.time())}catch(t){c.ErrorMonitor.Z().logError("Error constructing fragment request message",this.loggerId,l.Vr.qr,{detailedError:t,otherGuid:this.otherGuid}),i=null}try{i&&t.mU.TQ.Zl(e.Dl.Request,i)}catch(t){c.ErrorMonitor.Z().logError("Error sending fragment request",this.loggerId,l.Vr.Qr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.D6=function(t){try{var i=t.transferId,n=t.data.oC(),r=t.chunkSize,s=t.totalSize,e=t.headers;if(this.Cl&&this.logger.debug("RCV Chunk "+n.byteLength),!this.Q6.has(i))return;null==this.Y6?(this.Cl&&this.logger.debug("INITIATED TR-"+i+",SIZE="+s),this.Y6=this.Q6.get(i),this.Y6.AP=i,f.Ku.Fu.tu&&this.J6(i,this.Y6.mU),null!=e?this.Y6.eg=e:this.logger.warn("HEADERS NULL IN FIRST CHUNK"),this.H6.E2(this.otherGuid,this.Y6,r,s),this.Y6.og=r,u.Framework.O()||(this.Y6.hg=n)):(f.Ku.Fu.tu&&this.J6(i,this.Y6.mU),this.Y6.og+=r,u.Framework.O()||(this.Y6.hg=a.appendBuffer(this.Y6.hg,n)));var h=u.Framework.O()?this.Y6.og:this.Y6.hg.byteLength;if(this.Cl&&this.logger.debug("RECEIVED "+h+"/"+s+" TRID "+i),h==s){this.Cl&&this.logger.debug("RCV ALL DATA "+h+" TR-"+this.Y6.Yp),this.Y6.Zp.kp=h,u.Framework.clearTimeout(this.Y6.ZV),this.Q6["delete"](i);var o=u.Framework.time()-this.X6.get(i);this.logger.debug("RCV ALL DATA FROM "+this.otherGuid+" AFTER "+o+" mseconds"),this.X6["delete"](i),this.H6.kj(i,this.Y6),this.Y6=null}}catch(t){c.ErrorMonitor.Z().logError("Error receiving chunk",this.loggerId,l.Vr.Yr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.J6=function(t,i){try{this.Cl&&this.logger.debug("SEND ACK "+t+" TO "+this.otherGuid);var n=new e.Rv.Tv.Ack();n.transferId=t,i.TQ.Zl(e.Dl.Ack,n)}catch(t){c.ErrorMonitor.Z().logError("Error sending ack",this.loggerId,l.Vr.Kr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.close=function(t){var i=this,n=r.defer();return null!=this.Y6&&this.z6(this.Y6.AP),this.Q6.keys().slice().forEach(function(t){i.z6(t)}),n.resolve(h.Lq.DV),n.promise},v.prototype.z6=function(t){try{if(this.Q6.has(t)){var i=this.Q6.get(t);i.Zp.kp=i.og,this.logger.debug("SEND CANCEL FOR "+t+" TO "+this.otherGuid),this.X6["delete"](t);var n=new e.Rv.Tv.Cancel();n.transferId=t,i.mU.TQ.Zl(e.Dl.Cancel,n),null!==this.Y6&&this.Y6.Qp()===i.Qp()&&(this.Y6=null),this.Q6["delete"](t)}else c.ErrorMonitor.Z().logError("Error cleaning up a not pending transfer",this.loggerId,l.Vr.Wr)}catch(t){c.ErrorMonitor.Z().logError("Error sending stop transfer",this.loggerId,l.Vr.$r,{detailedError:t,otherGuid:this.otherGuid})}},v);function v(t,i,n){this.loggerId="[FragmentRequester] ",this.Q6=new s(),this.X6=new s(),this.Y6=null,this.Cl=e.Cl,this.Vl=t,this.otherGuid=i,this.H6=n.fj,this.cj=n.cj,this.Wl=u.Framework.resolve(u.Framework.p.$l),this.logger=u.Framework.resolve(u.Framework.p.T).log(n.sessionId)}i.B6=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var o=n(3),u=n(0),a=n(5),f=n(2),c=n(1),r=(s.prototype.CQ=function(t){this.reportingGuid=t,this.TQ&&(this.TQ.receiver.setReportingGuid(this.reportingGuid),this.TQ.sender.setReportingGuid(this.reportingGuid))},s.prototype.Z6=function(t,i,n){var r=Math.max(1,i);for(n&&(this.t8+=r,this.n8+=t);this.r8.length>a.Ku.Hu.Bo;)this.r8.pop();var s=t/r;this.r8.unshift(s)},s.prototype.s8=function(t){this.Q6.has(t)?this.logger.warn(this.guid+" DUPLICATE {} PENDING REQUESTS "+t):this.Q6.set(t,u.Framework.time())},s.prototype.e8=function(t,i,n,r,s,e){try{if(this.Q6.has(t)){var h=this.Q6.get(t),o=u.Framework.time()-h;this.Q6["delete"](t),r&&s&&this.Z6(i,o,!0),this.IU.success(i),this.DH.h8(this.reportingGuid,i,n,s,e)}else c.ErrorMonitor.Z().logError("Error completing a non-existing request",this.loggerId,f._s.As,{otherGuid:this.guid,q6:this.reportingGuid})}catch(t){c.ErrorMonitor.Z().logError("Error handling request completed",this.loggerId,f._s.Is,{detailedError:t,otherGuid:this.guid,q6:this.reportingGuid})}},s.prototype.o8=function(t,i,n,r,s,e){try{if(this.Q6.has(t)){var h=this.Q6.get(t);this.Q6["delete"](t),a.Ku.Hu.Vo?this.Z6(i,h,!0):this.Z6(0,h,!0),this.IU.u8(i,r),this.DH.a8(this.reportingGuid,i,n,r,s,e)}else c.ErrorMonitor.Z().logError("Error partially failed a non-existing request",this.loggerId,f._s.ks,{otherGuid:this.guid,q6:this.reportingGuid})}catch(t){c.ErrorMonitor.Z().logError("Error handling request partially failed ",this.loggerId,f._s.Ns,{detailedError:t,otherGuid:this.guid})}},s.prototype.IP=function(t,i,n){try{if(this.Q6.has(t)){var r=this.Q6.get(t);this.Q6["delete"](t),this.Z6(0,r,!0),this.IU.failed(),this.DH.f8(this.reportingGuid,n,i)}else c.ErrorMonitor.Z().logError("Error failed a non-existing request",this.loggerId,f._s.Ds,{otherGuid:this.guid,q6:this.reportingGuid})}catch(t){c.ErrorMonitor.Z().logError("Error handling request failed ",this.loggerId,f._s.Cs,{detailedError:t,otherGuid:this.guid})}},s.prototype.c8=function(t,i){this.DH.l8(t,i,!0)},s.prototype.v8=function(t,i){this.DH.d8(t,i,!0)},s.prototype.E8=function(t,i,n){this.DH.w8(t,i,n,!0)},s.prototype.yP=function(){var t=this.r8.reduce(function(t,i){return t+i},0);return 0<this.r8.length?t/this.r8.length:0},s.prototype.p8=function(t){this.g8=t},s.prototype.b8=function(){return this.g8},s.prototype.gQ=function(){return this.lP.gQ()},s.prototype.y8=function(){return this.handshakeDelay},s.prototype.T8=function(t){var i=Math.max(0,this.uY-t);0<i&&i<a.Ku.ku.to&&(this.handshakeDelay=i)},s);function s(t,i,n,r,s,e,h){this.loggerId="[Partner] ",this.n8=0,this.t8=0,this.g8=0,this.r8=new Array(),this.m8=new Array(),this.Q6=new o(),this.handshakeDelay=-1,this.logger=r,this.TQ=n,this.guid=t,this.lP=e,this.O8=s,this.DH=i,this.IU=u.Framework.resolve(u.Framework.p.AD),this.NU=u.Framework.resolve(u.Framework.p.AD),this.uY=u.Framework.time(),h&&this.T8(h)}i.Partner=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(35),r=n(3),h=n(0),u=n(9),l=n(18),o=n(5),v=n(1),s=n(181),d=n(2),a=(f.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.p.T).log(t.sessionId),this.cj=t.cj,this.rw=t.rw,this.uploadScore=t.uploadScore,this.uj=t.uj,this.EQ=t.nU},f.prototype.nQ=function(t){return this.SQ(t.peerInfo.guid)},f.prototype.SQ=function(t){return this.NF.has(t)||this.AF.has(t)},f.prototype.zQ=function(t){return this.AF.has(t)?this.AF.get(t):this.NF.get(t)},f.prototype.zq=function(t){return this.FQ(t.peerInfo.guid)},f.prototype.FQ=function(t){return this.kF.has(t)||this.sQ.has(t)},f.prototype.GQ=function(t){return this.kF.has(t)?this.kF.get(t):this.sQ.get(t)},f.prototype.MQ=function(o){var u=this;try{var t=this.cj.S8();if(this.R8&&!t)if(this.SQ(o)){var a=this.zQ(o),f=this.uploadScore._8(!1),c=[];this.rw._1().then(function(t){u.logger.debug(u.AH+"SEND ALL HAVES TO "+o+","+t.length);for(var i=0;i<t.length;i++){var n=0;n=u.context.isLive()?t[i].size():t[i].totalSize;var r=t[i].Vp,s=new l.Rv.Tv.Have();s.setFragmentId(r.qp()),s.setSize(n),s.setUploadScore(f);var e=r;s.setId(e.KM()),s.setBitrate(e.bitrate),s.setDuration(e.duration),s.setType(e.Bp()),c.push(s)}if(0<c.length){var h=new l.Rv.Tv.Haves();h.setHave(c),a.TQ.Zl(l.Dl.Haves,h)}})}else v.ErrorMonitor.Z().logError("Error sending all haves to peer who is not out partner",this.AH,d.wi.Oi,{otherGuid:o})}catch(t){v.ErrorMonitor.Z().logError("Error sending all haves",this.AH,d.wi.pi,{detailedError:t,otherGuid:o})}},f.prototype.B0=function(i,n,r){var s=this,t=this.cj.S8();if(this.R8&&!t){var e=this.AF.values();this.NF.forEach(function(t,i){e.push(t)});var h=this.uploadScore._8(!1);e.forEach(function(t){(!r||r&&t.guid!=r.guid)&&s.I8(t.TQ,i,n,h)})}},f.prototype.I8=function(i,t,n,r){this.A8&&this.logger.debug(this.AH+"SEND HAVE TO "+i.otherGuid+" FOR "+t.qp());try{var s=new l.Rv.Tv.Have();s.setFragmentId(t.qp()),s.setSize(n),s.setUploadScore(r);var e=t;s.setId(e.KM()),s.setBitrate(e.bitrate),s.setDuration(e.duration),s.setType(e.Bp()),i.Zl(l.Dl.Have,s)}catch(t){v.ErrorMonitor.Z().logError("Error sending have ",this.AH,d.wi.gi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.P6=function(i,t){try{if(this.FQ(i)){this.N8&&this.logger.debug(this.AH+"HAVE RECEIVED FROM "+i+": "+t.fragmentId);var n=this.GQ(i);n.p8(t.getUploadScore()),this.uj.put(t,n),this.context.ZH(t)}else v.ErrorMonitor.Z().logError("Error receiving have from unknown peer",this.AH,d.wi.bi,{otherGuid:i})}catch(t){v.ErrorMonitor.Z().logError("Error handling received have",this.AH,d.wi.Ti,{detailedError:t,otherGuid:i})}},f.prototype.U6=function(i,t){var n=this;try{if(this.FQ(i)){this.N8&&this.logger.debug(this.AH+"BATCH HAVES RECEIVED FROM "+i);var r=this.GQ(i);t.getHave().forEach(function(t){r.p8(t.getUploadScore()),n.uj.put(t,r)}),this.context.ZH(t.getHave()[0])}else v.ErrorMonitor.Z().logError("Error receiving haves from unknown peer",this.AH,d.wi.yi,{otherGuid:i})}catch(t){v.ErrorMonitor.Z().logError("Error handling received haves",this.AH,d.wi.mi,{detailedError:t,otherGuid:i})}},f.prototype.pQ=function(i){try{var t=new l.Rv.Tv.Ping();t.id=this.cj.getId(),t.startTs=h.Framework.time(),this.logger.debug(this.AH+"REQUEST PING TO PEER GUID "+i.otherGuid),i.Zl(l.Dl.Ping,t)}catch(t){v.ErrorMonitor.Z().logError("Error requesting ping",this.AH,d.wi.Ri,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.F6=function(i){try{var t=i.id;if(!this.SQ(t))return void v.ErrorMonitor.Z().logError("Error receiving ping from an unknown peer",this.AH,d.wi.Ii,{otherGuid:t});var n=-1;i.startTs&&(n=i.startTs),this.k8(this.zQ(t).TQ,n)}catch(t){v.ErrorMonitor.Z().logError("Error handling received ping",this.AH,d.wi._i,{detailedError:t,otherGuid:i.id})}},f.prototype.C8=function(){try{for(var t="",i=0;i<o.Ku.Fu.Xo;i++)t+=String.fromCharCode(33+93*Math.random());var n=new ArrayBuffer(t.length),r=new Uint8Array(n),s=t.length;for(i=0;i<s;i++)r[i]=t.charCodeAt(i);this.D8=e.wrap(r)}catch(t){v.ErrorMonitor.Z().logError("Error creating random buffer for ping pong",this.logger,d.wi.Si,t)}},f.prototype.k8=function(i,t){try{var n=new l.Rv.Tv.Pong();n.id=this.cj.getId(),n.startTs=t,this.D8||this.C8(),n.data=this.D8,n.dataSize=o.Ku.Fu.Xo,this.logger.debug(this.AH+"SEND PONG TO PEER GUID "+i.otherGuid),i.Zl(l.Dl.Pong,n)}catch(t){v.ErrorMonitor.Z().logError("Error sending pong",this.AH,d.wi.Ai,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.G6=function(i){try{var t=i.id;if(!this.FQ(t))return void v.ErrorMonitor.Z().logError("Error receiving a pong from an unknown peer",this.AH,d.wi.Ni,{otherGuid:t});var n=h.Framework.time();if(i.startTs&&0<i.startTs){var r=n-i.startTs,s=this.GQ(t);i.dataSize==i.data.Wa().byteLength?s.Z6(i.dataSize,r,!0):v.ErrorMonitor.Z().logError("Error receing pong with wrong data size",this.AH,d.wi.ki,{otherGuid:t})}else v.ErrorMonitor.Z().logError("Error receiving pong with wrong timestamp",this.AH,d.wi.Ci,{otherGuid:t})}catch(t){v.ErrorMonitor.Z().logError("Error receiving pong",this.AH,d.wi.Di,{detailedError:t,otherGuid:i.id})}},f.prototype.DF=function(){try{var t=new r();return this.M8(this.kF,t),this.M8(this.sQ,t),t}catch(t){return v.ErrorMonitor.Z().logError("Error getting partner snapshots",this.AH,d.wi.Mi,t),new r()}},f.prototype.M8=function(t,h){var o=this;t.forEach(function(t,i){var n=new hive.snapshots.Partner();n.inPart=!0,n.outPart=o.SQ(i),n.connInfo=new hive.snapshots.ConnectivityInfo();var r=void 0;t.lP.peerInfo.publicIpString&&(r=t.lP.peerInfo.publicIpString);var s=void 0;t.lP.peerInfo.privateIpString&&(s=t.lP.peerInfo.privateIpString),n.connInfo.publicIp=r,n.connInfo.privateIp=s,n.connInfo.externalAs=t.lP.peerInfo.externalAs,n.connInfo.internalAs=t.lP.peerInfo.internalAs;var e=o.j8();e.rateReceived=t.yP(),n.metrics=e,-1!=t.y8()&&(n.metrics.handshakeDelay=t.y8()),n.udp=t.lP.peerInfo.type==u.Rf.If,h.set(t.reportingGuid,n)})},f.prototype.IF=function(){return new s.P8(this.kF.length,this.sQ.length,this.NF.length,this.AF.length)},f.prototype.j8=function(){var t=new hive.snapshots.PartnerMetrics();return t.rateReceived=0,t.rateSent=0,t.handshakeDelay=0,t},f);function f(){this.AH="[PARTNERSHIP] ",this.sQ=new r(),this.kF=new r(),this.AF=new r(),this.NF=new r(),this.A8=!1,this.N8=!1,this.R8=!0,this.active=!1,this.C8(),this.uQ=[]}i.Fq=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.kF=t,this.CF=i,this.NF=n,this.AF=r}i.P8=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(33),e=n(35),h=n(18),o=n(0),u=n(183),a=n(5),f=n(1),c=n(2),l=(v.prototype.setReportingGuid=function(t){this.q6=t},v.prototype.L8=function(t,i,n,r,s){var e=this;this.Cl&&this.logger.info("SEND FRAGMENT "+t+" TO "+this.otherGuid);try{var h=new u.H8();h.transferId=i,h.fragmentId=t,h.U8=s,h.headers=r,h.F8=n,h.G8=Math.ceil(h.F8/a.Ku.Fu.Xo),h.x8=0,this.B8.push(h),this.Cl&&this.B8.forEach(function(t){e.logger.debug(e.otherGuid+" PENDING OUT "+t)})}catch(t){f.ErrorMonitor.Z().logError("Error constructing chunk response",this.loggerId,c.Jr.zr,{detailedError:t,otherGuid:this.otherGuid})}null===this.response?this.V8():this.Cl&&this.logger.debug(this.otherGuid+" OUT MSG NOT NULL")},v.prototype.M6=function(t){this.Cl&&this.logger.debug("ONGOING "+t+" GOT ACK"),null!==this.response&&this.response.transferId.toString()===t.toString()?this.q8(!1):f.ErrorMonitor.Z().logError("Error receiving ack for unknown transfer",this.loggerId,c.Jr.rs)},v.prototype.cv=function(){null!=this.response&&this.q8(!1)},v.prototype.j6=function(i){null!=this.response&&this.response.transferId===i?(this.logger.debug("GOT CANCEL FOR ONGOING TR-"+i),this.logger.debug("TRANSPORT CANCEL STATS "+this.Vl+","+this.otherGuid+","+i),this.Q8["delete"](i),0!=this.response.x8?this.VZ.Y8(this.otherGuid,this.q6,this.response.x8,this.response.F8):this.VZ.K8(this.otherGuid,this.q6,this.response.F8),this.response=null,this.V8()):this.B8=this.B8.filter(function(t){return t.transferId!==i})},v.prototype.V8=function(){try{if(null===this.response&&0!==this.B8.length){var t=this.B8.shift();this.response=t,this.Cl&&this.logger.debug("DATA TO SEND LENGTH "+this.response.F8+" IN "+this.response.G8+" CHUNKS WITH TR-"+this.response.transferId),this.q8(!0)}}catch(t){f.ErrorMonitor.Z().logError("Error start sending chunks",this.loggerId,c.Jr.Zr,t),this.zl()}},v.prototype.q8=function(t){t&&(this.Q8.set(this.response.transferId,o.Framework.time()),this.W8=this.response.G8);try{if(null!=this.response)if(0===this.response.G8)this.logger.debug("FINISHED SENDING TRANSFER "+this.response.transferId+" WITH "+this.response.x8+" BYTES"),this.Q8["delete"](this.response.transferId),this.VZ.X8(this.otherGuid,this.q6,this.response.F8),this.response=null,this.J8(),this.V8();else{this.Cl&&this.logger.debug("A CHUNK");var i=Math.min(this.response.x8+a.Ku.Fu.Xo,this.response.F8),n=i-this.response.x8,r=new h.Rv.Tv.Chunk();if(r.transferId=this.response.transferId,r.totalSize=this.response.F8,r.chunkSize=n,t&&null!=this.response.headers&&(r.headers=this.response.headers),o.Framework.O()||null==this.response.U8)r.data=e.wrap(new ArrayBuffer(0));else if(r.data=this.dj.z8(this.response.fragmentId,this.W8-this.response.G8),null==r.data){var s=this.response.U8.slice(this.response.x8,i);r.data=e.wrap(s)}this.response.x8=this.response.x8+n,this.TQ.Zl(h.Dl.Chunk,r),this.Cl&&this.logger.debug("SND ["+this.response.x8+"-"+(this.response.x8+n)+"/"+this.response.F8+"] TO "+this.otherGuid+" OF TR-"+this.response.transferId),this.response.G8--}else this.logger.debug("NO MESSAGE TO SEND")}catch(t){f.ErrorMonitor.Z().logError("Error sending chunk",this.loggerId,c.Jr.ns,{detailedError:t,otherGuid:this.otherGuid}),this.zl()}},v.prototype.Xl=function(){return!(0===this.B8.length&&null===this.response)},v.prototype.C6=function(){var t=r.defer();return this.B8.length=0,this.Xl()?this.close=t:t.resolve("CLOSE"),t.promise},v.prototype.J8=function(){this.close&&this.close.resolve("CLOSED")},v.prototype.zl=function(){this.response=null},v);function v(t,i,n,r){this.loggerId="[FragmentSender] ",this.Cl=h.Cl,this.response=null,this.B8=new Array(),this.Q8=new s(),this.W8=0,this.close=null,this.Vl=t,this.otherGuid=i,this.VZ=n.VZ,this.TQ=r,this.dj=n.dj,this.logger=o.Framework.resolve(o.Framework.p.T).log(n.sessionId),this.Wl=o.Framework.resolve(o.Framework.p.$l)}i.V6=l},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.headers=null}i.H8=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.pv=r},function(t){t.exports=JSON.parse('{"package":"HiveMsgs","messages":[{"name":"Chunk","fields":[{"rule":"required","type":"int32","name":"transferId","id":1},{"rule":"required","type":"int32","name":"totalSize","id":2},{"rule":"required","type":"int32","name":"chunkSize","id":3},{"rule":"required","type":"bytes","name":"data","id":4},{"rule":"optional","type":"string","name":"headers","id":5}]},{"name":"Haves","fields":[{"rule":"repeated","type":"Have","name":"have","id":1}]},{"name":"Have","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"size","id":2},{"rule":"required","type":"int32","name":"type","id":3},{"rule":"required","type":"int32","name":"id","id":4},{"rule":"required","type":"int32","name":"bitrate","id":5},{"rule":"required","type":"int32","name":"duration","id":6},{"rule":"required","type":"float","name":"uploadScore","id":7}]},{"name":"Ping","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"uint64","name":"startTs","id":2}]},{"name":"Pong","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"bytes","name":"data","id":2},{"rule":"required","type":"int32","name":"dataSize","id":3},{"rule":"required","type":"uint64","name":"startTs","id":4}]},{"name":"Request","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"transferId","id":2}]},{"name":"DoNotHave","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"NoPartners","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Cancel","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Ack","fields":[{"rule":"optional","type":"int32","name":"transferId","id":1}]},{"name":"Close","fields":[{"rule":"required","type":"int32","name":"type","id":1}]},{"name":"StreamCharacteristics","fields":[{"rule":"required","type":"int32","name":"streamState","id":1},{"rule":"required","type":"int32","name":"bitrate","id":2},{"rule":"required","type":"int32","name":"delta","id":3}]},{"name":"OutPartnershipRequest","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"string","name":"contextId","id":2},{"rule":"required","type":"string","name":"p2pProtocolVersion","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"optional","type":"string","name":"publicIpString","id":6},{"rule":"optional","type":"string","name":"privateIpString","id":7},{"rule":"required","type":"string","name":"reportingGuid","id":8},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":9}]},{"name":"OutPartnershipResponse","fields":[{"rule":"required","type":"int32","name":"accept","id":1},{"rule":"optional","type":"int32","name":"internalAs","id":2},{"rule":"optional","type":"int32","name":"externalAs","id":3},{"rule":"optional","type":"string","name":"publicIpString","id":4},{"rule":"optional","type":"string","name":"privateIpString","id":5},{"rule":"optional","type":"string","name":"reportingGuid","id":6},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":7}]},{"name":"PeerInfoMessage","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"optional","type":"string","name":"publicIpString","id":2},{"rule":"optional","type":"string","name":"privateIpString","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":6}]},{"name":"UDPHandshakeMessage","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"string","name":"streamId","id":2},{"rule":"required","type":"float","name":"udpScore","id":3},{"rule":"required","type":"bool","name":"isLeader","id":4}]},{"name":"UDPHandshakeResponse","fields":[{"rule":"required","type":"string","name":"accept","id":1}]},{"name":"UDPSwitchLeadershipRequest","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"float","name":"udpScore","id":2}]},{"name":"UDPSwitchLeadershipAck","fields":[{"rule":"required","type":"bool","name":"ok","id":1}]},{"name":"Bitrate","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"int32","name":"bitrate","id":2}]}]}')},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(5),s=(e.tS=function(t,i){var n=0;return 0!=(n=t.udpScore>i.udpScore?1:t.udpScore<i.udpScore?-1:0)?-n:r.Ku.UDPBroadcast.eu?i.uuid.localeCompare(t.uuid):t.uuid.localeCompare(i.uuid)},e);function e(t,i,n,r,s){this.udpScore=0,this.FV=!1,this.streamId="",this.uuid=t,this.udpScore=i,n&&(this.address=n),r&&(this.FV=r),s&&(this.streamId=s)}i.HV=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(6),h=n(0),e=n(8),o=n(9),u=n(1),a=n(2),f=(c.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.p.T).log(t.sessionId),this.uj=t.uj,this.lj=t.lj,this.aj=t.aj,this.cj=t.cj,this.DH=t.nU,this.t9.Z8(t.cj)},c.prototype.request=function(t){this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+t.Vp.toString()+"-"+t.Zp.kp+" ["+e.yf[t.Bp()]+"] TO P2P"),this.Q6.set(t.Qp(),t);var i=this.Sv.next();t.AP=i,this.i9.set(i,t.Qp()),this.X1(t)},c.prototype.X1=function(t){var i=t.qp(),n=t.Qp(),r=this.n9(i);t.size=this.uj.uP(i).size;var s=this.t9.r9(r,t.type);null!=s?(this.logger.info("SELECT "+s.TQ.otherGuid+" (LAN LEADER "+s.lP.peerInfo.isLeader+" iAS "+s.lP.peerInfo.internalAs+" eAS "+s.lP.peerInfo.externalAs+" privateIp "+s.lP.peerInfo.privateIpString+" ) out of "+r.length+" type "+o.Rf[s.lP.peerInfo.type]+" size:"+t.size+" FOR TRANSFER"+t.AP+" REQUEST ID "+n),t.mU=s,t.V0=s.lP.peerInfo,t.mU.s8(t.AP),t.Zp.Ip=!0,t.Zp.Lp=h.Framework.time(),this._P(t)?(this.DH.s9(t),s.TQ.receiver.K6(t)):this.e9(t)):(u.ErrorMonitor.Z().logError("Error sending p2p request because we cannot find a partner",this.loggerId,a.ss.es),this.IP(t.AP,"NO PARTNERS FOUND FOR REQUEST"))},c.prototype.n9=function(t){var i=this,n=[];try{this.uj.aP(t).forEach(function(t){i.lj.FQ(t.guid)?n.push(t):i.logger.warn("I HAVE A HAVE FROM A NON IN-PARTNER "+t.guid)})}catch(t){u.ErrorMonitor.Z().logError("Error filtering in partners",this.loggerId,a.ss.hs,t)}return n},c.prototype.e9=function(t){var i=t.AP;if(this.logger.info("REQUEST "+t.AP+" TO "+t.mU.guid+" ABORTED BECAUSE OF SLOW P2P CONNECTION"),this.i9.has(i)){var n=this.i9.get(i);this.i9["delete"](i);var r=this.Q6.get(n);this.Q6["delete"](n),this.aj.D0(r)}},c.prototype._P=function(t){var i=this,n=!1;try{var r=0;null==t.size?(r=this.uj.uP(t.qp()).size,t.size=r,this.logger.warn("request size not set - this should not happen")):r=t.size;var s=r-t.og,e=t.ag.q0().zB(t,s);return 0<(t.W6=e)&&(n=!0,null==t.ZV&&(t.ZV=h.Framework.setTimeout(function(){i.h9(t)},e))),n}catch(t){return u.ErrorMonitor.Z().logError("Error setting request timeout",this.loggerId,a.ss.us,t),!1}},c.prototype.h9=function(t){this.DH.o9(t),this.IP(t.AP,"TIMED-OUT")},c.prototype.IP=function(t,i){this.logger.info(i+" "+t);var n=this.u9(t,!0);this.logger.warn("REQUEST "+t+" FOR "+n.Qp()+" FAILED BECAUSE "+i),n&&this.aj.T0(n)},c.prototype.u9=function(t,i){try{if(this.i9.has(t)){var n=this.i9.get(t);this.i9["delete"](t);var r=this.Q6.get(n);if(this.Q6["delete"](n),h.Framework.clearTimeout(r.ZV),i&&this.lj.FQ(r.mU.TQ.otherGuid)){r.mU.TQ.receiver.z6(t);var s=r.Bp()==e.yf.mf;0!=r.og?r.mU.o8(r.AP,r.og,r.Zp.p2pAgenTrafficSuccessQt,r.size,s,r.type):r.mU.IP(r.AP,s,r.size)}return r}return u.ErrorMonitor.Z().logError("Error cancelling request on non existing session",this.loggerId,a.ss.cs),null}catch(t){return u.ErrorMonitor.Z().logError("Error removing request",this.loggerId,a.ss.fs,t),null}},c.prototype.y0=function(t){if(this.Q6.has(t)){var i=this.Q6.get(t).AP;this.u9(i,!0)}},c.prototype.E2=function(t,i,n,r){this.logger.debug("FRL DOWNLOADING "+i.Qp()+" FROM "+t+" P2P")},c.prototype.kj=function(t,i){if(this.logger.debug("FRL PROMISED FRAGMENT "+i.Qp()+" RETURNED FROM P2P SIZE "+i.Zp.kp),i=this.u9(t,!1)){i.Zp.Up=h.Framework.time();var n=i.Bp()==e.yf.mf;i.mU.e8(i.AP,i.size,i.Zp.p2pAgenTrafficSuccessQt,!0,n,i.type),this.aj.O0(i)}else this.logger.warn("TRIED TO REMOVE A NON EXISTING REQUEST "+t+" (THIS SHOULD NOT HAPPEN. AT LEAST NOT TOO OFTEN)")},c.prototype.L6=function(t){var i=t.getTransferId();if(this.i9.has(i)){u.ErrorMonitor.Z().logError("Error receiving a do not have for my request",this.loggerId,a.ss.ls),this.logger.debug("DO NOT HAVE RECEIVED FOR "+i);var n=this.u9(i,!1);if(n){var r=n.Bp()==e.yf.mf;n.mU.IP(n.AP,r,n.size),this.aj.T0(n)}}else this.logger.warn("UNKNOWN DO NOT HAVE "+i)},c.prototype.x6=function(t,i){var n=i.transferId;if(this.i9.has(n)){u.ErrorMonitor.Z().logError("Error rejected request by a non partner",this.loggerId,a.ss.vs),this.lj.bQ(t);var r=this.u9(n,!1);r&&this.aj.T0(r)}},c.prototype.eh=function(t){return this.Q6.has(t)},c);function c(){this.loggerId="[P2PRequester] ",this.Sv=new s.Counter(),this.Q6=new r(),this.i9=new r(),this.t9=h.Framework.resolve(h.Framework.p.mD)}i.hZ=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(18),e=n(1),h=n(2),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.p.T).log(t.sessionId),this.MV=t,this.uj=t.uj,this.rw=t.rw,this.lj=t.lj,this.uploadScore=t.uploadScore,this.cj=t.cj,this.DH=t.nU},u.prototype.NH=function(t,i,n){try{if(this.lj.SQ(t)){var r=this.lj.zQ(t);this.a9(t,i,r)}else this.f9(t,i,n)}catch(t){e.ErrorMonitor.Z().logError("Error on responding to p2p request",this.loggerId,h.ds.Es,t)}},u.prototype.X8=function(t,i,n){try{if(this.uploadScore.success(n),this.lj.SQ(t)){var r=this.lj.zQ(t);r.NU.success(n),r.c8(n,i)}}catch(t){e.ErrorMonitor.Z().logError("Error on request satisfied",this.loggerId,h.ds.ws,t)}},u.prototype.Y8=function(t,i,n,r){try{if(this.uploadScore.u8(n,r),this.lj.SQ(t)){var s=this.lj.zQ(t);s.NU.u8(n,r),s.E8(n,r,i)}}catch(t){e.ErrorMonitor.Z().logError("Error on request partially satisfied",this.loggerId,h.ds.ps,t)}},u.prototype.K8=function(t,i,n){try{if(this.uploadScore.failed(),this.lj.SQ(t)){var r=this.lj.zQ(t);r.NU.failed(),r.v8(n,i)}}catch(t){e.ErrorMonitor.Z().logError("Error on request not satisfied",this.loggerId,h.ds.gs,t)}},u.prototype.a9=function(i,n,r){var s=this;this.rw.get(n.fragmentId).then(function(t){t?(s.logger.debug("SENDING TO "+i+","+n.fragmentId+","+n.transferId+","+t.length+" DL "+t.length),r.TQ.sender.L8(n.fragmentId,n.transferId,t.length,t.headers,t.data)):(s.logger.debug("RECEIVED REQUEST FOR "+n.fragmentId+" FROM "+i+" CAN'T BE SERVED"),s.c9(n.transferId,r))})},u.prototype.c9=function(t,i){try{this.logger.info("SEND DO NOT HAVE "+t+" TO "+i.TQ.Vl);var n=new s.Rv.Tv.DoNotHave();n.setTransferId(t),i.TQ.Zl(s.Dl.DoNotHave,n)}catch(t){e.ErrorMonitor.Z().logError("Error on sending do not have",this.loggerId,h.ds.bs,t)}},u.prototype.f9=function(t,i,n){try{this.logger.warn("GOT REQUEST FROM NON-PARTNER "+t+" FOR "+i.fragmentId);var r=new s.Rv.Tv.NoPartners();r.setTransferId(i.transferId),n.Zl(s.Dl.Ul,r)}catch(t){e.ErrorMonitor.Z().logError("Error on send no partners",this.loggerId,h.ds.ys,t)}},u);function u(){this.loggerId="[P2PResponder] "}i.oZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(33),o=n(0),s=n(5);(r=e=i.l9||(i.l9={}))[r.S=0]="S",r[r.v9=1]="F",r[r.d9=2]="PF";var u=function(t){this.ts=t},a=function(){this.E9=0,this.w9=0,this.p9=0,this.g9=0,this.b9=0,this.y9=0};i.T9=a;var f=(c.prototype.success=function(t){this.event(e.S,t,t)},c.prototype.failed=function(){this.event(e.v9,0,0)},c.prototype.u8=function(t,i){this.event(e.d9,t,i)},c.prototype.event=function(t,i,n){var r=new u(o.Framework.time());r.t=t,r.m9=i,r.O9=i/n,r.S9=(n-i)/n,this.R9.set(r.ts,r),this._9()},c.prototype._9=function(){var i=this,n=o.Framework.time()-2*s.Ku.Hu.qo;if(0<n){var r=[];this.R9.forEach(function(t,i){i<n&&r.push(i)}),r.forEach(function(t){i.R9["delete"](t)})}},c.prototype._U=function(t){var i=0,n=this.I9(t,s.Ku.Hu.qo);return null!=n&&(i=0==n.w9+n.p9+n.g9?0:(n.w9-s.Ku.Hu.Qo*(n.g9+n.p9))/(n.w9+s.Ku.Hu.Qo*(n.g9+n.p9))),i},c.prototype._8=function(t){var i=0,n=this.I9(t,s.Ku.Hu.qo);if(null!=n){var r=n.w9+n.p9+n.g9;i=0==r?0:(n.p9+n.g9*s.Ku.Hu.Ko)/r}return i},c.prototype.A9=function(t){var i=this.I9(!1,t);return null!=i?i.E9:0},c.prototype.I9=function(t,i){if(0==this.R9.keys().length)return null;var n=new a(),r=o.Framework.time()-i;r<0&&(r=0);var s=new h();return this.R9.forEach(function(t,i){r<=i&&s.set(i,t)}),s.forEach(function(t,i){switch(n.E9+=t.m9,t.t){case e.S:n.w9++;break;case e.v9:n.p9++;break;default:n.g9++,n.b9+=t.O9,n.y9+=t.S9}}),n},c.Ko=.2,c.Yo=.2,c);function c(){this.R9=new h()}i.uZ=f},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(4),u=n(0),a=n(191),f=n(193),c=n(97),l=n(2),v=n(1),d=n(15),E=(e=f.N9,s(w,e),w.prototype.start=function(t,i){void 0===i&&(i=[]);var n=u.Framework.resolve(u.Framework.p.T).log(t),r=null;return 0==this.gm.keys().length?(n.debug("TRIGGERING CONNECT "),r=this.k9(),this.C9(t,i)):(n.debug("ALREADY CONNECTED "),r=this.tl.bl(),this.C9(t,i),this.D9.isConnected()&&this.M9(this.pd,t)),r},w.prototype.k9=function(){var n=this,r=d.qc.Ic;return"localhost"===r&&(r="127.0.0.1:"+location.port),this.logger.debug("CONNECTING.."),this.tl.bl().then(function(t){var i=t.Ol();return n.logger.debug("MY IDENTITY ",i),n.pd=i,n.D9.start(r,i),t})},w.prototype._l=function(){return o.resolve(new h())},w.prototype.connect=function(i){var n=this,r=o.defer();return this.j9.has(i)?(this.logger.debug("Already connected to "+i+", ignoring"),r.resolve(this.j9.get(i))):this.channelManager.P9(this.pd,i).then(function(t){return n.connected(i,t)}).then(function(t){return r.resolve(t)}).fail(function(t){v.ErrorMonitor.Z().logError("Error establishing connection",n.loggerId,l.pt.Tt,{otherGuid:i}),r.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")}),r.promise},w.prototype.send=function(t,i,n){var r=this.channelManager.send(t,i);return r||(v.ErrorMonitor.Z().logError("Error sending message without channel established",this.loggerId,l.pt.Ot,{otherGuid:t}),this.L9(t)),r},w.prototype.H9=function(t,i,n){this.U9&&this.logger.debug("REC BUF "+n.byteLength+" "+n),this.j9.has(t)?(this.U9&&this.logger.debug("PROC MSG FROM "+t),this.j9.get(t).lv(n)):v.ErrorMonitor.Z().logError("Error receiving msg without having a connection established",this.loggerId,l.pt.Ot,{otherGuid:t})},w.prototype.connected=function(t,i){if(this.j9.has(t))this.logger.debug("RECONNECTED TO "+t+", RESETTING STATE"),this.j9.get(t).reset();else{this.logger.info("CONNECTED TO "+t);var n=i.BV;n.init(this.pd,t),this.j9.set(t,n)}return o.resolve(this.j9.get(t))},w.prototype.F9=function(t,i){this.logger.debug("FAILED CONN TO "+i),t.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")},w.prototype.G9=function(t,i){this.logger.info(t+" connected to me"),this.connected(t,i)},w.prototype.L9=function(t){this.j9.has(t)?(this.logger.info("Connection closed to "+t),this.j9["delete"](t),this.x9(t)):this.logger.warn("TRYING TO REMOVE A PEER THAT IS NOT THERE: "+t)},w.prototype.B9=function(){var s=this;c.hY.nY&&u.Framework.setInterval(function(){var r=u.Framework.time();s.j9.forEach(function(t,i){var n=r-t.yv();n>c.hY.sY&&(s.logger.debug("closing stale connection to "+i+" [unused for: "+n+"ms]"),s.disconnect(i))})},c.hY.rY)},w.prototype.stop=function(t){u.Framework.resolve(u.Framework.p.T).log(t).debug("STOPPING CONNECTIONS AND REMOVING LISTENERS"),this.V9(t)},w.prototype.q9=function(){},w.prototype.disconnect=function(t){this.j9.has(t)&&this.channelManager.disconnect(t)},w.wu="availableSendRate",w.pu="remoteAddress",w.gu="localAddress",w);function w(){var t=e.call(this)||this;return t.loggerId="[HiveNetworkManager] ",t.U9=!1,t.j9=new h(),t.Sv=1,t.tl=u.Framework.resolve(u.Framework.p.il),t.D9=u.Framework.resolve(u.Framework.p.ND),t.channelManager=new a.Q9(t.logger,t.D9,t),t.D9.init(t,t.logger,t.channelManager),t.B9(),t}i.zz=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(0),s=n(192),h=n(97),o=n(2),u=n(1),a=(f.prototype.P9=function(t,i){var n=null;if(i in this.Y9){var r=e.defer();r.reject("OTHER ALREADY TRYING TO CONNECT"),n=r.promise}else{this.K9.U9&&this.logger.info("Initiating connection to "+i);var s=this.W9(t,i);n=this.X9(s,i).connect(i)}return n},f.prototype.J9=function(t){t.z9 in this.Y9&&(delete this.Z9[t.label],delete this.Y9[t.z9]),t.open&&(this.K9.L9(t.z9),t.open=!1)},f.prototype.send=function(t,i){this.K9.U9&&this.logger.debug("DATA "+i.byteLength+" "+i);var n=this.Y9[t];return n&&n.channel?(n.send(i),!0):(u.ErrorMonitor.Z().logError("Error sending message wihtout channel established",this.loggerId,o.Gt.xt,{otherGuid:t}),!1)},f.prototype.trigger=function(t,i){var n=i.channel;if(n&&n.label&&this.Z9[n.label]){var r=this.Z9[n.label];(s=r[t]).call(r,i)}else{var s,e="handle_"+t;(s=this[e])?s.call(this,i):u.ErrorMonitor.Z().logError("Error received a message for a non existing function",this.loggerId,o.Gt.Bt,{t7:e})}},f.prototype.handle_offer=function(t){if(this.K9.U9&&this.logger.info("received an offer from "+t.peer.guid+" on channel "+t.channel.label),this.Y9[t.peer.guid]&&t.peer<this.K9.pd)this.D9.i7(this.K9.pd,t.peer.guid,t.channel.label);else{var i=this.X9(t.channel.label,t.peer.guid),n=this.n7(i);i.offer(t,n)}},f.prototype.n7=function(t){var i=this;return r.Framework.setTimeout(function(){u.ErrorMonitor.Z().logError("Error incoming connection timedout",i.loggerId,o.Gt.Vt,{otherGuid:t.z9}),t.close()},h.hY.eY)},f.prototype.X9=function(t,i){var n=new s.r7(this,this.K9,t,this.s7,this.e7,i);return this.Z9[t]=n,this.Y9[i]=n},f.prototype.handle_offer_rejected=function(t){this.K9.U9&&this.logger.debug("remote peer rejected ",t);var i=this.Y9[t.h7];i&&i.close(),delete this.Y9[t.h7],delete this.Z9[t.channel]},f.prototype.W9=function(t,i){return t.substring(0,Math.max(8,t.length))+":"+i.substring(0,Math.max(8,i.length))+":"+this.Sv++},f.prototype.disconnect=function(t){var i=this.Y9[t];i&&i.close()},f);function f(t,i,n){this.loggerId="[ChannelManager] ",this.e7={iceServers:[{urls:"stun:stun.hivestreaming.com:3478"}]},this.Sv=1,this.s7=null,this.Z9={},this.Y9={},this.logger=t,this.D9=i,this.K9=n}i.Q9=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(5),o=n(2),e=n(4),u=n(0),a=n(1),r=(h.prototype.o7=function(){var t=this;if(this.channel&&"open"!=this.channel.readyState){if(this.U9&&this.logger.debug(this.loggerId+"Check connection "+this.z9),this.u7<=0)return this.logger.debug(this.loggerId+"Closing channel since it couldnt be established to "+this.z9),void this.close();this.u7-=1,this.a7=u.Framework.setTimeout(function(){return t.o7()},this.timeout)}},h.prototype.close=function(){try{this.U9&&this.logger.debug(this.loggerId+"Closing connection to "+this.z9),this.f7(!0),this.channelManager.J9(this),this.MG&&"closed"!==this.MG.signalingState&&(this.MG.close(),this.MG=null,this.channel&&(this.channel.close(),this.channel=null))}catch(t){a.ErrorMonitor.Z().logError("Error closing the connection",this.loggerId,o.Rt.Ut,{detailedError:t,otherGuid:this.z9})}},h.prototype.c7=function(){return!!this.channel&&"connecting"===this.channel.readyState},h.prototype.connect=function(t){var i=this;this.U9&&this.logger.debug(this.loggerId+"Connecting to "+t),this.z9=t,this.channel=this.MG.createDataChannel(this.label);var n=this.l7(!0,-1);return this.a7=u.Framework.setTimeout(function(){return i.o7()},this.timeout),n},h.prototype.v7=function(t){var i=this,n=e.defer();return this.MG.setRemoteDescription(t).then(function(){n.resolve("OK")})["catch"](function(t){a.ErrorMonitor.Z().logError("Error setting remote description",i.loggerId,o.Rt.At,{detailedError:t,otherGuid:i.z9}),n.reject(t)}),n.promise},h.prototype.d7=function(t){var i=this,n=e.defer();return"closed"!==this.MG.signalingState?this.MG.setLocalDescription(t).then(function(){n.resolve(i.MG.localDescription)})["catch"](function(t){a.ErrorMonitor.Z().logError("Error setting local description",i.loggerId,o.Rt.Nt,{detailedError:t,otherGuid:i.z9}),n.reject(t)}):(a.ErrorMonitor.Z().logError("Signaling state is closed",this.loggerId,o.Rt.At),n.reject("Signaling state is closed")),n.promise},h.prototype.createOffer=function(){var i=this,n=e.defer();return this.MG.createOffer().then(function(t){n.resolve(new RTCSessionDescription(t))})["catch"](function(t){a.ErrorMonitor.Z().logError("Error creating offer",i.loggerId,o.Rt._t,{detailedError:t,otherGuid:i.z9}),i.close()}),n.promise},h.prototype.createAnswer=function(){var i=this,n=e.defer();return this.MG.createAnswer().then(function(t){n.resolve(new RTCSessionDescription(t))})["catch"](function(t){a.ErrorMonitor.Z().logError("Error creating answer",i.loggerId,o.Rt.It,{detailedError:t,otherGuid:i.z9}),n.reject(t)}),n.promise},h.prototype.offer=function(t,i){var n=this;this.U9&&(this.logger.debug(this.loggerId+"Received an offer from "+this.z9),this.logger.debug(this.loggerId+"Offer:",t)),this.MG.ondatachannel=function(t){n.channel=t.channel,n.l7(!1,i)};var r=new RTCSessionDescription(t.channel.offer);this.z9=t.peer.guid,this.v7(r).then(function(){return"closed"!==n.MG.signalingState?(n.update_ice_candidates(t),n.createAnswer()):e.reject("Connection closed while creating answer")}).then(function(t){return n.d7(t)}).then(function(t){n.logger.debug(n.loggerId+"Sending back an answer [candidates: "+n.E7.length+"]");var i=n.E7;n.E7=new Array(),n.channelManager.D9.answer(n,t,i,n.z9),n.w7=!0})["catch"](function(t){a.ErrorMonitor.Z().logError("Error responding to offer",n.loggerId,o.Rt.Lt,{detailedError:t,otherGuid:n.z9}),n.close()})},h.prototype.answer=function(t){var i=this;this.U9&&this.logger.debug(this.loggerId+"Answer: ",t);var n=new RTCSessionDescription(t.answer);this.v7(n).then(function(){"closed"!==i.MG.signalingState&&i.update_ice_candidates(t)})["catch"](function(t){a.ErrorMonitor.Z().logError("Error setting remote descriptor for the answer received",i.logger,o.Rt.Pt,{detailedError:t,otherGuid:i.z9}),i.close()})},h.prototype.update_ice_candidates=function(t){var n=this;t.channel.ice_candidates.forEach(function(t){n.U9&&n.logger.debug(n.loggerId+"got ICE cand: ",t);var i=new RTCIceCandidate(t);n.MG.addIceCandidate(i).then(function(){})["catch"](function(t){a.ErrorMonitor.Z().logError("Error updating ice candidates",n.loggerId,o.Rt.jt,{detailedError:t,otherGuid:n.z9})})})},h.prototype.l7=function(i,n){var r=this,s=e.defer();return this.channel.onopen=function(t){return r.p7(s,i,n)},this.channel.onclose=function(t){r.close(),s.reject(r)},this.channel.onmessage=function(t){return r.BV.lv(t.data)},this.channel.onerror=function(t){a.ErrorMonitor.Z().logError("Error setting up channel",r.loggerId,o.Rt.Ct,{detailedError:t,otherGuid:r.z9}),r.close()},s.promise},h.prototype.p7=function(t,i,n){var r=this;this.open=!0,this.channel.bufferedAmountLowThreshold=Math.min(this.MG.sctp.maxMessageSize,s.Ku.Fu.Xo),this.channel.addEventListener("bufferedamountlow",function(){r.BV.cv()}),t.resolve(this),i||(this.K9.G9(this.z9,this),n&&u.Framework.clearTimeout(n))},h.prototype.g7=function(){var t=this;this.w7&&-1==this.b7&&(this.b7=u.Framework.setTimeout(function(){t.y7(),t.f7(!1)},s.Ku.qu.Tu))},h.prototype.y7=function(){var i=this,t=this.E7;if(this.E7=new Array(),t&&0<t.length){var n=t.length;this.channelManager.D9.T7(this.K9.pd,this,t,this.z9).then(function(t){i.U9&&i.logger.debug(i.loggerId+"sent "+n+" more candidates")})["catch"](function(t){a.ErrorMonitor.Z().logError("Error sending candidates",i.loggerId,o.Rt.Ct,{detailedError:t,otherGuid:i.z9})})}},h.prototype.f7=function(t){t&&-1!=this.b7&&u.Framework.clearTimeout(this.b7),this.b7=-1},h.prototype.send=function(t){var i=this;null!==this.m7&&(u.Framework.clearTimeout(this.m7),this.m7=null);try{this.channel.send(t),this.channel.bufferedAmount<=s.Ku.Fu.Xo&&(this.m7=u.Framework.setTimeout(function(){return i.BV.cv()},0))}catch(t){a.ErrorMonitor.Z().logError("Error setting sending ",this.loggerId,o.Rt.Ft,{detailedError:t,otherGuid:this.z9}),this.close()}},h);function h(t,i,n,r,s,e){var h=this;this.U9=!1,this.loggerId="[Channel] ",this.b7=-1,this.MG=null,this.channel=null,this.m7=null,this.a7=null,this.u7=5,this.timeout=5e3,this.open=!1,this.w7=!1,this.E7=new Array(),this.channelManager=t,this.K9=i,this.label=n,this.s7=r,this.e7=s,this.z9=e,this.logger=u.Framework.resolve(u.Framework.p.T).log(),this.BV=u.Framework.resolve(u.Framework.p.PD),this.BV.init(this.K9.pd,e),this.MG=new RTCPeerConnection(this.e7),this.MG.onicecandidate=function(t){t&&t.candidate&&(h.E7.push(t.candidate),h.g7())},this.MG.onnegotiationneeded=function(){h.createOffer().then(function(t){return h.d7(t)}).then(function(t){h.U9&&h.logger.debug(h.loggerId+"Sending offer to "+h.z9+" [candidates: "+h.E7.length+"]");var i=h.E7;h.E7=new Array();var n=h.channelManager.D9.offer(h.K9.pd,h.z9,h,i,t);return h.w7=!0,n})["catch"](function(t){a.ErrorMonitor.Z().logError("Error negotiating with peer",h.loggerId,o.Rt.kt,{detailedError:t,otherGuid:h.z9}),h.close()})},this.MG.oniceconnectionstatechange=function(t){h.MG&&"disconnected"===h.MG.iceConnectionState&&h.close(),h.MG&&"failed"===h.MG.iceConnectionState&&(a.ErrorMonitor.Z().logError("Error establishing ICE connection",h.loggerId,o.Rt.kt,{otherGuid:h.z9}),h.close())},this.MG.onsignalingstatechange=function(t){"closed"===t.signalingState&&h.close()}}i.r7=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(2),h=n(1),o=(u.prototype.C9=function(t,i){void 0===i&&(i=[]),this.logger.info("SET LISTENERS FOR "+t+","+i.length),this.gm.set(t,i)},u.prototype.V9=function(t){this.gm["delete"](t)},u.prototype.O7=function(){0<this.gm.length&&this.gm.forEach(function(t,i){t.forEach(function(t){t.Xq&&t.Xq()})})},u.prototype.M9=function(n,t){var r=this;0<this.gm.length&&(t?this.gm.get(t).forEach(function(t){try{t.Xd&&t.Xd(n)}catch(t){h.ErrorMonitor.Z().logError("Error firing server connect when we have swarm",r.AH,e.pt.bt,t)}}):this.gm.forEach(function(t,i){t.forEach(function(t){try{t.Xd&&t.Xd(n)}catch(t){h.ErrorMonitor.Z().logError("Error firing server connect when we do not have swarm",r.AH,e.pt.yt,t)}})}))},u.prototype.x9=function(n){0<this.gm.length&&this.gm.forEach(function(t,i){t.forEach(function(t){t.Iq&&t.Iq(n)})})},u);function u(){this.AH="[Base Network Manager] ",this.gm=new r(),this.logger=s.Framework.resolve(s.Framework.p.T).log()}i.N9=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(4),o=n(0),u=n(16),r=(s.prototype.init=function(t,i,n){this.K9=t,this.logger=i,this.channelManager=n},s.prototype.isConnected=function(){return this.client.rE().isConnected()},s.prototype.start=function(t,i){var n=this;this.logger.debug("MY ID "+i),this.pd=i,this.client&&this.client.rE()?this.client.rE().on(HiveStreamingServices.h$,1,function(t){n.S7(t.msg)}):this.logger.error("error getting active services connection"),this.K9.M9(this.pd)},s.prototype.S7=function(t){var i=JSON.parse(t);this.K9.U9&&this.logger.debug("RCV MSG FROM SRV ",i),this.channelManager.trigger(i.msgName,i.msg)},s.prototype.R7=function(t,i,n){var r=this.wrap(i,t,n);if(this.client&&this.client.rE()){var s=JSON.stringify(r);this.K9.U9&&this.logger.debug(" FORWARDING REQUEST : "+s);var e=new u.Yc(HiveStreamingServices.h$,0,s);return this.client.rE().send(e)}return h.reject()},s.prototype.wrap=function(t,i,n){return{msgId:this.Sv++,destination:n,msg:t,msgName:i}},s.prototype.T7=function(t,i,n,r){var s={channel:{label:i.label,ice_candidates:n}};return this.R7("update_ice_candidates",s,r)},s.prototype.offer=function(t,i,n,r,s){var e={peer:{guid:t,first_seen:o.Framework.time()},channel:{label:n.label,ice_candidates:r,offer:s}};return this.R7("offer",e,n.z9)},s.prototype.i7=function(t,i,n){this.K9.U9&&this.logger.debug("Discovery service rejects offer from peer "+i+" on channel "+n);var r={h7:t,channel:n};return this.R7("answer",r,i)},s.prototype.answer=function(t,i,n,r){var s={answer:i,_7:this.K9.pd,channel:{label:t.label,ice_candidates:n}};return this.R7("answer",s,r)},s);function s(){this.Sv=1,this.client=o.Framework.resolve(o.Framework.p.Zc)}i.Zz=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(0),h=(o.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.p.T).log(t.sessionId),this.aj=t.aj,this.I7()},o.prototype.I7=function(){var t=this;e.Framework.setInterval(function(){t.A7()},s.Ku.Lu.Ho)},o.prototype.A7=function(){var i=this;this.Q6.values().filter(function(t){return e.Framework.time()-t.Zp.Pp>s.Ku.Lu.Uo}).forEach(function(t){i.aj.abort(t.ug),i.YH(t.qp(),t.Qp())})},o.prototype.QH=function(t){this.N7(t.qp(),t.Qp()),this.Q6.set(t.Qp(),t)},o.prototype.YH=function(t,i){this.Q6["delete"](i),this.k7(t,i)},o.prototype.$H=function(t){this.C7(t)},o.prototype.KH=function(t){this.HH["delete"](t)},o.prototype.C7=function(t){if(this.HH.set(t.qp(),t.xp()),this.D7.push(t.qp()),this.HH.length>s.Ku.Lu.Lo){var i=this.D7[0];this.HH["delete"](i),this.D7.splice(0,1)}},o.prototype.PH=function(t){return this.HH.has(t)},o.prototype.UH=function(t){return this.HH.get(t)},o.prototype.N7=function(t,i){if(this.M7.has(t))this.M7.get(t).push(i);else{var n=[];n.push(i),this.M7.set(t,n)}},o.prototype.k7=function(t,i){if(this.M7.has(t)){var n=this.M7.get(t),r=n.indexOf(i);-1==r?this.logger.warn("I CANNOT FIND THE REQUEST ID "+i):n.splice(r,1),0==n.length&&this.M7["delete"](t)}else this.logger.warn("TRIED TO REMOVE AN OBJECT THAT DOES NOT EXIST")},o.prototype.xH=function(t){var i=[];if(this.j7(t))for(var n=this.M7.get(t),r=0;r<n.length;r++)this.Q6.has(n[r])&&i.push(this.Q6.get(n[r]));return i},o.prototype.j7=function(t){return this.M7.has(t)},o.prototype.JH=function(){return 0!=this.Q6.length},o.prototype.GH=function(t){return this.M7.has(t)},o);function o(){this.HH=new r(),this.D7=[],this.Q6=new r(),this.M7=new r()}i.Lu=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(6),h=n(31),o=(u.prototype.setId=function(t){this.P7=t},u.prototype.getId=function(){return this.P7},u.prototype.RZ=function(t){this.udpScore=t},u.prototype._q=function(){return this.udpScore},u.prototype._Z=function(t){this.L7=t},u.prototype.e2=function(){return this.L7},u.prototype.setContextId=function(t){var i=h.sv.MO(t+"_"+s.Ku.ku.Kh).toString(h.sv.cO.lO);this.contextId=i},u.prototype.getContextId=function(){return this.contextId},u.prototype.vq=function(t){this.H7=t},u.prototype.rP=function(){return this.H7},u.prototype.Aq=function(t){this.U7=t},u.prototype.EP=function(){return this.U7},u.prototype.UQ=function(t){this.F7=t},u.prototype.wP=function(){return this.F7},u.prototype.HQ=function(t){this.G7=t},u.prototype.pP=function(){return this.G7},u.prototype.c2=function(t){this.x7=t},u.prototype.fP=function(){return this.x7},u.prototype.l2=function(t){this.B7=t},u.prototype.cP=function(){return this.B7},u.prototype.lq=function(t){this.V7=t},u.prototype.OP=function(){return this.V7},u.prototype.q7=function(t){this.Q7=t},u.prototype.gP=function(){return this.Q7},u.prototype.l0=function(t){this.watchingBitrate=t},u.prototype.c0=function(){return this.watchingBitrate},u.prototype.pq=function(t){this.wq=t},u.prototype.TP=function(){return this.wq},u.prototype.BG=function(t){this.privateIp=t},u.prototype.getPrivateIp=function(){return this.privateIp},u.prototype.HG=function(t){this.publicIp=t},u.prototype.getPublicIp=function(){return this.publicIp},u.prototype.setReportingGuid=function(t){this.reportingGuid=t},u.prototype.getReportingGuid=function(){return this.reportingGuid},u.prototype.setDelta=function(t){this.delta=t},u.prototype.getDelta=function(){return this.delta},u.prototype.Nj=function(t,i){this.Y7.set(t,i)},u.prototype._j=function(t){this.Y7["delete"](t)},u.prototype.PQ=function(){return this.Y7},u.prototype.TF=function(){return this.gP()?this.Y7.keys():[]},u.prototype.mF=function(){return this.gP()?[]:this.Y7.keys()},u.prototype.SZ=function(t){this.ticket=t},u.prototype.mP=function(){return this.ticket},u.prototype.wZ=function(t){this.WZ=t},u.prototype.S8=function(){return this.WZ},u.prototype.j1=function(){return this.srcThroughput},u);function u(){this.udpScore=0,this.L7=0,this.watchingBitrate=-1,this.H7=!1,this.Q7=!1,this.U7=!1,this.F7=!1,this.G7=!1,this.Y7=new r(),this.srcThroughput=new e.Ma()}i.dZ=o},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var a,f=n(9),e=n(198),c=n(2),l=n(1),v=n(5),h=(a=e.K7,s(o,a),o.prototype.r9=function(t,i){var r=[],s=[],e=[],h=[];try{var o=this.cj.fP(),u=this.cj.cP();return t.forEach(function(t){t.lP.peerInfo.type==f.Rf.If&&r.push(t);var i=t.lP.peerInfo.internalAs;if(0!=o&&o===i&&s.push(t),v.Ku.Fu.iu){var n=t.lP.peerInfo.externalAs;0!=u&&u===n&&e.push(t)}t.lP.peerInfo.type==f.Rf._f&&h.push(t)}),0<r.length?a.prototype.r9.call(this,r,i):0<s.length?a.prototype.r9.call(this,s,i):0<e.length?a.prototype.r9.call(this,e,i):a.prototype.r9.call(this,h,i)}catch(t){return l.ErrorMonitor.Z().logError("Error choosing partner for p2p",this.loggerId,c.xr.Br,t),null}},o);function o(){return null!==a&&a.apply(this,arguments)||this}i.aZ=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(5),e=n(1),h=n(2),o=(u.prototype.Z8=function(t){this.cj=t},u.prototype.r9=function(t,i){var n=this.W7(t);return n?n[0]:null},u.prototype.X7=function(t,i){return s.Ku.Fu.zo*(t.yP()/i)+s.Ku.Fu.Zo*(1-t.b8())},u.prototype.W7=function(t){var n=this;try{var r=.1;r+=t.map(function(t){return t.yP()}).reduce(function(t,i){return t+i});var i=t.sort(function(t,i){return n.X7(i,r)-n.X7(t,r)}),s=[];return i.forEach(function(t){s.push(t.guid+":"+n.X7(t,r))}),this.logger.debug("SC ["+s.join(", ")+"]"),i}catch(t){return e.ErrorMonitor.Z().logError("Error sorting the partners",this.loggerId,h.Fr.Gr,t),null}},u);function u(){this.loggerId="[PickerTRSingle] ",this.logger=r.Framework.resolve(r.Framework.p.T).log()}i.K7=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v=n(51),d=n(3),E=n(61),w=n(6),p=n(5),a=n(0),r=n(49),s=n(93),e=n(7).W.af,h=(o.prototype.init=function(t){this.logger=a.Framework.resolve(a.Framework.p.T).log(t.sessionId),this.cj=t.cj,this.bZ=t.bZ,this.jV=t.jV,this.rU=t.rU},o.prototype.Ej=function(t){this.wj=t},o.prototype.w2=function(){this.J7=!0,this.UZ()},o.prototype.dq=function(){if(p.Ku.Pu.Oo)this.z7();else{var t=!this.cj.EP()||this.cj.rP()||!e;this.logger.debug("REQUEST REMOTE ELECTION "+t),t?this.z7():this.Z7()}},o.prototype.z7=function(){var t=this.cj.fP(),i=t&&0!=t?s.CV.nj:s.CV.AS;this.bZ.a2(i)},o.prototype.Z7=function(){this.bZ.a2(s.CV.DV)},o.prototype.UZ=function(){var t=this;this.kZ(),this.ttt=a.Framework.setInterval(function(){t.dq()},p.Ku.Pu.Ro),this.rU.eb(),this.dq()},o.prototype.kZ=function(){this.ttt&&a.Framework.clearInterval(this.ttt)},o.prototype.CZ=function(){this.rU.$j(),this.wj.Z0()},o.prototype.Eq=function(t){var i=new d();if(t){this.itt().forEach(function(t){i.set(t,v.tj.ij)});var n=!1,r=v.tj.ij;this.cj.gP()&&(r=v.tj.nj,n=!0),this.rU.yj(i,r,n)}else this.rU.yj(i,v.tj.Nf,!1)},o.prototype.v2=function(t,i){var n=this,r=this.ntt(i),s=this.rU.bj().isLive();if(t&&0<t.length){var e=new E();e.hiveAddEach(t);var h=p.Ku.Pu.wo||e.some(function(t){var i=w.Va(hive.services.protocol.oU.uU,t.key.rankType);return n.logger.info("GOT RANKING "+i+",CRV "+t.cumulatedRankValue+",RV "+t.ranking+",GS "+t.groupSize),n.stt(t)});p.Ku.Pu.po&&(h=this.ett(h));var o=null!=r&&0!=r.length;if(this.logger.debug("Tracker reports ["+r.keys().join(", ")+"]  bitrates"),this.logger.debug("ISLive "+s+" DoElect "+h),p.Ku.Pu.Eo&&s){var u=this.itt();if(o&&h){this.cj.q7(!0),this.logger.info("BECOMING SITE LEADER");var a=new d();u.forEach(function(t){a.set(t,v.tj.ij)}),r.forEach(function(t,i){n.jV.DQ.has(t)||a.set(i,v.tj.nj)}),this.rU.yj(a,v.tj.nj,!1)}else{this.cj.q7(!1);var f=v.tj.Nf,c=new d();this.cj.EP()&&this.cj.rP()&&(f=v.tj.ij,u.forEach(function(t){c.set(t,v.tj.ij)})),this.rU.yj(c,f,!1)}}}else if(s){p.Ku.Pu.wo?this.cj.q7(!0):this.cj.q7(!1);var l=new d();f=v.tj.Nf,this.cj.EP()&&this.cj.rP()&&(this.itt().forEach(function(t){l.set(t,v.tj.ij)}),f=v.tj.ij),p.Ku.Pu.wo&&(f=v.tj.nj),this.rU.yj(l,f,!1)}},o.prototype.ett=function(t){return t?!(this.htt=!1):this.cj.gP()?this.htt?this.htt=!1:this.htt=!0:void 0},o.prototype.$Q=function(){var t=this.itt(),i=new d();t.forEach(function(t){i.set(t,v.tj.ij)});var n=!1,r=v.tj.ij;this.cj.gP()&&(r=v.tj.nj,n=!0),this.rU.yj(i,r,n)},o.prototype.itt=function(){var n=new E();return this.jV.DQ.forEach(function(t,i){t.peerInfo.watchingBitrate&&!n.has(t.peerInfo.watchingBitrate)&&n.hiveAdd(t.peerInfo.watchingBitrate)}),n.toArray()},o.prototype.ntt=function(t){var i=new d(),n=this.cj.fP();return t.forEach(function(t){null!=t.watchingBitrate&&(0<n?n===t.internalAs&&i.set(t.watchingBitrate,t.guid):i.set(t.watchingBitrate,t.guid))}),i},o.prototype.stt=function(t){if(t.groupSize<2)return!1;var i=Math.max(p.Ku.Pu.To,Math.round(t.groupSize*p.Ku.Pu.yo));return e||a.Framework.O()&&r.VM.xM?t.ranking<i&&(this.cj.rP()||!this.cj.EP()):t.ranking<i},o.prototype.Yj=function(t,i,n,r){var s=1,e=this.wj.eP(n,i),h=p.Ku.Pu.Io*a.Framework.random();if(t==v.tj.ij){var o=this.wj.h1()-h;s=Math.max(1,e-o)}else if(t==v.tj.nj){var u=p.Ku.Pu.Ao-h;s=Math.max(1,e-u)+r}return s=Math.round(s)},o);function o(){this.J7=!1,this.htt=!1}i.fZ=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(3),e=n(16),h=n(1),o=n(2);n(62);var u=n(6),a=(f.prototype.B1=function(t,i){try{return this.logger.debug("TRACKER CLIENT REGISTERED "+t),this.ott.has(t)||this.ott.set(t,i),this.ott.get(t)}catch(t){h.ErrorMonitor.Z().logError("Error adding new tracker client",this.loggerId,o.Mr.jr,t)}},f.prototype.Ql=function(t){this.ott["delete"](t)},f.prototype.Yl=function(t){return this.ott.get(t)},f.prototype.u2=function(t){var i=this;if(this.client&&this.client.rE()){var n=void 0;try{n=this.utt.oa(t,"TRACKER_REQ",0)}catch(t){h.ErrorMonitor.Z().logError("Error serializing the new request",this.loggerId,o.Mr.Pr,t)}if(n){var r=new e.Yc(HiveStreamingServices.s$,1,n),s=this.client.rE().send(r);s.then(function(){return i.logger.info("TRACKER REQUEST SENT")}),s.fail(function(t){h.ErrorMonitor.Z().logError("Error sending tracker request",i.loggerId,o.Mr.Cr)})}}else h.ErrorMonitor.Z().logError("Error sending tracker request because of connection",this.loggerId,o.Mr.Hr)},f.prototype.att=function(t){t.infos.map(function(t){t.guid=atob(t.guid),t.publicIp=new InetAddress(),t.publicIp.address=t.publicIpString,t.privateIp=new InetAddress(),t.privateIp.address=t.privateIpString}),t.peerInfo.guid=atob(t.peerInfo.guid),t.peerInfo.publicIp=new InetAddress(),t.peerInfo.publicIp.address=t.peerInfo.publicIpString,t.peerInfo.privateIp=new InetAddress(),t.peerInfo.privateIp.address=t.peerInfo.privateIpString},f.prototype.init=function(){var n=this;this.logger.debug("TRACKER MANAGER INIT"),this.client&&this.client.rE()?this.client.rE().on(HiveStreamingServices.s$,10,function(t){try{var i=null;try{i=n.utt.da(t.msg,"TRACKER_RESP",1,hive.services.protocol.oU.TrackerResponse),n.att(i)}catch(t){h.ErrorMonitor.Z().logError("Error deserializing the tracker response",n.loggerId,o.Mr.Lr,t)}n.ftt&&n.logger.debug("RESP "+JSON.stringify(i)),i&&n.ott.has(i.sessionId)?n.ott.get(i.sessionId).R0(i):n.logger.warn("SESSION ID NOT VALID OR NULL "+i.sessionId)}catch(t){h.ErrorMonitor.Z().logError("Error initializing the tracker manager",n.loggerId,o.Mr.Ur,t)}}):r.Framework.O()||this.logger.warn(this.loggerId+" CANNOT GET ACTIVE CONNECTION")},f);function f(){this.ftt=!1,this.loggerId="[TRACKER] ",this.ott=new s(),this.utt=new u.ya(),this.logger=r.Framework.resolve(r.Framework.p.T).log(),r.Framework.O()||(this.client=r.Framework.resolve(r.Framework.p.Zc))}i.Xz=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(21),r=(s.prototype.init=function(t,i){this.peer=t,this.sb=i},s.prototype.ctt=function(t){t.uuid=this.sb.el.pd;var i=this.sb.el.dF.ZU,n=this.ltt(i.p2pSubRespQt),r=this.ltt(i.srcRespQt);t.cdnRequests+=this.ltt(i.srcReqN),t.cdnResponses+=this.ltt(i.srcRespN),t.cdnResponseErrors+=this.ltt(i.srcRespErrN),t.cdnResponseBytes+=this.ltt(i.srcRespQt),t.p2pRequests+=this.ltt(i.p2pSubReqN),t.p2pResponses+=this.ltt(i.p2pSubRespN),t.p2pResponseErrors+=this.ltt(i.p2pSubRespErrN),t.p2pResponseBytes+=this.ltt(i.p2pSubRespQt),t.savings=this.ltt(n/(r+n)*100)},s.prototype.ltt=function(t){return t||0},s.prototype.vtt=function(e){var h=this;e.uuid=this.sb.el.pd;var t=this.sb.el.dF.iF,o=this.sb.el.dF.nF;t.forEach(function(t,i){e.partners[i]||(e.partners[i]=new u.Fv());var n=e.partners[i];n.uuid=i;var r=h.ltt(t.p2pSuccSent);n.sentBytes+=r,e.p2pPartnerTotalSentBytes+=r;var s=h.ltt(t.p2pSuccReceived);n.receivedBytes+=s,n.successTransfers+=h.ltt(t.p2pSuccReq),n.failedTransfers+=h.ltt(t.p2pFailReq),o.has(i)&&(n.rateReceived=o.get(i).rateReceived),n.Uv=Date.now()})},s.prototype.render=function(){var t=this.sb.renderStatsCallback;if(t){var i=new u.Hv();this.ctt(i),this.vtt(i);try{t(i)}catch(t){}}},s);function s(){}i.Qz=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(35),r=n(3),c=n(0),l=n(5),v=n(1),d=n(2),s=(e.prototype.init=function(t){this.logger=c.Framework.resolve(c.Framework.p.T).log(t.sessionId)},e.prototype._0=function(t){try{var i=t.qp(),n=t.hg,r=t.Zp.Np,s=Math.ceil(r/l.Ku.Fu.Xo),e=t.Vp.bitrate,h=0,o=Math.min(l.Ku.Fu.Xo,r);this.dtt(i,e);for(var u=o-h;0<s;){var a=null;try{c.Framework.O()||(a=f.wrap(n.slice(h,o))),h+=u}catch(t){v.ErrorMonitor.Z().logError("Error wrapping chunk",this.loggerId,d.mn.Sn,t)}this.Ett.get(i).push(a),s--,u=(o=Math.min(h+l.Ku.Fu.Xo,r))-h}}catch(t){v.ErrorMonitor.Z().logError("Error adding fragment to the fragmentMap",this.loggerId,d.mn.On,t)}},e.prototype.dtt=function(t,i){try{if(this.wtt.has(i)&&this.wtt.get(i).length>l.Ku.Cache.xo){var n=this.wtt.get(i)[0];this.Ett["delete"](n),this.wtt.get(i).shift()}if(this.wtt.has(i))this.wtt.get(i).push(t),this.Ett.set(t,[]);else{var r=[t];this.wtt.set(i,r),this.Ett.set(t,[])}}catch(t){v.ErrorMonitor.Z().logError("Error generating the chunk handler hashmaps",this.loggerId,d.mn.Rn,t)}},e.prototype.z8=function(t,i){return this.Ett.has(t)?this.Ett.get(t)[i]:null},e.prototype.ptt=function(t){return this.wtt.get(t)},e.prototype.PZ=function(){this.Ett=new r(),this.wtt=new r()},e);function e(){this.loggerId="[ChunkHandler] ",this.Ett=new r(),this.wtt=new r()}i.tZ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),h=n(5),s=n(0),o=n(2),u=n(1),e=(a.prototype.init=function(t){this.logger=s.Framework.resolve(s.Framework.p.T).log(t.sessionId),this.lj=t.lj,this.gtt=new r(),this.btt=new r(),this.ytt&&this.Ttt()},a.prototype.cQ=function(i,t,n){try{if(!this.ytt)return!1;if(this.gtt.has(i)||!t||!n)return!1;var r=this.mtt(t,n);return!!(r&&this.btt.has(r)&&this.btt.get(r).length>=h.Ku.Cu.ro)&&(u.ErrorMonitor.Z().logError("Error peer violates ip spoofing rules",this.loggerId,o.Ts.Os,{privateIp:t,publicIp:n,otherGuid:i}),this.logger.debug(this.loggerId+"Spoofing rule violated for "+i+" with privateIp "+t+" publicIp "+n),!0)}catch(t){return u.ErrorMonitor.Z().logError("Error checking if peer violates ip spoofing rules",this.loggerId,o.Ts.ms,{detailedError:t,otherGuid:i}),!1}},a.prototype.wQ=function(i,t,n){try{if(this.ytt&&n&&t){var r=this.mtt(t,n),s=this.gtt.get(i);s&&s!=r&&this.Ott(i,s),this.Stt(i,r)}}catch(t){u.ErrorMonitor.Z().logError("Error adding or updating ip spoofing maps",this.loggerId,o.Ts.Ss,{detailedError:t,otherGuid:i})}},a.prototype.Rtt=function(t){this.ytt&&this.xQ(t)},a.prototype.Iq=function(t){this.ytt&&this.xQ(t)},a.prototype.Stt=function(t,i){this.gtt.set(t,i);var n=[];this.btt.has(i)&&-1!=(n=this.btt.get(i)).indexOf(t)||(n.push(t),this.btt.set(i,n))},a.prototype.xQ=function(t){var i=this.gtt.get(t);i?(this.Ott(t,i),this.gtt["delete"](t)):this.logger.warn(this.loggerId+"no ip pair for guid "+t)},a.prototype.Ott=function(t,i){var n=this.btt.get(i),r=n.indexOf(t);-1!=r?(n.splice(r,1),0==n.length?this.btt["delete"](i):this.btt.set(t,n)):this.logger.warn(this.loggerId+"pair list "+i+" does not contain guid "+t)},a.prototype.mtt=function(t,i){return i+":"+t},a.prototype.Ttt=function(){var e=this;s.Framework.setInterval(function(){try{var s=[];e.btt.forEach(function(t,i){if(t.length>h.Ku.Cu.ro){for(var n=[],r=h.Ku.Cu.ro;r<t.length;r++)n.push(t[r]);e.logger.warn("IpSpoofing violation for "+i+" - closing: "+n),s.concat(n)}}),s.forEach(function(t){e.lj.mQ(t)})}catch(t){u.ErrorMonitor.Z().logError("Error checking periodic ip spoofing tables",e.loggerId,o.Ts.Rs,t)}},h.Ku.Cu.so)},a);function a(){this.loggerId="[IPSpoofing] ",this.ytt=h.Ku.Cu.io}i.Cu=e},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(98),o=n(5),u=n(63),a=n(0),f=n(2),c=n(1),l=(e=h.lY,s(v,e),v.prototype.aY=function(t,i){try{return i.sort(u.AU.RU),i.slice(0,t)}catch(t){return c.ErrorMonitor.Z().logError("Error selecting partners to remove",this._tt,f.vn.an,t),[]}},v.prototype.fY=function(t,n,r,i){try{return i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)}).slice(0,t)}catch(t){return c.ErrorMonitor.Z().logError("Error selecting partners to add",this._tt,f.vn.fn,t),[]}},v);function v(){var t=e.call(this)||this;return t._tt="[Score Partner Selection] ",t.type="Score",t}i.Itt=l;var d=(E.prototype.AQ=function(t){try{var i=t.filter(function(t){return!t.TQ.la.Xl()}),n=a.Framework.time(),r=i.filter(function(t){return n-t.uY>o.Ku.ku.Zh});return 0<r.length?(r.sort(u.kU.RU),r.slice(0,1)[0]):null}catch(t){return c.ErrorMonitor.Z().logError("Error updating partners out",this._tt,f.vn.cn,t),null}},E);function E(){this._tt="[Score Partner Selection] "}i.rZ=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var p=n(3),E=n(99),g=n(5),b=n(0),d=n(6),h=n(63),y=n(2),T=n(1),r=(s.prototype.init=function(t){this.cj=t.cj},s.prototype.oQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-g.Ku.Nu.Qh)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.TQ.la.Xl()}),f=b.Framework.time(),c=a.filter(function(t){return f-t.uY>g.Ku.ku.Zh}),l=Math.min(c.length,o);(e=this.aY(l,c)).length>l&&(u+=e.length-l);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t.IU._U(!1))})}return 0<u&&(s=this.fY(u,i,n,r)),new E.cY(s,e)}catch(t){return T.ErrorMonitor.Z().logError("Error updating in partners",this.Att,y.dn.hn,t),new E.cY([],[])}},s.prototype.aY=function(t,i){var n=this;try{i.sort(h.AU.RU);var r=i.slice(0,t);return i.slice(t,i.length).forEach(function(t){n.Ntt(t.lP)&&r.push(t)}),r}catch(t){return T.ErrorMonitor.Z().logError("Error selecting partners to remove",this.Att,y.dn.an,t),[]}},s.prototype.fY=function(t,i,n,r){var s=this;try{var e=[],h=[],o=[],u=[],a=[],f=[];i.forEach(function(t){f.push(t.guid)});var c=Math.floor(t*g.Ku.ku.Xh),l=this.cj.PQ();r.forEach(function(t){var i=t.peerInfo.streams;if(i){var n=s.isLeader(t,i,l);n.FV?n.ktt?e.push(t):h.push(t):s.Ctt(t,g.Ku.ku.$h)?s.Ntt(t)?a.push(t):u.push(t):o.push(t)}else a.push(t)});var v=this.Dtt(e,h,o,u,a,t,t,c);return v.slice(0,Math.min(v.length,t))}catch(t){return T.ErrorMonitor.Z().logError("Error selecting partners to add",this.Att,y.dn.fn,t),[]}},s.prototype.Dtt=function(t,i,n,r,s,e,h,o){try{var u=[],a=[];0<t.length&&b.Framework.random()<g.Ku.ku.Jh&&(a=(t=d.Ga(t)).slice(0,Math.min(t.length,o)),u.push.apply(u,a),h=e-a.length);var f=[];0<i.length&&(f=(i=d.Ga(i)).slice(0,Math.min(i.length,o)),u.push.apply(u,f),h=e-f.length);var c=[];0<n.length&&(c=(n=d.Ga(n)).slice(0,Math.min(n.length,o)),u.push.apply(u,c),h=e-c.length);var l=null;0<r.length&&(l=(r=d.Ga(r)).slice(0,Math.min(r.length,h)),h=e-((0<c.length?c.length:0)-l.length));var v=[];return 0<h&&0<s.length&&(v=(s=d.Ga(s)).slice(0,Math.min(s.length,h)),u.push.apply(u,v)),u}catch(t){return T.ErrorMonitor.Z().logError("Error grouping partners",this.Att,y.dn.En,t),[]}},s.prototype.isLeader=function(e,t,h){try{var o=!1,u=this.cj.fP(),a=this.cj.cP(),i=new p();t.forEach(function(t){i.set(t.bitrate,t)});var n=new p();return i.forEach(function(t,i){h.has(i)&&n.set(i,t)}),0<n.keys().length&&n.forEach(function(t,i){var n=h.get(i);if(n&&2<=t.state&&1<=n.type){var r=e.peerInfo.internalAs,s=e.peerInfo.externalAs;o=0<u?u===r:0<a&&a===s}}),{FV:!1,ktt:o}}catch(t){return T.ErrorMonitor.Z().logError("Error identifying if member is leader or same site",this.Att,y.dn.wn,{detailedError:t,otherGuid:e.peerInfo.guid}),{FV:!1,ktt:!1}}},s.prototype.Ctt=function(i,t){try{var n=this.cj.getDelta(),r=this.cj.c0(),s=this.Mtt(i,r);return(0!=n||0!=s)&&n<s&&s+t<n}catch(t){return T.ErrorMonitor.Z().logError("Error identifying if member is ahead or behind delta",this.Att,y.dn.pn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.Ntt=function(i){try{var t=this.cj.getDelta(),n=this.cj.c0(),r=this.Mtt(i,n);return 0==t&&0==r||r<t}catch(t){return T.ErrorMonitor.Z().logError("Error identifying if member is behind or not retrieveing the same bitrate",this.Att,y.dn.gn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.Mtt=function(i,n){try{var t=i.peerInfo.streams,r=0;return t&&t.forEach(function(t){t.bitrate==n&&(r=t.delta)}),r}catch(t){return T.ErrorMonitor.Z().logError("Error retrieving delta for member's bitrate",this.Att,y.dn.bn,{detailedError:t,otherGuid:i.peerInfo.guid}),0}},s);function s(){this.Att="[Delta Partner Selection] "}i.sZ=r;var e=(o.prototype.AQ=function(t,i,n){var r=this;try{this.cj=t;var s=this.cj.PQ(),e=i.streams;if(e){var h=n.filter(function(t){return!t.TQ.la.Xl()}),o=b.Framework.time(),u=h.filter(function(t){return o-t.uY>g.Ku.ku.Zh});if(0==e.filter(function(t){return s.has(t.bitrate)}).length)return null;var a=this.jtt(u),f=this.Ptt(s,a);if(f)return f;var c=s.keys().length,l=u.length,v=Math.round(l/c),d=a.keys().filter(function(t){return s.has(t)}),E=new p();d.forEach(function(t){E.set(t,a.get(t))});var w=null;return null!=(w=this.Ltt(E,v))?w:(e.forEach(function(t){var i=E.get(t.bitrate);if(null!=i){var n=r.Htt(i);0<n.length&&!g.Ku.ku.zh&&(w=n[0])}}),null!=w?w:null)}return null}catch(t){return T.ErrorMonitor.Z().logError("Error selecting partner to update out",this.loggerId,y.yn.Tn,t),null}},o.prototype.jtt=function(t){var r=new p();return t.forEach(function(t){var i=t.lP.peerInfo.watchingBitrate;if(i=i||-1,r.has(i)){var n=r.get(i);n.push(t),r.set(i,n)}else r.set(i,[t])}),r},o.prototype.Htt=function(t){return t.filter(function(t){if(0==t.NU.A9(g.Ku.Hu.Wo))return t})},o.prototype.Ltt=function(r,s){var n=[];r.forEach(function(t,i){n.push({bitrate:i,Utt:t.length})}),n.sort(function(t,i){return t.Utt>i.Utt?1:t.Utt<i.Utt?0:-1});var e=null;return n.forEach(function(t){var i=r.get(t.bitrate).length;if(s<i){var n=r.get(t.bitrate);0<n.length&&(n.sort(h.kU.RU),e=n[0])}}),e},o.prototype.Ptt=function(n,t){var r=this,s=null;return t.has(-1)?s=t.get(-1)[0]:t.filter(function(t,i){return!n.has(i)}).forEach(function(t,i){var n=r.Htt(t);0<n.length&&(s=n[0])}),s},o);function o(){this.loggerId="[Throughput Partner Selection] ",this.logger=b.Framework.resolve(b.Framework.p.T).log()}i.eZ=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),f=n(8),s=n(50),a=n(24),c=n(9),e=n(14),h=n(5),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.p.T).log(t.sessionId),this.loggerId="S["+t.sessionId+"]",this.el=t.sb.el,this.cj=t.cj,this.xZ()},u.prototype.A2=function(t){this.el.EF.metrics.memN=t,this.el.dF.metrics.memN=t},u.prototype.dQ=function(t,i){this.el.EF.metrics.lookupTotal++,this.el.dF.metrics.lookupTotal++,t?(this.el.EF.metrics.lookupNotFound++,this.el.dF.metrics.lookupNotFound++,this.el.EF.metrics.lookupFailed++,this.el.dF.metrics.lookupFailed++):i?(this.el.EF.metrics.lookupFailed++,this.el.dF.metrics.lookupFailed++):(this.el.EF.metrics.lookupReqEstablished++,this.el.dF.metrics.lookupReqEstablished++)},u.prototype.jQ=function(){this.el.EF.metrics.lookupReqAccept++,this.el.dF.metrics.lookupReqAccept++},u.prototype.h8=function(t,i,n,r,s){if(this.Ftt||r){var e=s==a.yp._p,h=this.el.JF(t),o=this.el.XF(t);h.p2pSuccReq++,h.p2pSuccReceived+=i,o.p2pSuccReq++,o.p2pSuccReceived+=i,e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i),0<n&&!e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i)}},u.prototype.a8=function(t,i,n,r,s,e){if(this.Ftt||s){var h=e==a.yp._p,o=this.el.JF(t),u=this.el.XF(t);o.p2pFailReq++,o.p2pSuccReceived+=i,o.p2pFailReceived+=r-i,u.p2pSuccReq++,u.p2pSuccReceived+=i,u.p2pFailReceived+=r-i,h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i),0<n&&!h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i)}},u.prototype.f8=function(t,i,n){if(this.Ftt||n){var r=this.el.JF(t),s=this.el.XF(t);r.p2pFailReq++,r.p2pFailReceived+=i,s.p2pFailReq++,s.p2pFailReceived+=i}},u.prototype.l8=function(t,i,n){if(this.Ftt||n){var r=this.el.JF(i),s=this.el.XF(i);r.p2pSuccResp++,r.p2pSuccSent+=t,s.p2pSuccResp++,s.p2pSuccSent+=t}},u.prototype.w8=function(t,i,n,r){if(this.Ftt||r){var s=this.el.JF(n),e=this.el.XF(n);s.p2pPartResp++,s.p2pSuccSent+=t,s.p2pFailSent+=i-t,e.p2pPartResp++,e.p2pSuccSent+=t,e.p2pFailSent+=i-t}},u.prototype.d8=function(t,i,n){if(this.Ftt||n){var r=this.el.JF(i),s=this.el.XF(i);r.p2pFailResp++,r.p2pFailSent+=t,s.p2pFailResp++,s.p2pFailSent+=t}},u.prototype.CH=function(t){t?this.el.EF.metrics.bitrateUpN++:this.el.EF.metrics.bitrateDwnN++},u.prototype.h0=function(t){if(-1==[f.yf.Of,f.yf.Sf].indexOf(t.Bp())){var i=t.Bp()!=f.yf.Tf;if((this.Ftt||i)&&(this.el.QF().reqN++,this.el.qF().reqN++,t.Bp()==f.yf.mf)){var n=t;if(n.bitrate){var r=n.bitrate;this.el.YF(r).reqN++,this.el.KF(r).reqN++}}}else this.el.QF().reqOtherN++,this.el.qF().reqOtherN++},u.prototype.M0=function(t){var i=t.Bp()!=f.yf.Tf;if(this.Ftt||i){var n,r=this.el.QF(),s=this.el.qF(),e=null,h=null;-1==[f.yf.Of,f.yf.Sf].indexOf(t.Bp())&&(r.srcReqN++,s.srcReqN++,!i||(n=this.Gtt(t))&&(e=this.el.YF(n),h=this.el.KF(n),e.srcReqN++,h.srcReqN++),t.xp()==a.yp.Op&&(r.srcOtherReqN++,s.srcOtherReqN++,!i||(n=this.Gtt(t))&&(e.srcOtherReqN++,h.srcOtherReqN++)))}},u.prototype.s9=function(t){if(this.el.QF().p2pSubReqN++,this.el.qF().p2pSubReqN++,t.Bp()==f.yf.mf){var i=this.Gtt(t);i&&(this.el.YF(i).p2pSubReqN++,this.el.KF(i).p2pSubReqN++)}},u.prototype.xtt=function(t,i){this.Btt(t,this.el.qF()),this.Btt(t,this.el.QF());var n=this.Gtt(t);n&&t.Bp()===f.yf.mf&&this.cj.c0()==n&&(this.Btt(t,this.el.YF(n)),this.Btt(t,this.el.KF(n))),isNaN(i)||(this.el.EF.metrics.srcThroughput=i)},u.prototype.U0=function(t,i){var n=t.Bp()!=f.yf.Tf;(this.Ftt||n)&&(-1!=[f.yf.Of,f.yf.Sf].indexOf(t.Bp())?(this.el.QF().respFallbackOtherN++,this.el.qF().respFallbackOtherN++):this.xtt(t,i))},u.prototype.P0=function(t,i){if(-1!=[f.yf.Of,f.yf.Sf].indexOf(t.Bp()))this.el.QF().respFallbackOthertErrN++,this.el.qF().respFallbackOthertErrN++;else{var n=t.Bp()!=f.yf.Tf;if(this.Ftt||n)if(this.kH(t.type))this.el.qF().respFallbackErrN++,this.el.QF().respFallbackErrN++,!n||(r=this.Gtt(t))&&(this.el.YF(r).respFallbackErrN++,this.el.KF(r).respFallbackErrN++),0==t.Zp.Mp&&(this.el.qF().srcRespErrN++,this.el.QF().srcRespErrN++,!n||(r=this.Gtt(t))&&t.Bp()===f.yf.mf&&(this.el.YF(r).srcRespErrN++,this.el.KF(r).srcRespErrN++)),this.xtt(t,i);else if(t.type==a.yp.Op&&-1!=h.Ku.ju.vo.indexOf(t.ug.status))this.el.QF().fallAgentFailedRespN++,this.el.qF().fallAgentFailedRespN++,this.el.QF().reqN--,this.el.qF().reqN--;else{var r;0==t.Zp.Mp&&(this.el.QF().srcOtherRespErrN++,this.el.qF().srcOtherRespErrN++),n||(r=this.Gtt(t))&&t.Bp()===f.yf.mf&&(this.el.YF(r).srcOtherRespErrN++,this.el.KF(r).srcOtherRespErrN++),this.xtt(t,i)}}},u.prototype.p0=function(t,i){if(i.N1==a.yp._p)this.el.qF().respP2pN++,this.el.QF().respP2pN++;else if(i.N1==a.yp.Op)this.el.qF().respFallbackN++,this.el.QF().respFallbackN++;else if(i.N1==a.yp.Tp){this.el.qF().lCacheRespN++,this.el.QF().lCacheRespN++;var n=r.Framework.O()?i.length:t.hg.byteLength;this.el.qF().lCacheRespQt+=n,this.el.QF().lCacheRespQt+=n}},u.prototype.A0=function(t,i){var n=t.Bp()!=f.yf.Tf;(this.Ftt||n)&&this.xtt(t,i);var r=new hive.snapshots.PartnerMetrics();r.rateReceived=t.mU.yP(),this.el.dF.nF.set(t.mU.reportingGuid,r)},u.prototype.m0=function(t){if(0!=t.og&&(this.el.QF().p2pSubRespErrN++,this.el.qF().p2pSubRespErrN++,t.Bp()==f.yf.mf)){var i=this.Gtt(t);i&&(this.el.YF(i).p2pSubRespErrN++,this.el.KF(i).p2pSubRespErrN++)}},u.prototype.o9=function(t){if(this.el.QF().p2pSubRespExpN++,this.el.qF().p2pSubRespExpN++,t.Bp()==f.yf.mf){var i=this.Gtt(t);i&&(this.el.YF(i).p2pSubRespExpN++,this.el.KF(i).p2pSubRespExpN++)}},u.prototype.Btt=function(t,i){var n=t.Zp.Np,r=t.Zp.Mp,s=t.Zp.kp,e=t.Zp.Cp,h=t.Zp.Dp;if(t.Bp()!=f.yf.Of){if(t.Zp.Ip&&e&&e<n){var o=e/n;i.p2pSubRespPartN+=o,this.kH(t.type)||(i.p2pAgenTrafficFailureQt+=n-s)}if(0!=h&&(h==n&&i.lCacheRespN++,i.lCacheRespQt+=t.Zp.Dp),0!=s)if(s==n&&(this.kH(t.type)&&i.respP2pN++,i.p2pSubRespN++),i.p2pSubReqQt+=n,i.p2pSubRespQt+=s,i.p2pAgenTrafficSuccessQt+=t.Zp.p2pAgenTrafficSuccessQt,i.p2pDirectQt+=s,t.mU.lP.peerInfo.type==c.Rf.If)i.p2pUdpbQt+=s,i.p2pNatQt+=s;else{var u=this.cj.fP();u&&0<u&&(null!=t.V0?u===t.V0.internalAs&&(i.p2pNatQt+=s):this.logger.warn("Missing partner info"))}}if(0!=r){if(this.Vtt(t.type)&&(i.srcOtherReqQt+=t.Zp.Mp),r==n)this.Vtt(t.type)?(i.srcOtherRespN++,i.srcOtherRespQt+=t.Zp.Mp,i.srcOtherOverQt+=t.Zp.Mp,i.fallAgentRespN++):i.respFallbackN++,i.srcRespN++;else{i.srcRespErrN++;var a=r/(s+r);i.respFallbackN=a,i.respP2pN=1-a,this.Vtt(t.type)&&(i.srcOtherRespErrN++,i.srcOtherRespQt+=t.Zp.Mp,i.srcOtherOverQt+=t.Zp.Mp,i.fallAgenTrafficFailureQt+=t.Zp.Mp)}i.srcReqQt+=t.Zp.Mp,i.srcRespQt+=t.Zp.Mp,i.srcOverQt+=t.Zp.Mp,this.Vtt(t.type)&&(i.fallAgenTrafficSuccessQt+=t.Zp.jp)}},u.prototype.Gtt=function(t){var i=null;if(t.Vp instanceof s.ZM){var n=t.Vp;n.bitrate&&(i=n.bitrate)}return i},u.prototype.kH=function(t){return t!=a.yp._p&&t!=a.yp.Op},u.prototype.Vtt=function(t){return!this.kH(t)},u.prototype.xZ=function(){this.qtt()},u.prototype.HZ=function(){r.Framework.clearInterval(this.Qtt),this.Qtt=null},u.prototype.qtt=function(){var t=this;null==this.Qtt&&(this.Qtt=r.Framework.setInterval(function(){t.el.HF=t.cj.cP(),t.el.LF=t.cj.fP(),t.el.UF=t.cj.getPublicIp()},h.Ku.Bu.bu))},u);function u(){this.Ftt=!0===e.HiveConfig.Stats.AudioAccounting,this.Qtt=null}i.qz=o},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(98),c=n(5),o=n(63),l=n(0),v=n(2),d=n(1),E=n(47),u=(e=h.lY,s(a,e),a.prototype.init=function(t){e.prototype.init.call(this,t),this.qZ=t.qZ},a.prototype.aY=function(t,i){try{return i.sort(o.AU.RU),i.slice(0,t)}catch(t){return d.ErrorMonitor.Z().logError("Error selecting partners to remove",this._tt,v.vn.an,t),[]}},a.prototype.fY=function(t,n,r,i){try{var s=i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)});if(0<s.length){this.qZ.Ytt(),this.qZ.Ktt(!0);var e=[],h=0;for(s.forEach(function(t){h+=t.U2(),t.U2()});0<s.length&&e.length<t;)for(var o=l.Framework.random()*h,u=0,a=0;a<s.length;a++){var f=s[a];if(u<=o&&o<=u+f.U2()){e.push(f),h-=f.U2(),s.splice(a,1);break}u+=f.U2()}return c.Ku.Qu.Ou&&(s.sort(function(t,i){return i.U2()-t.U2()}),E.wM.dM(null,null,"local_score",this.cj.getReportingGuid(),[[s.length],e.map(function(t){return t.U2()}),s.reduce(function(t,i){return 0<i.U2()&&t.push(i.U2()),t},[])],6)),e}return[]}catch(t){return d.ErrorMonitor.Z().logError("Error selecting partners to add",this._tt,v.vn.fn,t),[]}},a);function a(){var t=e.call(this)||this;return t._tt="[Score Partner Selection] ",t.type="Locality",t}i.nZ=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(5),r=(s.prototype.init=function(t){this.cj=t.cj},s.prototype.Ytt=function(){},s.prototype.Wtt=function(t,i){var n=0,r=t.split("."),s=i.split(".");if(4==r.length&&4==s.length)for(var e=0;e<r.length&&n==e;)r[e]==s[e]&&n++,e++;return n},s.prototype.$tt=function(t){var i=this,n=!1;return t.peerInfo.streams.forEach(function(t){t.bitrate==i.cj.c0()&&(n=!0)}),n},s.prototype.M2=function(t){var i=this.cj.getPrivateIp()?this.cj.getPrivateIp().split(".").slice(0,2).join("."):null,n=this.cj.fP(),r=this.cj.getPublicIp(),s=this.cj.cP(),e=!1,h=0;if(0<s&&s===t.peerInfo.externalAs&&(h+=u.Ku.Yu.Su,e=!0,0==n&&(h+=u.Ku.Yu.Ru)),r&&t.peerInfo.publicIpString){var o=this.Wtt(r,t.peerInfo.publicIpString);h+=o,4===o&&(e=!0)}e&&0<n&&n===t.peerInfo.internalAs&&(h+=u.Ku.Yu.Ru),e&&t.peerInfo.privateIpString&&t.peerInfo.privateIpString.startsWith(i)&&(h+=u.Ku.Yu._u),this.$tt(t)&&(h+=u.Ku.Yu.Iu),h/=u.Ku.Yu.Au,t.F2(h)},s.prototype.Ktt=function(t){void 0===t&&(t=!1)},s);function s(){}i.cZ=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4);n(210);var r=n(0),h=n(1),o=n(2),u=n(16),s=n(6),a=(f.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.p.T).log(t.sessionId),this.cj=t.cj},f.prototype.Xtt=function(){var s=this;this.client&&this.client.rE()?this.Jtt().then(function(t){s.logger.debug(s.loggerId+"Peer Locality Info constructed with privateip "+t.ztt.privateIp);var i=null;try{i=s.utt.oa(t,"LOCALITY_INFO",0)}catch(t){h.ErrorMonitor.Z().logError("Error serializing locality info update",s.loggerId,o._e.se)}if(i){var n=new u.Yc(HiveStreamingServices.u$,0,i),r=s.client.rE().send(n);r.then(function(){return s.logger.info("LOCALITY INFO UPDATE SENT")}),r.fail(function(t){h.ErrorMonitor.Z().logError("Error sending locality update",s.loggerId,o._e.Cr)})}}):h.ErrorMonitor.Z().logError("Error sending locality update because of missing connection",this.loggerId,o._e.Hr)},f.prototype.Jtt=function(){var n=this,t=e.defer(),i=new PeerLocalityInfo();i.Ztt=this.cj.getReportingGuid();var r=new CustomerInfo();r.partnerId=this.cj.mP().Pd(),r.customerId=this.cj.mP().Ld(),i.tit=r;var s=new NetworkInfo();return this.qd.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();n.cj.BG(i)}).fail(function(t){h.ErrorMonitor.Z().logError("Error getting connectivity info",n.loggerId,o._e.Rr)})["finally"](function(){""!=n.cj.getPublicIp()&&(s.publicIp=n.cj.getPublicIp()),""!=n.cj.getPrivateIp()&&(s.privateIp=n.cj.getPrivateIp()),i.ztt=s,t.resolve(i)}),t.promise},f.prototype.Xd=function(t){this.Xtt()},f);function f(){this.loggerId="[LocalityServiceClient] ",this.qd=r.Framework.resolve(r.Framework.p.Jd),this.utt=new s.ya(),r.Framework.O()||(this.client=r.Framework.resolve(r.Framework.p.Zc))}i.Vz=a},function(t,i,n){var s=n(23);CustomerInfo=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))},CustomerInfo.prototype={},CustomerInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.partnerId=t.jE().value:t.PE(n);break;case 2:n==s.Type.STRING?this.customerId=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},CustomerInfo.prototype.write=function(t){t.FE("CustomerInfo"),null!==this.partnerId&&void 0!==this.partnerId&&(t.GE("partnerId",s.Type.STRING,1),t.xE(this.partnerId),t.BE()),null!==this.customerId&&void 0!==this.customerId&&(t.GE("customerId",s.Type.STRING,2),t.xE(this.customerId),t.BE()),t.qE(),t.QE()},NetworkInfo=function(t){this.privateIp=null,this.publicIp=null,t&&(void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp))},NetworkInfo.prototype={},NetworkInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.privateIp=t.jE().value:t.PE(n);break;case 2:n==s.Type.STRING?this.publicIp=t.jE().value:t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},NetworkInfo.prototype.write=function(t){t.FE("NetworkInfo"),null!==this.privateIp&&void 0!==this.privateIp&&(t.GE("privateIp",s.Type.STRING,1),t.xE(this.privateIp),t.BE()),null!==this.publicIp&&void 0!==this.publicIp&&(t.GE("publicIp",s.Type.STRING,2),t.xE(this.publicIp),t.BE()),t.qE(),t.QE()},PeerLocalityInfo=function(t){this.Ztt=null,this.tit=null,this.ztt=null,t&&(void 0!==t.Ztt&&null!==t.Ztt&&(this.Ztt=t.Ztt),void 0!==t.tit&&null!==t.tit&&(this.tit=new CustomerInfo(t.tit)),void 0!==t.ztt&&null!==t.ztt&&(this.ztt=new NetworkInfo(t.ztt)))},PeerLocalityInfo.prototype={},PeerLocalityInfo.prototype.read=function(t){for(t.$w();;){var i=t.ME(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.Ztt=t.jE().value:t.PE(n);break;case 2:n==s.Type.STRUCT?(this.tit=new CustomerInfo(),this.tit.read(t)):t.PE(n);break;case 3:n==s.Type.STRUCT?(this.ztt=new NetworkInfo(),this.ztt.read(t)):t.PE(n);break;default:t.PE(n)}t.HE()}t.UE()},PeerLocalityInfo.prototype.write=function(t){t.FE("PeerLocalityInfo"),null!==this.Ztt&&void 0!==this.Ztt&&(t.GE("agentId",s.Type.STRING,1),t.xE(this.Ztt),t.BE()),null!==this.tit&&void 0!==this.tit&&(t.GE("customerInfo",s.Type.STRUCT,2),this.tit.write(t),t.BE()),null!==this.ztt&&void 0!==this.ztt&&(t.GE("networkInfo",s.Type.STRUCT,3),this.ztt.write(t),t.BE()),t.qE(),t.QE()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.startServer=function(t,i){try{this.iit&&this.iit.startServer(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.nit=function(){try{this.iit&&this.iit.nit()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.broadcast=function(t,i,n){try{this.iit&&this.iit.broadcast(t,i,n)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.MZ=function(){try{this.iit&&this.iit.MZ()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.rit=function(t,i){try{this.iit&&this.iit.rit(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e);function e(){this.loggerId="[ProxyUDPB]",this.logger=r.Framework.resolve(r.Framework.p.T).log(),this.iit=window.myUdpBroadcaster,this.iit||this.logger.error(this.loggerId+" helper undefined")}i.vZ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),e=n(5),h=n(9),o=n(213),s=n(14),u=(a.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.p.T).log(t.sessionId),this.iit=t.QZ,this.cj=t.cj},a.prototype.yZ=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.gm=t,this.contextId=this.cj.getContextId()},a.prototype.startServer=function(){var s=this;this.logger.debug(this.loggerId+"START UDP BROADCAST SERVER"),this.iit.startServer(e.Ku.UDPBroadcast.nu,function(t,i){if(-1<s.sit){var n=o.eit.Qc(i);if(n.uuid!=s.guid&&n.streamId==s.contextId&&n.p2pProtocolVersion===e.Ku.ku.Kh){s.logger.debug(s.loggerId+"I RECEIVED A MESSAGE FROM "+n.uuid);var r=new h.Mf(h.Rf.If,null,n.isLeader);r.guid=n.uuid,r.privateIpString=t,r.rankValue=n.rankValue,s.gm.forEach(function(t){return t.QV([r],!1)})}}})},a.prototype.GZ=function(){var t=this;this.logger.info(this.loggerId+"START BROADCAST EVERY "+e.Ku.UDPBroadcast.ru),-1!=this.sit&&r.Framework.clearInterval(this.sit),this.sit=r.Framework.setInterval(function(){t.hit()},e.Ku.UDPBroadcast.ru),this.hit()},a.prototype.MZ=function(){-1!=this.sit&&r.Framework.clearInterval(this.sit)},a.prototype.hit=function(){var t=new o.eit(this.contextId,this.cj.getId(),this.cj._q(),this.cj.rP(),e.Ku.ku.Kh);this.logger.info(this.loggerId+"BROADCAST MESSAGE contextId "+t.streamId+" id "+t.uuid+" udpscore "+t.rankValue+" lan leader "+t.isLeader+" protobufVersion "+t.p2pProtocolVersion),s.HiveConfig.UDPBroadcast.usiz&&(e.Ku.UDPBroadcast.su=s.HiveConfig.UDPBroadcast.usiz),this.iit.broadcast(e.Ku.UDPBroadcast.nu,e.Ku.UDPBroadcast.su,t.oa())},a.prototype.Xd=function(t){this.logger.info("UDPDISCOVERY SERVER CONNECTED"),this.oit||(this.guid=t,this.startServer(),this.GZ())},a);function a(){this.oit=!1,this.loggerId="[UDPBDiscovery] ",this.sit=-1}i.lZ=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.oa=function(){var t={streamId:this.streamId,uuid:this.uuid,rankValue:this.rankValue,isLeader:this.isLeader,p2pProtocolVersion:this.p2pProtocolVersion};return JSON.stringify(t,this.uit)},s.prototype.uit=function(t,i){if(null!==i)return i},s.Qc=function(t){var i=t,n=JSON.parse(i);return new s(n.streamId,n.uuid,n.rankValue,n.isLeader,n.p2pProtocolVersion)},s);function s(t,i,n,r,s){this.streamId=t,this.uuid=i,this.rankValue=n,this.isLeader=r,this.p2pProtocolVersion=s}i.eit=r},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(19),o=(e=h.HiveTechOptions,s(u,e),u);function u(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion="3.0.0",t.renderStatsCallback=void 0,t.pZ=void 0,t}i.xz=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(4),e=n(29),r=n(28),s=n(100),h=n(13),o=n(216),a=n(21),f=n(64),c=n(17),l=n(22),v=n(46),d=n(101),E=n(14),w=n(1),p=n(45),g=n(217),b=n(27),y=navigator,T=(m.prototype.getName=function(){return m.yg},m.prototype.getVersion=function(){return this.version},m.prototype.Ng=function(){return!1},m.prototype.Sx=function(){var r=this;if(null==this.ait||1e4<Date.now()-this.fit){var t="//"+f.UU.FD+":"+f.UU.CU+"/version.json";this.ait=h.bc(t).then(function(t){var i=JSON.parse(t);r.state=i.state,r.version=i.version;var n=i.app;return r.logger().debug(" Version: "+n+", Min: "+r.options_.minVersion+", Max: "+r.options_.cit),n&&n>=r.options_.minVersion&&(""===r.options_.cit||n<r.options_.cit)?"ready"===r.state?"ready":(r.logger().warn(r.id()+"Client not ready: "+r.state),u.reject(new a.HiveTechError(a.Qv.Yv,"state "+r.state))):u.reject(new a.HiveTechError(a.Qv.$v,"Hive Electron version "+n+" is not matching the version requirements MIN: "+r.options_.minVersion+", MAX: "+r.options_.cit))},function(t){var i="Client not reachable";return null!=t&&null!=t.status&&-1!=t.status&&(i="Client check returned "+t.status),r.logger().warn(r.id()+i),u.reject(new a.HiveTechError(a.Qv.Yv,i))})["catch"](function(t){return t instanceof a.HiveTechError?u.reject(t):u.reject(new a.HiveTechError(a.Qv.Yv,"error parsing response"))}),this.fit=Date.now()}return this.ait},m.prototype.initSession=function(n,t){var r=this,i=this.plugin.options(),s=i.readyCheckTimeout,e=i.Mv,h=this.lit.EY(s,e,this.logger()),o="Client Ready check timed out after "+h;return(h&&0<h?this.Sx().timeout(h,o):this.Sx()).then(function(){return r.resolveTicketPromise(n).then(function(t){var i=r.Rx(n,t);return r.vit(i)})})["catch"](function(t){return t instanceof a.HiveTechError?u.reject(t):u.reject(new a.HiveTechError(a.Qv.TICKET_ERROR,"generic error resolving ticket"))})},m.prototype.Bg=function(t,n){var r=this,i=this.plugin.options(),s=i.readyCheckTimeout,e=i.Mv,h=this.lit.EY(s,e,this.logger()),o="Client Ready check timed out after "+h;return(h&&0<h?this.Sx().timeout(h,o):this.Sx()).then(function(){return r.dit(n).then(function(t){var i=r.Rx(null,t,n);return r.vit(i)})})["catch"](function(t){return t instanceof Error&&t.message===o?u.reject(new a.HiveTechError(a.Qv.Xv,t.message)):t instanceof Error?u.reject(new a.HiveTechError(a.Qv.TICKET_ERROR,"generic error resolving ticket")):u.reject(t)})},m.prototype.vit=function(t){if(null!=t)return g.Eit.QB(t,this.plugin.getPluginId()),g.Eit.registerPlugin(this.plugin,this.plugin.getPluginId()),r.HiveRequestFactory.register(this),t;throw new a.HiveTechError(a.Qv.TICKET_ERROR,"error generating session")},m.prototype.$B=function(t){this.Dz=t},m.prototype.Cg=function(){return this.options_.initTimeout},m.prototype.isActive=function(t,i){var n=i.manifest.toLowerCase(),r=t.toLowerCase(),s=n.indexOf(".ism/manifest");if(-1<s){var e=n.substring(0,s);if(-1<r.indexOf(e))return-1<r.indexOf(".ism/manifest(format=mpd-time-csf)")?this.Dz?(i.ticket.SourceURL=t,!0):this.Mz(i,"The player does not use HiveRequest, downgrading to StatsJS"):this.Mz(i,"Protocol not supported by HiveJsProxy tech, downgrading to StatsJS")}else if(r===n)return!!this.Dz||this.Mz(i,"The player does not use HiveRequest, downgrading to StatsJS");return!1},m.prototype.Mz=function(i,t){var n=this;return i.tech=this.pg,p["default"].Z().initSession(i.ticket.pluginId,i.ticket.ticketUrl,!1).then(function(t){i.ey(t),t.ticket,n.logger().debug("[HiveJSProxy] downgrade verified ticket "+i.ticket.ticketUrl),n.plugin.updatePlayerInfo(t)}).fail(function(t){w.ErrorMonitor.Z().logError("Error initializing session when downgrading session tech",n.loggerId,{error:t})}),this.Dz&&this.Dz.wit(),this.Dz=void 0,r.HiveRequestFactory.register(this.pg),this.plugin.logger().warn("[HiveJsProxy] "+t),this.onError(new a.HiveTechError(a.Qv.Wv,t)),!0},m.prototype.ny=function(i,n){var r=this;this.logger().debug(this.id()+"Stopping session "+i.id+" [onUnload:"+n+"]");var t="//"+f.UU.FD+":"+f.UU.CU+"/proxy/"+this.plugin.getPluginId()+"/stop";n&&y.sendBeacon?(y.sendBeacon(t),this.logger().debug(this.id()+"session stopped ["+i.id+"][beacon]")):h.bc(t,null,!n).then(function(){r.logger().debug(r.id()+"session stopped ["+i.id+"]"+(n?"[sync]":""))},function(t){r.logger().warn(r.id()+"session close error ["+i.id+"]"+(n?"[sync]":""),t)})},m.prototype.ol=function(t,i){var n=i?c.Wc.IDLE:c.Wc.$c;this.logger().debug(this.id()+"idle state: "+c.Wc[n])},m.prototype.pb=function(t,i){var n=this,r="playing-point="+i.playingPoint;r+="&buffer-length="+i.bufferLength,r+="&total-buffering="+i.totalBuffering,r+="&width="+i.width,r+="&height="+i.height,r+="&fullscreen="+i.fullscreen;var s="//"+f.UU.FD+":"+f.UU.CU+"/proxy/"+this.plugin.getPluginId()+"/stats/put?"+r;return h.bc(s).fail(function(t){return n.logger().warn(n.id()+"error sending feedback to Hive Client",t),u.reject(t)})},m.prototype.Tb=function(t,i,n){var r=this,s="//"+f.UU.FD+":"+f.UU.CU+"/proxy/"+this.plugin.getPluginId()+"/event?type="+i;if(null!=n)for(var e in n)s+="&"+e+"="+n[e];return this.logger().debug(this.id()+"event "+l.PlayerEvents[i],null!=n?n:""),h.bc(s).fail(function(t){return r.logger().warn(r.id()+"error sending feedback event to Hive Client",t),u.reject(t)})},m.prototype.Cd=function(t,i){return u.resolve(!0)},m.prototype.onError=function(t){var i=!0;if(null!=this.options_.onError)try{i=this.options_.onError(t)}catch(t){w.ErrorMonitor.Z().logError("exception in user-defined onError callback",this.id(),t)}return i},m.prototype.onActiveSession=function(t){var i=this.plugin.getPlayerSource();0===i.indexOf("//")&&(i=location.protocol+i);var n=h.pc(f.UU.MU,f.UU.FD,f.UU.CU,this.plugin.getPluginId(),i);if(t.authenticationToken&&"3.0.1"<=this.version?h.Tc(n,JSON.stringify({authenticationToken:t.authenticationToken})):h.bc(n),this.updatePlayerInfo(t),d.pY.ht(this.logger()),this.Dz&&this.Dz.pit(),this.git(t),null!=this.options_.onActiveSession)try{this.options_.onActiveSession(t.toHiveSession())}catch(t){w.ErrorMonitor.Z().logError("exception in user-defined onActiveSession callback",this.id(),t)}},m.prototype.Lg=function(){},m.prototype.Ag=function(){},m.prototype.wg=function(t){this.plugin=t},m.prototype.id=function(){return"["+m.yg+"] "},m.prototype.bit=function(t){null!=t[m.yg]&&h.updateOptions(t[m.yg],this.options_)},m.prototype.resolveTicketPromise=function(n){var t,r=this;this.logger().debug(this.id()+"resolving ticket: "+n);var i=this.yit(n),s=JSON.stringify(this.Tit()),e=null;return this.plugin.options().testId&&((t={})[b.qc.Wb]=this.plugin.options().testId,e=t),h.Tc(i,s,"application/json",e).then(function(t){var i=JSON.parse(t);return r.logger().debug(r.id()+"resolved ticket "+n+" -> "+i.manifest),i},function(t){return r.logger().warn(r.id()+"ticket "+n+" resolve error: ",t),u.reject(new a.HiveTechError(a.Qv.TICKET_ERROR,t))})["catch"](function(t){return t instanceof a.HiveTechError?u.reject(t):u.reject(new a.HiveTechError(a.Qv.Kv,t))})},m.prototype.dit=function(t){var i,n=this;this.logger().debug(this.id()+"Initializing all the sessions via Electron: ",t);var r=this.mit(),s=JSON.stringify({authResponse:t,configurations:this.Tit()}),e=null;return this.plugin.options().testId&&((i={})[b.qc.Wb]=this.plugin.options().testId,e=i),this.logger().debug("My header ",e),h.Tc(r,s,"application/json",e).then(function(t){var i=JSON.parse(t);return n.logger().debug("got all sessions",i),i},function(t){return n.logger().warn(n.id()+" init sessions error: ",t),u.reject(new a.HiveTechError(a.Qv.TICKET_ERROR,t))})["catch"](function(t){return t instanceof a.HiveTechError?u.reject(t):u.reject(new a.HiveTechError(a.Qv.Kv,t))})},m.prototype.yit=function(t){return t=encodeURIComponent(t),h.pc(f.UU.GD,f.UU.FD,f.UU.CU,t,"&",this.plugin.getPluginId())},m.prototype.mit=function(){return h.pc(f.UU.DU,f.UU.FD,f.UU.CU,this.plugin.getPluginId())},m.prototype.Rx=function(t,i,n){var r=new v.Ticket();t?r.Vg(t):(r.Ug(n.partnerId,n.customerId,n.validated[0].videoId),r.originalManifest=i.manifest);var s=new e.HiveSessionInternal(t,r,i.manifest,null,this.plugin.options().jv);return s.Dx=!0,s.id=i.sessionId,s.ticket.sessionId=s.id,s},m.prototype.Tit=function(){var t={HiveConfig:{}};for(var i in window.HiveConfig)for(var n in t.HiveConfig[i]={},window.HiveConfig[i])t.HiveConfig[i][n]=window.HiveConfig[i][n];return t},m.prototype.git=function(t){var i=this;if(void 0!==E.HiveConfig.Stats.render){var n="//"+f.UU.FD+":"+f.UU.CU+"/proxy/"+this.plugin.getPluginId()+"/stats/get";if("undefined"!=typeof EventSource){var r=new EventSource(n);r.onmessage=function(t){i.Oit(t.data)},r.onerror=function(t){r.close()}}else this.Sit=window.setInterval(function(){h.bc(n).then(function(t){i.Oit(t)})},4e3)}},m.prototype.updatePlayerInfo=function(t){var i=this,n="comm-version="+this.plugin.Eg();n+="&plugin-name="+this.plugin.getPluginName(),n+="&plugin-version="+this.plugin.getPluginVersion(),n+="&player-tech="+this.plugin.getPlayerTech(),n+="&player-version="+this.plugin.getPlayerVersion(),this.plugin.getTelemetryId()&&(n+="&telemetry-id="+this.plugin.getTelemetryId());var r=h.pc(f.UU.PU,f.UU.FD,f.UU.CU,this.plugin.getPluginId(),n);return h.bc(r).fail(function(t){return i.logger().debug(i.id()+"error sending player Info to Hive Client",t),u.reject(t)})},m.prototype.Oit=function(t){try{var i=JSON.parse(t);for(var n in i)i.hasOwnProperty(n)&&(i[n].human=function(t){return 1e6<t?(t/1e6).toFixed(2)+"MB":1e3<t?(t/1e3).toFixed(2)+"KB":t+"B"});E.HiveConfig.Stats.render(i)}catch(t){console.trace(t)}},m.prototype.logger=function(){return this.plugin.logger()},m.prototype.getPluginId=function(){return this.plugin.getPluginId()},m.prototype.Zb=function(t){return new g.Eit(t)},m.prototype.zb=function(t){return new d.pY(t)},m.yg="HiveJsProxy",m);function m(t,i,n){this.loggerId="[HiveJsProxy]",this.fit=0,this.plugin=t,this.options_=new o.Rit(),this.bit(i),this.pg=n,this.lit=new s.wY()}i.HiveJsProxy=T},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(19),o=n(64),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion=o.UU.LU,t.cit=o.UU.HU,t}i.Rit=u},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(101),o=n(6),u=n(58),a=n(1),f=(e=h.pY,s(c,e),c.QB=function(t,i){c.YB[i]?c.YB[i].push(t):c.YB[i]=[t]},c.registerTech=function(t,i){c._it[i]=t},c.registerPlugin=function(t,i){c.KB[i]=t},c.prototype.send=function(){var i=this;if(!this.pluginId){var t=Object.keys(c.KB);0<t.length&&(this.pluginId=c.KB[t[0]])}var n=c.YB[this.pluginId],r=c.KB[this.pluginId],s=!1;n.forEach(function(t){u.lH(t)||u.lH(r)||t.manifest!==i.url||(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.$B(i),r.onActivateSession(i.url),s=!0)}),s||(n.forEach(function(t){!u.lH(t)&&!u.lH(r)&&0<=i.url.indexOf(t.manifest)&&(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.$B(i),r.onActivateSession(i.url),s=!0)}),s||(a.ErrorMonitor.Z().logError("HiveJS Tech or Plugin are not defined",this.loggerId),this.wit()))},c.prototype.wit=function(){var i=this,n=new XMLHttpRequest();n.open("GET",this.url),n.onreadystatechange=function(t){4===n.readyState&&(i.response=n.responseText,i.responseText=n.responseText,i.readyState=4,i.status=n.status,i.onreadystatechange(o.createEvent(Event,"readystatechange",t,i)),i.onload(o.createEvent(ProgressEvent,"load",t,i)),!1)},n.send()},c.prototype.pit=function(){e.prototype.send.call(this)},c.KB={},c.YB={},c.Xc={},c._it={},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.Eit=f},function(t,s,i){"use strict";var r,n=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(s,"s",{value:!0});var o=i(4),e=i(29),h=i(72),u=i(28),a=i(100),f=i(13),c=i(219),l=i(19),v=i(220),d=i(21),E=i(43),w=i(27),p=i(17),g=i(22),b=i(46),y=i(1),T=i(57);s.Iit=navigator;var m,O=(m=e.HiveSessionInternal,n(S,m),S);function S(){return null!==m&&m.apply(this,arguments)||this}var R=(_.prototype.getName=function(){return _.yg},_.prototype.getVersion=function(){return this.version},_.prototype.Ng=function(){return!1},_.prototype.Sx=function(){var n=this;if(null==this.ait||1e4<Date.now()-this.fit){var t=new T.Hd();t.Ud(navigator.userAgent);var i=t.pL();if("IE"===i.name&&i.version&&parseInt(i.version)<10)return o.reject(new d.HiveTechError(d.Qv.Yv,"Internet Explorer < v.10 not supported"));this.Ait=Date.now(),this.Nit=0;var r="//"+E.Av.FD+":"+this.plugin.options().monitorPort+"/version.json";this.logger().debug(this.id()+"verifying Hive Client version"),this.ait=f.bc(r).then(function(t){var i=JSON.parse(t);return n.state=i.state,n.version=i.version,"ready"===n.state?"developer"===n.version||n.version>=n.options_.minVersion?(n.Nit=Date.now(),n.logger().debug(n.id()+"Hive Client ready - version "+n.version+" ["+(n.Nit-n.Ait)+"]"),"ready"):(y.ErrorMonitor.Z().logError("Client version requirement not satisfied",n.id(),{version:n.version,minVersion:n.options_.minVersion}),n.plugin.addTechEvent(new g.vE(null,2)),o.reject(new d.HiveTechError(d.Qv.$v,"version "+n.version))):(y.ErrorMonitor.Z().logError("Cannot check version: client state not ready",n.id(),{state:n.state}),n.plugin.addTechEvent(new g.vE(null,1)),n.Nit=Date.now(),n.logger().debug("[Timing] Hive Client not ready",n.Nit-n.Ait),o.reject(new d.HiveTechError(d.Qv.Yv,"state "+n.state)))},function(t){var i="Client not reachable";return null!=t&&null!=t.status&&-1!=t.status&&(i="Client check returned error"),500===t.status?(y.ErrorMonitor.Z().logError(i,n.id(),{error:t}),n.plugin.addTechEvent(new g.vE(null,1)),o.reject(new d.HiveTechError(d.Qv.Kv,i))):(y.ErrorMonitor.Z().logError(i,n.id(),null!=t&&null!=t.status&&-1!=t.status?{status:t.status}:void 0),n.plugin.addTechEvent(new g.vE(null,0)),o.reject(new d.HiveTechError(d.Qv.Yv,i)))})["catch"](function(t){if(t instanceof d.HiveTechError)return o.reject(t);var i="Error fetching Hive Client version";return y.ErrorMonitor.Z().logError(i,n.id(),t),o.reject(new d.HiveTechError(d.Qv.Yv,i))}),this.fit=Date.now()}return this.ait},_.prototype.initSession=function(t,i){var n=this,r=this.plugin.options(),s=r.readyCheckTimeout,e=r.Mv,h=this.lit.EY(s,e,this.logger());return(h&&0<h?this.Sx().timeout(h,"Client Ready check timed out after "+h+"ms"):this.Sx()).then(function(){return n.kit(t)["catch"](function(t){return o.reject(t)})})["catch"](function(t){return t instanceof Error&&(t=new d.HiveTechError(d.Qv.Xv,t.message)),o.reject(t)})},_.prototype.Cg=function(){return this.options_.initTimeout},_.prototype.isActive=function(t,i){return-1<t.indexOf(i.Cit)},_.prototype.ny=function(i,n){var r=this;this.logger().debug(this.id()+"Stopping session "+i.id+" [complete close:"+n+"]");var t="//"+E.Av.FD+":"+this.plugin.options().playerPort+"/session?action=stop";t+="&currentSession="+i.id,n&&(t+="&completeStop=true"),n&&s.Iit.sendBeacon?(s.Iit.sendBeacon(t),this.logger().debug(this.id()+"session stopped ["+i.id+"][beacon]")):f.bc(t,null,!n).then(function(){r.logger().debug(r.id()+"session stopped ["+i.id+"]"+(n?"[sync]":""))},function(t){r.logger().warn(r.id()+"session close error ["+i.id+"]"+(n?"[sync]":""),t)})},_.prototype.ol=function(t,i){this.Dit=i?p.Wc.IDLE:p.Wc.$c,this.logger().notice("[HiveComm] client state: "+p.Wc[this.Dit])},_.prototype.pb=function(t,i){if(this.Dit==p.Wc.IDLE)return o.resolve(!0);var n="playing-point="+i.playingPoint;n+="&buffer-length="+i.bufferLength,n+="&total-buffering="+i.totalBuffering,n+="&width="+i.width,n+="&height="+i.height,n+="&fullscreen="+i.fullscreen;var r=t.Cit+"stats?"+n;return this.logger().trace(r),f.bc(r)},_.prototype.Tb=function(t,i,n){var r=this;if(!(i!==g.PlayerEvents.VISIBLE&&i!==g.PlayerEvents.HIDDEN||this.version&&("developer"===this.version||"2017"<=this.version)))return o.resolve(!0);var s=t.Cit+"player-event?type="+g.PlayerEvents[i];if(null!=n)for(var e in n)s+="&"+e+"="+n[e];return this.logger().debug(this.id()+"event "+g.PlayerEvents[i],null!=n?n:""),f.bc(s).fail(function(t){return r.logger().warn(r.id()+"error sending feedback event to Hive Client",t),o.reject(t)})},_.prototype.Cd=function(t,i){return o.resolve(!0)},_.prototype.updatePlayerInfo=function(t){var i=this;if(this.Mit())return this.logger().warn("Player info not supported in this Java client version"),o.resolve(!0);var n="comm-version="+this.plugin.Eg();n+="&plugin-name="+this.plugin.getPluginName(),n+="&plugin-version="+this.plugin.getPluginVersion(),n+="&player-tech="+this.plugin.getPlayerTech(),n+="&player-version="+this.plugin.getPlayerVersion(),this.plugin.getTelemetryId()&&(n+="&telemetry-id="+this.plugin.getTelemetryId());var r=t.Cit+"player-info?"+n;return f.bc(r).fail(function(t){return i.logger().debug(i.id()+"error sending player Info to Hive Client",t),o.reject(t)})},_.prototype.onError=function(t){var i=!0;if(null!=this.options_.onError)try{i=this.options_.onError(t)}catch(t){y.ErrorMonitor.Z().logError("Exception in user-defined onError callback",this.id(),t)}return i},_.prototype.Lg=function(t,i,n){var r={isReadyIn:this.Ait,isReadyOut:this.Nit,leaseIn:this.jit,leaseOut:this.Pit,resolveIn:this.Lit,resolveOut:this.Hit};void 0!==i&&null!=i&&(r.sessionId=i.id),void 0!==n&&(r.total=n);var s=JSON.parse(JSON.stringify(r));y.ErrorMonitor.Z().logError(t.message,this.id(),s),this.plugin.addTechEvent(new g.vE(null,5,r)),this.Uit()},_.prototype.onActiveSession=function(t){if(this.updatePlayerInfo(t),h.Ab.setItem("hiveActiveSessionId",t.id),null!=this.options_.onActiveSession)try{this.options_.onActiveSession(t.toHiveSession())}catch(t){y.ErrorMonitor.Z().logError("Exception in user-defined onActiveSession callback",this.id(),t)}},_.prototype.wg=function(t){this.plugin=t},_.prototype.id=function(){return"["+_.yg+"] "},_.prototype.bit=function(t){null!=t[_.yg]&&f.updateOptions(t[_.yg],this.options_)},_.prototype.kit=function(i){var n=this,r=new Date().getTime();return this.Fit(i).then(function(t){return t?n.Git(i,t,r):n.resolveTicketPromise(i).then(function(t){return n.Git(i,t,r)})})},_.prototype.Fit=function(i){var r=this;if(this.jit=Date.now(),this.plugin.options().useSessionCheck){var n="//"+E.Av.FD+":"+this.plugin.options().playerPort+"/session?&action=check";n+="&hivePluginId="+this.plugin.getPluginId(),n+="&callback="+encodeURIComponent(i);var t=h.Ab.getItem("hiveActiveSessionId");return h.Ab.removeItem("hiveActiveSessionId"),t&&(n+="&currentSession="+t),this.xit(),this.Bit(n).then(function(t){return r.Pit=Date.now(),t?r.Vit(t,n,i,r.jit):(r.logger().debug(r.id()+"session allowed ["+(r.Pit-r.jit)+"]"),!1)},function(t){if(400==t.status)return r.qit("bad request","error resolving ticket",t);if(401==t.status)return r.qit("unauthorized","error verifying the ticket",t);if(403!=t.status)return 404==t.status?(r.logger().debug(r.id()+"installed version does not support active session check"),r.Pit=Date.now(),!1):(y.ErrorMonitor.Z().logError("unhandled error from Java",r.id(),{error:t.status}),r.plugin.addTechEvent(new g.vE(null,4)),o.reject(new d.HiveTechError(d.Qv.Kv,t)));var i=_.Qit(t,void 0,"session"),n=i?{Yit:i}:void 0;return y.ErrorMonitor.Z().logError("reports another active session",r.id(),n),r.plugin.addTechEvent(new g.vE(null,3,n)),o.reject(new d.HiveTechError(d.Qv.Wv,"another active session"+(n?" ["+n.Yit+"]":"")))})["catch"](function(t){return t instanceof d.HiveTechError?o.reject(t):(y.ErrorMonitor.Z().logError("unhandled error on requestLeaseDirect",r.id(),{error:t}),r.plugin.addTechEvent(new g.vE(null,4)),r.Pit=Date.now(),r.plugin.logger().warn("[Timing] unhandeled session request ",r.Pit-r.jit),o.reject(new d.HiveTechError(d.Qv.Kv,t)))})["finally"](function(){clearTimeout(r.Kit)})}return this.logger().debug(this.id()+"Hive session check disabled - will directly resolve ticket (other active sessions may fail)"),o.resolve(!1)},_.prototype.Bit=function(t){var i;if(this.plugin.options().testId){if(!("developer"!==this.version||this.version<E.Av.qD))return f.bc(t,void 0,!0,((i={})[w.qc.Wb]=this.plugin.options().testId,i));this.logger().warn(this.id()+"The Hive Client Version installed does not support the test id in its generated metrics")}return f.bc(t)},_.prototype.qit=function(t,i,n){var r=_.Qit(n,t);return y.ErrorMonitor.Z().logError(i,this.id()),this.Hit=Date.now(),o.reject(new d.HiveTechError(d.Qv.TICKET_ERROR,r))},_.Qit=function(t,i,n){void 0===n&&(n="status");var r=i;if(t.body)try{r=JSON.parse(t.body)[n]}catch(t){}return r},_.prototype.resolveTicketPromise=function(i){var n=this;this.Lit=Date.now(),this.logger().debug(this.id()+"resolving ticket: "+i);var r=this.yit(i);return f.bc(r,"application/json").then(function(t){return n.Vit(t,r,i,n.Lit)},function(t){return n.Wit(t,i)})["catch"](function(t){return y.ErrorMonitor.Z().logError("error parsing ticket response",n.id(),t),o.reject(new d.HiveTechError(d.Qv.Kv,t))})},_.prototype.Wit=function(t,i){return y.ErrorMonitor.Z().logError("error resolving ticket",this.id(),{ticket:i}),o.reject(new d.HiveTechError(d.Qv.TICKET_ERROR,t))},_.prototype.Vit=function(t,i,n,r){var s=JSON.parse(t),e=c.$it((0===i.indexOf("//")?location.protocol:"")+i,s.location);return s.version&&!this.version&&(this.version=s.version),this.Hit=Date.now(),this.logger().debug(this.id()+"resolved ticket "+n+" -> "+e+" ["+(this.Hit-r)+"]"),e},_.prototype.Git=function(t,i,n){var r=this.Rx(t,i);if(null==r)throw new d.HiveTechError(d.Qv.TICKET_ERROR,"error generating session");var s=new Date().getTime()-n;return s>=this.options_.warnSlowRespTimeout&&this.Lg(new d.HiveTechError(d.Qv.Xv,this.id()+" The tech initialization took more than "+this.options_.warnSlowRespTimeout+" milliseconds"),r,s),u.HiveRequestFactory.register(this),r},_.prototype.Rx=function(t,i){var n=new b.Ticket();n.Vg(t);var r=new O(t,n,i,null,this.plugin.options().jv);r.Dx=!0;var s=E.Av.BD.exec(r.manifest);return null!=s?(r.Cit=s[1],r.id=s[5],r):null},_.prototype.yit=function(t){var i=-1==t.indexOf("?")?"?":"&";return this.Mit()?f.pc(E.Av.xD,E.Av.FD,this.plugin.options().playerPort,t):f.pc(E.Av.GD,E.Av.FD,this.plugin.options().playerPort,t,i,this.plugin.getPluginId4Java())},_.prototype.xit=function(){var t=this;this.Kit&&clearTimeout(this.Kit),this.Kit=setTimeout(function(){y.ErrorMonitor.Z().logError("The Lease Request is taking more than "+t.options_.warnSlowRespTimeout+" secs",t.id())},this.options_.warnSlowRespTimeout)},_.prototype.Uit=function(){this.jit=0,this.Pit=0,this.Lit=0,this.Hit=0},_.prototype.logger=function(){return this.plugin.logger()},_.prototype.Ag=function(){this.Uit()},_.prototype.Mit=function(){return this.options_.supportLegacyClient&&(!this.version||this.version.substr(0,4)<"2016")},_.prototype.getPluginId=function(){return this.plugin.getPluginId()},_.prototype.Zb=function(t){return new XMLHttpRequest()},_.prototype.zb=function(t){return new XMLHttpRequest()},_.yg="HiveJava",_);function _(t,i){this.fit=0,this.plugin=t,this.options_=new v.Xit(),this.lit=new a.wY(),this.bit(i),f.parseParameterOptions(window.location.href,new l.UrlConfigurableOptions(),this.options_)}s.HiveJava=R},function(t,i,n){var r,f,s,e,c;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,f=/^([^\/?#]*)(.*)$/,s=/(?:\/|^)\.(?=\/)/g,e=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,c={$it:function(t,i,n){if(n=n||{},t=t.trim(),!(i=i.trim())){if(!n.Jit)return t;var r=c.zit(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=c.$T(r.path),c.Zit(r)}var s=c.zit(i);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return n.Jit?(s.path=c.$T(s.path),c.Zit(s)):i;var e=c.zit(t);if(!e)throw new Error("Error trying to parse base URL.");if(!e.tnt&&e.path&&"/"!==e.path[0]){var h=f.exec(e.path);e.tnt=h[1],e.path=h[2]}e.tnt&&!e.path&&(e.path="/");var o={scheme:e.scheme,tnt:s.tnt,path:null,"int":s["int"],query:s.query,ay:s.ay};if(!s.tnt&&(o.tnt=e.tnt,"/"!==s.path[0]))if(s.path){var u=e.path,a=u.substring(0,u.lastIndexOf("/")+1)+s.path;o.path=c.$T(a)}else o.path=e.path,s["int"]||(o["int"]=e["int"],s.query||(o.query=e.query));return null===o.path&&(o.path=n.Jit?c.$T(s.path):s.path),c.Zit(o)},zit:function(t){var i=r.exec(t);return i?{scheme:i[1]||"",tnt:i[2]||"",path:i[3]||"","int":i[4]||"",query:i[5]||"",ay:i[6]||""}:null},$T:function(t){for(t=t.split("").reverse().join("").replace(s,"");t.length!==(t=t.replace(e,"")).length;);return t.split("").reverse().join("")},Zit:function(t){return t.scheme+t.tnt+t.path+t["int"]+t.query+t.ay}},t.exports=c},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(19),o=n(43),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion=o.Av.VD,t.initTimeout=6e4,t.warnSlowRespTimeout=5e3,t.supportLegacyClient=!1,t}i.Xit=u},function(t,i,n){"use strict";var e=this&&this.Dq||function(){return(e=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)};Object.defineProperty(i,"s",{value:!0});function r(t,s){var i=s.retryParameters,n=new o.cg({xhrSetup:function(t,i){var n=s.pluginId;for(var r in n?(t=new o.HiveRequestFactory(n).$b(),delete s.headers[h.SY]):t=new XMLHttpRequest(),t.open(i.method,i.url),i.headers)t.setRequestHeader(r,i.headers[r]);return t.responseType="arraybuffer",t.withCredentials=i.allowCrossSiteCredentials,t}}),r=new Promise(function(h,r){n.load(e({},s,{responseType:"arraybuffer",url:t}),{xK:i.maxAttempts,retryDelay:i.baseDelay,GK:1/0,timeout:i.timeout},{onSuccess:function(t,i,n){var r=t.data;if(t.data instanceof ArrayBuffer)r=o.BasicUtils.La(r);else{var s=unescape(encodeURIComponent(r));r=[];for(var e=0;e<s.length;e++)r.push(s.charCodeAt(e));r=new Uint8Array(r)}h({uri:t.url,data:r,headers:t.FK})},onError:function(t,i){var n=null;try{n=shaka.util.StringUtils.fromBytesAutoDetect(t.data)}catch(t){}r(new shaka.util.Error(shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.BAD_HTTP_STATUS,t.url,t.code,n))},onTimeout:function(){r(new shaka.util.Error(shaka.util.Error.Category.NETWORK,shaka.util.Error.Code.TIMEOUT,t))}})});return new shaka.util.AbortableOperation(r,function(){return n.abort(),Promise.resolve()})}var o=n(25),h=n(102);i.qY=r},function(t,i,n){"use strict";var r,e=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0}),i.xY=function(r){return s=shaka.abr.SimpleAbrManager,e(t,s),t.prototype.segmentDownloaded=function(t,i){var n=s.prototype.segmentDownloaded.call(this,t,i);return r.getActiveSession()&&(r.logger().debug(this.loggerId+"Segment downloaded!!!",t,i),0<=this.nnt&&r&&r._Y.accountCompleted(!0,this.nnt.toString(),i,!0)),n},t.prototype.chooseVariant=function(){var t=s.prototype.chooseVariant.call(this);return r.getActiveSession()&&(r.logger().debug(this.loggerId+"Variant chosen: ",t),t&&t.video&&t.video.bandwidth?this.rnt(t.video.bandwidth,r):t&&t.bandwidth&&this.rnt(t.bandwidth,r)),t},t.prototype.rnt=function(t,i){t<this.nnt?i._Y.bitrateSwitchDown():t>this.nnt&&i._Y.bitrateSwitchUp(),this.nnt=t},t;function t(){var t=s.call(this)||this;return t.nnt=0,t.loggerId="[HiveAbrManager] ",t}var s}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=(e=shaka.media.SimpleAbrManager,s(o,e),o.HY=function(){return null},o.prototype.snt=function(){var t=e.prototype.snt.call(this);if(t&&t.active){var i=o.HY()._Y,n=this.ent.nnt,r=t.bandwidth;r<n?i.bitrateSwitchDown():n<r&&i.bitrateSwitchUp(),this.ent.nnt=r}return t},o);function o(){return null!==e&&e.apply(this,arguments)||this}i.HiveAbrManager=h},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=(e=shaka.util.EWMABandwidthEstimator,s(o,e),o.HY=function(){return null},o.prototype.hQ=function(t,i){o.HY()._Y.accountCompleted(!0,String(this.nnt),i,!0),e.prototype.hQ.call(this,t,i)},o);function o(){var t=e.call(this)||this;return t.nnt=0,t}i.FY=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(25);i.GY=function(t,i){return function(){return function(t){var i=window.XMLHttpRequest;window.XMLHttpRequest=function(){return window.XMLHttpRequest=i,new r.HiveRequestFactory(t).$b()}}(t),i.apply(this,arguments)}}},function(t,i,n){"use strict";var r,s=this&&this.Sc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var o,u=n(25),a=(o=Error,s(e,o),e);function e(t,i,n,r,s,e){var h=o.call(this,t)||this;return h.type="Hive",h.url=i,h.method=n,h.responseHeaders=r,h.responseBody=s,h.status=e,h}i.getRequestPromise=function(t,h){var o=this;return new Promise(function(r,s){var e;new u.cg({xhrSetup:function(t,i){for(var n in(e=new u.HiveRequestFactory(o.getPluginId()).$b()).open("GET",i.url,!0),i.hnt)e.setRequestHeader(n,i.hnt[n]);e.responseType=i.responseType,e.withCredentials=i.withCredentials,e.onabort=function(){return s(new a("Request aborted.",e.url,"GET",e.responseHeaders,"",0))};try{h(e)}catch(t){o.logger().debug("[shaka.net.ts] beforeSendCallback error: ",t),u.logError("[shaka.net.ts] beforeSendCallback error: ",t)}return e}}).load(t,{retryDelay:t.retryDelay,xK:t.maxAttempts-1,timeout:0,GK:1/0},{onSuccess:function(t,i,n){o.logger().debug("onSuccess: ",t,i,n),r(e)},onError:function(t,i){o.logger().debug("onError: ",t,i),s(new a(t.text,e.url,"GET",e.responseHeaders,t.data,t.code))},onTimeout:function(t,i){o.logger().debug("onTimeout: ",t,i),s(new a("Timeout.",e.url,"GET",e.responseHeaders,"",0))}})})}}],g={},h.QO=f,h.c=g,h.d=function(t,i,n){h.ont(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"s",{value:!0})},h.t=function(i,t){if(1&t&&(i=h(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.s)return i;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var r in i)h.d(n,r,function(t){return i[t]}.bind(null,r));return n},h.n=function(t){var i=t&&t.s?function(){return t["default"]}:function(){return t};return h.d(i,"a",i),i},h.ont=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},h.yS="",h(h.ZO=103);function h(t){if(g[t])return g[t].exports;var i=g[t]={unt:t,ant:!1,exports:{}};return f[t].call(i.exports,i,i.exports,h),i.ant=!0,i.exports}var f,g})}),null);
__d("XVideoDataAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/video_data_async/",{video_id:{type:"String",required:!0},width:{type:"Int"},height:{type:"Int"},scrubbing_preference:{type:"Int"},source:{type:"String"},preferred_projection:{type:"Enum",enumType:1},supports_html5_video:{type:"Bool",defaultValue:!0},is_ad:{type:"Bool",defaultValue:!1},force_flash:{type:"Bool",defaultValue:!1},is_omnistab_preview_select_revert:{type:"Bool",defaultValue:!1},allow_dash_prefetch:{type:"Bool",defaultValue:!1},force_hd:{type:"Bool",defaultValue:!1},host_number:{type:"Int"},include_extra_drm_info:{type:"Bool",defaultValue:!0}})}),null);
__d("VideoDataAsyncControllerUri",["XVideoDataAsyncController"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.getURI=function(a,c,d,e,f,g,h,i){a=b("XVideoDataAsyncController").getURIBuilder().setString("video_id",a.toString()).setBool("supports_html5_video",c);d!==void 0&&(a=a.setBool("force_flash",d));e!==void 0&&(a=a.setBool("allow_dash_prefetch",e));f!==void 0&&(a=a.setBool("force_hd",f));g!==void 0&&(a=a.setInt("host_number",g));h!==void 0&&(a=a.setBool("include_extra_drm_info",h));i!==void 0&&(a=a.setString("source",i));return a.getURI()};return a}();e.exports=a}),null);
__d("canVideoPlayType",["DOM"],(function(a,b,c,d,e,f){var g=null;function a(a){g=g||b("DOM").create("video");return!("canPlayType"in g)?"":g.canPlayType(a)}e.exports=a}),null);
__d("supportsHTML5Video",["DOM","memoize"],(function(a,b,c,d,e,f){e.exports=b("memoize")(function(){return!!b("DOM").create("video").canPlayType})}),null);
__d("isHTML5VideoImplementationUnavailable",["VideoMimeTypes","canVideoPlayType","supportsHTML5Video"],(function(a,b,c,d,e,f){a=function(a){if(a){a=b("canVideoPlayType")(b("VideoMimeTypes").h264main30avc);return a!=="probably"}return!b("supportsHTML5Video")()};e.exports=a}),null);
__d("VideoPlayerMetaData",["regeneratorRuntime","Promise","ActorURI","AsyncRequest","TimeSlice","VideoData","VideoDataAsyncControllerUri","clearTimeout","isHTML5VideoImplementationUnavailable","setTimeout"],(function(a,b,c,d,e,f){"use strict";var g={},h=12e4;a=function(){function a(a){this.videoID=a}var c=a.prototype;c.getVideoID=function(){return this.videoID};c.genVideoData=function(a,c,d){var e=this,f;return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:g.prev=0;f=this.$1;(!f||a.forceRefetch)&&(this.$2&&(b("clearTimeout")(this.$2),this.$2=null),f=this.$1=this.$3(a,c),this.$2=b("setTimeout")(b("TimeSlice").guard(function(){e.$1=null,d()},"VideoPlayerMetaData cacheTimeout",{propagationType:b("TimeSlice").PropagationType.ORPHAN}),a.cacheTimeout||h));g.next=5;return b("regeneratorRuntime").awrap(f);case 5:return g.abrupt("return",g.sent);case 8:g.prev=8;g.t0=g["catch"](0);throw g.t0;case 11:case"end":return g.stop()}},null,this,[[0,8]])};c.$3=function(a,c){var d;d=(d=a==null?void 0:a.uriBuilder)!=null?d:new(b("VideoDataAsyncControllerUri"))();var e=a.forceFlash,f=a.allowDashPrefetch,g=a.forceHD,h=a.hostNumber,i=a.includeExtraDRMInfo;a=a.source;var j=d.getURI(this.videoID,!b("isHTML5VideoImplementationUnavailable")(!0),e,f,g,h,i,a);c!=null&&(j=b("ActorURI").create(j,c));return new(b("Promise"))(function(a,c){new(b("AsyncRequest"))(j).setMethod("GET").setURI(j).setReadOnly(!0).setAllowCrossPageTransition(!0).setHandler(function(d){d=d.payload;!d.error?a(new(b("VideoData"))(d)):c(d.error)}).setErrorHandler(function(a){c(a.getErrorDescription())}).send()})};a.get=function(b){g[b]||(g[b]=new a(b));return g[b]};a.genVideoData=function(c,d,e,f){return b("regeneratorRuntime").async(function(g){while(1)switch(g.prev=g.next){case 0:d===void 0&&(d={});e===void 0&&(e=void 0);f===void 0&&(f=function(){});g.next=5;return b("regeneratorRuntime").awrap(a.get(c).genVideoData(d,e,f));case 5:return g.abrupt("return",g.sent);case 6:case"end":return g.stop()}},null,this)};return a}();e.exports=a}),null);
__d("VideoQualityClasses",["VideoQualityClassInternal"],(function(a,b,c,d,e,f){e.exports=b("VideoQualityClassInternal").orderedValues}),null);
__d("getBufferedAheadOf",[],(function(a,b,c,d,e,f){function a(a){var b=1/60,c=a.currentTime;a=a.buffered;for(var d=0;d<a.length;d++){var e=a.start(d)-b,f=a.end(d)+b;if(c>=e&&c<=f)return Math.max(a.end(d)-c,0)}return 0}e.exports=a}),null);
__d("VideoPlayerPlayLogger",["EventListener","SubscriptionsHandler"],(function(a,b,c,d,e,f){a=function(){"use strict";function a(a,c){var d=this;this.$3=new(b("SubscriptionsHandler"))();this.$1=a;this.$2=c;this.$3.addSubscriptions(b("EventListener").listen(this.$1,"playing",function(){return d.$5()}),b("EventListener").listen(this.$1,"pause",function(){return d.$6()}))}var c=a.prototype;c.playStarted=function(){(this.$1.paused||this.$1.ended)&&(this.$4=this.$2.getOperationLogger("play").setState("pending_play").start())};c.$6=function(){this.$4&&(this.$4.setResult("aborted").log(),this.$4=null)};c.$5=function(){this.$4&&(this.$4.log(),this.$4=null)};c.unload=function(){this.$3.release()};return a}();e.exports=a}),null);
__d("dangerouslyOverrideMediaElementEndedProperty",[],(function(a,b,c,d,e,f){function a(a){a===void 0&&(a={});a.dangerouslyOverrideMediaElementEndedProperty=!0;return a}a.isEnded=function(a){return!!(a&&a.detail&&a.detail.dangerouslyOverrideMediaElementEndedProperty)};e.exports=a}),null);